/*! For license information please see main.d2b2e823.js.LICENSE.txt */
(()=>{"use strict";var e={4:(e,t,n)=>{var r=n(853),i=n(43),s=n(950);function o(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function l(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function c(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function u(e){if(l(e)!==e)throw Error(o(188))}function d(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=d(e)))return t;e=e.sibling}return null}var h=Object.assign,f=Symbol.for("react.element"),p=Symbol.for("react.transitional.element"),m=Symbol.for("react.portal"),g=Symbol.for("react.fragment"),v=Symbol.for("react.strict_mode"),y=Symbol.for("react.profiler"),b=Symbol.for("react.provider"),_=Symbol.for("react.consumer"),w=Symbol.for("react.context"),x=Symbol.for("react.forward_ref"),S=Symbol.for("react.suspense"),k=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),E=Symbol.for("react.lazy");Symbol.for("react.scope");var C=Symbol.for("react.activity");Symbol.for("react.legacy_hidden"),Symbol.for("react.tracing_marker");var N=Symbol.for("react.memo_cache_sentinel");Symbol.for("react.view_transition");var I=Symbol.iterator;function P(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=I&&e[I]||e["@@iterator"])?e:null}var A=Symbol.for("react.client.reference");function R(e){if(null==e)return null;if("function"===typeof e)return e.$$typeof===A?null:e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case g:return"Fragment";case y:return"Profiler";case v:return"StrictMode";case S:return"Suspense";case k:return"SuspenseList";case C:return"Activity"}if("object"===typeof e)switch(e.$$typeof){case m:return"Portal";case w:return(e.displayName||"Context")+".Provider";case _:return(e._context.displayName||"Context")+".Consumer";case x:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case T:return null!==(t=e.displayName||null)?t:R(e.type)||"Memo";case E:t=e._payload,e=e._init;try{return R(e(t))}catch(sa){}}return null}var D=Array.isArray,O=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,j=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,L={pending:!1,data:null,method:null,action:null},M=[],F=-1;function U(e){return{current:e}}function V(e){0>F||(e.current=M[F],M[F]=null,F--)}function z(e,t){F++,M[F]=e.current,e.current=t}var $=U(null),q=U(null),B=U(null),H=U(null);function W(e,t){switch(z(B,t),z(q,e),z($,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?sd(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=od(t=sd(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}V($),z($,e)}function K(){V($),V(q),V(B)}function G(e){null!==e.memoizedState&&z(H,e);var t=$.current,n=od(t,e.type);t!==n&&(z(q,e),z($,n))}function Q(e){q.current===e&&(V($),V(q)),H.current===e&&(V(H),Qd._currentValue=L)}var Y=Object.prototype.hasOwnProperty,X=r.unstable_scheduleCallback,J=r.unstable_cancelCallback,Z=r.unstable_shouldYield,ee=r.unstable_requestPaint,te=r.unstable_now,ne=r.unstable_getCurrentPriorityLevel,re=r.unstable_ImmediatePriority,ie=r.unstable_UserBlockingPriority,se=r.unstable_NormalPriority,oe=r.unstable_LowPriority,ae=r.unstable_IdlePriority,le=r.log,ce=r.unstable_setDisableYieldValue,ue=null,de=null;function he(e){if("function"===typeof le&&ce(e),de&&"function"===typeof de.setStrictMode)try{de.setStrictMode(ue,e)}catch(t){}}var fe=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(pe(e)/me|0)|0},pe=Math.log,me=Math.LN2;var ge=256,ve=4194304;function ye(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194048&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function be(e,t,n){var r=e.pendingLanes;if(0===r)return 0;var i=0,s=e.suspendedLanes,o=e.pingedLanes;e=e.warmLanes;var a=134217727&r;return 0!==a?0!==(r=a&~s)?i=ye(r):0!==(o&=a)?i=ye(o):n||0!==(n=a&~e)&&(i=ye(n)):0!==(a=r&~s)?i=ye(a):0!==o?i=ye(o):n||0!==(n=r&~e)&&(i=ye(n)),0===i?0:0!==t&&t!==i&&0===(t&s)&&((s=i&-i)>=(n=t&-t)||32===s&&0!==(4194048&n))?t:i}function _e(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function we(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function xe(){var e=ge;return 0===(4194048&(ge<<=1))&&(ge=256),e}function Se(){var e=ve;return 0===(62914560&(ve<<=1))&&(ve=4194304),e}function ke(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Te(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Ee(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var r=31-fe(t);e.entangledLanes|=t,e.entanglements[r]=1073741824|e.entanglements[r]|4194090&n}function Ce(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-fe(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}function Ne(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Ie(e){return 2<(e&=-e)?8<e?0!==(134217727&e)?32:268435456:8:2}function Pe(){var e=j.p;return 0!==e?e:void 0===(e=window.event)?32:uh(e.type)}var Ae=Math.random().toString(36).slice(2),Re="__reactFiber$"+Ae,De="__reactProps$"+Ae,Oe="__reactContainer$"+Ae,je="__reactEvents$"+Ae,Le="__reactListeners$"+Ae,Me="__reactHandles$"+Ae,Fe="__reactResources$"+Ae,Ue="__reactMarker$"+Ae;function Ve(e){delete e[Re],delete e[De],delete e[je],delete e[Le],delete e[Me]}function ze(e){var t=e[Re];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Oe]||n[Re]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=_d(e);null!==e;){if(n=e[Re])return n;e=_d(e)}return t}n=(e=n).parentNode}return null}function $e(e){if(e=e[Re]||e[Oe]){var t=e.tag;if(5===t||6===t||13===t||26===t||27===t||3===t)return e}return null}function qe(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(o(33))}function Be(e){var t=e[Fe];return t||(t=e[Fe]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function He(e){e[Ue]=!0}var We=new Set,Ke={};function Ge(e,t){Qe(e,t),Qe(e+"Capture",t)}function Qe(e,t){for(Ke[e]=t,e=0;e<t.length;e++)We.add(t[e])}var Ye,Xe,Je=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ze={},et={};function tt(e,t,n){if(i=t,Y.call(et,i)||!Y.call(Ze,i)&&(Je.test(i)?et[i]=!0:(Ze[i]=!0,0)))if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var r=t.toLowerCase().slice(0,5);if("data-"!==r&&"aria-"!==r)return void e.removeAttribute(t)}e.setAttribute(t,""+n)}var i}function nt(e,t,n){if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+n)}}function rt(e,t,n,r){if(null===r)e.removeAttribute(n);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(n)}e.setAttributeNS(t,n,""+r)}}function it(e){if(void 0===Ye)try{throw Error()}catch(sa){var t=sa.stack.trim().match(/\n( *(at )?)/);Ye=t&&t[1]||"",Xe=-1<sa.stack.indexOf("\n    at")?" (<anonymous>)":-1<sa.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+Ye+e+Xe}var st=!1;function ot(e,t){if(!e||st)return"";st=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(t){var n=function(){throw Error()};if(Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(n,[])}catch(sa){var r=sa}Reflect.construct(e,[],n)}else{try{n.call()}catch(i){r=i}e.call(n.prototype)}}else{try{throw Error()}catch(s){r=s}(n=e())&&"function"===typeof n.catch&&n.catch(function(){})}}catch(o){if(o&&r&&"string"===typeof o.stack)return[o.stack,r.stack]}return[null,null]}};r.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var i=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,"name");i&&i.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var s=r.DetermineComponentFrameRoot(),o=s[0],a=s[1];if(o&&a){var l=o.split("\n"),c=a.split("\n");for(i=r=0;r<l.length&&!l[r].includes("DetermineComponentFrameRoot");)r++;for(;i<c.length&&!c[i].includes("DetermineComponentFrameRoot");)i++;if(r===l.length||i===c.length)for(r=l.length-1,i=c.length-1;1<=r&&0<=i&&l[r]!==c[i];)i--;for(;1<=r&&0<=i;r--,i--)if(l[r]!==c[i]){if(1!==r||1!==i)do{if(r--,0>--i||l[r]!==c[i]){var u="\n"+l[r].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=r&&0<=i);break}}}finally{st=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?it(n):""}function at(e){switch(e.tag){case 26:case 27:case 5:return it(e.type);case 16:return it("Lazy");case 13:return it("Suspense");case 19:return it("SuspenseList");case 0:case 15:return ot(e.type,!1);case 11:return ot(e.type.render,!1);case 1:return ot(e.type,!0);case 31:return it("Activity");default:return""}}function lt(e){try{var t="";do{t+=at(e),e=e.return}while(e);return t}catch(sa){return"\nError generating stack: "+sa.message+"\n"+sa.stack}}function ct(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function ut(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function dt(e){e._valueTracker||(e._valueTracker=function(e){var t=ut(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function ht(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=ut(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function ft(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(NT){return e.body}}var pt=/[\n"\\]/g;function mt(e){return e.replace(pt,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function gt(e,t,n,r,i,s,o,a){e.name="",null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o?e.type=o:e.removeAttribute("type"),null!=t?"number"===o?(0===t&&""===e.value||e.value!=t)&&(e.value=""+ct(t)):e.value!==""+ct(t)&&(e.value=""+ct(t)):"submit"!==o&&"reset"!==o||e.removeAttribute("value"),null!=t?yt(e,o,ct(t)):null!=n?yt(e,o,ct(n)):null!=r&&e.removeAttribute("value"),null==i&&null!=s&&(e.defaultChecked=!!s),null!=i&&(e.checked=i&&"function"!==typeof i&&"symbol"!==typeof i),null!=a&&"function"!==typeof a&&"symbol"!==typeof a&&"boolean"!==typeof a?e.name=""+ct(a):e.removeAttribute("name")}function vt(e,t,n,r,i,s,o,a){if(null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s&&(e.type=s),null!=t||null!=n){if(!("submit"!==s&&"reset"!==s||void 0!==t&&null!==t))return;n=null!=n?""+ct(n):"",t=null!=t?""+ct(t):n,a||t===e.value||(e.value=t),e.defaultValue=t}r="function"!==typeof(r=null!=r?r:i)&&"symbol"!==typeof r&&!!r,e.checked=a?e.checked:!!r,e.defaultChecked=!!r,null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o&&(e.name=o)}function yt(e,t,n){"number"===t&&ft(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function bt(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+ct(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function _t(e,t,n){null==t||((t=""+ct(t))!==e.value&&(e.value=t),null!=n)?e.defaultValue=null!=n?""+ct(n):"":e.defaultValue!==t&&(e.defaultValue=t)}function wt(e,t,n,r){if(null==t){if(null!=r){if(null!=n)throw Error(o(92));if(D(r)){if(1<r.length)throw Error(o(93));r=r[0]}n=r}null==n&&(n=""),t=n}n=ct(t),e.defaultValue=n,(r=e.textContent)===n&&""!==r&&null!==r&&(e.value=r)}function xt(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var St=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function kt(e,t,n){var r=0===t.indexOf("--");null==n||"boolean"===typeof n||""===n?r?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":r?e.setProperty(t,n):"number"!==typeof n||0===n||St.has(t)?"float"===t?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function Tt(e,t,n){if(null!=t&&"object"!==typeof t)throw Error(o(62));if(e=e.style,null!=n){for(var r in n)!n.hasOwnProperty(r)||null!=t&&t.hasOwnProperty(r)||(0===r.indexOf("--")?e.setProperty(r,""):"float"===r?e.cssFloat="":e[r]="");for(var i in t)r=t[i],t.hasOwnProperty(i)&&n[i]!==r&&kt(e,i,r)}else for(var s in t)t.hasOwnProperty(s)&&kt(e,s,t[s])}function Et(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ct=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Nt=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function It(e){return Nt.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var Pt=null;function At(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Rt=null,Dt=null;function Ot(e){var t=$e(e);if(t&&(e=t.stateNode)){var n=e[De]||null;e:switch(e=t.stateNode,t.type){case"input":if(gt(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+mt(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=r[De]||null;if(!i)throw Error(o(90));gt(r,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name)}}for(t=0;t<n.length;t++)(r=n[t]).form===e.form&&ht(r)}break e;case"textarea":_t(e,n.value,n.defaultValue);break e;case"select":null!=(t=n.value)&&bt(e,!!n.multiple,t,!1)}}}var jt=!1;function Lt(e,t,n){if(jt)return e(t,n);jt=!0;try{return e(t)}finally{if(jt=!1,(null!==Rt||null!==Dt)&&($c(),Rt&&(t=Rt,e=Dt,Dt=Rt=null,Ot(t),e)))for(t=0;t<e.length;t++)Ot(e[t])}}function Mt(e,t){var n=e.stateNode;if(null===n)return null;var r=n[De]||null;if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(o(231,t,typeof n));return n}var Ft=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),Ut=!1;if(Ft)try{var Vt={};Object.defineProperty(Vt,"passive",{get:function(){Ut=!0}}),window.addEventListener("test",Vt,Vt),window.removeEventListener("test",Vt,Vt)}catch(NT){Ut=!1}var zt=null,$t=null,qt=null;function Bt(){if(qt)return qt;var e,t,n=$t,r=n.length,i="value"in zt?zt.value:zt.textContent,s=i.length;for(e=0;e<r&&n[e]===i[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===i[s-t];t++);return qt=i.slice(e,1<t?1-t:void 0)}function Ht(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Wt(){return!0}function Kt(){return!1}function Gt(e){function t(t,n,r,i,s){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(i):i[o]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?Wt:Kt,this.isPropagationStopped=Kt,this}return h(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Wt)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Wt)},persist:function(){},isPersistent:Wt}),t}var Qt,Yt,Xt,Jt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Zt=Gt(Jt),en=h({},Jt,{view:0,detail:0}),tn=Gt(en),nn=h({},en,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:pn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Xt&&(Xt&&"mousemove"===e.type?(Qt=e.screenX-Xt.screenX,Yt=e.screenY-Xt.screenY):Yt=Qt=0,Xt=e),Qt)},movementY:function(e){return"movementY"in e?e.movementY:Yt}}),rn=Gt(nn),sn=Gt(h({},nn,{dataTransfer:0})),on=Gt(h({},en,{relatedTarget:0})),an=Gt(h({},Jt,{animationName:0,elapsedTime:0,pseudoElement:0})),ln=Gt(h({},Jt,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),cn=Gt(h({},Jt,{data:0})),un={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},dn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},hn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=hn[e])&&!!t[e]}function pn(){return fn}var mn=Gt(h({},en,{key:function(e){if(e.key){var t=un[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Ht(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?dn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:pn,charCode:function(e){return"keypress"===e.type?Ht(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Ht(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),gn=Gt(h({},nn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),vn=Gt(h({},en,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:pn})),yn=Gt(h({},Jt,{propertyName:0,elapsedTime:0,pseudoElement:0})),bn=Gt(h({},nn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),_n=Gt(h({},Jt,{newState:0,oldState:0})),wn=[9,13,27,32],xn=Ft&&"CompositionEvent"in window,Sn=null;Ft&&"documentMode"in document&&(Sn=document.documentMode);var kn=Ft&&"TextEvent"in window&&!Sn,Tn=Ft&&(!xn||Sn&&8<Sn&&11>=Sn),En=String.fromCharCode(32),Cn=!1;function Nn(e,t){switch(e){case"keyup":return-1!==wn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function In(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Pn=!1;var An={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Rn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!An[e.type]:"textarea"===t}function Dn(e,t,n,r){Rt?Dt?Dt.push(r):Dt=[r]:Rt=r,0<(t=Hu(t,"onChange")).length&&(n=new Zt("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var On=null,jn=null;function Ln(e){Mu(e,0)}function Mn(e){if(ht(qe(e)))return e}function Fn(e,t){if("change"===e)return t}var Un=!1;if(Ft){var Vn;if(Ft){var zn="oninput"in document;if(!zn){var $n=document.createElement("div");$n.setAttribute("oninput","return;"),zn="function"===typeof $n.oninput}Vn=zn}else Vn=!1;Un=Vn&&(!document.documentMode||9<document.documentMode)}function qn(){On&&(On.detachEvent("onpropertychange",Bn),jn=On=null)}function Bn(e){if("value"===e.propertyName&&Mn(jn)){var t=[];Dn(t,jn,e,At(e)),Lt(Ln,t)}}function Hn(e,t,n){"focusin"===e?(qn(),jn=n,(On=t).attachEvent("onpropertychange",Bn)):"focusout"===e&&qn()}function Wn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Mn(jn)}function Kn(e,t){if("click"===e)return Mn(t)}function Gn(e,t){if("input"===e||"change"===e)return Mn(t)}var Qn="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function Yn(e,t){if(Qn(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Y.call(t,i)||!Qn(e[i],t[i]))return!1}return!0}function Xn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Jn(e,t){var n,r=Xn(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Xn(r)}}function Zn(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?Zn(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function er(e){for(var t=ft((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=ft((e=t.contentWindow).document)}return t}function tr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var nr=Ft&&"documentMode"in document&&11>=document.documentMode,rr=null,ir=null,sr=null,or=!1;function ar(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;or||null==rr||rr!==ft(r)||("selectionStart"in(r=rr)&&tr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},sr&&Yn(sr,r)||(sr=r,0<(r=Hu(ir,"onSelect")).length&&(t=new Zt("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=rr)))}function lr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var cr={animationend:lr("Animation","AnimationEnd"),animationiteration:lr("Animation","AnimationIteration"),animationstart:lr("Animation","AnimationStart"),transitionrun:lr("Transition","TransitionRun"),transitionstart:lr("Transition","TransitionStart"),transitioncancel:lr("Transition","TransitionCancel"),transitionend:lr("Transition","TransitionEnd")},ur={},dr={};function hr(e){if(ur[e])return ur[e];if(!cr[e])return e;var t,n=cr[e];for(t in n)if(n.hasOwnProperty(t)&&t in dr)return ur[e]=n[t];return e}Ft&&(dr=document.createElement("div").style,"AnimationEvent"in window||(delete cr.animationend.animation,delete cr.animationiteration.animation,delete cr.animationstart.animation),"TransitionEvent"in window||delete cr.transitionend.transition);var fr=hr("animationend"),pr=hr("animationiteration"),mr=hr("animationstart"),gr=hr("transitionrun"),vr=hr("transitionstart"),yr=hr("transitioncancel"),br=hr("transitionend"),_r=new Map,wr="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function xr(e,t){_r.set(e,t),Ge(t,[e])}wr.push("scrollEnd");var Sr=new WeakMap;function kr(e,t){if("object"===typeof e&&null!==e){var n=Sr.get(e);return void 0!==n?n:(t={value:e,source:t,stack:lt(t)},Sr.set(e,t),t)}return{value:e,source:t,stack:lt(t)}}var Tr=[],Er=0,Cr=0;function Nr(){for(var e=Er,t=Cr=Er=0;t<e;){var n=Tr[t];Tr[t++]=null;var r=Tr[t];Tr[t++]=null;var i=Tr[t];Tr[t++]=null;var s=Tr[t];if(Tr[t++]=null,null!==r&&null!==i){var o=r.pending;null===o?i.next=i:(i.next=o.next,o.next=i),r.pending=i}0!==s&&Rr(n,i,s)}}function Ir(e,t,n,r){Tr[Er++]=e,Tr[Er++]=t,Tr[Er++]=n,Tr[Er++]=r,Cr|=r,e.lanes|=r,null!==(e=e.alternate)&&(e.lanes|=r)}function Pr(e,t,n,r){return Ir(e,t,n,r),Dr(e)}function Ar(e,t){return Ir(e,null,null,t),Dr(e)}function Rr(e,t,n){e.lanes|=n;var r=e.alternate;null!==r&&(r.lanes|=n);for(var i=!1,s=e.return;null!==s;)s.childLanes|=n,null!==(r=s.alternate)&&(r.childLanes|=n),22===s.tag&&(null===(e=s.stateNode)||1&e._visibility||(i=!0)),e=s,s=s.return;return 3===e.tag?(s=e.stateNode,i&&null!==t&&(i=31-fe(n),null===(r=(e=s.hiddenUpdates)[i])?e[i]=[t]:r.push(t),t.lane=536870912|n),s):null}function Dr(e){if(50<Dc)throw Dc=0,Oc=null,Error(o(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var Or={};function jr(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Lr(e,t,n,r){return new jr(e,t,n,r)}function Mr(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Fr(e,t){var n=e.alternate;return null===n?((n=Lr(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=65011712&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function Ur(e,t){e.flags&=65011714;var n=e.alternate;return null===n?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Vr(e,t,n,r,i,s){var a=0;if(r=e,"function"===typeof e)Mr(e)&&(a=1);else if("string"===typeof e)a=function(e,t,n){if(1===n||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!==typeof t.precedence||"string"!==typeof t.href||""===t.href)break;return!0;case"link":if("string"!==typeof t.rel||"string"!==typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"===typeof t.precedence&&null==e);case"script":if(t.async&&"function"!==typeof t.async&&"symbol"!==typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"===typeof t.src)return!0}return!1}(e,n,$.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case C:return(e=Lr(31,n,t,i)).elementType=C,e.lanes=s,e;case g:return zr(n.children,i,s,t);case v:a=8,i|=24;break;case y:return(e=Lr(12,n,t,2|i)).elementType=y,e.lanes=s,e;case S:return(e=Lr(13,n,t,i)).elementType=S,e.lanes=s,e;case k:return(e=Lr(19,n,t,i)).elementType=k,e.lanes=s,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case b:case w:a=10;break e;case _:a=9;break e;case x:a=11;break e;case T:a=14;break e;case E:a=16,r=null;break e}a=29,n=Error(o(130,null===e?"null":typeof e,"")),r=null}return(t=Lr(a,n,t,i)).elementType=e,t.type=r,t.lanes=s,t}function zr(e,t,n,r){return(e=Lr(7,e,r,t)).lanes=n,e}function $r(e,t,n){return(e=Lr(6,e,null,t)).lanes=n,e}function qr(e,t,n){return(t=Lr(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Br=[],Hr=0,Wr=null,Kr=0,Gr=[],Qr=0,Yr=null,Xr=1,Jr="";function Zr(e,t){Br[Hr++]=Kr,Br[Hr++]=Wr,Wr=e,Kr=t}function ei(e,t,n){Gr[Qr++]=Xr,Gr[Qr++]=Jr,Gr[Qr++]=Yr,Yr=e;var r=Xr;e=Jr;var i=32-fe(r)-1;r&=~(1<<i),n+=1;var s=32-fe(t)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Xr=1<<32-fe(t)+i|n<<i|r,Jr=s+e}else Xr=1<<s|n<<i|r,Jr=e}function ti(e){null!==e.return&&(Zr(e,1),ei(e,1,0))}function ni(e){for(;e===Wr;)Wr=Br[--Hr],Br[Hr]=null,Kr=Br[--Hr],Br[Hr]=null;for(;e===Yr;)Yr=Gr[--Qr],Gr[Qr]=null,Jr=Gr[--Qr],Gr[Qr]=null,Xr=Gr[--Qr],Gr[Qr]=null}var ri=null,ii=null,si=!1,oi=null,ai=!1,li=Error(o(519));function ci(e){throw mi(kr(Error(o(418,"")),e)),li}function ui(e){var t=e.stateNode,n=e.type,r=e.memoizedProps;switch(t[Re]=e,t[De]=r,n){case"dialog":Fu("cancel",t),Fu("close",t);break;case"iframe":case"object":case"embed":Fu("load",t);break;case"video":case"audio":for(n=0;n<ju.length;n++)Fu(ju[n],t);break;case"source":Fu("error",t);break;case"img":case"image":case"link":Fu("error",t),Fu("load",t);break;case"details":Fu("toggle",t);break;case"input":Fu("invalid",t),vt(t,r.value,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name,!0),dt(t);break;case"select":Fu("invalid",t);break;case"textarea":Fu("invalid",t),wt(t,r.value,r.defaultValue,r.children),dt(t)}"string"!==typeof(n=r.children)&&"number"!==typeof n&&"bigint"!==typeof n||t.textContent===""+n||!0===r.suppressHydrationWarning||Xu(t.textContent,n)?(null!=r.popover&&(Fu("beforetoggle",t),Fu("toggle",t)),null!=r.onScroll&&Fu("scroll",t),null!=r.onScrollEnd&&Fu("scrollend",t),null!=r.onClick&&(t.onclick=Ju),t=!0):t=!1,t||ci(e)}function di(e){for(ri=e.return;ri;)switch(ri.tag){case 5:case 13:return void(ai=!1);case 27:case 3:return void(ai=!0);default:ri=ri.return}}function hi(e){if(e!==ri)return!1;if(!si)return di(e),si=!0,!1;var t,n=e.tag;if((t=3!==n&&27!==n)&&((t=5===n)&&(t=!("form"!==(t=e.type)&&"button"!==t)||ad(e.type,e.memoizedProps)),t=!t),t&&ii&&ci(e),di(e),13===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(o(317));e:{for(e=e.nextSibling,n=0;e;){if(8===e.nodeType)if("/$"===(t=e.data)){if(0===n){ii=yd(e.nextSibling);break e}n--}else"$"!==t&&"$!"!==t&&"$?"!==t||n++;e=e.nextSibling}ii=null}}else 27===n?(n=ii,pd(e.type)?(e=bd,bd=null,ii=e):ii=n):ii=ri?yd(e.stateNode.nextSibling):null;return!0}function fi(){ii=ri=null,si=!1}function pi(){var e=oi;return null!==e&&(null===_c?_c=e:_c.push.apply(_c,e),oi=null),e}function mi(e){null===oi?oi=[e]:oi.push(e)}var gi=U(null),vi=null,yi=null;function bi(e,t,n){z(gi,t._currentValue),t._currentValue=n}function _i(e){e._currentValue=gi.current,V(gi)}function wi(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function xi(e,t,n,r){var i=e.child;for(null!==i&&(i.return=e);null!==i;){var s=i.dependencies;if(null!==s){var a=i.child;s=s.firstContext;e:for(;null!==s;){var l=s;s=i;for(var c=0;c<t.length;c++)if(l.context===t[c]){s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),wi(s.return,n,e),r||(a=null);break e}s=l.next}}else if(18===i.tag){if(null===(a=i.return))throw Error(o(341));a.lanes|=n,null!==(s=a.alternate)&&(s.lanes|=n),wi(a,n,e),a=null}else a=i.child;if(null!==a)a.return=i;else for(a=i;null!==a;){if(a===e){a=null;break}if(null!==(i=a.sibling)){i.return=a.return,a=i;break}a=a.return}i=a}}function Si(e,t,n,r){e=null;for(var i=t,s=!1;null!==i;){if(!s)if(0!==(524288&i.flags))s=!0;else if(0!==(262144&i.flags))break;if(10===i.tag){var a=i.alternate;if(null===a)throw Error(o(387));if(null!==(a=a.memoizedProps)){var l=i.type;Qn(i.pendingProps.value,a.value)||(null!==e?e.push(l):e=[l])}}else if(i===H.current){if(null===(a=i.alternate))throw Error(o(387));a.memoizedState.memoizedState!==i.memoizedState.memoizedState&&(null!==e?e.push(Qd):e=[Qd])}i=i.return}null!==e&&xi(t,e,n,r),t.flags|=262144}function ki(e){for(e=e.firstContext;null!==e;){if(!Qn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Ti(e){vi=e,yi=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function Ei(e){return Ni(vi,e)}function Ci(e,t){return null===vi&&Ti(e),Ni(e,t)}function Ni(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},null===yi){if(null===e)throw Error(o(308));yi=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else yi=yi.next=t;return n}var Ii="undefined"!==typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},Pi=r.unstable_scheduleCallback,Ai=r.unstable_NormalPriority,Ri={$$typeof:w,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Di(){return{controller:new Ii,data:new Map,refCount:0}}function Oi(e){e.refCount--,0===e.refCount&&Pi(Ai,function(){e.controller.abort()})}var ji=null,Li=0,Mi=0,Fi=null;function Ui(){if(0===--Li&&null!==ji){null!==Fi&&(Fi.status="fulfilled");var e=ji;ji=null,Mi=0,Fi=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var Vi=O.S;O.S=function(e,t){"object"===typeof t&&null!==t&&"function"===typeof t.then&&function(e,t){if(null===ji){var n=ji=[];Li=0,Mi=Pu(),Fi={status:"pending",value:void 0,then:function(e){n.push(e)}}}Li++,t.then(Ui,Ui)}(0,t),null!==Vi&&Vi(e,t)};var zi=U(null);function $i(){var e=zi.current;return null!==e?e:ic.pooledCache}function qi(e,t){z(zi,null===t?zi.current:t.pool)}function Bi(){var e=$i();return null===e?null:{parent:Ri._currentValue,pool:e}}var Hi=Error(o(460)),Wi=Error(o(474)),Ki=Error(o(542)),Gi={then:function(){}};function Qi(e){return"fulfilled"===(e=e.status)||"rejected"===e}function Yi(){}function Xi(e,t,n){switch(void 0===(n=e[n])?e.push(t):n!==t&&(t.then(Yi,Yi),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw es(e=t.reason),e;default:if("string"===typeof t.status)t.then(Yi,Yi);else{if(null!==(e=ic)&&100<e.shellSuspendCounter)throw Error(o(482));(e=t).status="pending",e.then(function(e){if("pending"===t.status){var n=t;n.status="fulfilled",n.value=e}},function(e){if("pending"===t.status){var n=t;n.status="rejected",n.reason=e}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw es(e=t.reason),e}throw Ji=t,Hi}}var Ji=null;function Zi(){if(null===Ji)throw Error(o(459));var e=Ji;return Ji=null,e}function es(e){if(e===Hi||e===Ki)throw Error(o(483))}var ts=!1;function ns(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function rs(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function is(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function ss(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&rc)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,t=Dr(e),Rr(e,null,n),t}return Ir(e,r,t,n),Dr(e)}function os(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194048&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,Ce(e,n)}}function as(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var o={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};null===s?i=s=o:s=s.next=o,n=n.next}while(null!==n);null===s?i=s=t:s=s.next=t}else i=s=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,callbacks:r.callbacks},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var ls=!1;function cs(){if(ls){if(null!==Fi)throw Fi}}function us(e,t,n,r){ls=!1;var i=e.updateQueue;ts=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(null!==a){i.shared.pending=null;var l=a,c=l.next;l.next=null,null===o?s=c:o.next=c,o=l;var u=e.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==o&&(null===a?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(null!==s){var d=i.baseState;for(o=0,u=c=l=null,a=s;;){var f=-536870913&a.lane,p=f!==a.lane;if(p?(oc&f)===f:(r&f)===f){0!==f&&f===Mi&&(ls=!0),null!==u&&(u=u.next={lane:0,tag:a.tag,payload:a.payload,callback:null,next:null});e:{var m=e,g=a;f=t;var v=n;switch(g.tag){case 1:if("function"===typeof(m=g.payload)){d=m.call(v,d,f);break e}d=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null===(f="function"===typeof(m=g.payload)?m.call(v,d,f):m)||void 0===f)break e;d=h({},d,f);break e;case 2:ts=!0}}null!==(f=a.callback)&&(e.flags|=64,p&&(e.flags|=8192),null===(p=i.callbacks)?i.callbacks=[f]:p.push(f))}else p={lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(c=u=p,l=d):u=u.next=p,o|=f;if(null===(a=a.next)){if(null===(a=i.shared.pending))break;a=(p=a).next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}null===u&&(l=d),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,null===s&&(i.shared.lanes=0),pc|=o,e.lanes=o,e.memoizedState=d}}function ds(e,t){if("function"!==typeof e)throw Error(o(191,e));e.call(t)}function hs(e,t){var n=e.callbacks;if(null!==n)for(e.callbacks=null,e=0;e<n.length;e++)ds(n[e],t)}var fs=U(null),ps=U(0);function ms(e,t){z(ps,e=hc),z(fs,t),hc=e|t.baseLanes}function gs(){z(ps,hc),z(fs,fs.current)}function vs(){hc=ps.current,V(fs),V(ps)}var ys=0,bs=null,_s=null,ws=null,xs=!1,Ss=!1,ks=!1,Ts=0,Es=0,Cs=null,Ns=0;function Is(){throw Error(o(321))}function Ps(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Qn(e[n],t[n]))return!1;return!0}function As(e,t,n,r,i,s){return ys=s,bs=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,O.H=null===e||null===e.memoizedState?Wo:Ko,ks=!1,s=n(r,i),ks=!1,Ss&&(s=Ds(t,n,r,i)),Rs(e),s}function Rs(e){O.H=Ho;var t=null!==_s&&null!==_s.next;if(ys=0,ws=_s=bs=null,xs=!1,Es=0,Cs=null,t)throw Error(o(300));null===e||Na||null!==(e=e.dependencies)&&ki(e)&&(Na=!0)}function Ds(e,t,n,r){bs=e;var i=0;do{if(Ss&&(Cs=null),Es=0,Ss=!1,25<=i)throw Error(o(301));if(i+=1,ws=_s=null,null!=e.updateQueue){var s=e.updateQueue;s.lastEffect=null,s.events=null,s.stores=null,null!=s.memoCache&&(s.memoCache.index=0)}O.H=Go,s=t(n,r)}while(Ss);return s}function Os(){var e=O.H,t=e.useState()[0];return t="function"===typeof t.then?Vs(t):t,e=e.useState()[0],(null!==_s?_s.memoizedState:null)!==e&&(bs.flags|=1024),t}function js(){var e=0!==Ts;return Ts=0,e}function Ls(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function Ms(e){if(xs){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}xs=!1}ys=0,ws=_s=bs=null,Ss=!1,Es=Ts=0,Cs=null}function Fs(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ws?bs.memoizedState=ws=e:ws=ws.next=e,ws}function Us(){if(null===_s){var e=bs.alternate;e=null!==e?e.memoizedState:null}else e=_s.next;var t=null===ws?bs.memoizedState:ws.next;if(null!==t)ws=t,_s=e;else{if(null===e){if(null===bs.alternate)throw Error(o(467));throw Error(o(310))}e={memoizedState:(_s=e).memoizedState,baseState:_s.baseState,baseQueue:_s.baseQueue,queue:_s.queue,next:null},null===ws?bs.memoizedState=ws=e:ws=ws.next=e}return ws}function Vs(e){var t=Es;return Es+=1,null===Cs&&(Cs=[]),e=Xi(Cs,e,t),t=bs,null===(null===ws?t.memoizedState:ws.next)&&(t=t.alternate,O.H=null===t||null===t.memoizedState?Wo:Ko),e}function zs(e){if(null!==e&&"object"===typeof e){if("function"===typeof e.then)return Vs(e);if(e.$$typeof===w)return Ei(e)}throw Error(o(438,String(e)))}function $s(e){var t=null,n=bs.updateQueue;if(null!==n&&(t=n.memoCache),null==t){var r=bs.alternate;null!==r&&(null!==(r=r.updateQueue)&&(null!=(r=r.memoCache)&&(t={data:r.data.map(function(e){return e.slice()}),index:0})))}if(null==t&&(t={data:[],index:0}),null===n&&(n={lastEffect:null,events:null,stores:null,memoCache:null},bs.updateQueue=n),n.memoCache=t,void 0===(n=t.data[t.index]))for(n=t.data[t.index]=Array(e),r=0;r<e;r++)n[r]=N;return t.index++,n}function qs(e,t){return"function"===typeof t?t(e):t}function Bs(e){return Hs(Us(),_s,e)}function Hs(e,t,n){var r=e.queue;if(null===r)throw Error(o(311));r.lastRenderedReducer=n;var i=e.baseQueue,s=r.pending;if(null!==s){if(null!==i){var a=i.next;i.next=s.next,s.next=a}t.baseQueue=i=s,r.pending=null}if(s=e.baseState,null===i)e.memoizedState=s;else{var l=a=null,c=null,u=t=i.next,d=!1;do{var h=-536870913&u.lane;if(h!==u.lane?(oc&h)===h:(ys&h)===h){var f=u.revertLane;if(0===f)null!==c&&(c=c.next={lane:0,revertLane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),h===Mi&&(d=!0);else{if((ys&f)===f){u=u.next,f===Mi&&(d=!0);continue}h={lane:0,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=h,a=s):c=c.next=h,bs.lanes|=f,pc|=f}h=u.action,ks&&n(s,h),s=u.hasEagerState?u.eagerState:n(s,h)}else f={lane:h,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=f,a=s):c=c.next=f,bs.lanes|=h,pc|=h;u=u.next}while(null!==u&&u!==t);if(null===c?a=s:c.next=l,!Qn(s,e.memoizedState)&&(Na=!0,d&&null!==(n=Fi)))throw n;e.memoizedState=s,e.baseState=a,e.baseQueue=c,r.lastRenderedState=s}return null===i&&(r.lanes=0),[e.memoizedState,r.dispatch]}function Ws(e){var t=Us(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,s=t.memoizedState;if(null!==i){n.pending=null;var a=i=i.next;do{s=e(s,a.action),a=a.next}while(a!==i);Qn(s,t.memoizedState)||(Na=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),n.lastRenderedState=s}return[s,r]}function Ks(e,t,n){var r=bs,i=Us(),s=si;if(s){if(void 0===n)throw Error(o(407));n=n()}else n=t();var a=!Qn((_s||i).memoizedState,n);if(a&&(i.memoizedState=n,Na=!0),i=i.queue,vo(2048,8,Ys.bind(null,r,i,e),[e]),i.getSnapshot!==t||a||null!==ws&&1&ws.memoizedState.tag){if(r.flags|=2048,po(9,{destroy:void 0,resource:void 0},Qs.bind(null,r,i,n,t),null),null===ic)throw Error(o(349));s||0!==(124&ys)||Gs(r,t,n)}return n}function Gs(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=bs.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},bs.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Qs(e,t,n,r){t.value=n,t.getSnapshot=r,Xs(t)&&Js(e)}function Ys(e,t,n){return n(function(){Xs(t)&&Js(e)})}function Xs(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Qn(e,n)}catch(E_){return!0}}function Js(e){var t=Ar(e,2);null!==t&&Mc(t,e,2)}function Zs(e){var t=Fs();if("function"===typeof e){var n=e;if(e=n(),ks){he(!0);try{n()}finally{he(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:qs,lastRenderedState:e},t}function eo(e,t,n,r){return e.baseState=n,Hs(e,_s,"function"===typeof r?r:qs)}function to(e,t,n,r,i){if($o(e))throw Error(o(485));if(null!==(e=t.action)){var s={payload:i,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){s.listeners.push(e)}};null!==O.T?n(!0):s.isTransition=!1,r(s),null===(n=t.pending)?(s.next=t.pending=s,no(t,s)):(s.next=n.next,t.pending=n.next=s)}}function no(e,t){var n=t.action,r=t.payload,i=e.state;if(t.isTransition){var s=O.T,o={};O.T=o;try{var a=n(i,r),l=O.S;null!==l&&l(o,a),ro(e,t,a)}catch(E_){so(e,t,E_)}finally{O.T=s}}else try{ro(e,t,s=n(i,r))}catch(c){so(e,t,c)}}function ro(e,t,n){null!==n&&"object"===typeof n&&"function"===typeof n.then?n.then(function(n){io(e,t,n)},function(n){return so(e,t,n)}):io(e,t,n)}function io(e,t,n){t.status="fulfilled",t.value=n,oo(t),e.state=n,null!==(t=e.pending)&&((n=t.next)===t?e.pending=null:(n=n.next,t.next=n,no(e,n)))}function so(e,t,n){var r=e.pending;if(e.pending=null,null!==r){r=r.next;do{t.status="rejected",t.reason=n,oo(t),t=t.next}while(t!==r)}e.action=null}function oo(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function ao(e,t){return t}function lo(e,t){if(si){var n=ic.formState;if(null!==n){e:{var r=bs;if(si){if(ii){t:{for(var i=ii,s=ai;8!==i.nodeType;){if(!s){i=null;break t}if(null===(i=yd(i.nextSibling))){i=null;break t}}i="F!"===(s=i.data)||"F"===s?i:null}if(i){ii=yd(i.nextSibling),r="F!"===i.data;break e}}ci(r)}r=!1}r&&(t=n[0])}}return(n=Fs()).memoizedState=n.baseState=t,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ao,lastRenderedState:t},n.queue=r,n=Uo.bind(null,bs,r),r.dispatch=n,r=Zs(!1),s=zo.bind(null,bs,!1,r.queue),i={state:t,dispatch:null,action:e,pending:null},(r=Fs()).queue=i,n=to.bind(null,bs,i,s,n),i.dispatch=n,r.memoizedState=e,[t,n,!1]}function co(e){return uo(Us(),_s,e)}function uo(e,t,n){if(t=Hs(e,t,ao)[0],e=Bs(qs)[0],"object"===typeof t&&null!==t&&"function"===typeof t.then)try{var r=Vs(t)}catch(sa){if(sa===Hi)throw Ki;throw sa}else r=t;var i=(t=Us()).queue,s=i.dispatch;return n!==t.memoizedState&&(bs.flags|=2048,po(9,{destroy:void 0,resource:void 0},ho.bind(null,i,n),null)),[r,s,e]}function ho(e,t){e.action=t}function fo(e){var t=Us(),n=_s;if(null!==n)return uo(t,n,e);Us(),t=t.memoizedState;var r=(n=Us()).queue.dispatch;return n.memoizedState=e,[t,r,!1]}function po(e,t,n,r){return e={tag:e,create:n,deps:r,inst:t,next:null},null===(t=bs.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},bs.updateQueue=t),null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function mo(){return Us().memoizedState}function go(e,t,n,r){var i=Fs();r=void 0===r?null:r,bs.flags|=e,i.memoizedState=po(1|t,{destroy:void 0,resource:void 0},n,r)}function vo(e,t,n,r){var i=Us();r=void 0===r?null:r;var s=i.memoizedState.inst;null!==_s&&null!==r&&Ps(r,_s.memoizedState.deps)?i.memoizedState=po(t,s,n,r):(bs.flags|=e,i.memoizedState=po(1|t,s,n,r))}function yo(e,t){go(8390656,8,e,t)}function bo(e,t){vo(2048,8,e,t)}function _o(e,t){return vo(4,2,e,t)}function wo(e,t){return vo(4,4,e,t)}function xo(e,t){if("function"===typeof t){e=e();var n=t(e);return function(){"function"===typeof n?n():t(null)}}if(null!==t&&void 0!==t)return e=e(),t.current=e,function(){t.current=null}}function So(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,vo(4,4,xo.bind(null,t,e),n)}function ko(){}function To(e,t){var n=Us();t=void 0===t?null:t;var r=n.memoizedState;return null!==t&&Ps(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Eo(e,t){var n=Us();t=void 0===t?null:t;var r=n.memoizedState;if(null!==t&&Ps(t,r[1]))return r[0];if(r=e(),ks){he(!0);try{e()}finally{he(!1)}}return n.memoizedState=[r,t],r}function Co(e,t,n){return void 0===n||0!==(1073741824&ys)?e.memoizedState=t:(e.memoizedState=n,e=Lc(),bs.lanes|=e,pc|=e,n)}function No(e,t,n,r){return Qn(n,t)?n:null!==fs.current?(e=Co(e,n,r),Qn(e,t)||(Na=!0),e):0===(42&ys)?(Na=!0,e.memoizedState=n):(e=Lc(),bs.lanes|=e,pc|=e,t)}function Io(e,t,n,r,i){var s=j.p;j.p=0!==s&&8>s?s:8;var o=O.T,a={};O.T=a,zo(e,!1,t,n);try{var l=i(),c=O.S;if(null!==c&&c(a,l),null!==l&&"object"===typeof l&&"function"===typeof l.then){var u=function(e,t){var n=[],r={status:"pending",value:null,reason:null,then:function(e){n.push(e)}};return e.then(function(){r.status="fulfilled",r.value=t;for(var e=0;e<n.length;e++)(0,n[e])(t)},function(e){for(r.status="rejected",r.reason=e,e=0;e<n.length;e++)(0,n[e])(void 0)}),r}(l,r);Vo(e,t,u,jc())}else Vo(e,t,r,jc())}catch(E_){Vo(e,t,{then:function(){},status:"rejected",reason:E_},jc())}finally{j.p=s,O.T=o}}function Po(){}function Ao(e,t,n,r){if(5!==e.tag)throw Error(o(476));var i=Ro(e).queue;Io(e,i,t,L,null===n?Po:function(){return Do(e),n(r)})}function Ro(e){var t=e.memoizedState;if(null!==t)return t;var n={};return(t={memoizedState:L,baseState:L,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:qs,lastRenderedState:L},next:null}).next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:qs,lastRenderedState:n},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function Do(e){Vo(e,Ro(e).next.queue,{},jc())}function Oo(){return Ei(Qd)}function jo(){return Us().memoizedState}function Lo(){return Us().memoizedState}function Mo(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var n=jc(),r=ss(t,e=is(n),n);return null!==r&&(Mc(r,t,n),os(r,t,n)),t={cache:Di()},void(e.payload=t)}t=t.return}}function Fo(e,t,n){var r=jc();n={lane:r,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null},$o(e)?qo(t,n):null!==(n=Pr(e,t,n,r))&&(Mc(n,e,r),Bo(n,t,r))}function Uo(e,t,n){Vo(e,t,n,jc())}function Vo(e,t,n,r){var i={lane:r,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null};if($o(e))qo(t,i);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var o=t.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,Qn(a,o))return Ir(e,t,i,0),null===ic&&Nr(),!1}catch(E_){}if(null!==(n=Pr(e,t,i,r)))return Mc(n,e,r),Bo(n,t,r),!0}return!1}function zo(e,t,n,r){if(r={lane:2,revertLane:Pu(),action:r,hasEagerState:!1,eagerState:null,next:null},$o(e)){if(t)throw Error(o(479))}else null!==(t=Pr(e,n,r,2))&&Mc(t,e,2)}function $o(e){var t=e.alternate;return e===bs||null!==t&&t===bs}function qo(e,t){Ss=xs=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Bo(e,t,n){if(0!==(4194048&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,Ce(e,n)}}var Ho={readContext:Ei,use:zs,useCallback:Is,useContext:Is,useEffect:Is,useImperativeHandle:Is,useLayoutEffect:Is,useInsertionEffect:Is,useMemo:Is,useReducer:Is,useRef:Is,useState:Is,useDebugValue:Is,useDeferredValue:Is,useTransition:Is,useSyncExternalStore:Is,useId:Is,useHostTransitionStatus:Is,useFormState:Is,useActionState:Is,useOptimistic:Is,useMemoCache:Is,useCacheRefresh:Is},Wo={readContext:Ei,use:zs,useCallback:function(e,t){return Fs().memoizedState=[e,void 0===t?null:t],e},useContext:Ei,useEffect:yo,useImperativeHandle:function(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,go(4194308,4,xo.bind(null,t,e),n)},useLayoutEffect:function(e,t){return go(4194308,4,e,t)},useInsertionEffect:function(e,t){go(4,2,e,t)},useMemo:function(e,t){var n=Fs();t=void 0===t?null:t;var r=e();if(ks){he(!0);try{e()}finally{he(!1)}}return n.memoizedState=[r,t],r},useReducer:function(e,t,n){var r=Fs();if(void 0!==n){var i=n(t);if(ks){he(!0);try{n(t)}finally{he(!1)}}}else i=t;return r.memoizedState=r.baseState=i,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:i},r.queue=e,e=e.dispatch=Fo.bind(null,bs,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},Fs().memoizedState=e},useState:function(e){var t=(e=Zs(e)).queue,n=Uo.bind(null,bs,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:ko,useDeferredValue:function(e,t){return Co(Fs(),e,t)},useTransition:function(){var e=Zs(!1);return e=Io.bind(null,bs,e.queue,!0,!1),Fs().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var r=bs,i=Fs();if(si){if(void 0===n)throw Error(o(407));n=n()}else{if(n=t(),null===ic)throw Error(o(349));0!==(124&oc)||Gs(r,t,n)}i.memoizedState=n;var s={value:n,getSnapshot:t};return i.queue=s,yo(Ys.bind(null,r,s,e),[e]),r.flags|=2048,po(9,{destroy:void 0,resource:void 0},Qs.bind(null,r,s,n,t),null),n},useId:function(){var e=Fs(),t=ic.identifierPrefix;if(si){var n=Jr;t="\xab"+t+"R"+(n=(Xr&~(1<<32-fe(Xr)-1)).toString(32)+n),0<(n=Ts++)&&(t+="H"+n.toString(32)),t+="\xbb"}else t="\xab"+t+"r"+(n=Ns++).toString(32)+"\xbb";return e.memoizedState=t},useHostTransitionStatus:Oo,useFormState:lo,useActionState:lo,useOptimistic:function(e){var t=Fs();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=zo.bind(null,bs,!0,n),n.dispatch=t,[e,t]},useMemoCache:$s,useCacheRefresh:function(){return Fs().memoizedState=Mo.bind(null,bs)}},Ko={readContext:Ei,use:zs,useCallback:To,useContext:Ei,useEffect:bo,useImperativeHandle:So,useInsertionEffect:_o,useLayoutEffect:wo,useMemo:Eo,useReducer:Bs,useRef:mo,useState:function(){return Bs(qs)},useDebugValue:ko,useDeferredValue:function(e,t){return No(Us(),_s.memoizedState,e,t)},useTransition:function(){var e=Bs(qs)[0],t=Us().memoizedState;return["boolean"===typeof e?e:Vs(e),t]},useSyncExternalStore:Ks,useId:jo,useHostTransitionStatus:Oo,useFormState:co,useActionState:co,useOptimistic:function(e,t){return eo(Us(),0,e,t)},useMemoCache:$s,useCacheRefresh:Lo},Go={readContext:Ei,use:zs,useCallback:To,useContext:Ei,useEffect:bo,useImperativeHandle:So,useInsertionEffect:_o,useLayoutEffect:wo,useMemo:Eo,useReducer:Ws,useRef:mo,useState:function(){return Ws(qs)},useDebugValue:ko,useDeferredValue:function(e,t){var n=Us();return null===_s?Co(n,e,t):No(n,_s.memoizedState,e,t)},useTransition:function(){var e=Ws(qs)[0],t=Us().memoizedState;return["boolean"===typeof e?e:Vs(e),t]},useSyncExternalStore:Ks,useId:jo,useHostTransitionStatus:Oo,useFormState:fo,useActionState:fo,useOptimistic:function(e,t){var n=Us();return null!==_s?eo(n,0,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:$s,useCacheRefresh:Lo},Qo=null,Yo=0;function Xo(e){var t=Yo;return Yo+=1,null===Qo&&(Qo=[]),Xi(Qo,e,t)}function Jo(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function Zo(e,t){if(t.$$typeof===f)throw Error(o(525));throw e=Object.prototype.toString.call(t),Error(o(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ea(e){return(0,e._init)(e._payload)}function ta(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function i(e,t){return(e=Fr(e,t)).index=0,e.sibling=null,e}function s(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=67108866,n):r:(t.flags|=67108866,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=$r(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,r){var s=n.type;return s===g?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===E&&ea(s)===t.type)?(Jo(t=i(t,n.props),n),t.return=e,t):(Jo(t=Vr(n.type,n.key,n.props,null,e.mode,r),n),t.return=e,t)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=qr(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function d(e,t,n,r,s){return null===t||7!==t.tag?((t=zr(n,e.mode,r,s)).return=e,t):((t=i(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t||"bigint"===typeof t)return(t=$r(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case p:return Jo(n=Vr(t.type,t.key,t.props,null,e.mode,n),t),n.return=e,n;case m:return(t=qr(t,e.mode,n)).return=e,t;case E:return h(e,t=(0,t._init)(t._payload),n)}if(D(t)||P(t))return(t=zr(t,e.mode,n,null)).return=e,t;if("function"===typeof t.then)return h(e,Xo(t),n);if(t.$$typeof===w)return h(e,Ci(e,t),n);Zo(e,t)}return null}function f(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n||"bigint"===typeof n)return null!==i?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case p:return n.key===i?c(e,t,n,r):null;case m:return n.key===i?u(e,t,n,r):null;case E:return f(e,t,n=(i=n._init)(n._payload),r)}if(D(n)||P(n))return null!==i?null:d(e,t,n,r,null);if("function"===typeof n.then)return f(e,t,Xo(n),r);if(n.$$typeof===w)return f(e,t,Ci(e,n),r);Zo(e,n)}return null}function v(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r||"bigint"===typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case p:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case m:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i);case E:return v(e,t,n,r=(0,r._init)(r._payload),i)}if(D(r)||P(r))return d(t,e=e.get(n)||null,r,i,null);if("function"===typeof r.then)return v(e,t,n,Xo(r),i);if(r.$$typeof===w)return v(e,t,n,Ci(t,r),i);Zo(t,r)}return null}function y(l,c,u,d){if("object"===typeof u&&null!==u&&u.type===g&&null===u.key&&(u=u.props.children),"object"===typeof u&&null!==u){switch(u.$$typeof){case p:e:{for(var b=u.key;null!==c;){if(c.key===b){if((b=u.type)===g){if(7===c.tag){n(l,c.sibling),(d=i(c,u.props.children)).return=l,l=d;break e}}else if(c.elementType===b||"object"===typeof b&&null!==b&&b.$$typeof===E&&ea(b)===c.type){n(l,c.sibling),Jo(d=i(c,u.props),u),d.return=l,l=d;break e}n(l,c);break}t(l,c),c=c.sibling}u.type===g?((d=zr(u.props.children,l.mode,d,u.key)).return=l,l=d):(Jo(d=Vr(u.type,u.key,u.props,null,l.mode,d),u),d.return=l,l=d)}return a(l);case m:e:{for(b=u.key;null!==c;){if(c.key===b){if(4===c.tag&&c.stateNode.containerInfo===u.containerInfo&&c.stateNode.implementation===u.implementation){n(l,c.sibling),(d=i(c,u.children||[])).return=l,l=d;break e}n(l,c);break}t(l,c),c=c.sibling}(d=qr(u,l.mode,d)).return=l,l=d}return a(l);case E:return y(l,c,u=(b=u._init)(u._payload),d)}if(D(u))return function(i,o,a,l){for(var c=null,u=null,d=o,p=o=0,m=null;null!==d&&p<a.length;p++){d.index>p?(m=d,d=null):m=d.sibling;var g=f(i,d,a[p],l);if(null===g){null===d&&(d=m);break}e&&d&&null===g.alternate&&t(i,d),o=s(g,o,p),null===u?c=g:u.sibling=g,u=g,d=m}if(p===a.length)return n(i,d),si&&Zr(i,p),c;if(null===d){for(;p<a.length;p++)null!==(d=h(i,a[p],l))&&(o=s(d,o,p),null===u?c=d:u.sibling=d,u=d);return si&&Zr(i,p),c}for(d=r(d);p<a.length;p++)null!==(m=v(d,i,p,a[p],l))&&(e&&null!==m.alternate&&d.delete(null===m.key?p:m.key),o=s(m,o,p),null===u?c=m:u.sibling=m,u=m);return e&&d.forEach(function(e){return t(i,e)}),si&&Zr(i,p),c}(l,c,u,d);if(P(u)){if("function"!==typeof(b=P(u)))throw Error(o(150));return function(i,a,l,c){if(null==l)throw Error(o(151));for(var u=null,d=null,p=a,m=a=0,g=null,y=l.next();null!==p&&!y.done;m++,y=l.next()){p.index>m?(g=p,p=null):g=p.sibling;var b=f(i,p,y.value,c);if(null===b){null===p&&(p=g);break}e&&p&&null===b.alternate&&t(i,p),a=s(b,a,m),null===d?u=b:d.sibling=b,d=b,p=g}if(y.done)return n(i,p),si&&Zr(i,m),u;if(null===p){for(;!y.done;m++,y=l.next())null!==(y=h(i,y.value,c))&&(a=s(y,a,m),null===d?u=y:d.sibling=y,d=y);return si&&Zr(i,m),u}for(p=r(p);!y.done;m++,y=l.next())null!==(y=v(p,i,m,y.value,c))&&(e&&null!==y.alternate&&p.delete(null===y.key?m:y.key),a=s(y,a,m),null===d?u=y:d.sibling=y,d=y);return e&&p.forEach(function(e){return t(i,e)}),si&&Zr(i,m),u}(l,c,u=b.call(u),d)}if("function"===typeof u.then)return y(l,c,Xo(u),d);if(u.$$typeof===w)return y(l,c,Ci(l,u),d);Zo(l,u)}return"string"===typeof u&&""!==u||"number"===typeof u||"bigint"===typeof u?(u=""+u,null!==c&&6===c.tag?(n(l,c.sibling),(d=i(c,u)).return=l,l=d):(n(l,c),(d=$r(u,l.mode,d)).return=l,l=d),a(l)):n(l,c)}return function(e,t,n,r){try{Yo=0;var i=y(e,t,n,r);return Qo=null,i}catch(sa){if(sa===Hi||sa===Ki)throw sa;var s=Lr(29,sa,null,e.mode);return s.lanes=r,s.return=e,s}}}var na=ta(!0),ra=ta(!1),ia=U(null),oa=null;function aa(e){var t=e.alternate;z(da,1&da.current),z(ia,e),null===oa&&(null===t||null!==fs.current||null!==t.memoizedState)&&(oa=e)}function la(e){if(22===e.tag){if(z(da,da.current),z(ia,e),null===oa){var t=e.alternate;null!==t&&null!==t.memoizedState&&(oa=e)}}else ca()}function ca(){z(da,da.current),z(ia,ia.current)}function ua(e){V(ia),oa===e&&(oa=null),V(da)}var da=U(0);function ha(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||vd(n)))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function fa(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:h({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var pa={enqueueSetState:function(e,t,n){e=e._reactInternals;var r=jc(),i=is(r);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=ss(e,i,r))&&(Mc(t,e,r),os(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=jc(),i=is(r);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=ss(e,i,r))&&(Mc(t,e,r),os(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=jc(),r=is(n);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=ss(e,r,n))&&(Mc(t,e,n),os(t,e,n))}};function ma(e,t,n,r,i,s,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,s,o):!t.prototype||!t.prototype.isPureReactComponent||(!Yn(n,r)||!Yn(i,s))}function ga(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&pa.enqueueReplaceState(t,t.state,null)}function va(e,t){var n=t;if("ref"in t)for(var r in n={},t)"ref"!==r&&(n[r]=t[r]);if(e=e.defaultProps)for(var i in n===t&&(n=h({},n)),e)void 0===n[i]&&(n[i]=e[i]);return n}var ya="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)};function ba(e){ya(e)}function _a(e){console.error(e)}function wa(e){ya(e)}function xa(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(n){setTimeout(function(){throw n})}}function Sa(e,t,n){try{(0,e.onCaughtError)(n.value,{componentStack:n.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(r){setTimeout(function(){throw r})}}function ka(e,t,n){return(n=is(n)).tag=3,n.payload={element:null},n.callback=function(){xa(e,t)},n}function Ta(e){return(e=is(e)).tag=3,e}function Ea(e,t,n,r){var i=n.type.getDerivedStateFromError;if("function"===typeof i){var s=r.value;e.payload=function(){return i(s)},e.callback=function(){Sa(t,n,r)}}var o=n.stateNode;null!==o&&"function"===typeof o.componentDidCatch&&(e.callback=function(){Sa(t,n,r),"function"!==typeof i&&(null===Tc?Tc=new Set([this]):Tc.add(this));var e=r.stack;this.componentDidCatch(r.value,{componentStack:null!==e?e:""})})}var Ca=Error(o(461)),Na=!1;function Ia(e,t,n,r){t.child=null===e?ra(t,null,n,r):na(t,e.child,n,r)}function Pa(e,t,n,r,i){n=n.render;var s=t.ref;if("ref"in r){var o={};for(var a in r)"ref"!==a&&(o[a]=r[a])}else o=r;return Ti(t),r=As(e,t,n,o,s,i),a=js(),null===e||Na?(si&&a&&ti(t),t.flags|=1,Ia(e,t,r,i),t.child):(Ls(e,t,i),Ya(e,t,i))}function Aa(e,t,n,r,i){if(null===e){var s=n.type;return"function"!==typeof s||Mr(s)||void 0!==s.defaultProps||null!==n.compare?((e=Vr(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,Ra(e,t,s,r,i))}if(s=e.child,!Xa(e,i)){var o=s.memoizedProps;if((n=null!==(n=n.compare)?n:Yn)(o,r)&&e.ref===t.ref)return Ya(e,t,i)}return t.flags|=1,(e=Fr(s,r)).ref=t.ref,e.return=t,t.child=e}function Ra(e,t,n,r,i){if(null!==e){var s=e.memoizedProps;if(Yn(s,r)&&e.ref===t.ref){if(Na=!1,t.pendingProps=r=s,!Xa(e,i))return t.lanes=e.lanes,Ya(e,t,i);0!==(131072&e.flags)&&(Na=!0)}}return La(e,t,n,r,i)}function Da(e,t,n){var r=t.pendingProps,i=r.children,s=null!==e?e.memoizedState:null;if("hidden"===r.mode){if(0!==(128&t.flags)){if(r=null!==s?s.baseLanes|n:n,null!==e){for(i=t.child=e.child,s=0;null!==i;)s=s|i.lanes|i.childLanes,i=i.sibling;t.childLanes=s&~r}else t.childLanes=0,t.child=null;return Oa(e,t,r,n)}if(0===(536870912&n))return t.lanes=t.childLanes=536870912,Oa(e,t,null!==s?s.baseLanes|n:n,n);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&qi(0,null!==s?s.cachePool:null),null!==s?ms(t,s):gs(),la(t)}else null!==s?(qi(0,s.cachePool),ms(t,s),ca(),t.memoizedState=null):(null!==e&&qi(0,null),gs(),ca());return Ia(e,t,i,n),t.child}function Oa(e,t,n,r){var i=$i();return i=null===i?null:{parent:Ri._currentValue,pool:i},t.memoizedState={baseLanes:n,cachePool:i},null!==e&&qi(0,null),gs(),la(t),null!==e&&Si(e,t,r,!0),null}function ja(e,t){var n=t.ref;if(null===n)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!==typeof n&&"object"!==typeof n)throw Error(o(284));null!==e&&e.ref===n||(t.flags|=4194816)}}function La(e,t,n,r,i){return Ti(t),n=As(e,t,n,r,void 0,i),r=js(),null===e||Na?(si&&r&&ti(t),t.flags|=1,Ia(e,t,n,i),t.child):(Ls(e,t,i),Ya(e,t,i))}function Ma(e,t,n,r,i,s){return Ti(t),t.updateQueue=null,n=Ds(t,r,n,i),Rs(e),r=js(),null===e||Na?(si&&r&&ti(t),t.flags|=1,Ia(e,t,n,s),t.child):(Ls(e,t,s),Ya(e,t,s))}function Fa(e,t,n,r,i){if(Ti(t),null===t.stateNode){var s=Or,o=n.contextType;"object"===typeof o&&null!==o&&(s=Ei(o)),s=new n(r,s),t.memoizedState=null!==s.state&&void 0!==s.state?s.state:null,s.updater=pa,t.stateNode=s,s._reactInternals=t,(s=t.stateNode).props=r,s.state=t.memoizedState,s.refs={},ns(t),o=n.contextType,s.context="object"===typeof o&&null!==o?Ei(o):Or,s.state=t.memoizedState,"function"===typeof(o=n.getDerivedStateFromProps)&&(fa(t,n,o,r),s.state=t.memoizedState),"function"===typeof n.getDerivedStateFromProps||"function"===typeof s.getSnapshotBeforeUpdate||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||(o=s.state,"function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount(),o!==s.state&&pa.enqueueReplaceState(s,s.state,null),us(t,r,s,i),cs(),s.state=t.memoizedState),"function"===typeof s.componentDidMount&&(t.flags|=4194308),r=!0}else if(null===e){s=t.stateNode;var a=t.memoizedProps,l=va(n,a);s.props=l;var c=s.context,u=n.contextType;o=Or,"object"===typeof u&&null!==u&&(o=Ei(u));var d=n.getDerivedStateFromProps;u="function"===typeof d||"function"===typeof s.getSnapshotBeforeUpdate,a=t.pendingProps!==a,u||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(a||c!==o)&&ga(t,s,r,o),ts=!1;var h=t.memoizedState;s.state=h,us(t,r,s,i),cs(),c=t.memoizedState,a||h!==c||ts?("function"===typeof d&&(fa(t,n,d,r),c=t.memoizedState),(l=ts||ma(t,n,l,r,h,c,o))?(u||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4194308)):("function"===typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),s.props=r,s.state=c,s.context=o,r=l):("function"===typeof s.componentDidMount&&(t.flags|=4194308),r=!1)}else{s=t.stateNode,rs(e,t),u=va(n,o=t.memoizedProps),s.props=u,d=t.pendingProps,h=s.context,c=n.contextType,l=Or,"object"===typeof c&&null!==c&&(l=Ei(c)),(c="function"===typeof(a=n.getDerivedStateFromProps)||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o!==d||h!==l)&&ga(t,s,r,l),ts=!1,h=t.memoizedState,s.state=h,us(t,r,s,i),cs();var f=t.memoizedState;o!==d||h!==f||ts||null!==e&&null!==e.dependencies&&ki(e.dependencies)?("function"===typeof a&&(fa(t,n,a,r),f=t.memoizedState),(u=ts||ma(t,n,u,r,h,f,l)||null!==e&&null!==e.dependencies&&ki(e.dependencies))?(c||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(r,f,l),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(r,f,l)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof s.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=f),s.props=r,s.state=f,s.context=l,r=u):("function"!==typeof s.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return s=r,ja(e,t),r=0!==(128&t.flags),s||r?(s=t.stateNode,n=r&&"function"!==typeof n.getDerivedStateFromError?null:s.render(),t.flags|=1,null!==e&&r?(t.child=na(t,e.child,null,i),t.child=na(t,null,n,i)):Ia(e,t,n,i),t.memoizedState=s.state,e=t.child):e=Ya(e,t,i),e}function Ua(e,t,n,r){return fi(),t.flags|=256,Ia(e,t,n,r),t.child}var Va={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function za(e){return{baseLanes:e,cachePool:Bi()}}function $a(e,t,n){return e=null!==e?e.childLanes&~n:0,t&&(e|=vc),e}function qa(e,t,n){var r,i=t.pendingProps,s=!1,a=0!==(128&t.flags);if((r=a)||(r=(null===e||null!==e.memoizedState)&&0!==(2&da.current)),r&&(s=!0,t.flags&=-129),r=0!==(32&t.flags),t.flags&=-33,null===e){if(si){if(s?aa(t):ca(),si){var l,c=ii;if(l=c){e:{for(l=c,c=ai;8!==l.nodeType;){if(!c){c=null;break e}if(null===(l=yd(l.nextSibling))){c=null;break e}}c=l}null!==c?(t.memoizedState={dehydrated:c,treeContext:null!==Yr?{id:Xr,overflow:Jr}:null,retryLane:536870912,hydrationErrors:null},(l=Lr(18,null,null,0)).stateNode=c,l.return=t,t.child=l,ri=t,ii=null,l=!0):l=!1}l||ci(t)}if(null!==(c=t.memoizedState)&&null!==(c=c.dehydrated))return vd(c)?t.lanes=32:t.lanes=536870912,null;ua(t)}return c=i.children,i=i.fallback,s?(ca(),c=Ha({mode:"hidden",children:c},s=t.mode),i=zr(i,s,n,null),c.return=t,i.return=t,c.sibling=i,t.child=c,(s=t.child).memoizedState=za(n),s.childLanes=$a(e,r,n),t.memoizedState=Va,i):(aa(t),Ba(t,c))}if(null!==(l=e.memoizedState)&&null!==(c=l.dehydrated)){if(a)256&t.flags?(aa(t),t.flags&=-257,t=Wa(e,t,n)):null!==t.memoizedState?(ca(),t.child=e.child,t.flags|=128,t=null):(ca(),s=i.fallback,c=t.mode,i=Ha({mode:"visible",children:i.children},c),(s=zr(s,c,n,null)).flags|=2,i.return=t,s.return=t,i.sibling=s,t.child=i,na(t,e.child,null,n),(i=t.child).memoizedState=za(n),i.childLanes=$a(e,r,n),t.memoizedState=Va,t=s);else if(aa(t),vd(c)){if(r=c.nextSibling&&c.nextSibling.dataset)var u=r.dgst;r=u,(i=Error(o(419))).stack="",i.digest=r,mi({value:i,source:null,stack:null}),t=Wa(e,t,n)}else if(Na||Si(e,t,n,!1),r=0!==(n&e.childLanes),Na||r){if(null!==(r=ic)&&(0!==(i=0!==((i=0!==(42&(i=n&-n))?1:Ne(i))&(r.suspendedLanes|n))?0:i)&&i!==l.retryLane))throw l.retryLane=i,Ar(e,i),Mc(r,e,i),Ca;"$?"===c.data||Gc(),t=Wa(e,t,n)}else"$?"===c.data?(t.flags|=192,t.child=e.child,t=null):(e=l.treeContext,ii=yd(c.nextSibling),ri=t,si=!0,oi=null,ai=!1,null!==e&&(Gr[Qr++]=Xr,Gr[Qr++]=Jr,Gr[Qr++]=Yr,Xr=e.id,Jr=e.overflow,Yr=t),(t=Ba(t,i.children)).flags|=4096);return t}return s?(ca(),s=i.fallback,c=t.mode,u=(l=e.child).sibling,(i=Fr(l,{mode:"hidden",children:i.children})).subtreeFlags=65011712&l.subtreeFlags,null!==u?s=Fr(u,s):(s=zr(s,c,n,null)).flags|=2,s.return=t,i.return=t,i.sibling=s,t.child=i,i=s,s=t.child,null===(c=e.child.memoizedState)?c=za(n):(null!==(l=c.cachePool)?(u=Ri._currentValue,l=l.parent!==u?{parent:u,pool:u}:l):l=Bi(),c={baseLanes:c.baseLanes|n,cachePool:l}),s.memoizedState=c,s.childLanes=$a(e,r,n),t.memoizedState=Va,i):(aa(t),e=(n=e.child).sibling,(n=Fr(n,{mode:"visible",children:i.children})).return=t,n.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n)}function Ba(e,t){return(t=Ha({mode:"visible",children:t},e.mode)).return=e,e.child=t}function Ha(e,t){return(e=Lr(22,e,null,t)).lanes=0,e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},e}function Wa(e,t,n){return na(t,e.child,null,n),(e=Ba(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Ka(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),wi(e.return,t,n)}function Ga(e,t,n,r,i){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function Qa(e,t,n){var r=t.pendingProps,i=r.revealOrder,s=r.tail;if(Ia(e,t,r.children,n),0!==(2&(r=da.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Ka(e,n,t);else if(19===e.tag)Ka(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}switch(z(da,r),i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===ha(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Ga(t,!1,i,n,s);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===ha(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Ga(t,!0,n,null,s);break;case"together":Ga(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ya(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),pc|=t.lanes,0===(n&t.childLanes)){if(null===e)return null;if(Si(e,t,n,!1),0===(n&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(o(153));if(null!==t.child){for(n=Fr(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Fr(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Xa(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!ki(e))}function Ja(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps)Na=!0;else{if(!Xa(e,n)&&0===(128&t.flags))return Na=!1,function(e,t,n){switch(t.tag){case 3:W(t,t.stateNode.containerInfo),bi(0,Ri,e.memoizedState.cache),fi();break;case 27:case 5:G(t);break;case 4:W(t,t.stateNode.containerInfo);break;case 10:bi(0,t.type,t.memoizedProps.value);break;case 13:var r=t.memoizedState;if(null!==r)return null!==r.dehydrated?(aa(t),t.flags|=128,null):0!==(n&t.child.childLanes)?qa(e,t,n):(aa(t),null!==(e=Ya(e,t,n))?e.sibling:null);aa(t);break;case 19:var i=0!==(128&e.flags);if((r=0!==(n&t.childLanes))||(Si(e,t,n,!1),r=0!==(n&t.childLanes)),i){if(r)return Qa(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),z(da,da.current),r)break;return null;case 22:case 23:return t.lanes=0,Da(e,t,n);case 24:bi(0,Ri,e.memoizedState.cache)}return Ya(e,t,n)}(e,t,n);Na=0!==(131072&e.flags)}else Na=!1,si&&0!==(1048576&t.flags)&&ei(t,Kr,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var r=t.elementType,i=r._init;if(r=i(r._payload),t.type=r,"function"!==typeof r){if(void 0!==r&&null!==r){if((i=r.$$typeof)===x){t.tag=11,t=Pa(null,t,r,e,n);break e}if(i===T){t.tag=14,t=Aa(null,t,r,e,n);break e}}throw t=R(r)||r,Error(o(306,t,""))}Mr(r)?(e=va(r,e),t.tag=1,t=Fa(null,t,r,e,n)):(t.tag=0,t=La(null,t,r,e,n))}return t;case 0:return La(e,t,t.type,t.pendingProps,n);case 1:return Fa(e,t,r=t.type,i=va(r,t.pendingProps),n);case 3:e:{if(W(t,t.stateNode.containerInfo),null===e)throw Error(o(387));r=t.pendingProps;var s=t.memoizedState;i=s.element,rs(e,t),us(t,r,null,n);var a=t.memoizedState;if(r=a.cache,bi(0,Ri,r),r!==s.cache&&xi(t,[Ri],n,!0),cs(),r=a.element,s.isDehydrated){if(s={element:r,isDehydrated:!1,cache:a.cache},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=Ua(e,t,r,n);break e}if(r!==i){mi(i=kr(Error(o(424)),t)),t=Ua(e,t,r,n);break e}if(9===(e=t.stateNode.containerInfo).nodeType)e=e.body;else e="HTML"===e.nodeName?e.ownerDocument.body:e;for(ii=yd(e.firstChild),ri=t,si=!0,oi=null,ai=!0,n=ra(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fi(),r===i){t=Ya(e,t,n);break e}Ia(e,t,r,n)}t=t.child}return t;case 26:return ja(e,t),null===e?(n=Id(t.type,null,t.pendingProps,null))?t.memoizedState=n:si||(n=t.type,e=t.pendingProps,(r=id(B.current).createElement(n))[Re]=t,r[De]=e,td(r,n,e),He(r),t.stateNode=r):t.memoizedState=Id(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return G(t),null===e&&si&&(r=t.stateNode=wd(t.type,t.pendingProps,B.current),ri=t,ai=!0,i=ii,pd(t.type)?(bd=i,ii=yd(r.firstChild)):ii=i),Ia(e,t,t.pendingProps.children,n),ja(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&si&&((i=r=ii)&&(null!==(r=function(e,t,n,r){for(;1===e.nodeType;){var i=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!r&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(r){if(!e[Ue])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(s=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(s!==i.rel||e.getAttribute("href")!==(null==i.href||""===i.href?null:i.href)||e.getAttribute("crossorigin")!==(null==i.crossOrigin?null:i.crossOrigin)||e.getAttribute("title")!==(null==i.title?null:i.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((s=e.getAttribute("src"))!==(null==i.src?null:i.src)||e.getAttribute("type")!==(null==i.type?null:i.type)||e.getAttribute("crossorigin")!==(null==i.crossOrigin?null:i.crossOrigin))&&s&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var s=null==i.name?null:""+i.name;if("hidden"===i.type&&e.getAttribute("name")===s)return e}if(null===(e=yd(e.nextSibling)))break}return null}(r,t.type,t.pendingProps,ai))?(t.stateNode=r,ri=t,ii=yd(r.firstChild),ai=!1,i=!0):i=!1),i||ci(t)),G(t),i=t.type,s=t.pendingProps,a=null!==e?e.memoizedProps:null,r=s.children,ad(i,s)?r=null:null!==a&&ad(i,a)&&(t.flags|=32),null!==t.memoizedState&&(i=As(e,t,Os,null,null,n),Qd._currentValue=i),ja(e,t),Ia(e,t,r,n),t.child;case 6:return null===e&&si&&((e=n=ii)&&(null!==(n=function(e,t,n){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!n)return null;if(null===(e=yd(e.nextSibling)))return null}return e}(n,t.pendingProps,ai))?(t.stateNode=n,ri=t,ii=null,e=!0):e=!1),e||ci(t)),null;case 13:return qa(e,t,n);case 4:return W(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=na(t,null,r,n):Ia(e,t,r,n),t.child;case 11:return Pa(e,t,t.type,t.pendingProps,n);case 7:return Ia(e,t,t.pendingProps,n),t.child;case 8:case 12:return Ia(e,t,t.pendingProps.children,n),t.child;case 10:return r=t.pendingProps,bi(0,t.type,r.value),Ia(e,t,r.children,n),t.child;case 9:return i=t.type._context,r=t.pendingProps.children,Ti(t),r=r(i=Ei(i)),t.flags|=1,Ia(e,t,r,n),t.child;case 14:return Aa(e,t,t.type,t.pendingProps,n);case 15:return Ra(e,t,t.type,t.pendingProps,n);case 19:return Qa(e,t,n);case 31:return r=t.pendingProps,n=t.mode,r={mode:r.mode,children:r.children},null===e?((n=Ha(r,n)).ref=t.ref,t.child=n,n.return=t,t=n):((n=Fr(e.child,r)).ref=t.ref,t.child=n,n.return=t,t=n),t;case 22:return Da(e,t,n);case 24:return Ti(t),r=Ei(Ri),null===e?(null===(i=$i())&&(i=ic,s=Di(),i.pooledCache=s,s.refCount++,null!==s&&(i.pooledCacheLanes|=n),i=s),t.memoizedState={parent:r,cache:i},ns(t),bi(0,Ri,i)):(0!==(e.lanes&n)&&(rs(e,t),us(t,null,null,n),cs()),i=e.memoizedState,s=t.memoizedState,i.parent!==r?(i={parent:r,cache:r},t.memoizedState=i,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=i),bi(0,Ri,r)):(r=s.cache,bi(0,Ri,r),r!==i.cache&&xi(t,[Ri],n,!0))),Ia(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(o(156,t.tag))}function Za(e){e.flags|=4}function el(e,t){if("stylesheet"!==t.type||0!==(4&t.state.loading))e.flags&=-16777217;else if(e.flags|=16777216,!$d(t)){if(null!==(t=ia.current)&&((4194048&oc)===oc?null!==oa:(62914560&oc)!==oc&&0===(536870912&oc)||t!==oa))throw Ji=Gi,Wi;e.flags|=8192}}function tl(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?Se():536870912,e.lanes|=t,yc|=t)}function nl(e,t){if(!si)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function rl(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=65011712&i.subtreeFlags,r|=65011712&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function il(e,t,n){var r=t.pendingProps;switch(ni(t),t.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return rl(t),null;case 3:return n=t.stateNode,r=null,null!==e&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),_i(Ri),K(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(hi(t)?Za(t):null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,pi())),rl(t),null;case 26:return n=t.memoizedState,null===e?(Za(t),null!==n?(rl(t),el(t,n)):(rl(t),t.flags&=-16777217)):n?n!==e.memoizedState?(Za(t),rl(t),el(t,n)):(rl(t),t.flags&=-16777217):(e.memoizedProps!==r&&Za(t),rl(t),t.flags&=-16777217),null;case 27:Q(t),n=B.current;var i=t.type;if(null!==e&&null!=t.stateNode)e.memoizedProps!==r&&Za(t);else{if(!r){if(null===t.stateNode)throw Error(o(166));return rl(t),null}e=$.current,hi(t)?ui(t):(e=wd(i,r,n),t.stateNode=e,Za(t))}return rl(t),null;case 5:if(Q(t),n=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==r&&Za(t);else{if(!r){if(null===t.stateNode)throw Error(o(166));return rl(t),null}if(e=$.current,hi(t))ui(t);else{switch(i=id(B.current),e){case 1:e=i.createElementNS("http://www.w3.org/2000/svg",n);break;case 2:e=i.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;default:switch(n){case"svg":e=i.createElementNS("http://www.w3.org/2000/svg",n);break;case"math":e=i.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;case"script":(e=i.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e="string"===typeof r.is?i.createElement("select",{is:r.is}):i.createElement("select"),r.multiple?e.multiple=!0:r.size&&(e.size=r.size);break;default:e="string"===typeof r.is?i.createElement(n,{is:r.is}):i.createElement(n)}}e[Re]=t,e[De]=r;e:for(i=t.child;null!==i;){if(5===i.tag||6===i.tag)e.appendChild(i.stateNode);else if(4!==i.tag&&27!==i.tag&&null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break e;for(;null===i.sibling;){if(null===i.return||i.return===t)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}t.stateNode=e;e:switch(td(e,n,r),n){case"button":case"input":case"select":case"textarea":e=!!r.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&Za(t)}}return rl(t),t.flags&=-16777217,null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==r&&Za(t);else{if("string"!==typeof r&&null===t.stateNode)throw Error(o(166));if(e=B.current,hi(t)){if(e=t.stateNode,n=t.memoizedProps,r=null,null!==(i=ri))switch(i.tag){case 27:case 5:r=i.memoizedProps}e[Re]=t,(e=!!(e.nodeValue===n||null!==r&&!0===r.suppressHydrationWarning||Xu(e.nodeValue,n)))||ci(t)}else(e=id(e).createTextNode(r))[Re]=t,t.stateNode=e}return rl(t),null;case 13:if(r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(i=hi(t),null!==r&&null!==r.dehydrated){if(null===e){if(!i)throw Error(o(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(o(317));i[Re]=t}else fi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;rl(t),i=!1}else i=pi(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=i),i=!0;if(!i)return 256&t.flags?(ua(t),t):(ua(t),null)}if(ua(t),0!==(128&t.flags))return t.lanes=n,t;if(n=null!==r,e=null!==e&&null!==e.memoizedState,n){i=null,null!==(r=t.child).alternate&&null!==r.alternate.memoizedState&&null!==r.alternate.memoizedState.cachePool&&(i=r.alternate.memoizedState.cachePool.pool);var s=null;null!==r.memoizedState&&null!==r.memoizedState.cachePool&&(s=r.memoizedState.cachePool.pool),s!==i&&(r.flags|=2048)}return n!==e&&n&&(t.child.flags|=8192),tl(t,t.updateQueue),rl(t),null;case 4:return K(),null===e&&zu(t.stateNode.containerInfo),rl(t),null;case 10:return _i(t.type),rl(t),null;case 19:if(V(da),null===(i=t.memoizedState))return rl(t),null;if(r=0!==(128&t.flags),null===(s=i.rendering))if(r)nl(i,!1);else{if(0!==fc||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(s=ha(e))){for(t.flags|=128,nl(i,!1),e=s.updateQueue,t.updateQueue=e,tl(t,e),t.subtreeFlags=0,e=n,n=t.child;null!==n;)Ur(n,e),n=n.sibling;return z(da,1&da.current|2),t.child}e=e.sibling}null!==i.tail&&te()>Sc&&(t.flags|=128,r=!0,nl(i,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=ha(s))){if(t.flags|=128,r=!0,e=e.updateQueue,t.updateQueue=e,tl(t,e),nl(i,!0),null===i.tail&&"hidden"===i.tailMode&&!s.alternate&&!si)return rl(t),null}else 2*te()-i.renderingStartTime>Sc&&536870912!==n&&(t.flags|=128,r=!0,nl(i,!1),t.lanes=4194304);i.isBackwards?(s.sibling=t.child,t.child=s):(null!==(e=i.last)?e.sibling=s:t.child=s,i.last=s)}return null!==i.tail?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=te(),t.sibling=null,e=da.current,z(da,r?1&e|2:1&e),t):(rl(t),null);case 22:case 23:return ua(t),vs(),r=null!==t.memoizedState,null!==e?null!==e.memoizedState!==r&&(t.flags|=8192):r&&(t.flags|=8192),r?0!==(536870912&n)&&0===(128&t.flags)&&(rl(t),6&t.subtreeFlags&&(t.flags|=8192)):rl(t),null!==(n=t.updateQueue)&&tl(t,n.retryQueue),n=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),r=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(r=t.memoizedState.cachePool.pool),r!==n&&(t.flags|=2048),null!==e&&V(zi),null;case 24:return n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),_i(Ri),rl(t),null;case 25:case 30:return null}throw Error(o(156,t.tag))}function sl(e,t){switch(ni(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return _i(Ri),K(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return Q(t),null;case 13:if(ua(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(o(340));fi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return V(da),null;case 4:return K(),null;case 10:return _i(t.type),null;case 22:case 23:return ua(t),vs(),null!==e&&V(zi),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return _i(Ri),null;default:return null}}function ol(e,t){switch(ni(t),t.tag){case 3:_i(Ri),K();break;case 26:case 27:case 5:Q(t);break;case 4:K();break;case 13:ua(t);break;case 19:V(da);break;case 10:_i(t.type);break;case 22:case 23:ua(t),vs(),null!==e&&V(zi);break;case 24:_i(Ri)}}function al(e,t){try{var n=t.updateQueue,r=null!==n?n.lastEffect:null;if(null!==r){var i=r.next;n=i;do{if((n.tag&e)===e){r=void 0;var s=n.create,o=n.inst;r=s(),o.destroy=r}n=n.next}while(n!==i)}}catch(E_){du(t,t.return,E_)}}function ll(e,t,n){try{var r=t.updateQueue,i=null!==r?r.lastEffect:null;if(null!==i){var s=i.next;r=s;do{if((r.tag&e)===e){var o=r.inst,a=o.destroy;if(void 0!==a){o.destroy=void 0,i=t;var l=n,c=a;try{c()}catch(E_){du(i,l,E_)}}}r=r.next}while(r!==s)}}catch(E_){du(t,t.return,E_)}}function cl(e){var t=e.updateQueue;if(null!==t){var n=e.stateNode;try{hs(t,n)}catch(E_){du(e,e.return,E_)}}}function ul(e,t,n){n.props=va(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(E_){du(e,t,E_)}}function dl(e,t){try{var n=e.ref;if(null!==n){switch(e.tag){case 26:case 27:case 5:var r=e.stateNode;break;default:r=e.stateNode}"function"===typeof n?e.refCleanup=n(r):n.current=r}}catch(E_){du(e,t,E_)}}function hl(e,t){var n=e.ref,r=e.refCleanup;if(null!==n)if("function"===typeof r)try{r()}catch(E_){du(e,t,E_)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"===typeof n)try{n(null)}catch(i){du(e,t,i)}else n.current=null}function fl(e){var t=e.type,n=e.memoizedProps,r=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&r.focus();break e;case"img":n.src?r.src=n.src:n.srcSet&&(r.srcset=n.srcSet)}}catch(E_){du(e,e.return,E_)}}function pl(e,t,n){try{var r=e.stateNode;!function(e,t,n,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var i=null,s=null,a=null,l=null,c=null,u=null,d=null;for(p in n){var h=n[p];if(n.hasOwnProperty(p)&&null!=h)switch(p){case"checked":case"value":break;case"defaultValue":c=h;default:r.hasOwnProperty(p)||Zu(e,t,p,null,r,h)}}for(var f in r){var p=r[f];if(h=n[f],r.hasOwnProperty(f)&&(null!=p||null!=h))switch(f){case"type":s=p;break;case"name":i=p;break;case"checked":u=p;break;case"defaultChecked":d=p;break;case"value":a=p;break;case"defaultValue":l=p;break;case"children":case"dangerouslySetInnerHTML":if(null!=p)throw Error(o(137,t));break;default:p!==h&&Zu(e,t,f,p,r,h)}}return void gt(e,a,l,c,u,d,s,i);case"select":for(s in p=a=l=f=null,n)if(c=n[s],n.hasOwnProperty(s)&&null!=c)switch(s){case"value":break;case"multiple":p=c;default:r.hasOwnProperty(s)||Zu(e,t,s,null,r,c)}for(i in r)if(s=r[i],c=n[i],r.hasOwnProperty(i)&&(null!=s||null!=c))switch(i){case"value":f=s;break;case"defaultValue":l=s;break;case"multiple":a=s;default:s!==c&&Zu(e,t,i,s,r,c)}return t=l,n=a,r=p,void(null!=f?bt(e,!!n,f,!1):!!r!==!!n&&(null!=t?bt(e,!!n,t,!0):bt(e,!!n,n?[]:"",!1)));case"textarea":for(l in p=f=null,n)if(i=n[l],n.hasOwnProperty(l)&&null!=i&&!r.hasOwnProperty(l))switch(l){case"value":case"children":break;default:Zu(e,t,l,null,r,i)}for(a in r)if(i=r[a],s=n[a],r.hasOwnProperty(a)&&(null!=i||null!=s))switch(a){case"value":f=i;break;case"defaultValue":p=i;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=i)throw Error(o(91));break;default:i!==s&&Zu(e,t,a,i,r,s)}return void _t(e,f,p);case"option":for(var m in n)if(f=n[m],n.hasOwnProperty(m)&&null!=f&&!r.hasOwnProperty(m))if("selected"===m)e.selected=!1;else Zu(e,t,m,null,r,f);for(c in r)if(f=r[c],p=n[c],r.hasOwnProperty(c)&&f!==p&&(null!=f||null!=p))if("selected"===c)e.selected=f&&"function"!==typeof f&&"symbol"!==typeof f;else Zu(e,t,c,f,r,p);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var g in n)f=n[g],n.hasOwnProperty(g)&&null!=f&&!r.hasOwnProperty(g)&&Zu(e,t,g,null,r,f);for(u in r)if(f=r[u],p=n[u],r.hasOwnProperty(u)&&f!==p&&(null!=f||null!=p))switch(u){case"children":case"dangerouslySetInnerHTML":if(null!=f)throw Error(o(137,t));break;default:Zu(e,t,u,f,r,p)}return;default:if(Et(t)){for(var v in n)f=n[v],n.hasOwnProperty(v)&&void 0!==f&&!r.hasOwnProperty(v)&&ed(e,t,v,void 0,r,f);for(d in r)f=r[d],p=n[d],!r.hasOwnProperty(d)||f===p||void 0===f&&void 0===p||ed(e,t,d,f,r,p);return}}for(var y in n)f=n[y],n.hasOwnProperty(y)&&null!=f&&!r.hasOwnProperty(y)&&Zu(e,t,y,null,r,f);for(h in r)f=r[h],p=n[h],!r.hasOwnProperty(h)||f===p||null==f&&null==p||Zu(e,t,h,f,r,p)}(r,e.type,n,t),r[De]=t}catch(E_){du(e,e.return,E_)}}function ml(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&pd(e.type)||4===e.tag}function gl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ml(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&pd(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function vl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?(9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).insertBefore(e,t):((t=9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Ju));else if(4!==r&&(27===r&&pd(e.type)&&(n=e.stateNode,t=null),null!==(e=e.child)))for(vl(e,t,n),e=e.sibling;null!==e;)vl(e,t,n),e=e.sibling}function yl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&(27===r&&pd(e.type)&&(n=e.stateNode),null!==(e=e.child)))for(yl(e,t,n),e=e.sibling;null!==e;)yl(e,t,n),e=e.sibling}function bl(e){var t=e.stateNode,n=e.memoizedProps;try{for(var r=e.type,i=t.attributes;i.length;)t.removeAttributeNode(i[0]);td(t,r,n),t[Re]=e,t[De]=n}catch(E_){du(e,e.return,E_)}}var _l=!1,wl=!1,xl=!1,Sl="function"===typeof WeakSet?WeakSet:Set,kl=null;function Tl(e,t,n){var r=n.flags;switch(n.tag){case 0:case 11:case 15:Fl(e,n),4&r&&al(5,n);break;case 1:if(Fl(e,n),4&r)if(e=n.stateNode,null===t)try{e.componentDidMount()}catch(E_){du(n,n.return,E_)}else{var i=va(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(i,t,e.__reactInternalSnapshotBeforeUpdate)}catch(o){du(n,n.return,o)}}64&r&&cl(n),512&r&&dl(n,n.return);break;case 3:if(Fl(e,n),64&r&&null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 27:case 5:case 1:t=n.child.stateNode}try{hs(e,t)}catch(E_){du(n,n.return,E_)}}break;case 27:null===t&&4&r&&bl(n);case 26:case 5:Fl(e,n),null===t&&4&r&&fl(n),512&r&&dl(n,n.return);break;case 12:Fl(e,n);break;case 13:Fl(e,n),4&r&&Al(e,n),64&r&&(null!==(e=n.memoizedState)&&(null!==(e=e.dehydrated)&&function(e,t){var n=e.ownerDocument;if("$?"!==e.data||"complete"===n.readyState)t();else{var r=function(){t(),n.removeEventListener("DOMContentLoaded",r)};n.addEventListener("DOMContentLoaded",r),e._reactRetry=r}}(e,n=mu.bind(null,n))));break;case 22:if(!(r=null!==n.memoizedState||_l)){t=null!==t&&null!==t.memoizedState||wl,i=_l;var s=wl;_l=r,(wl=t)&&!s?Vl(e,n,0!==(8772&n.subtreeFlags)):Fl(e,n),_l=i,wl=s}break;case 30:break;default:Fl(e,n)}}function El(e){var t=e.alternate;null!==t&&(e.alternate=null,El(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&Ve(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Cl=null,Nl=!1;function Il(e,t,n){for(n=n.child;null!==n;)Pl(e,t,n),n=n.sibling}function Pl(e,t,n){if(de&&"function"===typeof de.onCommitFiberUnmount)try{de.onCommitFiberUnmount(ue,n)}catch(s){}switch(n.tag){case 26:wl||hl(n,t),Il(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode).parentNode.removeChild(n);break;case 27:wl||hl(n,t);var r=Cl,i=Nl;pd(n.type)&&(Cl=n.stateNode,Nl=!1),Il(e,t,n),xd(n.stateNode),Cl=r,Nl=i;break;case 5:wl||hl(n,t);case 6:if(r=Cl,i=Nl,Cl=null,Il(e,t,n),Nl=i,null!==(Cl=r))if(Nl)try{(9===Cl.nodeType?Cl.body:"HTML"===Cl.nodeName?Cl.ownerDocument.body:Cl).removeChild(n.stateNode)}catch(E_){du(n,t,E_)}else try{Cl.removeChild(n.stateNode)}catch(E_){du(n,t,E_)}break;case 18:null!==Cl&&(Nl?(md(9===(e=Cl).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,n.stateNode),Nh(e)):md(Cl,n.stateNode));break;case 4:r=Cl,i=Nl,Cl=n.stateNode.containerInfo,Nl=!0,Il(e,t,n),Cl=r,Nl=i;break;case 0:case 11:case 14:case 15:wl||ll(2,n,t),wl||ll(4,n,t),Il(e,t,n);break;case 1:wl||(hl(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount&&ul(n,t,r)),Il(e,t,n);break;case 21:Il(e,t,n);break;case 22:wl=(r=wl)||null!==n.memoizedState,Il(e,t,n),wl=r;break;default:Il(e,t,n)}}function Al(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{Nh(e)}catch(E_){du(t,t.return,E_)}}function Rl(e,t){var n=function(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new Sl),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new Sl),t;default:throw Error(o(435,e.tag))}}(e);t.forEach(function(t){var r=gu.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))})}function Dl(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r],s=e,a=t,l=a;e:for(;null!==l;){switch(l.tag){case 27:if(pd(l.type)){Cl=l.stateNode,Nl=!1;break e}break;case 5:Cl=l.stateNode,Nl=!1;break e;case 3:case 4:Cl=l.stateNode.containerInfo,Nl=!0;break e}l=l.return}if(null===Cl)throw Error(o(160));Pl(s,a,i),Cl=null,Nl=!1,null!==(s=i.alternate)&&(s.return=null),i.return=null}if(13878&t.subtreeFlags)for(t=t.child;null!==t;)jl(t,e),t=t.sibling}var Ol=null;function jl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Dl(t,e),Ll(e),4&r&&(ll(3,e,e.return),al(3,e),ll(5,e,e.return));break;case 1:Dl(t,e),Ll(e),512&r&&(wl||null===n||hl(n,n.return)),64&r&&_l&&(null!==(e=e.updateQueue)&&(null!==(r=e.callbacks)&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===n?r:n.concat(r))));break;case 26:var i=Ol;if(Dl(t,e),Ll(e),512&r&&(wl||null===n||hl(n,n.return)),4&r){var s=null!==n?n.memoizedState:null;if(r=e.memoizedState,null===n)if(null===r)if(null===e.stateNode){e:{r=e.type,n=e.memoizedProps,i=i.ownerDocument||i;t:switch(r){case"title":(!(s=i.getElementsByTagName("title")[0])||s[Ue]||s[Re]||"http://www.w3.org/2000/svg"===s.namespaceURI||s.hasAttribute("itemprop"))&&(s=i.createElement(r),i.head.insertBefore(s,i.querySelector("head > title"))),td(s,r,n),s[Re]=e,He(s),r=s;break e;case"link":var a=Vd("link","href",i).get(r+(n.href||""));if(a)for(var l=0;l<a.length;l++)if((s=a[l]).getAttribute("href")===(null==n.href||""===n.href?null:n.href)&&s.getAttribute("rel")===(null==n.rel?null:n.rel)&&s.getAttribute("title")===(null==n.title?null:n.title)&&s.getAttribute("crossorigin")===(null==n.crossOrigin?null:n.crossOrigin)){a.splice(l,1);break t}td(s=i.createElement(r),r,n),i.head.appendChild(s);break;case"meta":if(a=Vd("meta","content",i).get(r+(n.content||"")))for(l=0;l<a.length;l++)if((s=a[l]).getAttribute("content")===(null==n.content?null:""+n.content)&&s.getAttribute("name")===(null==n.name?null:n.name)&&s.getAttribute("property")===(null==n.property?null:n.property)&&s.getAttribute("http-equiv")===(null==n.httpEquiv?null:n.httpEquiv)&&s.getAttribute("charset")===(null==n.charSet?null:n.charSet)){a.splice(l,1);break t}td(s=i.createElement(r),r,n),i.head.appendChild(s);break;default:throw Error(o(468,r))}s[Re]=e,He(s),r=s}e.stateNode=r}else zd(i,e.type,e.stateNode);else e.stateNode=jd(i,r,e.memoizedProps);else s!==r?(null===s?null!==n.stateNode&&(n=n.stateNode).parentNode.removeChild(n):s.count--,null===r?zd(i,e.type,e.stateNode):jd(i,r,e.memoizedProps)):null===r&&null!==e.stateNode&&pl(e,e.memoizedProps,n.memoizedProps)}break;case 27:Dl(t,e),Ll(e),512&r&&(wl||null===n||hl(n,n.return)),null!==n&&4&r&&pl(e,e.memoizedProps,n.memoizedProps);break;case 5:if(Dl(t,e),Ll(e),512&r&&(wl||null===n||hl(n,n.return)),32&e.flags){i=e.stateNode;try{xt(i,"")}catch(E_){du(e,e.return,E_)}}4&r&&null!=e.stateNode&&pl(e,i=e.memoizedProps,null!==n?n.memoizedProps:i),1024&r&&(xl=!0);break;case 6:if(Dl(t,e),Ll(e),4&r){if(null===e.stateNode)throw Error(o(162));r=e.memoizedProps,n=e.stateNode;try{n.nodeValue=r}catch(E_){du(e,e.return,E_)}}break;case 3:if(Ud=null,i=Ol,Ol=Td(t.containerInfo),Dl(t,e),Ol=i,Ll(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Nh(t.containerInfo)}catch(E_){du(e,e.return,E_)}xl&&(xl=!1,Ml(e));break;case 4:r=Ol,Ol=Td(e.stateNode.containerInfo),Dl(t,e),Ll(e),Ol=r;break;case 12:default:Dl(t,e),Ll(e);break;case 13:Dl(t,e),Ll(e),8192&e.child.flags&&null!==e.memoizedState!==(null!==n&&null!==n.memoizedState)&&(xc=te()),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,Rl(e,r)));break;case 22:i=null!==e.memoizedState;var c=null!==n&&null!==n.memoizedState,u=_l,d=wl;if(_l=u||i,wl=d||c,Dl(t,e),wl=d,_l=u,Ll(e),8192&r)e:for(t=e.stateNode,t._visibility=i?-2&t._visibility:1|t._visibility,i&&(null===n||c||_l||wl||Ul(e)),n=null,t=e;;){if(5===t.tag||26===t.tag){if(null===n){c=n=t;try{if(s=c.stateNode,i)"function"===typeof(a=s.style).setProperty?a.setProperty("display","none","important"):a.display="none";else{l=c.stateNode;var h=c.memoizedProps.style,f=void 0!==h&&null!==h&&h.hasOwnProperty("display")?h.display:null;l.style.display=null==f||"boolean"===typeof f?"":(""+f).trim()}}catch(E_){du(c,c.return,E_)}}}else if(6===t.tag){if(null===n){c=t;try{c.stateNode.nodeValue=i?"":c.memoizedProps}catch(E_){du(c,c.return,E_)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}4&r&&(null!==(r=e.updateQueue)&&(null!==(n=r.retryQueue)&&(r.retryQueue=null,Rl(e,n))));break;case 19:Dl(t,e),Ll(e),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,Rl(e,r)));case 30:case 21:}}function Ll(e){var t=e.flags;if(2&t){try{for(var n,r=e.return;null!==r;){if(ml(r)){n=r;break}r=r.return}if(null==n)throw Error(o(160));switch(n.tag){case 27:var i=n.stateNode;yl(e,gl(e),i);break;case 5:var s=n.stateNode;32&n.flags&&(xt(s,""),n.flags&=-33),yl(e,gl(e),s);break;case 3:case 4:var a=n.stateNode.containerInfo;vl(e,gl(e),a);break;default:throw Error(o(161))}}catch(E_){du(e,e.return,E_)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Ml(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;Ml(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function Fl(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)Tl(e,t.alternate,t),t=t.sibling}function Ul(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:ll(4,t,t.return),Ul(t);break;case 1:hl(t,t.return);var n=t.stateNode;"function"===typeof n.componentWillUnmount&&ul(t,t.return,n),Ul(t);break;case 27:xd(t.stateNode);case 26:case 5:hl(t,t.return),Ul(t);break;case 22:null===t.memoizedState&&Ul(t);break;default:Ul(t)}e=e.sibling}}function Vl(e,t,n){for(n=n&&0!==(8772&t.subtreeFlags),t=t.child;null!==t;){var r=t.alternate,i=e,s=t,o=s.flags;switch(s.tag){case 0:case 11:case 15:Vl(i,s,n),al(4,s);break;case 1:if(Vl(i,s,n),"function"===typeof(i=(r=s).stateNode).componentDidMount)try{i.componentDidMount()}catch(E_){du(r,r.return,E_)}if(null!==(i=(r=s).updateQueue)){var a=r.stateNode;try{var l=i.shared.hiddenCallbacks;if(null!==l)for(i.shared.hiddenCallbacks=null,i=0;i<l.length;i++)ds(l[i],a)}catch(E_){du(r,r.return,E_)}}n&&64&o&&cl(s),dl(s,s.return);break;case 27:bl(s);case 26:case 5:Vl(i,s,n),n&&null===r&&4&o&&fl(s),dl(s,s.return);break;case 12:Vl(i,s,n);break;case 13:Vl(i,s,n),n&&4&o&&Al(i,s);break;case 22:null===s.memoizedState&&Vl(i,s,n),dl(s,s.return);break;case 30:break;default:Vl(i,s,n)}t=t.sibling}}function zl(e,t){var n=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==n&&(null!=e&&e.refCount++,null!=n&&Oi(n))}function $l(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Oi(e))}function ql(e,t,n,r){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)Bl(e,t,n,r),t=t.sibling}function Bl(e,t,n,r){var i=t.flags;switch(t.tag){case 0:case 11:case 15:ql(e,t,n,r),2048&i&&al(9,t);break;case 1:case 13:default:ql(e,t,n,r);break;case 3:ql(e,t,n,r),2048&i&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Oi(e)));break;case 12:if(2048&i){ql(e,t,n,r),e=t.stateNode;try{var s=t.memoizedProps,o=s.id,a=s.onPostCommit;"function"===typeof a&&a(o,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(E_){du(t,t.return,E_)}}else ql(e,t,n,r);break;case 23:break;case 22:s=t.stateNode,o=t.alternate,null!==t.memoizedState?2&s._visibility?ql(e,t,n,r):Wl(e,t):2&s._visibility?ql(e,t,n,r):(s._visibility|=2,Hl(e,t,n,r,0!==(10256&t.subtreeFlags))),2048&i&&zl(o,t);break;case 24:ql(e,t,n,r),2048&i&&$l(t.alternate,t)}}function Hl(e,t,n,r,i){for(i=i&&0!==(10256&t.subtreeFlags),t=t.child;null!==t;){var s=e,o=t,a=n,l=r,c=o.flags;switch(o.tag){case 0:case 11:case 15:Hl(s,o,a,l,i),al(8,o);break;case 23:break;case 22:var u=o.stateNode;null!==o.memoizedState?2&u._visibility?Hl(s,o,a,l,i):Wl(s,o):(u._visibility|=2,Hl(s,o,a,l,i)),i&&2048&c&&zl(o.alternate,o);break;case 24:Hl(s,o,a,l,i),i&&2048&c&&$l(o.alternate,o);break;default:Hl(s,o,a,l,i)}t=t.sibling}}function Wl(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var n=e,r=t,i=r.flags;switch(r.tag){case 22:Wl(n,r),2048&i&&zl(r.alternate,r);break;case 24:Wl(n,r),2048&i&&$l(r.alternate,r);break;default:Wl(n,r)}t=t.sibling}}var Kl=8192;function Gl(e){if(e.subtreeFlags&Kl)for(e=e.child;null!==e;)Ql(e),e=e.sibling}function Ql(e){switch(e.tag){case 26:Gl(e),e.flags&Kl&&null!==e.memoizedState&&function(e,t,n){if(null===qd)throw Error(o(475));var r=qd;if("stylesheet"===t.type&&("string"!==typeof n.media||!1!==matchMedia(n.media).matches)&&0===(4&t.state.loading)){if(null===t.instance){var i=Pd(n.href),s=e.querySelector(Ad(i));if(s)return null!==(e=s._p)&&"object"===typeof e&&"function"===typeof e.then&&(r.count++,r=Hd.bind(r),e.then(r,r)),t.state.loading|=4,t.instance=s,void He(s);s=e.ownerDocument||e,n=Rd(n),(i=Sd.get(i))&&Md(n,i),He(s=s.createElement("link"));var a=s;a._p=new Promise(function(e,t){a.onload=e,a.onerror=t}),td(s,"link",n),t.instance=s}null===r.stylesheets&&(r.stylesheets=new Map),r.stylesheets.set(t,e),(e=t.state.preload)&&0===(3&t.state.loading)&&(r.count++,t=Hd.bind(r),e.addEventListener("load",t),e.addEventListener("error",t))}}(Ol,e.memoizedState,e.memoizedProps);break;case 5:default:Gl(e);break;case 3:case 4:var t=Ol;Ol=Td(e.stateNode.containerInfo),Gl(e),Ol=t;break;case 22:null===e.memoizedState&&(null!==(t=e.alternate)&&null!==t.memoizedState?(t=Kl,Kl=16777216,Gl(e),Kl=t):Gl(e))}}function Yl(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function Xl(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];kl=r,ec(r,e)}Yl(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)Jl(e),e=e.sibling}function Jl(e){switch(e.tag){case 0:case 11:case 15:Xl(e),2048&e.flags&&ll(9,e,e.return);break;case 3:case 12:default:Xl(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,Zl(e)):Xl(e)}}function Zl(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];kl=r,ec(r,e)}Yl(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:ll(8,t,t.return),Zl(t);break;case 22:2&(n=t.stateNode)._visibility&&(n._visibility&=-3,Zl(t));break;default:Zl(t)}e=e.sibling}}function ec(e,t){for(;null!==kl;){var n=kl;switch(n.tag){case 0:case 11:case 15:ll(8,n,t);break;case 23:case 22:if(null!==n.memoizedState&&null!==n.memoizedState.cachePool){var r=n.memoizedState.cachePool.pool;null!=r&&r.refCount++}break;case 24:Oi(n.memoizedState.cache)}if(null!==(r=n.child))r.return=n,kl=r;else e:for(n=e;null!==kl;){var i=(r=kl).sibling,s=r.return;if(El(r),r===n){kl=null;break e}if(null!==i){i.return=s,kl=i;break e}kl=s}}}var tc={getCacheForType:function(e){var t=Ei(Ri),n=t.data.get(e);return void 0===n&&(n=e(),t.data.set(e,n)),n}},nc="function"===typeof WeakMap?WeakMap:Map,rc=0,ic=null,sc=null,oc=0,ac=0,lc=null,cc=!1,uc=!1,dc=!1,hc=0,fc=0,pc=0,mc=0,gc=0,vc=0,yc=0,bc=null,_c=null,wc=!1,xc=0,Sc=1/0,kc=null,Tc=null,Ec=0,Cc=null,Nc=null,Ic=0,Pc=0,Ac=null,Rc=null,Dc=0,Oc=null;function jc(){if(0!==(2&rc)&&0!==oc)return oc&-oc;if(null!==O.T){return 0!==Mi?Mi:Pu()}return Pe()}function Lc(){0===vc&&(vc=0===(536870912&oc)||si?xe():536870912);var e=ia.current;return null!==e&&(e.flags|=32),vc}function Mc(e,t,n){(e!==ic||2!==ac&&9!==ac)&&null===e.cancelPendingCommit||(Bc(e,0),zc(e,oc,vc,!1)),Te(e,n),0!==(2&rc)&&e===ic||(e===ic&&(0===(2&rc)&&(mc|=n),4===fc&&zc(e,oc,vc,!1)),Su(e))}function Fc(e,t,n){if(0!==(6&rc))throw Error(o(327));for(var r=!n&&0===(124&t)&&0===(t&e.expiredLanes)||_e(e,t),i=r?function(e,t){var n=rc;rc|=2;var r=Wc(),i=Kc();ic!==e||oc!==t?(kc=null,Sc=te()+500,Bc(e,t)):uc=_e(e,t);e:for(;;)try{if(0!==ac&&null!==sc){t=sc;var s=lc;t:switch(ac){case 1:ac=0,lc=null,eu(e,t,s,1);break;case 2:case 9:if(Qi(s)){ac=0,lc=null,Zc(t);break}t=function(){2!==ac&&9!==ac||ic!==e||(ac=7),Su(e)},s.then(t,t);break e;case 3:ac=7;break e;case 4:ac=5;break e;case 7:Qi(s)?(ac=0,lc=null,Zc(t)):(ac=0,lc=null,eu(e,t,s,7));break;case 5:var a=null;switch(sc.tag){case 26:a=sc.memoizedState;case 5:case 27:var l=sc;if(!a||$d(a)){ac=0,lc=null;var c=l.sibling;if(null!==c)sc=c;else{var u=l.return;null!==u?(sc=u,tu(u)):sc=null}break t}}ac=0,lc=null,eu(e,t,s,5);break;case 6:ac=0,lc=null,eu(e,t,s,6);break;case 8:qc(),fc=6;break e;default:throw Error(o(462))}}Xc();break}catch(d){Hc(e,d)}return yi=vi=null,O.H=r,O.A=i,rc=n,null!==sc?0:(ic=null,oc=0,Nr(),fc)}(e,t):Qc(e,t,!0),s=r;;){if(0===i){uc&&!r&&zc(e,t,0,!1);break}if(n=e.current.alternate,!s||Vc(n)){if(2===i){if(s=t,e.errorRecoveryDisabledLanes&s)var a=0;else a=0!==(a=-536870913&e.pendingLanes)?a:536870912&a?536870912:0;if(0!==a){t=a;e:{var l=e;i=bc;var c=l.current.memoizedState.isDehydrated;if(c&&(Bc(l,a).flags|=256),2!==(a=Qc(l,a,!1))){if(dc&&!c){l.errorRecoveryDisabledLanes|=s,mc|=s,i=4;break e}s=_c,_c=i,null!==s&&(null===_c?_c=s:_c.push.apply(_c,s))}i=a}if(s=!1,2!==i)continue}}if(1===i){Bc(e,0),zc(e,t,0,!0);break}e:{switch(r=e,s=i){case 0:case 1:throw Error(o(345));case 4:if((4194048&t)!==t)break;case 6:zc(r,t,vc,!cc);break e;case 2:_c=null;break;case 3:case 5:break;default:throw Error(o(329))}if((62914560&t)===t&&10<(i=xc+300-te())){if(zc(r,t,vc,!cc),0!==be(r,0,!0))break e;r.timeoutHandle=cd(Uc.bind(null,r,n,_c,kc,wc,t,vc,mc,yc,cc,s,2,-0,0),i)}else Uc(r,n,_c,kc,wc,t,vc,mc,yc,cc,s,0,-0,0)}break}i=Qc(e,t,!1),s=!1}Su(e)}function Uc(e,t,n,r,i,s,a,l,c,u,d,h,f,p){if(e.timeoutHandle=-1,(8192&(h=t.subtreeFlags)||16785408===(16785408&h))&&(qd={stylesheets:null,count:0,unsuspend:Bd},Ql(t),null!==(h=function(){if(null===qd)throw Error(o(475));var e=qd;return e.stylesheets&&0===e.count&&Kd(e,e.stylesheets),0<e.count?function(t){var n=setTimeout(function(){if(e.stylesheets&&Kd(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}},6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(n)}}:null}())))return e.cancelPendingCommit=h(ru.bind(null,e,t,s,n,r,i,a,l,c,d,1,f,p)),void zc(e,s,a,!u);ru(e,t,s,n,r,i,a,l,c)}function Vc(e){for(var t=e;;){var n=t.tag;if((0===n||11===n||15===n)&&16384&t.flags&&(null!==(n=t.updateQueue)&&null!==(n=n.stores)))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!Qn(s(),i))return!1}catch(E_){return!1}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function zc(e,t,n,r){t&=~gc,t&=~mc,e.suspendedLanes|=t,e.pingedLanes&=~t,r&&(e.warmLanes|=t),r=e.expirationTimes;for(var i=t;0<i;){var s=31-fe(i),o=1<<s;r[s]=-1,i&=~o}0!==n&&Ee(e,n,t)}function $c(){return 0!==(6&rc)||(ku(0,!1),!1)}function qc(){if(null!==sc){if(0===ac)var e=sc.return;else yi=vi=null,Ms(e=sc),Qo=null,Yo=0,e=sc;for(;null!==e;)ol(e.alternate,e),e=e.return;sc=null}}function Bc(e,t){var n=e.timeoutHandle;-1!==n&&(e.timeoutHandle=-1,ud(n)),null!==(n=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,n()),qc(),ic=e,sc=n=Fr(e.current,null),oc=t,ac=0,lc=null,cc=!1,uc=_e(e,t),dc=!1,yc=vc=gc=mc=pc=fc=0,_c=bc=null,wc=!1,0!==(8&t)&&(t|=32&t);var r=e.entangledLanes;if(0!==r)for(e=e.entanglements,r&=t;0<r;){var i=31-fe(r),s=1<<i;t|=e[i],r&=~s}return hc=t,Nr(),n}function Hc(e,t){bs=null,O.H=Ho,t===Hi||t===Ki?(t=Zi(),ac=3):t===Wi?(t=Zi(),ac=4):ac=t===Ca?8:null!==t&&"object"===typeof t&&"function"===typeof t.then?6:1,lc=t,null===sc&&(fc=1,xa(e,kr(t,e.current)))}function Wc(){var e=O.H;return O.H=Ho,null===e?Ho:e}function Kc(){var e=O.A;return O.A=tc,e}function Gc(){fc=4,cc||(4194048&oc)!==oc&&null!==ia.current||(uc=!0),0===(134217727&pc)&&0===(134217727&mc)||null===ic||zc(ic,oc,vc,!1)}function Qc(e,t,n){var r=rc;rc|=2;var i=Wc(),s=Kc();ic===e&&oc===t||(kc=null,Bc(e,t)),t=!1;var o=fc;e:for(;;)try{if(0!==ac&&null!==sc){var a=sc,l=lc;switch(ac){case 8:qc(),o=6;break e;case 3:case 2:case 9:case 6:null===ia.current&&(t=!0);var c=ac;if(ac=0,lc=null,eu(e,a,l,c),n&&uc){o=0;break e}break;default:c=ac,ac=0,lc=null,eu(e,a,l,c)}}Yc(),o=fc;break}catch(u){Hc(e,u)}return t&&e.shellSuspendCounter++,yi=vi=null,rc=r,O.H=i,O.A=s,null===sc&&(ic=null,oc=0,Nr()),o}function Yc(){for(;null!==sc;)Jc(sc)}function Xc(){for(;null!==sc&&!Z();)Jc(sc)}function Jc(e){var t=Ja(e.alternate,e,hc);e.memoizedProps=e.pendingProps,null===t?tu(e):sc=t}function Zc(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=Ma(n,t,t.pendingProps,t.type,void 0,oc);break;case 11:t=Ma(n,t,t.pendingProps,t.type.render,t.ref,oc);break;case 5:Ms(t);default:ol(n,t),t=Ja(n,t=sc=Ur(t,hc),hc)}e.memoizedProps=e.pendingProps,null===t?tu(e):sc=t}function eu(e,t,n,r){yi=vi=null,Ms(t),Qo=null,Yo=0;var i=t.return;try{if(function(e,t,n,r,i){if(n.flags|=32768,null!==r&&"object"===typeof r&&"function"===typeof r.then){if(null!==(t=n.alternate)&&Si(t,n,i,!0),null!==(n=ia.current)){switch(n.tag){case 13:return null===oa?Gc():null===n.alternate&&0===fc&&(fc=3),n.flags&=-257,n.flags|=65536,n.lanes=i,r===Gi?n.flags|=16384:(null===(t=n.updateQueue)?n.updateQueue=new Set([r]):t.add(r),hu(e,r,i)),!1;case 22:return n.flags|=65536,r===Gi?n.flags|=16384:(null===(t=n.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([r])},n.updateQueue=t):null===(n=t.retryQueue)?t.retryQueue=new Set([r]):n.add(r),hu(e,r,i)),!1}throw Error(o(435,n.tag))}return hu(e,r,i),Gc(),!1}if(si)return null!==(t=ia.current)?(0===(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=i,r!==li&&mi(kr(e=Error(o(422),{cause:r}),n))):(r!==li&&mi(kr(t=Error(o(423),{cause:r}),n)),(e=e.current.alternate).flags|=65536,i&=-i,e.lanes|=i,r=kr(r,n),as(e,i=ka(e.stateNode,r,i)),4!==fc&&(fc=2)),!1;var s=Error(o(520),{cause:r});if(s=kr(s,n),null===bc?bc=[s]:bc.push(s),4!==fc&&(fc=2),null===t)return!0;r=kr(r,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=i&-i,n.lanes|=e,as(n,e=ka(n.stateNode,r,e)),!1;case 1:if(t=n.type,s=n.stateNode,0===(128&n.flags)&&("function"===typeof t.getDerivedStateFromError||null!==s&&"function"===typeof s.componentDidCatch&&(null===Tc||!Tc.has(s))))return n.flags|=65536,i&=-i,n.lanes|=i,Ea(i=Ta(i),e,n,r),as(n,i),!1}n=n.return}while(null!==n);return!1}(e,i,t,n,oc))return fc=1,xa(e,kr(n,e.current)),void(sc=null)}catch(E_){if(null!==i)throw sc=i,E_;return fc=1,xa(e,kr(n,e.current)),void(sc=null)}32768&t.flags?(si||1===r?e=!0:uc||0!==(536870912&oc)?e=!1:(cc=e=!0,(2===r||9===r||3===r||6===r)&&(null!==(r=ia.current)&&13===r.tag&&(r.flags|=16384))),nu(t,e)):tu(t)}function tu(e){var t=e;do{if(0!==(32768&t.flags))return void nu(t,cc);e=t.return;var n=il(t.alternate,t,hc);if(null!==n)return void(sc=n);if(null!==(t=t.sibling))return void(sc=t);sc=t=e}while(null!==t);0===fc&&(fc=5)}function nu(e,t){do{var n=sl(e.alternate,e);if(null!==n)return n.flags&=32767,void(sc=n);if(null!==(n=e.return)&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&null!==(e=e.sibling))return void(sc=e);sc=e=n}while(null!==e);fc=6,sc=null}function ru(e,t,n,r,i,s,a,l,c){e.cancelPendingCommit=null;do{lu()}while(0!==Ec);if(0!==(6&rc))throw Error(o(327));if(null!==t){if(t===e.current)throw Error(o(177));if(s=t.lanes|t.childLanes,function(e,t,n,r,i,s){var o=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var a=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(n=o&~n;0<n;){var u=31-fe(n),d=1<<u;a[u]=0,l[u]=-1;var h=c[u];if(null!==h)for(c[u]=null,u=0;u<h.length;u++){var f=h[u];null!==f&&(f.lane&=-536870913)}n&=~d}0!==r&&Ee(e,r,0),0!==s&&0===i&&0!==e.tag&&(e.suspendedLanes|=s&~(o&~t))}(e,n,s|=Cr,a,l,c),e===ic&&(sc=ic=null,oc=0),Nc=t,Cc=e,Ic=n,Pc=s,Ac=i,Rc=r,0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?(e.callbackNode=null,e.callbackPriority=0,X(se,function(){return cu(),null})):(e.callbackNode=null,e.callbackPriority=0),r=0!==(13878&t.flags),0!==(13878&t.subtreeFlags)||r){r=O.T,O.T=null,i=j.p,j.p=2,a=rc,rc|=4;try{!function(e,t){if(e=e.containerInfo,nd=rh,tr(e=er(e))){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch(g){n=null;break e}var a=0,l=-1,c=-1,u=0,d=0,h=e,f=null;t:for(;;){for(var p;h!==n||0!==i&&3!==h.nodeType||(l=a+i),h!==s||0!==r&&3!==h.nodeType||(c=a+r),3===h.nodeType&&(a+=h.nodeValue.length),null!==(p=h.firstChild);)f=h,h=p;for(;;){if(h===e)break t;if(f===n&&++u===i&&(l=a),f===s&&++d===r&&(c=a),null!==(p=h.nextSibling))break;f=(h=f).parentNode}h=p}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(rd={focusedElem:e,selectionRange:n},rh=!1,kl=t;null!==kl;)if(e=(t=kl).child,0!==(1024&t.subtreeFlags)&&null!==e)e.return=t,kl=e;else for(;null!==kl;){switch(s=(t=kl).alternate,e=t.flags,t.tag){case 0:case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(0!==(1024&e)&&null!==s){e=void 0,n=t,i=s.memoizedProps,s=s.memoizedState,r=n.stateNode;try{var m=va(n.type,i,(n.elementType,n.type));e=r.getSnapshotBeforeUpdate(m,s),r.__reactInternalSnapshotBeforeUpdate=e}catch(E_){du(n,n.return,E_)}}break;case 3:if(0!==(1024&e))if(9===(n=(e=t.stateNode.containerInfo).nodeType))gd(e);else if(1===n)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":gd(e);break;default:e.textContent=""}break;default:if(0!==(1024&e))throw Error(o(163))}if(null!==(e=t.sibling)){e.return=t.return,kl=e;break}kl=t.return}}(e,t)}finally{rc=a,j.p=i,O.T=r}}Ec=1,iu(),su(),ou()}}function iu(){if(1===Ec){Ec=0;var e=Cc,t=Nc,n=0!==(13878&t.flags);if(0!==(13878&t.subtreeFlags)||n){n=O.T,O.T=null;var r=j.p;j.p=2;var i=rc;rc|=4;try{jl(t,e);var s=rd,o=er(e.containerInfo),a=s.focusedElem,l=s.selectionRange;if(o!==a&&a&&a.ownerDocument&&Zn(a.ownerDocument.documentElement,a)){if(null!==l&&tr(a)){var c=l.start,u=l.end;if(void 0===u&&(u=c),"selectionStart"in a)a.selectionStart=c,a.selectionEnd=Math.min(u,a.value.length);else{var d=a.ownerDocument||document,h=d&&d.defaultView||window;if(h.getSelection){var f=h.getSelection(),p=a.textContent.length,m=Math.min(l.start,p),g=void 0===l.end?m:Math.min(l.end,p);!f.extend&&m>g&&(o=g,g=m,m=o);var v=Jn(a,m),y=Jn(a,g);if(v&&y&&(1!==f.rangeCount||f.anchorNode!==v.node||f.anchorOffset!==v.offset||f.focusNode!==y.node||f.focusOffset!==y.offset)){var b=d.createRange();b.setStart(v.node,v.offset),f.removeAllRanges(),m>g?(f.addRange(b),f.extend(y.node,y.offset)):(b.setEnd(y.node,y.offset),f.addRange(b))}}}}for(d=[],f=a;f=f.parentNode;)1===f.nodeType&&d.push({element:f,left:f.scrollLeft,top:f.scrollTop});for("function"===typeof a.focus&&a.focus(),a=0;a<d.length;a++){var _=d[a];_.element.scrollLeft=_.left,_.element.scrollTop=_.top}}rh=!!nd,rd=nd=null}finally{rc=i,j.p=r,O.T=n}}e.current=t,Ec=2}}function su(){if(2===Ec){Ec=0;var e=Cc,t=Nc,n=0!==(8772&t.flags);if(0!==(8772&t.subtreeFlags)||n){n=O.T,O.T=null;var r=j.p;j.p=2;var i=rc;rc|=4;try{Tl(e,t.alternate,t)}finally{rc=i,j.p=r,O.T=n}}Ec=3}}function ou(){if(4===Ec||3===Ec){Ec=0,ee();var e=Cc,t=Nc,n=Ic,r=Rc;0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?Ec=5:(Ec=0,Nc=Cc=null,au(e,e.pendingLanes));var i=e.pendingLanes;if(0===i&&(Tc=null),Ie(n),t=t.stateNode,de&&"function"===typeof de.onCommitFiberRoot)try{de.onCommitFiberRoot(ue,t,void 0,128===(128&t.current.flags))}catch(l){}if(null!==r){t=O.T,i=j.p,j.p=2,O.T=null;try{for(var s=e.onRecoverableError,o=0;o<r.length;o++){var a=r[o];s(a.value,{componentStack:a.stack})}}finally{O.T=t,j.p=i}}0!==(3&Ic)&&lu(),Su(e),i=e.pendingLanes,0!==(4194090&n)&&0!==(42&i)?e===Oc?Dc++:(Dc=0,Oc=e):Dc=0,ku(0,!1)}}function au(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,Oi(t)))}function lu(e){return iu(),su(),ou(),cu()}function cu(){if(5!==Ec)return!1;var e=Cc,t=Pc;Pc=0;var n=Ie(Ic),r=O.T,i=j.p;try{j.p=32>n?32:n,O.T=null,n=Ac,Ac=null;var s=Cc,a=Ic;if(Ec=0,Nc=Cc=null,Ic=0,0!==(6&rc))throw Error(o(331));var l=rc;if(rc|=4,Jl(s.current),Bl(s,s.current,a,n),rc=l,ku(0,!1),de&&"function"===typeof de.onPostCommitFiberRoot)try{de.onPostCommitFiberRoot(ue,s)}catch(c){}return!0}finally{j.p=i,O.T=r,au(e,t)}}function uu(e,t,n){t=kr(n,t),null!==(e=ss(e,t=ka(e.stateNode,t,2),2))&&(Te(e,2),Su(e))}function du(e,t,n){if(3===e.tag)uu(e,e,n);else for(;null!==t;){if(3===t.tag){uu(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Tc||!Tc.has(r))){e=kr(n,e),null!==(r=ss(t,n=Ta(2),2))&&(Ea(n,r,t,e),Te(r,2),Su(r));break}}t=t.return}}function hu(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new nc;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(dc=!0,i.add(n),e=fu.bind(null,e,t,n),t.then(e,e))}function fu(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,ic===e&&(oc&n)===n&&(4===fc||3===fc&&(62914560&oc)===oc&&300>te()-xc?0===(2&rc)&&Bc(e,0):gc|=n,yc===oc&&(yc=0)),Su(e)}function pu(e,t){0===t&&(t=Se()),null!==(e=Ar(e,t))&&(Te(e,t),Su(e))}function mu(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),pu(e,n)}function gu(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;case 22:r=e.stateNode._retryCache;break;default:throw Error(o(314))}null!==r&&r.delete(t),pu(e,n)}var vu=null,yu=null,bu=!1,_u=!1,wu=!1,xu=0;function Su(e){e!==yu&&null===e.next&&(null===yu?vu=yu=e:yu=yu.next=e),_u=!0,bu||(bu=!0,hd(function(){0!==(6&rc)?X(re,Tu):Eu()}))}function ku(e,t){if(!wu&&_u){wu=!0;do{for(var n=!1,r=vu;null!==r;){if(!t)if(0!==e){var i=r.pendingLanes;if(0===i)var s=0;else{var o=r.suspendedLanes,a=r.pingedLanes;s=(1<<31-fe(42|e)+1)-1,s=201326741&(s&=i&~(o&~a))?201326741&s|1:s?2|s:0}0!==s&&(n=!0,Iu(r,s))}else s=oc,0===(3&(s=be(r,r===ic?s:0,null!==r.cancelPendingCommit||-1!==r.timeoutHandle)))||_e(r,s)||(n=!0,Iu(r,s));r=r.next}}while(n);wu=!1}}function Tu(){Eu()}function Eu(){_u=bu=!1;var e=0;0!==xu&&(function(){var e=window.event;if(e&&"popstate"===e.type)return e!==ld&&(ld=e,!0);return ld=null,!1}()&&(e=xu),xu=0);for(var t=te(),n=null,r=vu;null!==r;){var i=r.next,s=Cu(r,t);0===s?(r.next=null,null===n?vu=i:n.next=i,null===i&&(yu=n)):(n=r,(0!==e||0!==(3&s))&&(_u=!0)),r=i}ku(e,!1)}function Cu(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,s=-62914561&e.pendingLanes;0<s;){var o=31-fe(s),a=1<<o,l=i[o];-1===l?0!==(a&n)&&0===(a&r)||(i[o]=we(a,t)):l<=t&&(e.expiredLanes|=a),s&=~a}if(n=oc,n=be(e,e===(t=ic)?n:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),r=e.callbackNode,0===n||e===t&&(2===ac||9===ac)||null!==e.cancelPendingCommit)return null!==r&&null!==r&&J(r),e.callbackNode=null,e.callbackPriority=0;if(0===(3&n)||_e(e,n)){if((t=n&-n)===e.callbackPriority)return t;switch(null!==r&&J(r),Ie(n)){case 2:case 8:n=ie;break;case 32:default:n=se;break;case 268435456:n=ae}return r=Nu.bind(null,e),n=X(n,r),e.callbackPriority=t,e.callbackNode=n,t}return null!==r&&null!==r&&J(r),e.callbackPriority=2,e.callbackNode=null,2}function Nu(e,t){if(0!==Ec&&5!==Ec)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(lu()&&e.callbackNode!==n)return null;var r=oc;return 0===(r=be(e,e===ic?r:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:(Fc(e,r,t),Cu(e,te()),null!=e.callbackNode&&e.callbackNode===n?Nu.bind(null,e):null)}function Iu(e,t){if(lu())return null;Fc(e,t,!0)}function Pu(){return 0===xu&&(xu=xe()),xu}function Au(e){return null==e||"symbol"===typeof e||"boolean"===typeof e?null:"function"===typeof e?e:It(""+e)}function Ru(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}for(var Du=0;Du<wr.length;Du++){var Ou=wr[Du];xr(Ou.toLowerCase(),"on"+(Ou[0].toUpperCase()+Ou.slice(1)))}xr(fr,"onAnimationEnd"),xr(pr,"onAnimationIteration"),xr(mr,"onAnimationStart"),xr("dblclick","onDoubleClick"),xr("focusin","onFocus"),xr("focusout","onBlur"),xr(gr,"onTransitionRun"),xr(vr,"onTransitionStart"),xr(yr,"onTransitionCancel"),xr(br,"onTransitionEnd"),Qe("onMouseEnter",["mouseout","mouseover"]),Qe("onMouseLeave",["mouseout","mouseover"]),Qe("onPointerEnter",["pointerout","pointerover"]),Qe("onPointerLeave",["pointerout","pointerover"]),Ge("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ge("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ge("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ge("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ge("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ge("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ju="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Lu=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ju));function Mu(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;s=a,i.currentTarget=c;try{s(i)}catch(E_){ya(E_)}i.currentTarget=null,s=l}else for(o=0;o<r.length;o++){if(l=(a=r[o]).instance,c=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;s=a,i.currentTarget=c;try{s(i)}catch(E_){ya(E_)}i.currentTarget=null,s=l}}}}function Fu(e,t){var n=t[je];void 0===n&&(n=t[je]=new Set);var r=e+"__bubble";n.has(r)||($u(t,e,2,!1),n.add(r))}function Uu(e,t,n){var r=0;t&&(r|=4),$u(n,e,r,t)}var Vu="_reactListening"+Math.random().toString(36).slice(2);function zu(e){if(!e[Vu]){e[Vu]=!0,We.forEach(function(t){"selectionchange"!==t&&(Lu.has(t)||Uu(t,!1,e),Uu(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Vu]||(t[Vu]=!0,Uu("selectionchange",!1,t))}}function $u(e,t,n,r){switch(uh(t)){case 2:var i=ih;break;case 8:i=sh;break;default:i=oh}n=i.bind(null,t,n,e),i=void 0,!Ut||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function qu(e,t,n,r,i){var s=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var a=r.stateNode.containerInfo;if(a===i)break;if(4===o)for(o=r.return;null!==o;){var c=o.tag;if((3===c||4===c)&&o.stateNode.containerInfo===i)return;o=o.return}for(;null!==a;){if(null===(o=ze(a)))return;if(5===(c=o.tag)||6===c||26===c||27===c){r=s=o;continue e}a=a.parentNode}}r=r.return}Lt(function(){var r=s,i=At(n),o=[];e:{var a=_r.get(e);if(void 0!==a){var c=Zt,u=e;switch(e){case"keypress":if(0===Ht(n))break e;case"keydown":case"keyup":c=mn;break;case"focusin":u="focus",c=on;break;case"focusout":u="blur",c=on;break;case"beforeblur":case"afterblur":c=on;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=rn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=sn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=vn;break;case fr:case pr:case mr:c=an;break;case br:c=yn;break;case"scroll":case"scrollend":c=tn;break;case"wheel":c=bn;break;case"copy":case"cut":case"paste":c=ln;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=gn;break;case"toggle":case"beforetoggle":c=_n}var d=0!==(4&t),h=!d&&("scroll"===e||"scrollend"===e),f=d?null!==a?a+"Capture":null:a;d=[];for(var p,m=r;null!==m;){var g=m;if(p=g.stateNode,5!==(g=g.tag)&&26!==g&&27!==g||null===p||null===f||null!=(g=Mt(m,f))&&d.push(Bu(m,g,p)),h)break;m=m.return}0<d.length&&(a=new c(a,u,null,n,i),o.push({event:a,listeners:d}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===Pt||!(u=n.relatedTarget||n.fromElement)||!ze(u)&&!u[Oe])&&(c||a)&&(a=i.window===i?i:(a=i.ownerDocument)?a.defaultView||a.parentWindow:window,c?(c=r,null!==(u=(u=n.relatedTarget||n.toElement)?ze(u):null)&&(h=l(u),d=u.tag,u!==h||5!==d&&27!==d&&6!==d)&&(u=null)):(c=null,u=r),c!==u)){if(d=rn,g="onMouseLeave",f="onMouseEnter",m="mouse","pointerout"!==e&&"pointerover"!==e||(d=gn,g="onPointerLeave",f="onPointerEnter",m="pointer"),h=null==c?a:qe(c),p=null==u?a:qe(u),(a=new d(g,m+"leave",c,n,i)).target=h,a.relatedTarget=p,g=null,ze(i)===r&&((d=new d(f,m+"enter",u,n,i)).target=p,d.relatedTarget=h,g=d),h=g,c&&u)e:{for(f=u,m=0,p=d=c;p;p=Wu(p))m++;for(p=0,g=f;g;g=Wu(g))p++;for(;0<m-p;)d=Wu(d),m--;for(;0<p-m;)f=Wu(f),p--;for(;m--;){if(d===f||null!==f&&d===f.alternate)break e;d=Wu(d),f=Wu(f)}d=null}else d=null;null!==c&&Ku(o,a,c,d,!1),null!==u&&null!==h&&Ku(o,h,u,d,!0)}if("select"===(c=(a=r?qe(r):window).nodeName&&a.nodeName.toLowerCase())||"input"===c&&"file"===a.type)var v=Fn;else if(Rn(a))if(Un)v=Gn;else{v=Wn;var y=Hn}else!(c=a.nodeName)||"input"!==c.toLowerCase()||"checkbox"!==a.type&&"radio"!==a.type?r&&Et(r.elementType)&&(v=Fn):v=Kn;switch(v&&(v=v(e,r))?Dn(o,v,n,i):(y&&y(e,a,r),"focusout"===e&&r&&"number"===a.type&&null!=r.memoizedProps.value&&yt(a,"number",a.value)),y=r?qe(r):window,e){case"focusin":(Rn(y)||"true"===y.contentEditable)&&(rr=y,ir=r,sr=null);break;case"focusout":sr=ir=rr=null;break;case"mousedown":or=!0;break;case"contextmenu":case"mouseup":case"dragend":or=!1,ar(o,n,i);break;case"selectionchange":if(nr)break;case"keydown":case"keyup":ar(o,n,i)}var b;if(xn)e:{switch(e){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else Pn?Nn(e,n)&&(_="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(_="onCompositionStart");_&&(Tn&&"ko"!==n.locale&&(Pn||"onCompositionStart"!==_?"onCompositionEnd"===_&&Pn&&(b=Bt()):($t="value"in(zt=i)?zt.value:zt.textContent,Pn=!0)),0<(y=Hu(r,_)).length&&(_=new cn(_,e,null,n,i),o.push({event:_,listeners:y}),b?_.data=b:null!==(b=In(n))&&(_.data=b))),(b=kn?function(e,t){switch(e){case"compositionend":return In(t);case"keypress":return 32!==t.which?null:(Cn=!0,En);case"textInput":return(e=t.data)===En&&Cn?null:e;default:return null}}(e,n):function(e,t){if(Pn)return"compositionend"===e||!xn&&Nn(e,t)?(e=Bt(),qt=$t=zt=null,Pn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Tn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(_=Hu(r,"onBeforeInput")).length&&(y=new cn("onBeforeInput","beforeinput",null,n,i),o.push({event:y,listeners:_}),y.data=b)),function(e,t,n,r,i){if("submit"===t&&n&&n.stateNode===i){var s=Au((i[De]||null).action),o=r.submitter;o&&null!==(t=(t=o[De]||null)?Au(t.formAction):o.getAttribute("formAction"))&&(s=t,o=null);var a=new Zt("action","action",null,r,i);e.push({event:a,listeners:[{instance:null,listener:function(){if(r.defaultPrevented){if(0!==xu){var e=o?Ru(i,o):new FormData(i);Ao(n,{pending:!0,data:e,method:i.method,action:s},null,e)}}else"function"===typeof s&&(a.preventDefault(),e=o?Ru(i,o):new FormData(i),Ao(n,{pending:!0,data:e,method:i.method,action:s},s,e))},currentTarget:i}]})}}(o,e,r,n,i)}Mu(o,t)})}function Bu(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Hu(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,s=i.stateNode;if(5!==(i=i.tag)&&26!==i&&27!==i||null===s||(null!=(i=Mt(e,n))&&r.unshift(Bu(e,i,s)),null!=(i=Mt(e,t))&&r.push(Bu(e,i,s))),3===e.tag)return r;e=e.return}return[]}function Wu(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function Ku(e,t,n,r,i){for(var s=t._reactName,o=[];null!==n&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(a=a.tag,null!==l&&l===r)break;5!==a&&26!==a&&27!==a||null===c||(l=c,i?null!=(c=Mt(n,s))&&o.unshift(Bu(n,c,l)):i||null!=(c=Mt(n,s))&&o.push(Bu(n,c,l))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Gu=/\r\n?/g,Qu=/\u0000|\uFFFD/g;function Yu(e){return("string"===typeof e?e:""+e).replace(Gu,"\n").replace(Qu,"")}function Xu(e,t){return t=Yu(t),Yu(e)===t}function Ju(){}function Zu(e,t,n,r,i,s){switch(n){case"children":"string"===typeof r?"body"===t||"textarea"===t&&""===r||xt(e,r):("number"===typeof r||"bigint"===typeof r)&&"body"!==t&&xt(e,""+r);break;case"className":nt(e,"class",r);break;case"tabIndex":nt(e,"tabindex",r);break;case"dir":case"role":case"viewBox":case"width":case"height":nt(e,n,r);break;case"style":Tt(e,r,s);break;case"data":if("object"!==t){nt(e,"data",r);break}case"src":case"href":if(""===r&&("a"!==t||"href"!==n)){e.removeAttribute(n);break}if(null==r||"function"===typeof r||"symbol"===typeof r||"boolean"===typeof r){e.removeAttribute(n);break}r=It(""+r),e.setAttribute(n,r);break;case"action":case"formAction":if("function"===typeof r){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"===typeof s&&("formAction"===n?("input"!==t&&Zu(e,t,"name",i.name,i,null),Zu(e,t,"formEncType",i.formEncType,i,null),Zu(e,t,"formMethod",i.formMethod,i,null),Zu(e,t,"formTarget",i.formTarget,i,null)):(Zu(e,t,"encType",i.encType,i,null),Zu(e,t,"method",i.method,i,null),Zu(e,t,"target",i.target,i,null))),null==r||"symbol"===typeof r||"boolean"===typeof r){e.removeAttribute(n);break}r=It(""+r),e.setAttribute(n,r);break;case"onClick":null!=r&&(e.onclick=Ju);break;case"onScroll":null!=r&&Fu("scroll",e);break;case"onScrollEnd":null!=r&&Fu("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!==typeof r||!("__html"in r))throw Error(o(61));if(null!=(n=r.__html)){if(null!=i.children)throw Error(o(60));e.innerHTML=n}}break;case"multiple":e.multiple=r&&"function"!==typeof r&&"symbol"!==typeof r;break;case"muted":e.muted=r&&"function"!==typeof r&&"symbol"!==typeof r;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==r||"function"===typeof r||"boolean"===typeof r||"symbol"===typeof r){e.removeAttribute("xlink:href");break}n=It(""+r),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,""+r):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":!0===r?e.setAttribute(n,""):!1!==r&&null!=r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,r):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":null!=r&&"function"!==typeof r&&"symbol"!==typeof r&&!isNaN(r)&&1<=r?e.setAttribute(n,r):e.removeAttribute(n);break;case"rowSpan":case"start":null==r||"function"===typeof r||"symbol"===typeof r||isNaN(r)?e.removeAttribute(n):e.setAttribute(n,r);break;case"popover":Fu("beforetoggle",e),Fu("toggle",e),tt(e,"popover",r);break;case"xlinkActuate":rt(e,"http://www.w3.org/1999/xlink","xlink:actuate",r);break;case"xlinkArcrole":rt(e,"http://www.w3.org/1999/xlink","xlink:arcrole",r);break;case"xlinkRole":rt(e,"http://www.w3.org/1999/xlink","xlink:role",r);break;case"xlinkShow":rt(e,"http://www.w3.org/1999/xlink","xlink:show",r);break;case"xlinkTitle":rt(e,"http://www.w3.org/1999/xlink","xlink:title",r);break;case"xlinkType":rt(e,"http://www.w3.org/1999/xlink","xlink:type",r);break;case"xmlBase":rt(e,"http://www.w3.org/XML/1998/namespace","xml:base",r);break;case"xmlLang":rt(e,"http://www.w3.org/XML/1998/namespace","xml:lang",r);break;case"xmlSpace":rt(e,"http://www.w3.org/XML/1998/namespace","xml:space",r);break;case"is":tt(e,"is",r);break;case"innerText":case"textContent":break;default:(!(2<n.length)||"o"!==n[0]&&"O"!==n[0]||"n"!==n[1]&&"N"!==n[1])&&tt(e,n=Ct.get(n)||n,r)}}function ed(e,t,n,r,i,s){switch(n){case"style":Tt(e,r,s);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!==typeof r||!("__html"in r))throw Error(o(61));if(null!=(n=r.__html)){if(null!=i.children)throw Error(o(60));e.innerHTML=n}}break;case"children":"string"===typeof r?xt(e,r):("number"===typeof r||"bigint"===typeof r)&&xt(e,""+r);break;case"onScroll":null!=r&&Fu("scroll",e);break;case"onScrollEnd":null!=r&&Fu("scrollend",e);break;case"onClick":null!=r&&(e.onclick=Ju);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:Ke.hasOwnProperty(n)||("o"!==n[0]||"n"!==n[1]||(i=n.endsWith("Capture"),t=n.slice(2,i?n.length-7:void 0),"function"===typeof(s=null!=(s=e[De]||null)?s[n]:null)&&e.removeEventListener(t,s,i),"function"!==typeof r)?n in e?e[n]=r:!0===r?e.setAttribute(n,""):tt(e,n,r):("function"!==typeof s&&null!==s&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,r,i)))}}function td(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Fu("error",e),Fu("load",e);var r,i=!1,s=!1;for(r in n)if(n.hasOwnProperty(r)){var a=n[r];if(null!=a)switch(r){case"src":i=!0;break;case"srcSet":s=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(o(137,t));default:Zu(e,t,r,a,n,null)}}return s&&Zu(e,t,"srcSet",n.srcSet,n,null),void(i&&Zu(e,t,"src",n.src,n,null));case"input":Fu("invalid",e);var l=r=a=s=null,c=null,u=null;for(i in n)if(n.hasOwnProperty(i)){var d=n[i];if(null!=d)switch(i){case"name":s=d;break;case"type":a=d;break;case"checked":c=d;break;case"defaultChecked":u=d;break;case"value":r=d;break;case"defaultValue":l=d;break;case"children":case"dangerouslySetInnerHTML":if(null!=d)throw Error(o(137,t));break;default:Zu(e,t,i,d,n,null)}}return vt(e,r,l,c,u,a,s,!1),void dt(e);case"select":for(s in Fu("invalid",e),i=a=r=null,n)if(n.hasOwnProperty(s)&&null!=(l=n[s]))switch(s){case"value":r=l;break;case"defaultValue":a=l;break;case"multiple":i=l;default:Zu(e,t,s,l,n,null)}return t=r,n=a,e.multiple=!!i,void(null!=t?bt(e,!!i,t,!1):null!=n&&bt(e,!!i,n,!0));case"textarea":for(a in Fu("invalid",e),r=s=i=null,n)if(n.hasOwnProperty(a)&&null!=(l=n[a]))switch(a){case"value":i=l;break;case"defaultValue":s=l;break;case"children":r=l;break;case"dangerouslySetInnerHTML":if(null!=l)throw Error(o(91));break;default:Zu(e,t,a,l,n,null)}return wt(e,i,s,r),void dt(e);case"option":for(c in n)if(n.hasOwnProperty(c)&&null!=(i=n[c]))if("selected"===c)e.selected=i&&"function"!==typeof i&&"symbol"!==typeof i;else Zu(e,t,c,i,n,null);return;case"dialog":Fu("beforetoggle",e),Fu("toggle",e),Fu("cancel",e),Fu("close",e);break;case"iframe":case"object":Fu("load",e);break;case"video":case"audio":for(i=0;i<ju.length;i++)Fu(ju[i],e);break;case"image":Fu("error",e),Fu("load",e);break;case"details":Fu("toggle",e);break;case"embed":case"source":case"link":Fu("error",e),Fu("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in n)if(n.hasOwnProperty(u)&&null!=(i=n[u]))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(o(137,t));default:Zu(e,t,u,i,n,null)}return;default:if(Et(t)){for(d in n)n.hasOwnProperty(d)&&(void 0!==(i=n[d])&&ed(e,t,d,i,n,void 0));return}}for(l in n)n.hasOwnProperty(l)&&(null!=(i=n[l])&&Zu(e,t,l,i,n,null))}var nd=null,rd=null;function id(e){return 9===e.nodeType?e:e.ownerDocument}function sd(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function od(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function ad(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"bigint"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ld=null;var cd="function"===typeof setTimeout?setTimeout:void 0,ud="function"===typeof clearTimeout?clearTimeout:void 0,dd="function"===typeof Promise?Promise:void 0,hd="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof dd?function(e){return dd.resolve(null).then(e).catch(fd)}:cd;function fd(e){setTimeout(function(){throw e})}function pd(e){return"head"===e}function md(e,t){var n=t,r=0,i=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&8===s.nodeType)if("/$"===(n=s.data)){if(0<r&&8>r){n=r;var o=e.ownerDocument;if(1&n&&xd(o.documentElement),2&n&&xd(o.body),4&n)for(xd(n=o.head),o=n.firstChild;o;){var a=o.nextSibling,l=o.nodeName;o[Ue]||"SCRIPT"===l||"STYLE"===l||"LINK"===l&&"stylesheet"===o.rel.toLowerCase()||n.removeChild(o),o=a}}if(0===i)return e.removeChild(s),void Nh(t);i--}else"$"===n||"$?"===n||"$!"===n?i++:r=n.charCodeAt(0)-48;else r=0;n=s}while(n);Nh(t)}function gd(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":gd(n),Ve(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===n.rel.toLowerCase())continue}e.removeChild(n)}}function vd(e){return"$!"===e.data||"$?"===e.data&&"complete"===e.ownerDocument.readyState}function yd(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"F!"===t||"F"===t)break;if("/$"===t)return null}}return e}var bd=null;function _d(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}function wd(e,t,n){switch(t=id(n),e){case"html":if(!(e=t.documentElement))throw Error(o(452));return e;case"head":if(!(e=t.head))throw Error(o(453));return e;case"body":if(!(e=t.body))throw Error(o(454));return e;default:throw Error(o(451))}}function xd(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Ve(e)}var Sd=new Map,kd=new Set;function Td(e){return"function"===typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var Ed=j.d;j.d={f:function(){var e=Ed.f(),t=$c();return e||t},r:function(e){var t=$e(e);null!==t&&5===t.tag&&"form"===t.type?Do(t):Ed.r(e)},D:function(e){Ed.D(e),Nd("dns-prefetch",e,null)},C:function(e,t){Ed.C(e,t),Nd("preconnect",e,t)},L:function(e,t,n){Ed.L(e,t,n);var r=Cd;if(r&&e&&t){var i='link[rel="preload"][as="'+mt(t)+'"]';"image"===t&&n&&n.imageSrcSet?(i+='[imagesrcset="'+mt(n.imageSrcSet)+'"]',"string"===typeof n.imageSizes&&(i+='[imagesizes="'+mt(n.imageSizes)+'"]')):i+='[href="'+mt(e)+'"]';var s=i;switch(t){case"style":s=Pd(e);break;case"script":s=Dd(e)}Sd.has(s)||(e=h({rel:"preload",href:"image"===t&&n&&n.imageSrcSet?void 0:e,as:t},n),Sd.set(s,e),null!==r.querySelector(i)||"style"===t&&r.querySelector(Ad(s))||"script"===t&&r.querySelector(Od(s))||(td(t=r.createElement("link"),"link",e),He(t),r.head.appendChild(t)))}},m:function(e,t){Ed.m(e,t);var n=Cd;if(n&&e){var r=t&&"string"===typeof t.as?t.as:"script",i='link[rel="modulepreload"][as="'+mt(r)+'"][href="'+mt(e)+'"]',s=i;switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":s=Dd(e)}if(!Sd.has(s)&&(e=h({rel:"modulepreload",href:e},t),Sd.set(s,e),null===n.querySelector(i))){switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Od(s)))return}td(r=n.createElement("link"),"link",e),He(r),n.head.appendChild(r)}}},X:function(e,t){Ed.X(e,t);var n=Cd;if(n&&e){var r=Be(n).hoistableScripts,i=Dd(e),s=r.get(i);s||((s=n.querySelector(Od(i)))||(e=h({src:e,async:!0},t),(t=Sd.get(i))&&Fd(e,t),He(s=n.createElement("script")),td(s,"link",e),n.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},r.set(i,s))}},S:function(e,t,n){Ed.S(e,t,n);var r=Cd;if(r&&e){var i=Be(r).hoistableStyles,s=Pd(e);t=t||"default";var o=i.get(s);if(!o){var a={loading:0,preload:null};if(o=r.querySelector(Ad(s)))a.loading=5;else{e=h({rel:"stylesheet",href:e,"data-precedence":t},n),(n=Sd.get(s))&&Md(e,n);var l=o=r.createElement("link");He(l),td(l,"link",e),l._p=new Promise(function(e,t){l.onload=e,l.onerror=t}),l.addEventListener("load",function(){a.loading|=1}),l.addEventListener("error",function(){a.loading|=2}),a.loading|=4,Ld(o,t,r)}o={type:"stylesheet",instance:o,count:1,state:a},i.set(s,o)}}},M:function(e,t){Ed.M(e,t);var n=Cd;if(n&&e){var r=Be(n).hoistableScripts,i=Dd(e),s=r.get(i);s||((s=n.querySelector(Od(i)))||(e=h({src:e,async:!0,type:"module"},t),(t=Sd.get(i))&&Fd(e,t),He(s=n.createElement("script")),td(s,"link",e),n.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},r.set(i,s))}}};var Cd="undefined"===typeof document?null:document;function Nd(e,t,n){var r=Cd;if(r&&"string"===typeof t&&t){var i=mt(t);i='link[rel="'+e+'"][href="'+i+'"]',"string"===typeof n&&(i+='[crossorigin="'+n+'"]'),kd.has(i)||(kd.add(i),e={rel:e,crossOrigin:n,href:t},null===r.querySelector(i)&&(td(t=r.createElement("link"),"link",e),He(t),r.head.appendChild(t)))}}function Id(e,t,n,r){var i,s,a,l,c=(c=B.current)?Td(c):null;if(!c)throw Error(o(446));switch(e){case"meta":case"title":return null;case"style":return"string"===typeof n.precedence&&"string"===typeof n.href?(t=Pd(n.href),(r=(n=Be(c).hoistableStyles).get(t))||(r={type:"style",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===n.rel&&"string"===typeof n.href&&"string"===typeof n.precedence){e=Pd(n.href);var u=Be(c).hoistableStyles,d=u.get(e);if(d||(c=c.ownerDocument||c,d={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},u.set(e,d),(u=c.querySelector(Ad(e)))&&!u._p&&(d.instance=u,d.state.loading=5),Sd.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Sd.set(e,n),u||(i=c,s=e,a=n,l=d.state,i.querySelector('link[rel="preload"][as="style"]['+s+"]")?l.loading=1:(s=i.createElement("link"),l.preload=s,s.addEventListener("load",function(){return l.loading|=1}),s.addEventListener("error",function(){return l.loading|=2}),td(s,"link",a),He(s),i.head.appendChild(s))))),t&&null===r)throw Error(o(528,""));return d}if(t&&null!==r)throw Error(o(529,""));return null;case"script":return t=n.async,"string"===typeof(n=n.src)&&t&&"function"!==typeof t&&"symbol"!==typeof t?(t=Dd(n),(r=(n=Be(c).hoistableScripts).get(t))||(r={type:"script",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};default:throw Error(o(444,e))}}function Pd(e){return'href="'+mt(e)+'"'}function Ad(e){return'link[rel="stylesheet"]['+e+"]"}function Rd(e){return h({},e,{"data-precedence":e.precedence,precedence:null})}function Dd(e){return'[src="'+mt(e)+'"]'}function Od(e){return"script[async]"+e}function jd(e,t,n){if(t.count++,null===t.instance)switch(t.type){case"style":var r=e.querySelector('style[data-href~="'+mt(n.href)+'"]');if(r)return t.instance=r,He(r),r;var i=h({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return He(r=(e.ownerDocument||e).createElement("style")),td(r,"style",i),Ld(r,n.precedence,e),t.instance=r;case"stylesheet":i=Pd(n.href);var s=e.querySelector(Ad(i));if(s)return t.state.loading|=4,t.instance=s,He(s),s;r=Rd(n),(i=Sd.get(i))&&Md(r,i),He(s=(e.ownerDocument||e).createElement("link"));var a=s;return a._p=new Promise(function(e,t){a.onload=e,a.onerror=t}),td(s,"link",r),t.state.loading|=4,Ld(s,n.precedence,e),t.instance=s;case"script":return s=Dd(n.src),(i=e.querySelector(Od(s)))?(t.instance=i,He(i),i):(r=n,(i=Sd.get(s))&&Fd(r=h({},n),i),He(i=(e=e.ownerDocument||e).createElement("script")),td(i,"link",r),e.head.appendChild(i),t.instance=i);case"void":return null;default:throw Error(o(443,t.type))}else"stylesheet"===t.type&&0===(4&t.state.loading)&&(r=t.instance,t.state.loading|=4,Ld(r,n.precedence,e));return t.instance}function Ld(e,t,n){for(var r=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),i=r.length?r[r.length-1]:null,s=i,o=0;o<r.length;o++){var a=r[o];if(a.dataset.precedence===t)s=a;else if(s!==i)break}s?s.parentNode.insertBefore(e,s.nextSibling):(t=9===n.nodeType?n.head:n).insertBefore(e,t.firstChild)}function Md(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function Fd(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var Ud=null;function Vd(e,t,n){if(null===Ud){var r=new Map,i=Ud=new Map;i.set(n,r)}else(r=(i=Ud).get(n))||(r=new Map,i.set(n,r));if(r.has(e))return r;for(r.set(e,null),n=n.getElementsByTagName(e),i=0;i<n.length;i++){var s=n[i];if(!(s[Ue]||s[Re]||"link"===e&&"stylesheet"===s.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==s.namespaceURI){var o=s.getAttribute(t)||"";o=e+o;var a=r.get(o);a?a.push(s):r.set(o,[s])}}return r}function zd(e,t,n){(e=e.ownerDocument||e).head.insertBefore(n,"title"===t?e.querySelector("head > title"):null)}function $d(e){return"stylesheet"!==e.type||0!==(3&e.state.loading)}var qd=null;function Bd(){}function Hd(){if(this.count--,0===this.count)if(this.stylesheets)Kd(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var Wd=null;function Kd(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,Wd=new Map,t.forEach(Gd,e),Wd=null,Hd.call(e))}function Gd(e,t){if(!(4&t.state.loading)){var n=Wd.get(e);if(n)var r=n.get(null);else{n=new Map,Wd.set(e,n);for(var i=e.querySelectorAll("link[data-precedence],style[data-precedence]"),s=0;s<i.length;s++){var o=i[s];"LINK"!==o.nodeName&&"not all"===o.getAttribute("media")||(n.set(o.dataset.precedence,o),r=o)}r&&n.set(null,r)}o=(i=t.instance).getAttribute("data-precedence"),(s=n.get(o)||r)===r&&n.set(null,i),n.set(o,i),this.count++,r=Hd.bind(this),i.addEventListener("load",r),i.addEventListener("error",r),s?s.parentNode.insertBefore(i,s.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(i,e.firstChild),t.state.loading|=4}}var Qd={$$typeof:w,Provider:null,Consumer:null,_currentValue:L,_currentValue2:L,_threadCount:0};function Yd(e,t,n,r,i,s,o,a){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ke(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ke(0),this.hiddenUpdates=ke(null),this.identifierPrefix=r,this.onUncaughtError=i,this.onCaughtError=s,this.onRecoverableError=o,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=a,this.incompleteTransitions=new Map}function Xd(e,t,n,r,i,s,o,a,l,c,u,d){return e=new Yd(e,t,n,o,a,l,c,d),t=1,!0===s&&(t|=24),s=Lr(3,null,null,t),e.current=s,s.stateNode=e,(t=Di()).refCount++,e.pooledCache=t,t.refCount++,s.memoizedState={element:r,isDehydrated:n,cache:t},ns(s),e}function Jd(e){return e?e=Or:Or}function Zd(e,t,n,r,i,s){i=Jd(i),null===r.context?r.context=i:r.pendingContext=i,(r=is(t)).payload={element:n},null!==(s=void 0===s?null:s)&&(r.callback=s),null!==(n=ss(e,r,t))&&(Mc(n,0,t),os(n,e,t))}function eh(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function th(e,t){eh(e,t),(e=e.alternate)&&eh(e,t)}function nh(e){if(13===e.tag){var t=Ar(e,67108864);null!==t&&Mc(t,0,67108864),th(e,67108864)}}var rh=!0;function ih(e,t,n,r){var i=O.T;O.T=null;var s=j.p;try{j.p=2,oh(e,t,n,r)}finally{j.p=s,O.T=i}}function sh(e,t,n,r){var i=O.T;O.T=null;var s=j.p;try{j.p=8,oh(e,t,n,r)}finally{j.p=s,O.T=i}}function oh(e,t,n,r){if(rh){var i=ah(r);if(null===i)qu(e,t,r,lh,n),bh(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return hh=_h(hh,e,t,n,r,i),!0;case"dragenter":return fh=_h(fh,e,t,n,r,i),!0;case"mouseover":return ph=_h(ph,e,t,n,r,i),!0;case"pointerover":var s=i.pointerId;return mh.set(s,_h(mh.get(s)||null,e,t,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,gh.set(s,_h(gh.get(s)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(bh(e,r),4&t&&-1<yh.indexOf(e)){for(;null!==i;){var s=$e(i);if(null!==s)switch(s.tag){case 3:if((s=s.stateNode).current.memoizedState.isDehydrated){var o=ye(s.pendingLanes);if(0!==o){var a=s;for(a.pendingLanes|=2,a.entangledLanes|=2;o;){var l=1<<31-fe(o);a.entanglements[1]|=l,o&=~l}Su(s),0===(6&rc)&&(Sc=te()+500,ku(0,!1))}}break;case 13:null!==(a=Ar(s,2))&&Mc(a,0,2),$c(),th(s,2)}if(null===(s=ah(r))&&qu(e,t,r,lh,n),s===i)break;i=s}null!==i&&r.stopPropagation()}else qu(e,t,r,null,n)}}function ah(e){return ch(e=At(e))}var lh=null;function ch(e){if(lh=null,null!==(e=ze(e))){var t=l(e);if(null===t)e=null;else{var n=t.tag;if(13===n){if(null!==(e=c(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return lh=e,null}function uh(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ne()){case re:return 2;case ie:return 8;case se:case oe:return 32;case ae:return 268435456;default:return 32}default:return 32}}var dh=!1,hh=null,fh=null,ph=null,mh=new Map,gh=new Map,vh=[],yh="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function bh(e,t){switch(e){case"focusin":case"focusout":hh=null;break;case"dragenter":case"dragleave":fh=null;break;case"mouseover":case"mouseout":ph=null;break;case"pointerover":case"pointerout":mh.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":gh.delete(t.pointerId)}}function _h(e,t,n,r,i,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},null!==t&&(null!==(t=$e(t))&&nh(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function wh(e){var t=ze(e.target);if(null!==t){var n=l(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=c(n)))return e.blockedOn=t,void function(e,t){var n=j.p;try{return j.p=e,t()}finally{j.p=n}}(e.priority,function(){if(13===n.tag){var e=jc();e=Ne(e);var t=Ar(n,e);null!==t&&Mc(t,0,e),th(n,e)}})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function xh(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=ah(e.nativeEvent);if(null!==n)return null!==(t=$e(n))&&nh(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);Pt=r,n.target.dispatchEvent(r),Pt=null,t.shift()}return!0}function Sh(e,t,n){xh(e)&&n.delete(t)}function kh(){dh=!1,null!==hh&&xh(hh)&&(hh=null),null!==fh&&xh(fh)&&(fh=null),null!==ph&&xh(ph)&&(ph=null),mh.forEach(Sh),gh.forEach(Sh)}function Th(e,t){e.blockedOn===t&&(e.blockedOn=null,dh||(dh=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,kh)))}var Eh=null;function Ch(e){Eh!==e&&(Eh=e,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){Eh===e&&(Eh=null);for(var t=0;t<e.length;t+=3){var n=e[t],r=e[t+1],i=e[t+2];if("function"!==typeof r){if(null===ch(r||n))continue;break}var s=$e(n);null!==s&&(e.splice(t,3),t-=3,Ao(s,{pending:!0,data:i,method:n.method,action:r},r,i))}}))}function Nh(e){function t(t){return Th(t,e)}null!==hh&&Th(hh,e),null!==fh&&Th(fh,e),null!==ph&&Th(ph,e),mh.forEach(t),gh.forEach(t);for(var n=0;n<vh.length;n++){var r=vh[n];r.blockedOn===e&&(r.blockedOn=null)}for(;0<vh.length&&null===(n=vh[0]).blockedOn;)wh(n),null===n.blockedOn&&vh.shift();if(null!=(n=(e.ownerDocument||e).$$reactFormReplay))for(r=0;r<n.length;r+=3){var i=n[r],s=n[r+1],o=i[De]||null;if("function"===typeof s)o||Ch(n);else if(o){var a=null;if(s&&s.hasAttribute("formAction")){if(i=s,o=s[De]||null)a=o.formAction;else if(null!==ch(i))continue}else a=o.action;"function"===typeof a?n[r+1]=a:(n.splice(r,3),r-=3),Ch(n)}}}function Ih(e){this._internalRoot=e}function Ph(e){this._internalRoot=e}Ph.prototype.render=Ih.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(o(409));Zd(t.current,jc(),e,t,null,null)},Ph.prototype.unmount=Ih.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;Zd(e.current,2,null,e,null,null),$c(),t[Oe]=null}},Ph.prototype.unstable_scheduleHydration=function(e){if(e){var t=Pe();e={blockedOn:null,target:e,priority:t};for(var n=0;n<vh.length&&0!==t&&t<vh[n].priority;n++);vh.splice(n,0,e),0===n&&wh(e)}};var Ah=i.version;if("19.1.0"!==Ah)throw Error(o(527,Ah,"19.1.0"));j.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(o(188));throw e=Object.keys(e).join(","),Error(o(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=l(e)))throw Error(o(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var s=i.alternate;if(null===s){if(null!==(r=i.return)){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return u(i),e;if(s===r)return u(i),t;s=s.sibling}throw Error(o(188))}if(n.return!==r.return)n=i,r=s;else{for(var a=!1,c=i.child;c;){if(c===n){a=!0,n=i,r=s;break}if(c===r){a=!0,r=i,n=s;break}c=c.sibling}if(!a){for(c=s.child;c;){if(c===n){a=!0,n=s,r=i;break}if(c===r){a=!0,r=s,n=i;break}c=c.sibling}if(!a)throw Error(o(189))}}if(n.alternate!==r)throw Error(o(190))}if(3!==n.tag)throw Error(o(188));return n.stateNode.current===n?e:t}(t),e=null===(e=null!==e?d(e):null)?null:e.stateNode};var Rh={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:O,reconcilerVersion:"19.1.0"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Dh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Dh.isDisabled&&Dh.supportsFiber)try{ue=Dh.inject(Rh),de=Dh}catch(Oh){}}t.createRoot=function(e,t){if(!a(e))throw Error(o(299));var n=!1,r="",i=ba,s=_a,l=wa;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onUncaughtError&&(i=t.onUncaughtError),void 0!==t.onCaughtError&&(s=t.onCaughtError),void 0!==t.onRecoverableError&&(l=t.onRecoverableError),void 0!==t.unstable_transitionCallbacks&&t.unstable_transitionCallbacks),t=Xd(e,1,!1,null,0,n,r,i,s,l,0,null),e[Oe]=t.current,zu(e),new Ih(t)},t.hydrateRoot=function(e,t,n){if(!a(e))throw Error(o(299));var r=!1,i="",s=ba,l=_a,c=wa,u=null;return null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(i=n.identifierPrefix),void 0!==n.onUncaughtError&&(s=n.onUncaughtError),void 0!==n.onCaughtError&&(l=n.onCaughtError),void 0!==n.onRecoverableError&&(c=n.onRecoverableError),void 0!==n.unstable_transitionCallbacks&&n.unstable_transitionCallbacks,void 0!==n.formState&&(u=n.formState)),(t=Xd(e,1,!0,t,0,r,i,s,l,c,0,u)).context=Jd(null),n=t.current,(i=is(r=Ne(r=jc()))).callback=null,ss(n,i,r),n=r,t.current.lanes=n,Te(t,n),Su(t),e[Oe]=t.current,zu(e),new Ph(t)},t.version="19.1.0"},43:(e,t,n)=>{e.exports=n(288)},288:(e,t)=>{var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var _=b.prototype=new y;_.constructor=b,m(_,v.prototype),_.isPureReactComponent=!0;var w=Array.isArray,x={H:null,A:null,T:null,S:null,V:null},S=Object.prototype.hasOwnProperty;function k(e,t,r,i,s,o){return r=o.ref,{$$typeof:n,type:e,key:t,ref:void 0!==r?r:null,props:o}}function T(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var E=/\/+/g;function C(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function N(){}function I(e,t,i,s,o){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var l,c,u=!1;if(null===e)u=!0;else switch(a){case"bigint":case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case n:case r:u=!0;break;case h:return I((u=e._init)(e._payload),t,i,s,o)}}if(u)return o=o(e),u=""===s?"."+C(e,0):s,w(o)?(i="",null!=u&&(i=u.replace(E,"$&/")+"/"),I(o,t,i,"",function(e){return e})):null!=o&&(T(o)&&(l=o,c=i+(null==o.key||e&&e.key===o.key?"":(""+o.key).replace(E,"$&/")+"/")+u,o=k(l.type,c,void 0,0,0,l.props)),t.push(o)),1;u=0;var d,p=""===s?".":s+":";if(w(e))for(var m=0;m<e.length;m++)u+=I(s=e[m],t,i,a=p+C(s,m),o);else if("function"===typeof(m=null===(d=e)||"object"!==typeof d?null:"function"===typeof(d=f&&d[f]||d["@@iterator"])?d:null))for(e=m.call(e),m=0;!(s=e.next()).done;)u+=I(s=s.value,t,i,a=p+C(s,m++),o);else if("object"===a){if("function"===typeof e.then)return I(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"===typeof e.status?e.then(N,N):(e.status="pending",e.then(function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)},function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(e),t,i,s,o);throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return u}function P(e,t,n){if(null==e)return e;var r=[],i=0;return I(e,r,"","",function(e){return t.call(n,e,i++)}),r}function A(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var R="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)};function D(){}t.Children={map:P,forEach:function(e,t,n){P(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return P(e,function(){t++}),t},toArray:function(e){return P(e,function(e){return e})||[]},only:function(e){if(!T(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=i,t.Profiler=o,t.PureComponent=b,t.StrictMode=s,t.Suspense=u,t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=x,t.__COMPILER_RUNTIME={__proto__:null,c:function(e){return x.H.useMemoCache(e)}},t.cache=function(e){return function(){return e.apply(null,arguments)}},t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("The argument must be a React element, but you passed "+e+".");var r=m({},e.props),i=e.key;if(null!=t)for(s in void 0!==t.ref&&void 0,void 0!==t.key&&(i=""+t.key),t)!S.call(t,s)||"key"===s||"__self"===s||"__source"===s||"ref"===s&&void 0===t.ref||(r[s]=t[s]);var s=arguments.length-2;if(1===s)r.children=n;else if(1<s){for(var o=Array(s),a=0;a<s;a++)o[a]=arguments[a+2];r.children=o}return k(e.type,i,void 0,0,0,r)},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:a,_context:e},e},t.createElement=function(e,t,n){var r,i={},s=null;if(null!=t)for(r in void 0!==t.key&&(s=""+t.key),t)S.call(t,r)&&"key"!==r&&"__self"!==r&&"__source"!==r&&(i[r]=t[r]);var o=arguments.length-2;if(1===o)i.children=n;else if(1<o){for(var a=Array(o),l=0;l<o;l++)a[l]=arguments[l+2];i.children=a}if(e&&e.defaultProps)for(r in o=e.defaultProps)void 0===i[r]&&(i[r]=o[r]);return k(e,s,void 0,0,0,i)},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=T,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:A}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=x.T,n={};x.T=n;try{var r=e(),i=x.S;null!==i&&i(n,r),"object"===typeof r&&null!==r&&"function"===typeof r.then&&r.then(D,R)}catch(E_){R(E_)}finally{x.T=t}},t.unstable_useCacheRefresh=function(){return x.H.useCacheRefresh()},t.use=function(e){return x.H.use(e)},t.useActionState=function(e,t,n){return x.H.useActionState(e,t,n)},t.useCallback=function(e,t){return x.H.useCallback(e,t)},t.useContext=function(e){return x.H.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e,t){return x.H.useDeferredValue(e,t)},t.useEffect=function(e,t,n){var r=x.H;if("function"===typeof n)throw Error("useEffect CRUD overload is not enabled in this build of React.");return r.useEffect(e,t)},t.useId=function(){return x.H.useId()},t.useImperativeHandle=function(e,t,n){return x.H.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return x.H.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return x.H.useLayoutEffect(e,t)},t.useMemo=function(e,t){return x.H.useMemo(e,t)},t.useOptimistic=function(e,t){return x.H.useOptimistic(e,t)},t.useReducer=function(e,t,n){return x.H.useReducer(e,t,n)},t.useRef=function(e){return x.H.useRef(e)},t.useState=function(e){return x.H.useState(e)},t.useSyncExternalStore=function(e,t,n){return x.H.useSyncExternalStore(e,t,n)},t.useTransition=function(){return x.H.useTransition()},t.version="19.1.0"},391:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(4)},579:(e,t,n)=>{e.exports=n(799)},672:(e,t,n)=>{var r=n(43);function i(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(){}var o={d:{f:s,r:function(){throw Error(i(522))},D:s,C:s,L:s,m:s,X:s,S:s,M:s},p:0,findDOMNode:null},a=Symbol.for("react.portal");var l=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(e,t){return"font"===e?"":"string"===typeof t?"use-credentials"===t?t:"":void 0}t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=o,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)throw Error(i(299));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:a,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.flushSync=function(e){var t=l.T,n=o.p;try{if(l.T=null,o.p=2,e)return e()}finally{l.T=t,o.p=n,o.d.f()}},t.preconnect=function(e,t){"string"===typeof e&&(t?t="string"===typeof(t=t.crossOrigin)?"use-credentials"===t?t:"":void 0:t=null,o.d.C(e,t))},t.prefetchDNS=function(e){"string"===typeof e&&o.d.D(e)},t.preinit=function(e,t){if("string"===typeof e&&t&&"string"===typeof t.as){var n=t.as,r=c(n,t.crossOrigin),i="string"===typeof t.integrity?t.integrity:void 0,s="string"===typeof t.fetchPriority?t.fetchPriority:void 0;"style"===n?o.d.S(e,"string"===typeof t.precedence?t.precedence:void 0,{crossOrigin:r,integrity:i,fetchPriority:s}):"script"===n&&o.d.X(e,{crossOrigin:r,integrity:i,fetchPriority:s,nonce:"string"===typeof t.nonce?t.nonce:void 0})}},t.preinitModule=function(e,t){if("string"===typeof e)if("object"===typeof t&&null!==t){if(null==t.as||"script"===t.as){var n=c(t.as,t.crossOrigin);o.d.M(e,{crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0})}}else null==t&&o.d.M(e)},t.preload=function(e,t){if("string"===typeof e&&"object"===typeof t&&null!==t&&"string"===typeof t.as){var n=t.as,r=c(n,t.crossOrigin);o.d.L(e,n,{crossOrigin:r,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0,type:"string"===typeof t.type?t.type:void 0,fetchPriority:"string"===typeof t.fetchPriority?t.fetchPriority:void 0,referrerPolicy:"string"===typeof t.referrerPolicy?t.referrerPolicy:void 0,imageSrcSet:"string"===typeof t.imageSrcSet?t.imageSrcSet:void 0,imageSizes:"string"===typeof t.imageSizes?t.imageSizes:void 0,media:"string"===typeof t.media?t.media:void 0})}},t.preloadModule=function(e,t){if("string"===typeof e)if(t){var n=c(t.as,t.crossOrigin);o.d.m(e,{as:"string"===typeof t.as&&"script"!==t.as?t.as:void 0,crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0})}else o.d.m(e)},t.requestFormReset=function(e){o.d.r(e)},t.unstable_batchedUpdates=function(e,t){return e(t)},t.useFormState=function(e,t,n){return l.H.useFormState(e,t,n)},t.useFormStatus=function(){return l.H.useHostTransitionStatus()},t.version="19.1.0"},799:(e,t)=>{var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.fragment");function i(e,t,r){var i=null;if(void 0!==r&&(i=""+r),void 0!==t.key&&(i=""+t.key),"key"in t)for(var s in r={},t)"key"!==s&&(r[s]=t[s]);else r=t;return t=r.ref,{$$typeof:n,type:e,key:i,ref:void 0!==t?t:null,props:r}}t.Fragment=r,t.jsx=i,t.jsxs=i},853:(e,t,n)=>{e.exports=n(896)},896:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<s(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,o=i>>>1;r<o;){var a=2*(r+1)-1,l=e[a],c=a+1,u=e[c];if(0>s(l,n))c<i&&0>s(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[a]=n,r=a);else{if(!(c<i&&0>s(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if(t.unstable_now=void 0,"object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],u=[],d=1,h=null,f=3,p=!1,m=!1,g=!1,v=!1,y="function"===typeof setTimeout?setTimeout:null,b="function"===typeof clearTimeout?clearTimeout:null,_="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=r(u);null!==t;){if(null===t.callback)i(u);else{if(!(t.startTime<=e))break;i(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function x(e){if(g=!1,w(e),!m)if(null!==r(c))m=!0,k||(k=!0,S());else{var t=r(u);null!==t&&R(x,t.startTime-e)}}var S,k=!1,T=-1,E=5,C=-1;function N(){return!!v||!(t.unstable_now()-C<E)}function I(){if(v=!1,k){var e=t.unstable_now();C=e;var n=!0;try{e:{m=!1,g&&(g=!1,b(T),T=-1),p=!0;var s=f;try{t:{for(w(e),h=r(c);null!==h&&!(h.expirationTime>e&&N());){var o=h.callback;if("function"===typeof o){h.callback=null,f=h.priorityLevel;var a=o(h.expirationTime<=e);if(e=t.unstable_now(),"function"===typeof a){h.callback=a,w(e),n=!0;break t}h===r(c)&&i(c),w(e)}else i(c);h=r(c)}if(null!==h)n=!0;else{var l=r(u);null!==l&&R(x,l.startTime-e),n=!1}}break e}finally{h=null,f=s,p=!1}n=void 0}}finally{n?S():k=!1}}}if("function"===typeof _)S=function(){_(I)};else if("undefined"!==typeof MessageChannel){var P=new MessageChannel,A=P.port2;P.port1.onmessage=I,S=function(){A.postMessage(null)}}else S=function(){y(I,0)};function R(e,n){T=y(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_requestPaint=function(){v=!0},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,i,s){var o=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?o+s:o:s=o,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:d++,callback:i,priorityLevel:e,startTime:s,expirationTime:a=s+a,sortIndex:-1},s>o?(e.sortIndex=s,n(u,e),null===r(c)&&e===r(u)&&(g?(b(T),T=-1):g=!0,R(x,s-o))):(e.sortIndex=a,n(c,e),m||p||(m=!0,k||(k=!0,S()))),e},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},950:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(672)}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,n),s.exports}(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,i){if(1&i&&(r=this(r)),8&i)return r;if("object"===typeof r&&r){if(4&i&&r.__esModule)return r;if(16&i&&"function"===typeof r.then)return r}var s=Object.create(null);n.r(s);var o={};e=e||[null,t({}),t([]),t(t)];for(var a=2&i&&r;"object"==typeof a&&!~e.indexOf(a);a=t(a))Object.getOwnPropertyNames(a).forEach(e=>o[e]=()=>r[e]);return o.default=()=>r,n.d(s,o),s}})(),n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(NT){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/";var r,i=n(43),s=n.t(i,2),o=n(391);function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(r||(r={}));const l="popstate";function c(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function u(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(NT){}}}function d(e,t){return{usr:e.state,key:e.key,idx:t}}function h(e,t,n,r){return void 0===n&&(n=null),a({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?p(t):t,{state:n,key:t&&t.key||r||Math.random().toString(36).substr(2,8)})}function f(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(t+="#"===r.charAt(0)?r:"#"+r),t}function p(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function m(e,t,n,i){void 0===i&&(i={});let{window:s=document.defaultView,v5Compat:o=!1}=i,u=s.history,p=r.Pop,m=null,g=v();function v(){return(u.state||{idx:null}).idx}function y(){p=r.Pop;let e=v(),t=null==e?null:e-g;g=e,m&&m({action:p,location:_.location,delta:t})}function b(e){let t="null"!==s.location.origin?s.location.origin:s.location.href,n="string"===typeof e?e:f(e);return n=n.replace(/ $/,"%20"),c(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}null==g&&(g=0,u.replaceState(a({},u.state,{idx:g}),""));let _={get action(){return p},get location(){return e(s,u)},listen(e){if(m)throw new Error("A history only accepts one active listener");return s.addEventListener(l,y),m=e,()=>{s.removeEventListener(l,y),m=null}},createHref:e=>t(s,e),createURL:b,encodeLocation(e){let t=b(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){p=r.Push;let i=h(_.location,e,t);n&&n(i,e),g=v()+1;let a=d(i,g),l=_.createHref(i);try{u.pushState(a,"",l)}catch(E_){if(E_ instanceof DOMException&&"DataCloneError"===E_.name)throw E_;s.location.assign(l)}o&&m&&m({action:p,location:_.location,delta:1})},replace:function(e,t){p=r.Replace;let i=h(_.location,e,t);n&&n(i,e),g=v();let s=d(i,g),a=_.createHref(i);u.replaceState(s,"",a),o&&m&&m({action:p,location:_.location,delta:0})},go:e=>u.go(e)};return _}var g;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(g||(g={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function v(e,t,n){return void 0===n&&(n="/"),y(e,t,n,!1)}function y(e,t,n,r){let i=R(("string"===typeof t?p(t):t).pathname||"/",n);if(null==i)return null;let s=b(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every((e,n)=>e===t[n]);return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(s);let o=null;for(let a=0;null==o&&a<s.length;++a){let e=A(i);o=I(s[a],e,r)}return o}function b(e,t,n,r){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===r&&(r="");let i=(e,i,s)=>{let o={relativePath:void 0===s?e.path||"":s,caseSensitive:!0===e.caseSensitive,childrenIndex:i,route:e};o.relativePath.startsWith("/")&&(c(o.relativePath.startsWith(r),'Absolute route path "'+o.relativePath+'" nested under path "'+r+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),o.relativePath=o.relativePath.slice(r.length));let a=M([r,o.relativePath]),l=n.concat(o);e.children&&e.children.length>0&&(c(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+a+'".'),b(e.children,t,l,a)),(null!=e.path||e.index)&&t.push({path:a,score:N(a,e.index),routesMeta:l})};return e.forEach((e,t)=>{var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?"))for(let r of _(e.path))i(e,t,r);else i(e,t)}),t}function _(e){let t=e.split("/");if(0===t.length)return[];let[n,...r]=t,i=n.endsWith("?"),s=n.replace(/\?$/,"");if(0===r.length)return i?[s,""]:[s];let o=_(r.join("/")),a=[];return a.push(...o.map(e=>""===e?s:[s,e].join("/"))),i&&a.push(...o),a.map(t=>e.startsWith("/")&&""===t?"/":t)}const w=/^:[\w-]+$/,x=3,S=2,k=1,T=10,E=-2,C=e=>"*"===e;function N(e,t){let n=e.split("/"),r=n.length;return n.some(C)&&(r+=E),t&&(r+=S),n.filter(e=>!C(e)).reduce((e,t)=>e+(w.test(t)?x:""===t?k:T),r)}function I(e,t,n){void 0===n&&(n=!1);let{routesMeta:r}=e,i={},s="/",o=[];for(let a=0;a<r.length;++a){let e=r[a],l=a===r.length-1,c="/"===s?t:t.slice(s.length)||"/",u=P({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),d=e.route;if(!u&&l&&n&&!r[r.length-1].route.index&&(u=P({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!u)return null;Object.assign(i,u.params),o.push({params:i,pathname:M([s,u.pathname]),pathnameBase:F(M([s,u.pathnameBase])),route:d}),"/"!==u.pathnameBase&&(s=M([s,u.pathnameBase]))}return o}function P(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);u("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let r=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,n)=>(r.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)"));e.endsWith("*")?(r.push({paramName:"*"}),i+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":""!==e&&"/"!==e&&(i+="(?:(?=\\/|$))");let s=new RegExp(i,t?void 0:"i");return[s,r]}(e.path,e.caseSensitive,e.end),i=t.match(n);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:r.reduce((e,t,n)=>{let{paramName:r,isOptional:i}=t;if("*"===r){let e=a[n]||"";o=s.slice(0,s.length-e.length).replace(/(.)\/+$/,"$1")}const l=a[n];return e[r]=i&&!l?void 0:(l||"").replace(/%2F/g,"/"),e},{}),pathname:s,pathnameBase:o,pattern:e}}function A(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(E_){return u(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+E_+")."),e}}function R(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function D(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function O(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}function j(e,t){let n=O(e);return t?n.map((e,t)=>t===n.length-1?e.pathname:e.pathnameBase):n.map(e=>e.pathnameBase)}function L(e,t,n,r){let i;void 0===r&&(r=!1),"string"===typeof e?i=p(e):(i=a({},e),c(!i.pathname||!i.pathname.includes("?"),D("?","pathname","search",i)),c(!i.pathname||!i.pathname.includes("#"),D("#","pathname","hash",i)),c(!i.search||!i.search.includes("#"),D("#","search","hash",i)));let s,o=""===e||""===i.pathname,l=o?"/":i.pathname;if(null==l)s=n;else{let e=t.length-1;if(!r&&l.startsWith("..")){let t=l.split("/");for(;".."===t[0];)t.shift(),e-=1;i.pathname=t.join("/")}s=e>=0?t[e]:"/"}let u=function(e,t){void 0===t&&(t="/");let{pathname:n,search:r="",hash:i=""}="string"===typeof e?p(e):e,s=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)}),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:s,search:U(r),hash:V(i)}}(i,s),d=l&&"/"!==l&&l.endsWith("/"),h=(o||"."===l)&&n.endsWith("/");return u.pathname.endsWith("/")||!d&&!h||(u.pathname+="/"),u}const M=e=>e.join("/").replace(/\/\/+/g,"/"),F=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),U=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",V=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;function z(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const $=["post","put","patch","delete"],q=(new Set($),["get",...$]);new Set(q),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function B(){return B=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},B.apply(this,arguments)}const H=i.createContext(null);const W=i.createContext(null);const K=i.createContext(null);const G=i.createContext(null);const Q=i.createContext({outlet:null,matches:[],isDataRoute:!1});const Y=i.createContext(null);function X(){return null!=i.useContext(G)}function J(){return X()||c(!1),i.useContext(G).location}function Z(e){i.useContext(K).static||i.useLayoutEffect(e)}function ee(){let{isDataRoute:e}=i.useContext(Q);return e?function(){let{router:e}=ue(le.UseNavigateStable),t=he(ce.UseNavigateStable),n=i.useRef(!1);return Z(()=>{n.current=!0}),i.useCallback(function(r,i){void 0===i&&(i={}),n.current&&("number"===typeof r?e.navigate(r):e.navigate(r,B({fromRouteId:t},i)))},[e,t])}():function(){X()||c(!1);let e=i.useContext(H),{basename:t,future:n,navigator:r}=i.useContext(K),{matches:s}=i.useContext(Q),{pathname:o}=J(),a=JSON.stringify(j(s,n.v7_relativeSplatPath)),l=i.useRef(!1);return Z(()=>{l.current=!0}),i.useCallback(function(n,i){if(void 0===i&&(i={}),!l.current)return;if("number"===typeof n)return void r.go(n);let s=L(n,JSON.parse(a),o,"path"===i.relative);null==e&&"/"!==t&&(s.pathname="/"===s.pathname?t:M([t,s.pathname])),(i.replace?r.replace:r.push)(s,i.state,i)},[t,r,a,o,e])}()}function te(e,t){let{relative:n}=void 0===t?{}:t,{future:r}=i.useContext(K),{matches:s}=i.useContext(Q),{pathname:o}=J(),a=JSON.stringify(j(s,r.v7_relativeSplatPath));return i.useMemo(()=>L(e,JSON.parse(a),o,"path"===n),[e,a,o,n])}function ne(e,t,n,s){X()||c(!1);let{navigator:o}=i.useContext(K),{matches:a}=i.useContext(Q),l=a[a.length-1],u=l?l.params:{},d=(l&&l.pathname,l?l.pathnameBase:"/");l&&l.route;let h,f=J();if(t){var m;let e="string"===typeof t?p(t):t;"/"===d||(null==(m=e.pathname)?void 0:m.startsWith(d))||c(!1),h=e}else h=f;let g=h.pathname||"/",y=g;if("/"!==d){let e=d.replace(/^\//,"").split("/");y="/"+g.replace(/^\//,"").split("/").slice(e.length).join("/")}let b=v(e,{pathname:y});let _=ae(b&&b.map(e=>Object.assign({},e,{params:Object.assign({},u,e.params),pathname:M([d,o.encodeLocation?o.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?d:M([d,o.encodeLocation?o.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})),a,n,s);return t&&_?i.createElement(G.Provider,{value:{location:B({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:r.Pop}},_):_}function re(){let e=function(){var e;let t=i.useContext(Y),n=de(ce.UseRouteError),r=he(ce.UseRouteError);if(void 0!==t)return t;return null==(e=n.errors)?void 0:e[r]}(),t=z(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:r};return i.createElement(i.Fragment,null,i.createElement("h2",null,"Unexpected Application Error!"),i.createElement("h3",{style:{fontStyle:"italic"}},t),n?i.createElement("pre",{style:s},n):null,null)}const ie=i.createElement(re,null);class se extends i.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?i.createElement(Q.Provider,{value:this.props.routeContext},i.createElement(Y.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function oe(e){let{routeContext:t,match:n,children:r}=e,s=i.useContext(H);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),i.createElement(Q.Provider,{value:t},r)}function ae(e,t,n,r){var s;if(void 0===t&&(t=[]),void 0===n&&(n=null),void 0===r&&(r=null),null==e){var o;if(!n)return null;if(n.errors)e=n.matches;else{if(!(null!=(o=r)&&o.v7_partialHydration&&0===t.length&&!n.initialized&&n.matches.length>0))return null;e=n.matches}}let a=e,l=null==(s=n)?void 0:s.errors;if(null!=l){let e=a.findIndex(e=>e.route.id&&void 0!==(null==l?void 0:l[e.route.id]));e>=0||c(!1),a=a.slice(0,Math.min(a.length,e+1))}let u=!1,d=-1;if(n&&r&&r.v7_partialHydration)for(let i=0;i<a.length;i++){let e=a[i];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(d=i),e.route.id){let{loaderData:t,errors:r}=n,i=e.route.loader&&void 0===t[e.route.id]&&(!r||void 0===r[e.route.id]);if(e.route.lazy||i){u=!0,a=d>=0?a.slice(0,d+1):[a[0]];break}}}return a.reduceRight((e,r,s)=>{let o,c=!1,h=null,f=null;var p;n&&(o=l&&r.route.id?l[r.route.id]:void 0,h=r.route.errorElement||ie,u&&(d<0&&0===s?(p="route-fallback",!1||fe[p]||(fe[p]=!0),c=!0,f=null):d===s&&(c=!0,f=r.route.hydrateFallbackElement||null)));let m=t.concat(a.slice(0,s+1)),g=()=>{let t;return t=o?h:c?f:r.route.Component?i.createElement(r.route.Component,null):r.route.element?r.route.element:e,i.createElement(oe,{match:r,routeContext:{outlet:e,matches:m,isDataRoute:null!=n},children:t})};return n&&(r.route.ErrorBoundary||r.route.errorElement||0===s)?i.createElement(se,{location:n.location,revalidation:n.revalidation,component:h,error:o,children:g(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):g()},null)}var le=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(le||{}),ce=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(ce||{});function ue(e){let t=i.useContext(H);return t||c(!1),t}function de(e){let t=i.useContext(W);return t||c(!1),t}function he(e){let t=function(){let e=i.useContext(Q);return e||c(!1),e}(),n=t.matches[t.matches.length-1];return n.route.id||c(!1),n.route.id}const fe={};function pe(e,t){null==e||e.v7_startTransition,void 0===(null==e?void 0:e.v7_relativeSplatPath)&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}s.startTransition;function me(e){let{to:t,replace:n,state:r,relative:s}=e;X()||c(!1);let{future:o,static:a}=i.useContext(K),{matches:l}=i.useContext(Q),{pathname:u}=J(),d=ee(),h=L(t,j(l,o.v7_relativeSplatPath),u,"path"===s),f=JSON.stringify(h);return i.useEffect(()=>d(JSON.parse(f),{replace:n,state:r,relative:s}),[d,f,s,n,r]),null}function ge(e){c(!1)}function ve(e){let{basename:t="/",children:n=null,location:s,navigationType:o=r.Pop,navigator:a,static:l=!1,future:u}=e;X()&&c(!1);let d=t.replace(/^\/*/,"/"),h=i.useMemo(()=>({basename:d,navigator:a,static:l,future:B({v7_relativeSplatPath:!1},u)}),[d,u,a,l]);"string"===typeof s&&(s=p(s));let{pathname:f="/",search:m="",hash:g="",state:v=null,key:y="default"}=s,b=i.useMemo(()=>{let e=R(f,d);return null==e?null:{location:{pathname:e,search:m,hash:g,state:v,key:y},navigationType:o}},[d,f,m,g,v,y,o]);return null==b?null:i.createElement(K.Provider,{value:h},i.createElement(G.Provider,{children:n,value:b}))}function ye(e){let{children:t,location:n}=e;return ne(be(t),n)}new Promise(()=>{});i.Component;function be(e,t){void 0===t&&(t=[]);let n=[];return i.Children.forEach(e,(e,r)=>{if(!i.isValidElement(e))return;let s=[...t,r];if(e.type===i.Fragment)return void n.push.apply(n,be(e.props.children,s));e.type!==ge&&c(!1),e.props.index&&e.props.children&&c(!1);let o={id:e.props.id||s.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(o.children=be(e.props.children,s)),n.push(o)}),n}var _e=n(950),we=n.t(_e,2);function xe(){return xe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},xe.apply(this,arguments)}function Se(e,t){if(null==e)return{};var n,r,i={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);const ke=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"];try{window.__reactRouterVersion="6"}catch(NT){}new Map;const Te=s.startTransition;we.flushSync,s.useId;function Ee(e){let{basename:t,children:n,future:r,window:s}=e,o=i.useRef();var a;null==o.current&&(o.current=(void 0===(a={window:s,v5Compat:!0})&&(a={}),m(function(e,t){let{pathname:n,search:r,hash:i}=e.location;return h("",{pathname:n,search:r,hash:i},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"===typeof t?t:f(t)},null,a)));let l=o.current,[c,u]=i.useState({action:l.action,location:l.location}),{v7_startTransition:d}=r||{},p=i.useCallback(e=>{d&&Te?Te(()=>u(e)):u(e)},[u,d]);return i.useLayoutEffect(()=>l.listen(p),[l,p]),i.useEffect(()=>pe(r),[r]),i.createElement(ve,{basename:t,children:n,location:c.location,navigationType:c.action,navigator:l,future:r})}const Ce="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,Ne=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ie=i.forwardRef(function(e,t){let n,{onClick:r,relative:s,reloadDocument:o,replace:a,state:l,target:u,to:d,preventScrollReset:h,viewTransition:p}=e,m=Se(e,ke),{basename:g}=i.useContext(K),v=!1;if("string"===typeof d&&Ne.test(d)&&(n=d,Ce))try{let e=new URL(window.location.href),t=d.startsWith("//")?new URL(e.protocol+d):new URL(d),n=R(t.pathname,g);t.origin===e.origin&&null!=n?d=n+t.search+t.hash:v=!0}catch(NT){}let y=function(e,t){let{relative:n}=void 0===t?{}:t;X()||c(!1);let{basename:r,navigator:s}=i.useContext(K),{hash:o,pathname:a,search:l}=te(e,{relative:n}),u=a;return"/"!==r&&(u="/"===a?r:M([r,a])),s.createHref({pathname:u,search:l,hash:o})}(d,{relative:s}),b=function(e,t){let{target:n,replace:r,state:s,preventScrollReset:o,relative:a,viewTransition:l}=void 0===t?{}:t,c=ee(),u=J(),d=te(e,{relative:a});return i.useCallback(t=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(t,n)){t.preventDefault();let n=void 0!==r?r:f(u)===f(d);c(e,{replace:n,state:s,preventScrollReset:o,relative:a,viewTransition:l})}},[u,c,d,r,s,n,e,o,a,l])}(d,{replace:a,state:l,target:u,preventScrollReset:h,relative:s,viewTransition:p});return i.createElement("a",xe({},m,{href:n||y,onClick:v||o?r:function(e){r&&r(e),e.defaultPrevented||b(e)},ref:t,target:u}))});var Pe,Ae;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Pe||(Pe={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(Ae||(Ae={}));const Re=n.p+"static/media/robot.3973d5cb4a0f6562e504.png";var De=n(579);function Oe(){return(0,De.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 to-slate-950 text-white flex items-center justify-center px-4 py-12",children:(0,De.jsxs)("div",{className:"max-w-6xl w-full flex flex-col md:flex-row items-center gap-10 bg-white/5 backdrop-blur-md rounded-3xl p-10 md:p-14 border border-slate-700 shadow-2xl",children:[(0,De.jsxs)("div",{className:"flex-1 text-center md:text-left",children:[(0,De.jsxs)("h1",{className:"text-4xl md:text-5xl font-extrabold mb-4",children:["Welcome to ",(0,De.jsx)("span",{className:"text-indigo-400",children:"SEC Dashboard"})]}),(0,De.jsxs)("p",{className:"text-lg md:text-xl text-slate-300 mb-8",children:["Control. Visualize. Compete.",(0,De.jsx)("br",{}),"A futuristic dashboard for the UPT Space Engineering Challenge 2025."]}),(0,De.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 justify-center md:justify-start",children:[(0,De.jsx)(Ie,{to:"/login",className:"px-6 py-3 bg-indigo-600 hover:bg-indigo-700 rounded-xl text-lg font-semibold shadow transition",children:"\ud83d\ude80 Login"}),(0,De.jsx)(Ie,{to:"/signup",className:"px-6 py-3 bg-white text-slate-900 hover:bg-gray-200 rounded-xl text-lg font-semibold shadow transition",children:"\ud83e\uddd1\u200d\ud83d\ude80 Sign Up"})]})]}),(0,De.jsx)("div",{className:"flex-1 flex justify-center",children:(0,De.jsx)("img",{src:Re,alt:"Robot mascot",className:"w-[240px] md:w-[280px] lg:w-[320px] drop-shadow-xl"})})]})})}const je=!1,Le=!1,Me="${JSCORE_VERSION}",Fe=function(e,t){if(!e)throw Ue(t)},Ue=function(e){return new Error("Firebase Database ("+Me+") INTERNAL ASSERT FAILED: "+e)},Ve=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},ze={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<e.length;i+=3){const t=e[i],s=i+1<e.length,o=s?e[i+1]:0,a=i+2<e.length,l=a?e[i+2]:0,c=t>>2,u=(3&t)<<4|o>>4;let d=(15&o)<<2|l>>6,h=63&l;a||(h=64,s||(d=64)),r.push(n[c],n[u],n[d],n[h])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(Ve(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],o=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<e.length;){const t=n[e.charAt(i++)],s=i<e.length?n[e.charAt(i)]:0;++i;const o=i<e.length?n[e.charAt(i)]:64;++i;const a=i<e.length?n[e.charAt(i)]:64;if(++i,null==t||null==s||null==o||null==a)throw new $e;const l=t<<2|s>>4;if(r.push(l),64!==o){const e=s<<4&240|o>>2;if(r.push(e),64!==a){const e=o<<6&192|a;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class $e extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const qe=function(e){const t=Ve(e);return ze.encodeByteArray(t,!0)},Be=function(e){return qe(e).replace(/\./g,"")},He=function(e){try{return ze.decodeString(e,!0)}catch(NT){console.error("base64Decode failed: ",NT)}return null};function We(e){return Ke(void 0,e)}function Ke(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(const n in t)t.hasOwnProperty(n)&&Ge(n)&&(e[n]=Ke(e[n],t[n]));return e}function Ge(e){return"__proto__"!==e}function Qe(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}const Ye=()=>{try{return Qe().__FIREBASE_DEFAULTS__||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(NT){return}const t=e&&He(e[1]);return t&&JSON.parse(t)})()}catch(NT){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${NT}`)}},Xe=e=>{var t,n;return null===(n=null===(t=Ye())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},Je=e=>{const t=Xe(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]},Ze=()=>{var e;return null===(e=Ye())||void 0===e?void 0:e.config},et=e=>{var t;return null===(t=Ye())||void 0===t?void 0:t[`_${e}`]};class tt{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}function nt(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch(t){return!1}}async function rt(e){return(await fetch(e,{credentials:"include"})).ok}function it(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[Be(JSON.stringify({alg:"none",type:"JWT"})),Be(JSON.stringify(s)),""].join(".")}const st={};let ot=!1;function at(e,t){if("undefined"===typeof window||"undefined"===typeof document||!nt(window.location.host)||st[e]===t||st[e]||ot)return;function n(e){return`__firebase__banner__${e}`}st[e]=t;const r="__firebase__banner",i=function(){const e={prod:[],emulator:[]};for(const t of Object.keys(st))st[t]?e.emulator.push(t):e.prod.push(t);return e}().prod.length>0;function s(){const e=document.createElement("span");return e.style.cursor="pointer",e.style.marginLeft="16px",e.style.fontSize="24px",e.innerHTML=" &times;",e.onclick=()=>{ot=!0,function(){const e=document.getElementById(r);e&&e.remove()}()},e}function o(){const e=function(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),n=!0),{created:n,element:t}}(r),t=n("text"),o=document.getElementById(t)||document.createElement("span"),a=n("learnmore"),l=document.getElementById(a)||document.createElement("a"),c=n("preprendIcon"),u=document.getElementById(c)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(e.created){const t=e.element;!function(e){e.style.display="flex",e.style.background="#7faaf0",e.style.position="fixed",e.style.bottom="5px",e.style.left="5px",e.style.padding=".5em",e.style.borderRadius="5px",e.style.alignItems="center"}(t),function(e,t){e.setAttribute("id",t),e.innerText="Learn more",e.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",e.setAttribute("target","__blank"),e.style.paddingLeft="5px",e.style.textDecoration="underline"}(l,a);const n=s();!function(e,t){e.setAttribute("width","24"),e.setAttribute("id",t),e.setAttribute("height","24"),e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("fill","none"),e.style.marginLeft="-6px"}(u,c),t.append(u,o,l,n),document.body.appendChild(t)}i?(o.innerText="Preview backend disconnected.",u.innerHTML='<g clip-path="url(#clip0_6013_33858)">\n<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6013_33858">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>'):(u.innerHTML='<g clip-path="url(#clip0_6083_34804)">\n<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6083_34804">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>',o.innerText="Preview backend running in this workspace."),o.setAttribute("id",t)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",o):o()}function lt(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function ct(){return"undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(lt())}function ut(){var e;const t=null===(e=Ye())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(NT){return!1}}function dt(){return"object"===typeof navigator&&"ReactNative"===navigator.product}function ht(){return!0===je||!0===Le}function ft(){return!ut()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function pt(){return!ut()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function mt(){try{return"object"===typeof indexedDB}catch(NT){return!1}}class gt extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,gt.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,vt.prototype.create)}}class vt{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n=`${this.service}/${e}`,r=this.errors[e],i=r?function(e,t){return e.replace(yt,(e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`})}(r,t):"Error",s=`${this.serviceName}: ${i} (${n}).`;return new gt(n,s,t)}}const yt=/\{\$([^}]+)}/g;function bt(e){return JSON.parse(e)}function _t(e){return JSON.stringify(e)}const wt=function(e){let t={},n={},r={},i="";try{const s=e.split(".");t=bt(He(s[0])||""),n=bt(He(s[1])||""),i=s[2],r=n.d||{},delete n.d}catch(NT){}return{header:t,claims:n,data:r,signature:i}};function xt(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function St(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function kt(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function Tt(e,t,n){const r={};for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r}function Et(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],s=t[i];if(Ct(n)&&Ct(s)){if(!Et(n,s))return!1}else if(n!==s)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function Ct(e){return null!==e&&"object"===typeof e}function Nt(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach(e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function It(e){const t={};return e.replace(/^\?/,"").split("&").forEach(e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}}),t}function Pt(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class At{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const n=this.W_;if("string"===typeof e)for(let u=0;u<16;u++)n[u]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let u=0;u<16;u++)n[u]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let u=16;u<80;u++){const e=n[u-3]^n[u-8]^n[u-14]^n[u-16];n[u]=4294967295&(e<<1|e>>>31)}let r,i,s=this.chain_[0],o=this.chain_[1],a=this.chain_[2],l=this.chain_[3],c=this.chain_[4];for(let u=0;u<80;u++){u<40?u<20?(r=l^o&(a^l),i=1518500249):(r=o^a^l,i=1859775393):u<60?(r=o&a|l&(o|a),i=2400959708):(r=o^a^l,i=3395469782);const e=(s<<5|s>>>27)+r+c+i+n[u]&4294967295;c=l,l=a,a=4294967295&(o<<30|o>>>2),o=s,s=e}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,t){if(null==e)return;void 0===t&&(t=e.length);const n=t-this.blockSize;let r=0;const i=this.buf_;let s=this.inbuf_;for(;r<t;){if(0===s)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"===typeof e){for(;r<t;)if(i[s]=e.charCodeAt(r),++s,++r,s===this.blockSize){this.compress_(i),s=0;break}}else for(;r<t;)if(i[s]=e[r],++s,++r,s===this.blockSize){this.compress_(i),s=0;break}}this.inbuf_=s,this.total_+=t}digest(){const e=[];let t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let r=this.blockSize-1;r>=56;r--)this.buf_[r]=255&t,t/=256;this.compress_(this.buf_);let n=0;for(let r=0;r<5;r++)for(let t=24;t>=0;t-=8)e[n]=this.chain_[r]>>t&255,++n;return e}}class Rt{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!==typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"===typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=Dt),void 0===r.error&&(r.error=Dt),void 0===r.complete&&(r.complete=Dt);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(NT){}}),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(NT){"undefined"!==typeof console&&console.error&&console.error(NT)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Dt(){}function Ot(e,t){return`${e} failed: ${t} argument `}const jt=function(e){let t=0;for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t};function Lt(e){return e&&e._delegate?e._delegate:e}class Mt{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Ft="[DEFAULT]";class Ut{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new tt;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(NT){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(NT){if(r)return null;throw NT}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:Ft})}catch(NT){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(NT){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ft;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ft;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ft;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[i,s]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(i)&&s.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch(r){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===Ft?void 0:i),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch(s){}var i;return r||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ft;return this.component?this.component.multipleInstances?e:Ft:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class Vt{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Ut(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const zt=[];var $t;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}($t||($t={}));const qt={debug:$t.DEBUG,verbose:$t.VERBOSE,info:$t.INFO,warn:$t.WARN,error:$t.ERROR,silent:$t.SILENT},Bt=$t.INFO,Ht={[$t.DEBUG]:"log",[$t.VERBOSE]:"log",[$t.INFO]:"info",[$t.WARN]:"warn",[$t.ERROR]:"error"},Wt=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),r=Ht[t];if(!r)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);for(var i=arguments.length,s=new Array(i>2?i-2:0),o=2;o<i;o++)s[o-2]=arguments[o];console[r](`[${n}]  ${e.name}:`,...s)};class Kt{constructor(e){this.name=e,this._logLevel=Bt,this._logHandler=Wt,this._userLogHandler=null,zt.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in $t))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?qt[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,$t.DEBUG,...t),this._logHandler(this,$t.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,$t.VERBOSE,...t),this._logHandler(this,$t.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,$t.INFO,...t),this._logHandler(this,$t.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,$t.WARN,...t),this._logHandler(this,$t.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,$t.ERROR,...t),this._logHandler(this,$t.ERROR,...t)}}let Gt,Qt;const Yt=new WeakMap,Xt=new WeakMap,Jt=new WeakMap,Zt=new WeakMap,en=new WeakMap;let tn={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return Xt.get(e);if("objectStoreNames"===t)return e.objectStoreNames||Jt.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return sn(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function nn(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Qt||(Qt=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(on(this),n),sn(Yt.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return sn(e.apply(on(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const s=e.call(on(this),t,...r);return Jt.set(s,t.sort?t.sort():[t]),sn(s)}}function rn(e){return"function"===typeof e?nn(e):(e instanceof IDBTransaction&&function(e){if(Xt.has(e))return;const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)});Xt.set(e,t)}(e),t=e,(Gt||(Gt=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(e=>t instanceof e)?new Proxy(e,tn):e);var t}function sn(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(sn(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",s)});return t.then(t=>{t instanceof IDBCursor&&Yt.set(t,e)}).catch(()=>{}),en.set(t,e),t}(e);if(Zt.has(e))return Zt.get(e);const t=rn(e);return t!==e&&(Zt.set(e,t),en.set(t,e)),t}const on=e=>en.get(e);const an=["get","getKey","getAll","getAllKeys","count"],ln=["put","add","delete","clear"],cn=new Map;function un(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(cn.get(t))return cn.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=ln.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!an.includes(n))return;const s=async function(e){const t=this.transaction(e,i?"readwrite":"readonly");let s=t.store;for(var o=arguments.length,a=new Array(o>1?o-1:0),l=1;l<o;l++)a[l-1]=arguments[l];return r&&(s=s.index(a.shift())),(await Promise.all([s[n](...a),i&&t.done]))[0]};return cn.set(t,s),s}tn=(e=>({...e,get:(t,n,r)=>un(t,n)||e.get(t,n,r),has:(t,n)=>!!un(t,n)||e.has(t,n)}))(tn);class dn{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null}).filter(e=>e).join(" ")}}const hn="@firebase/app",fn="0.13.2",pn=new Kt("@firebase/app"),mn="@firebase/app-compat",gn="@firebase/analytics-compat",vn="@firebase/analytics",yn="@firebase/app-check-compat",bn="@firebase/app-check",_n="@firebase/auth",wn="@firebase/auth-compat",xn="@firebase/database",Sn="@firebase/data-connect",kn="@firebase/database-compat",Tn="@firebase/functions",En="@firebase/functions-compat",Cn="@firebase/installations",Nn="@firebase/installations-compat",In="@firebase/messaging",Pn="@firebase/messaging-compat",An="@firebase/performance",Rn="@firebase/performance-compat",Dn="@firebase/remote-config",On="@firebase/remote-config-compat",jn="@firebase/storage",Ln="@firebase/storage-compat",Mn="@firebase/firestore",Fn="@firebase/ai",Un="@firebase/firestore-compat",Vn="firebase",zn="[DEFAULT]",$n={[hn]:"fire-core",[mn]:"fire-core-compat",[vn]:"fire-analytics",[gn]:"fire-analytics-compat",[bn]:"fire-app-check",[yn]:"fire-app-check-compat",[_n]:"fire-auth",[wn]:"fire-auth-compat",[xn]:"fire-rtdb",[Sn]:"fire-data-connect",[kn]:"fire-rtdb-compat",[Tn]:"fire-fn",[En]:"fire-fn-compat",[Cn]:"fire-iid",[Nn]:"fire-iid-compat",[In]:"fire-fcm",[Pn]:"fire-fcm-compat",[An]:"fire-perf",[Rn]:"fire-perf-compat",[Dn]:"fire-rc",[On]:"fire-rc-compat",[jn]:"fire-gcs",[Ln]:"fire-gcs-compat",[Mn]:"fire-fst",[Un]:"fire-fst-compat",[Fn]:"fire-vertex","fire-js":"fire-js",[Vn]:"fire-js-all"},qn=new Map,Bn=new Map,Hn=new Map;function Wn(e,t){try{e.container.addComponent(t)}catch(NT){pn.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,NT)}}function Kn(e){const t=e.name;if(Hn.has(t))return pn.debug(`There were multiple attempts to register component ${t}.`),!1;Hn.set(t,e);for(const n of qn.values())Wn(n,e);for(const n of Bn.values())Wn(n,e);return!0}function Gn(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function Qn(e){return null!==e&&void 0!==e&&void 0!==e.settings}const Yn=new vt("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class Xn{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Mt("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Yn.create("app-deleted",{appName:this._name})}}const Jn="11.10.0";function Zn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const r=Object.assign({name:zn,automaticDataCollectionEnabled:!0},t),i=r.name;if("string"!==typeof i||!i)throw Yn.create("bad-app-name",{appName:String(i)});if(n||(n=Ze()),!n)throw Yn.create("no-options");const s=qn.get(i);if(s){if(Et(n,s.options)&&Et(r,s.config))return s;throw Yn.create("duplicate-app",{appName:i})}const o=new Vt(i);for(const l of Hn.values())o.addComponent(l);const a=new Xn(n,r,o);return qn.set(i,a),a}function er(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:zn;const t=qn.get(e);if(!t&&e===zn&&Ze())return Zn();if(!t)throw Yn.create("no-app",{appName:e});return t}function tr(e,t,n){var r;let i=null!==(r=$n[e])&&void 0!==r?r:e;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const e=[`Unable to register library "${i}" with version "${t}":`];return s&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&e.push("and"),o&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void pn.warn(e.join(" "))}Kn(new Mt(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}const nr="firebase-heartbeat-store";let rr=null;function ir(){return rr||(rr=function(e,t){let{blocked:n,upgrade:r,blocking:i,terminated:s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=indexedDB.open(e,t),a=sn(o);return r&&o.addEventListener("upgradeneeded",e=>{r(sn(o.result),e.oldVersion,e.newVersion,sn(o.transaction),e)}),n&&o.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),a.then(e=>{s&&e.addEventListener("close",()=>s()),i&&e.addEventListener("versionchange",e=>i(e.oldVersion,e.newVersion,e))}).catch(()=>{}),a}("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(nr)}catch(NT){console.warn(NT)}}}).catch(e=>{throw Yn.create("idb-open",{originalErrorMessage:e.message})})),rr}async function sr(e,t){try{const n=(await ir()).transaction(nr,"readwrite"),r=n.objectStore(nr);await r.put(t,or(e)),await n.done}catch(NT){if(NT instanceof gt)pn.warn(NT.message);else{const t=Yn.create("idb-set",{originalErrorMessage:null===NT||void 0===NT?void 0:NT.message});pn.warn(t.message)}}}function or(e){return`${e.name}!${e.options.appId}`}class ar{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new cr(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){var e,t;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=lr();if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))return;if(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(e=>e.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats.length>30){const e=function(e){if(0===e.length)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(NT){pn.warn(NT)}}async getHeartbeatsHeader(){var e;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=lr(),{heartbeatsToSend:n,unsentEntries:r}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let r=e.slice();for(const i of e){const e=n.find(e=>e.agent===i.agent);if(e){if(e.dates.push(i.date),ur(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),ur(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),i=Be(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(NT){return pn.warn(NT),""}}}function lr(){return(new Date).toISOString().substring(0,10)}class cr{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!mt()&&new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(E_){t(E_)}}).then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await ir()).transaction(nr),n=await t.objectStore(nr).get(or(e));return await t.done,n}catch(NT){if(NT instanceof gt)pn.warn(NT.message);else{const t=Yn.create("idb-get",{originalErrorMessage:null===NT||void 0===NT?void 0:NT.message});pn.warn(t.message)}}}(this.app);return(null===e||void 0===e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return sr(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return sr(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function ur(e){return Be(JSON.stringify({version:2,heartbeats:e})).length}var dr;dr="",Kn(new Mt("platform-logger",e=>new dn(e),"PRIVATE")),Kn(new Mt("heartbeat",e=>new ar(e),"PRIVATE")),tr(hn,fn,dr),tr(hn,fn,"esm2017"),tr("fire-js","");function hr(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}Object.create;Object.create;"function"===typeof SuppressedError&&SuppressedError;function fr(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const pr=fr,mr=new vt("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),gr=new Kt("@firebase/auth");function vr(e){if(gr.logLevel<=$t.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];gr.error(`Auth (${Jn}): ${e}`,...n)}}function yr(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw xr(e,...n)}function br(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return xr(e,...n)}function _r(e,t,n){const r=Object.assign(Object.assign({},pr()),{[t]:n});return new vt("auth","Firebase",r).create(t,{appName:e.name})}function wr(e){return _r(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function xr(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!==typeof e){const t=n[0],r=[...n.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(t,...r)}return mr.create(e,...n)}function Sr(e,t){if(!e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];throw xr(t,...r)}}function kr(e){const t="INTERNAL ASSERTION FAILED: "+e;throw vr(t),new Error(t)}function Tr(e,t){e||kr(t)}function Er(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function Cr(){return"http:"===Nr()||"https:"===Nr()}function Nr(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}function Ir(){return!("undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(Cr()||function(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}()||"connection"in navigator))||navigator.onLine}class Pr{constructor(e,t){this.shortDelay=e,this.longDelay=t,Tr(t>e,"Short delay should be less than long delay!"),this.isMobile=ct()||dt()}get(){return Ir()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Ar(e,t){Tr(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class Rr{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:"undefined"!==typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!==typeof fetch?fetch:void kr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:"undefined"!==typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!==typeof Headers?Headers:void kr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:"undefined"!==typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!==typeof Response?Response:void kr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Dr={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Or=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],jr=new Pr(3e4,6e4);function Lr(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function Mr(e,t,n,r){return Fr(e,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},async()=>{let i={},s={};r&&("GET"===t?s=r:i={body:JSON.stringify(r)});const o=Nt(Object.assign({key:e.config.apiKey},s)).slice(1),a=await e._getAdditionalHeaders();a["Content-Type"]="application/json",e.languageCode&&(a["X-Firebase-Locale"]=e.languageCode);const l=Object.assign({method:t,headers:a},i);return"undefined"!==typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||(l.referrerPolicy="no-referrer"),e.emulatorConfig&&nt(e.emulatorConfig.host)&&(l.credentials="include"),Rr.fetch()(await Vr(e,e.config.apiHost,n,o),l)})}async function Fr(e,t,n){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},Dr),t);try{const t=new $r(e),i=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await i.json();if("needConfirmation"in s)throw qr(e,"account-exists-with-different-credential",s);if(i.ok&&!("errorMessage"in s))return s;{const t=i.ok?s.errorMessage:s.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw qr(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw qr(e,"email-already-in-use",s);if("USER_DISABLED"===n)throw qr(e,"user-disabled",s);const a=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw _r(e,a,o);yr(e,a)}}catch(NT){if(NT instanceof gt)throw NT;yr(e,"network-request-failed",{message:String(NT)})}}async function Ur(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const s=await Mr(e,t,n,r,i);return"mfaPendingCredential"in s&&yr(e,"multi-factor-auth-required",{_serverResponse:s}),s}async function Vr(e,t,n,r){const i=`${t}${n}?${r}`,s=e,o=s.config.emulator?Ar(e.config,i):`${e.config.apiScheme}://${i}`;if(Or.includes(n)&&(await s._persistenceManagerAvailable,"COOKIE"===s._getPersistenceType())){return s._getPersistence()._getFinalTarget(o).toString()}return o}function zr(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class $r{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(br(this.auth,"network-request-failed")),jr.get())})}}function qr(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=br(e,t,r);return i.customData._tokenResponse=n,i}function Br(e){return void 0!==e&&void 0!==e.enterprise}class Hr{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return zr(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Wr(e,t){return Mr(e,"GET","/v2/recaptchaConfig",Lr(e,t))}async function Kr(e,t){return Mr(e,"POST","/v1/accounts:lookup",t)}function Gr(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(NT){}}function Qr(e){return 1e3*Number(e)}function Yr(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return vr("JWT malformed, contained fewer than 3 sections"),null;try{const e=He(n);return e?JSON.parse(e):(vr("Failed to decode base64 JWT payload"),null)}catch(NT){return vr("Caught error parsing JWT payload as JSON",null===NT||void 0===NT?void 0:NT.toString()),null}}function Xr(e){const t=Yr(e);return Sr(t,"internal-error"),Sr("undefined"!==typeof t.exp,"internal-error"),Sr("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function Jr(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return t;try{return await t}catch(NT){throw NT instanceof gt&&function(e){let{code:t}=e;return"auth/user-disabled"===t||"auth/user-token-expired"===t}(NT)&&e.auth.currentUser===e&&await e.auth.signOut(),NT}}class Zr{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(NT){return void("auth/network-request-failed"===(null===NT||void 0===NT?void 0:NT.code)&&this.schedule(!0))}this.schedule()}}class ei{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Gr(this.lastLoginAt),this.creationTime=Gr(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function ti(e){var t;const n=e.auth,r=await e.getIdToken(),i=await Jr(e,Kr(n,{idToken:r}));Sr(null===i||void 0===i?void 0:i.users.length,n,"internal-error");const s=i.users[0];e._notifyReloadListener(s);const o=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?ni(s.providerUserInfo):[],a=function(e,t){const n=e.filter(e=>!t.some(t=>t.providerId===e.providerId));return[...n,...t]}(e.providerData,o),l=e.isAnonymous,c=!(e.email&&s.passwordHash)&&!(null===a||void 0===a?void 0:a.length),u=!!l&&c,d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new ei(s.createdAt,s.lastLoginAt),isAnonymous:u};Object.assign(e,d)}function ni(e){return e.map(e=>{var{providerId:t}=e,n=hr(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}class ri{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Sr(e.idToken,"internal-error"),Sr("undefined"!==typeof e.idToken,"internal-error"),Sr("undefined"!==typeof e.refreshToken,"internal-error");const t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):Xr(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Sr(0!==e.length,"internal-error");const t=Xr(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||!this.accessToken||this.isExpired?(Sr(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:i}=await async function(e,t){const n=await Fr(e,{},async()=>{const n=Nt({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:i}=e.config,s=await Vr(e,r,"/v1/token",`key=${i}`),o=await e._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";const a={method:"POST",headers:o,body:n};return e.emulatorConfig&&nt(e.emulatorConfig.host)&&(a.credentials="include"),Rr.fetch()(s,a)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,s=new ri;return n&&(Sr("string"===typeof n,"internal-error",{appName:e}),s.refreshToken=n),r&&(Sr("string"===typeof r,"internal-error",{appName:e}),s.accessToken=r),i&&(Sr("number"===typeof i,"internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ri,this.toJSON())}_performRefresh(){return kr("not implemented")}}function ii(e,t){Sr("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}class si{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,i=hr(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Zr(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new ei(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await Jr(this,this.stsTokenManager.getToken(this.auth,e));return Sr(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=Lt(e),r=await n.getIdToken(t),i=Yr(r);Sr(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s="object"===typeof i.firebase?i.firebase:void 0,o=null===s||void 0===s?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:Gr(Qr(i.auth_time)),issuedAtTime:Gr(Qr(i.iat)),expirationTime:Gr(Qr(i.exp)),signInProvider:o||null,signInSecondFactor:(null===s||void 0===s?void 0:s.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=Lt(e);await ti(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(Sr(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>Object.assign({},e)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new si(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Sr(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await ti(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Qn(this.auth.app))return Promise.reject(wr(this.auth));const e=await this.getIdToken();return await Jr(this,async function(e,t){return Mr(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,i,s,o,a,l,c;const u=null!==(n=t.displayName)&&void 0!==n?n:void 0,d=null!==(r=t.email)&&void 0!==r?r:void 0,h=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,f=null!==(s=t.photoURL)&&void 0!==s?s:void 0,p=null!==(o=t.tenantId)&&void 0!==o?o:void 0,m=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,g=null!==(l=t.createdAt)&&void 0!==l?l:void 0,v=null!==(c=t.lastLoginAt)&&void 0!==c?c:void 0,{uid:y,emailVerified:b,isAnonymous:_,providerData:w,stsTokenManager:x}=t;Sr(y&&x,e,"internal-error");const S=ri.fromJSON(this.name,x);Sr("string"===typeof y,e,"internal-error"),ii(u,e.name),ii(d,e.name),Sr("boolean"===typeof b,e,"internal-error"),Sr("boolean"===typeof _,e,"internal-error"),ii(h,e.name),ii(f,e.name),ii(p,e.name),ii(m,e.name),ii(g,e.name),ii(v,e.name);const k=new si({uid:y,auth:e,email:d,emailVerified:b,displayName:u,isAnonymous:_,photoURL:f,phoneNumber:h,tenantId:p,stsTokenManager:S,createdAt:g,lastLoginAt:v});return w&&Array.isArray(w)&&(k.providerData=w.map(e=>Object.assign({},e))),m&&(k._redirectEventId=m),k}static async _fromIdTokenResponse(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=new ri;r.updateFromServerResponse(t);const i=new si({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await ti(i),i}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];Sr(void 0!==r.localId,"internal-error");const i=void 0!==r.providerUserInfo?ni(r.providerUserInfo):[],s=!(r.email&&r.passwordHash)&&!(null===i||void 0===i?void 0:i.length),o=new ri;o.updateFromIdToken(n);const a=new si({uid:r.localId,auth:e,stsTokenManager:o,isAnonymous:s}),l={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:i,metadata:new ei(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(null===i||void 0===i?void 0:i.length)};return Object.assign(a,l),a}}const oi=new Map;function ai(e){Tr(e instanceof Function,"Expected a class definition");let t=oi.get(e);return t?(Tr(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,oi.set(e,t),t)}class li{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}li.type="NONE";const ci=li;function ui(e,t,n){return`firebase:${e}:${t}:${n}`}class di{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=ui(this.userKey,r.apiKey,i),this.fullPersistenceKey=ui("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if("string"===typeof e){const t=await Kr(this.auth,{idToken:e}).catch(()=>{});return t?si._fromGetAccountInfoResponse(this.auth,t,e):null}return si._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";if(!t.length)return new di(ai(ci),e,n);const r=(await Promise.all(t.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e);let i=r[0]||ai(ci);const s=ui(n,e.config.apiKey,e.name);let o=null;for(const c of t)try{const t=await c._get(s);if(t){let n;if("string"===typeof t){const r=await Kr(e,{idToken:t}).catch(()=>{});if(!r)break;n=await si._fromGetAccountInfoResponse(e,r,t)}else n=si._fromJSON(e,t);c!==i&&(o=n),i=c;break}}catch(l){}const a=r.filter(e=>e._shouldAllowMigration);return i._shouldAllowMigration&&a.length?(i=a[0],o&&await i._set(s,o.toJSON()),await Promise.all(t.map(async e=>{if(e!==i)try{await e._remove(s)}catch(l){}})),new di(i,e,n)):new di(i,e,n)}}function hi(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(gi(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(fi(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(yi(t))return"Blackberry";if(bi(t))return"Webos";if(pi(t))return"Safari";if((t.includes("chrome/")||mi(t))&&!t.includes("edge/"))return"Chrome";if(vi(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null===n||void 0===n?void 0:n.length))return n[1]}return"Other"}function fi(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:lt();return/firefox\//i.test(e)}function pi(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:lt()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function mi(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:lt();return/crios\//i.test(e)}function gi(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:lt();return/iemobile/i.test(e)}function vi(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:lt();return/android/i.test(e)}function yi(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:lt();return/blackberry/i.test(e)}function bi(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:lt();return/webos/i.test(e)}function _i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:lt();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function wi(){return function(){const e=lt();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()&&10===document.documentMode}function xi(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:lt();return _i(e)||vi(e)||bi(e)||yi(e)||/windows phone/i.test(e)||gi(e)}function Si(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=hi(lt());break;case"Worker":t=`${hi(lt())}-${e}`;break;default:t=e}const r=n.length?n.join(","):"FirebaseCore-web";return`${t}/JsCore/${Jn}/${r}`}class ki{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise((n,r)=>{try{n(e(t))}catch(NT){r(NT)}});n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(NT){t.reverse();for(const n of t)try{n()}catch(dE){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===NT||void 0===NT?void 0:NT.message})}}}class Ti{constructor(e){var t,n,r,i;const s=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=s.minPasswordLength)&&void 0!==t?t:6,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),void 0!==s.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),void 0!==s.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),void 0!==s.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),void 0!==s.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(r=null===(n=e.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==r?r:"",this.forceUpgradeOnSignin=null!==(i=e.forceUpgradeOnSignin)&&void 0!==i&&i,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,r,i,s,o;const a={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,a),this.validatePasswordCharacterOptions(e,a),a.isValid&&(a.isValid=null===(t=a.meetsMinPasswordLength)||void 0===t||t),a.isValid&&(a.isValid=null===(n=a.meetsMaxPasswordLength)||void 0===n||n),a.isValid&&(a.isValid=null===(r=a.containsLowercaseLetter)||void 0===r||r),a.isValid&&(a.isValid=null===(i=a.containsUppercaseLetter)||void 0===i||i),a.isValid&&(a.isValid=null===(s=a.containsNumericCharacter)||void 0===s||s),a.isValid&&(a.isValid=null===(o=a.containsNonAlphanumericCharacter)||void 0===o||o),a}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class Ei{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ni(this),this.idTokenSubscription=new Ni(this),this.beforeStateQueue=new ki(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=mr,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(e=>this._resolvePersistenceManagerAvailable=e)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ai(t)),this._initializationPromise=this.queue(async()=>{var n,r,i;if(!this._deleted&&(this.persistenceManager=await di.create(this,e),null===(n=this._resolvePersistenceManagerAvailable)||void 0===n||n.call(this),!this._deleted)){if(null===(r=this._popupRedirectResolver)||void 0===r?void 0:r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(NT){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(i=this.currentUser)||void 0===i?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await Kr(this,{idToken:e}),n=await si._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Qn(this.app)){const e=this.app.settings.authIdToken;return e?new Promise(t=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(e).then(t,t))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,s=null===r||void 0===r?void 0:r._redirectEventId,o=await this.tryRedirectSignIn(e);n&&n!==s||!(null===o||void 0===o?void 0:o.user)||(r=o.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(NT){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(NT))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Sr(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(NT){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await ti(e)}catch(NT){if("auth/network-request-failed"!==(null===NT||void 0===NT?void 0:NT.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Qn(this.app))return Promise.reject(wr(this));const t=e?Lt(e):null;return t&&Sr(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._deleted)return e&&Sr(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Qn(this.app)?Promise.reject(wr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Qn(this.app)?Promise.reject(wr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ai(e))})}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e){return Mr(e,"GET","/v2/passwordPolicy",Lr(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}(this),t=new Ti(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new vt("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return Mr(e,"POST","/v2/accounts:revokeToken",Lr(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&ai(e)||this._popupRedirectResolver;Sr(t,this,"argument-error"),this.redirectPersistenceManager=await di.create(this,[ai(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"===typeof t?t:t.next.bind(t);let s=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Sr(o,this,"internal-error"),o.then(()=>{s||i(this.currentUser)}),"function"===typeof t){const i=e.addObserver(t,n,r);return()=>{s=!0,i()}}{const n=e.addObserver(t);return()=>{s=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Sr(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Si(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;if(Qn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null===t||void 0===t?void 0:t.error)&&function(e){if(gr.logLevel<=$t.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];gr.warn(`Auth (${Jn}): ${e}`,...n)}}(`Error while retrieving App Check token: ${t.error}`),null===t||void 0===t?void 0:t.token}}function Ci(e){return Lt(e)}class Ni{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new Rt(e,t);return n.subscribe.bind(n)}(e=>this.observer=e)}get next(){return Sr(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Ii={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Pi(e){return Ii.loadJS(e)}function Ai(e){return`__${e}${Math.floor(1e6*Math.random())}`}class Ri{constructor(){this.enterprise=new Di}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class Di{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const Oi="NO_RECAPTCHA";class ji{constructor(e){this.type="recaptcha-enterprise",this.auth=Ci(e)}async verify(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(t,n,r){const i=window.grecaptcha;Br(i)?i.enterprise.ready(()=>{i.enterprise.execute(t,{action:e}).then(e=>{n(e)}).catch(()=>{n(Oi)})}):r(Error("No reCAPTCHA enterprise script loaded."))}if(this.auth.settings.appVerificationDisabledForTesting){return(new Ri).execute("siteKey",{action:"verify"})}return new Promise((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise(async(t,n)=>{Wr(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(r=>{if(void 0!==r.recaptchaKey){const n=new Hr(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))}).catch(e=>{n(e)})})})(this.auth).then(i=>{if(!t&&Br(window.grecaptcha))n(i,e,r);else{if("undefined"===typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));let t=Ii.recaptchaEnterpriseScript;0!==t.length&&(t+=i),Pi(t).then(()=>{n(i,e,r)}).catch(e=>{r(e)})}}).catch(e=>{r(e)})})}}async function Li(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const s=new ji(e);let o;if(i)o=Oi;else try{o=await s.verify(n)}catch(E_){o=await s.verify(n,!0)}const a=Object.assign({},t);if("mfaSmsEnrollment"===n||"mfaSmsSignIn"===n){if("phoneEnrollmentInfo"in a){const e=a.phoneEnrollmentInfo.phoneNumber,t=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:t,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const e=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:e,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function Mi(e,t,n,r,i){var s,o;if("EMAIL_PASSWORD_PROVIDER"===i){if(null===(s=e._getRecaptchaConfig())||void 0===s?void 0:s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await Li(e,t,n,"getOobCode"===n);return r(e,i)}return r(e,t).catch(async i=>{if("auth/missing-recaptcha-token"===i.code){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const i=await Li(e,t,n,"getOobCode"===n);return r(e,i)}return Promise.reject(i)})}if("PHONE_PROVIDER"===i){if(null===(o=e._getRecaptchaConfig())||void 0===o?void 0:o.isProviderEnabled("PHONE_PROVIDER")){const i=await Li(e,t,n);return r(e,i).catch(async i=>{var s;if("AUDIT"===(null===(s=e._getRecaptchaConfig())||void 0===s?void 0:s.getProviderEnforcementState("PHONE_PROVIDER"))&&("auth/missing-recaptcha-token"===i.code||"auth/invalid-app-credential"===i.code)){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${n} flow.`);const i=await Li(e,t,n,!1,!0);return r(e,i)}return Promise.reject(i)})}{const i=await Li(e,t,n,!1,!0);return r(e,i)}}return Promise.reject(i+" provider is not supported.")}async function Fi(e){const t=Ci(e),n=await Wr(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new Hr(n);if(null==t.tenantId?t._agentRecaptchaConfig=r:t._tenantRecaptchaConfigs[t.tenantId]=r,r.isAnyProviderEnabled()){new ji(t).verify()}}function Ui(e,t,n){const r=Ci(e);Sr(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const i=!!(null===n||void 0===n?void 0:n.disableWarnings),s=Vi(t),{host:o,port:a}=function(e){const t=Vi(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const e=i[1];return{host:e,port:zi(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:zi(t)}}}(t),l=null===a?"":`:${a}`,c={url:`${s}//${o}${l}/`},u=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator)return Sr(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),void Sr(Et(c,r.config.emulator)&&Et(u,r.emulatorConfig),r,"emulator-config-failed");r.config.emulator=c,r.emulatorConfig=u,r.settings.appVerificationDisabledForTesting=!0,nt(o)?(rt(`${s}//${o}${l}`),at("Auth",!0)):i||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function Vi(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function zi(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class $i{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return kr("not implemented")}_getIdTokenResponse(e){return kr("not implemented")}_linkToIdToken(e,t){return kr("not implemented")}_getReauthenticationResolver(e){return kr("not implemented")}}async function qi(e,t){return Mr(e,"POST","/v1/accounts:signUp",t)}async function Bi(e,t){return Ur(e,"POST","/v1/accounts:signInWithPassword",Lr(e,t))}async function Hi(e,t){return Mr(e,"POST","/v1/accounts:sendOobCode",Lr(e,t))}class Wi extends $i{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new Wi(e,t,"password")}static _fromEmailAndCode(e,t){return new Wi(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e;if((null===t||void 0===t?void 0:t.email)&&(null===t||void 0===t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return Mi(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",Bi,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return Ur(e,"POST","/v1/accounts:signInWithEmailLink",Lr(e,t))}(e,{email:this._email,oobCode:this._password});default:yr(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return Mi(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",qi,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return Ur(e,"POST","/v1/accounts:signInWithEmailLink",Lr(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:yr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Ki(e,t){return Ur(e,"POST","/v1/accounts:signInWithIdp",Lr(e,t))}class Gi extends $i{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Gi(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):yr("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,i=hr(t,["providerId","signInMethod"]);if(!n||!r)return null;const s=new Gi(n,r);return s.idToken=i.idToken||void 0,s.accessToken=i.accessToken||void 0,s.secret=i.secret,s.nonce=i.nonce,s.pendingToken=i.pendingToken||null,s}_getIdTokenResponse(e){return Ki(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Ki(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Ki(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Nt(t)}return e}}async function Qi(e,t){return Mr(e,"POST","/v1/accounts:sendVerificationCode",Lr(e,t))}const Yi={USER_NOT_FOUND:"user-not-found"};class Xi extends $i{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Xi({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Xi({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return Ur(e,"POST","/v1/accounts:signInWithPhoneNumber",Lr(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await Ur(e,"POST","/v1/accounts:signInWithPhoneNumber",Lr(e,t));if(n.temporaryProof)throw qr(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return Ur(e,"POST","/v1/accounts:signInWithPhoneNumber",Lr(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),Yi)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"===typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}=e;return n||t||r||i?new Xi({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}class Ji{constructor(e){var t,n,r,i,s,o;const a=It(Pt(e)),l=null!==(t=a.apiKey)&&void 0!==t?t:null,c=null!==(n=a.oobCode)&&void 0!==n?n:null,u=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=a.mode)&&void 0!==r?r:null);Sr(l&&c&&u,"argument-error"),this.apiKey=l,this.operation=u,this.code=c,this.continueUrl=null!==(i=a.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(s=a.lang)&&void 0!==s?s:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(e){const t=function(e){const t=It(Pt(e)).link,n=t?It(Pt(t)).deep_link_id:null,r=It(Pt(e)).deep_link_id;return(r?It(Pt(r)).link:null)||r||n||t||e}(e);try{return new Ji(t)}catch(n){return null}}}class Zi{constructor(){this.providerId=Zi.PROVIDER_ID}static credential(e,t){return Wi._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Ji.parseLink(t);return Sr(n,"argument-error"),Wi._fromEmailAndCode(e,n.code,n.tenantId)}}Zi.PROVIDER_ID="password",Zi.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Zi.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class es{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class ts extends es{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class ns extends ts{constructor(){super("facebook.com")}static credential(e){return Gi._fromParams({providerId:ns.PROVIDER_ID,signInMethod:ns.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ns.credentialFromTaggedObject(e)}static credentialFromError(e){return ns.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return ns.credential(t.oauthAccessToken)}catch(n){return null}}}ns.FACEBOOK_SIGN_IN_METHOD="facebook.com",ns.PROVIDER_ID="facebook.com";class rs extends ts{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Gi._fromParams({providerId:rs.PROVIDER_ID,signInMethod:rs.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return rs.credentialFromTaggedObject(e)}static credentialFromError(e){return rs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:n,oauthAccessToken:r}=t;if(!n&&!r)return null;try{return rs.credential(n,r)}catch(i){return null}}}rs.GOOGLE_SIGN_IN_METHOD="google.com",rs.PROVIDER_ID="google.com";class is extends ts{constructor(){super("github.com")}static credential(e){return Gi._fromParams({providerId:is.PROVIDER_ID,signInMethod:is.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return is.credentialFromTaggedObject(e)}static credentialFromError(e){return is.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return is.credential(t.oauthAccessToken)}catch(n){return null}}}is.GITHUB_SIGN_IN_METHOD="github.com",is.PROVIDER_ID="github.com";class ss extends ts{constructor(){super("twitter.com")}static credential(e,t){return Gi._fromParams({providerId:ss.PROVIDER_ID,signInMethod:ss.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return ss.credentialFromTaggedObject(e)}static credentialFromError(e){return ss.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=t;if(!n||!r)return null;try{return ss.credential(n,r)}catch(i){return null}}}async function os(e,t){return Ur(e,"POST","/v1/accounts:signUp",Lr(e,t))}ss.TWITTER_SIGN_IN_METHOD="twitter.com",ss.PROVIDER_ID="twitter.com";class as{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=await si._fromIdTokenResponse(e,n,r),s=ls(n);return new as({user:i,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=ls(n);return new as({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function ls(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class cs extends gt{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,cs.prototype),this.customData={appName:e.name,tenantId:null!==(i=e.tenantId)&&void 0!==i?i:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new cs(e,t,n,r)}}function us(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(n=>{if("auth/multi-factor-auth-required"===n.code)throw cs._fromErrorAndOperation(e,n,t,r);throw n})}async function ds(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=await Jr(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return as._forOperation(e,"link",r)}async function hs(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{auth:r}=e;if(Qn(r.app))return Promise.reject(wr(r));const i="reauthenticate";try{const s=await Jr(e,us(r,i,t,e),n);Sr(s.idToken,r,"internal-error");const o=Yr(s.idToken);Sr(o,r,"internal-error");const{sub:a}=o;return Sr(e.uid===a,r,"user-mismatch"),as._forOperation(e,i,s)}catch(NT){throw"auth/user-not-found"===(null===NT||void 0===NT?void 0:NT.code)&&yr(r,"user-mismatch"),NT}}async function fs(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Qn(e.app))return Promise.reject(wr(e));const r="signIn",i=await us(e,r,t),s=await as._fromIdTokenResponse(e,r,i);return n||await e._updateCurrentUser(s.user),s}async function ps(e,t){return fs(Ci(e),t)}function ms(e,t,n){var r;Sr((null===(r=n.url)||void 0===r?void 0:r.length)>0,e,"invalid-continue-uri"),Sr("undefined"===typeof n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),Sr("undefined"===typeof n.linkDomain||n.linkDomain.length>0,e,"invalid-hosting-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.linkDomain=n.linkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(Sr(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(Sr(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}async function gs(e){const t=Ci(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}async function vs(e,t){const n={identifier:t,continueUri:Cr()?Er():"http://localhost"},{signinMethods:r}=await async function(e,t){return Mr(e,"POST","/v1/accounts:createAuthUri",Lr(e,t))}(Lt(e),n);return r||[]}async function ys(e,t){const n=Lt(e),r={requestType:"VERIFY_EMAIL",idToken:await e.getIdToken()};t&&ms(n.auth,r,t);const{email:i}=await async function(e,t){return Hi(e,t)}(n.auth,r);i!==e.email&&await e.reload()}function bs(e,t){return Mr(e,"POST","/v2/accounts/mfaEnrollment:start",Lr(e,t))}new WeakMap;const _s="__sak";class ws{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(_s,"1"),this.storage.removeItem(_s),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class xs extends ws{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=xi(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.key)return void this.forAllChangedKeys((e,t,n)=>{this.notifyListeners(e,n)});const n=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},i=this.storage.getItem(n);wi()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}xs.type="LOCAL";const Ss=xs;function ks(e){var t,n;const r=e.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),i=RegExp(`${r}=([^;]+)`);return null!==(n=null===(t=document.cookie.match(i))||void 0===t?void 0:t[1])&&void 0!==n?n:null}function Ts(e){return`${"http:"===window.location.protocol?"__dev_":"__HOST-"}FIREBASE_${e.split(":")[3]}`}class Es{constructor(){this.type="COOKIE",this.listenerUnsubscribes=new Map}_getFinalTarget(e){if(void 0===typeof window)return e;const t=new URL(`${window.location.origin}/__cookies__`);return t.searchParams.set("finalTarget",e),t}async _isAvailable(){var e;return!("boolean"===typeof isSecureContext&&!isSecureContext)&&("undefined"!==typeof navigator&&"undefined"!==typeof document&&(null===(e=navigator.cookieEnabled)||void 0===e||e))}async _set(e,t){}async _get(e){if(!this._isAvailable())return null;const t=Ts(e);if(window.cookieStore){const e=await window.cookieStore.get(t);return null===e||void 0===e?void 0:e.value}return ks(t)}async _remove(e){if(!this._isAvailable())return;if(!await this._get(e))return;const t=Ts(e);document.cookie=`${t}=;Max-Age=34560000;Partitioned;Secure;SameSite=Strict;Path=/;Priority=High`,await fetch("/__cookies__",{method:"DELETE"}).catch(()=>{})}_addListener(e,t){if(!this._isAvailable())return;const n=Ts(e);if(window.cookieStore){const e=e=>{const r=e.changed.find(e=>e.name===n);r&&t(r.value);e.deleted.find(e=>e.name===n)&&t(null)},r=()=>window.cookieStore.removeEventListener("change",e);return this.listenerUnsubscribes.set(t,r),window.cookieStore.addEventListener("change",e)}let r=ks(n);const i=setInterval(()=>{const e=ks(n);e!==r&&(t(e),r=e)},1e3);this.listenerUnsubscribes.set(t,()=>clearInterval(i))}_removeListener(e,t){const n=this.listenerUnsubscribes.get(t);n&&(n(),this.listenerUnsubscribes.delete(t))}}Es.type="COOKIE";class Cs extends ws{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Cs.type="SESSION";const Ns=Cs;class Is{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(t=>t.isListeningto(e));if(t)return t;const n=new Is(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:i}=t.data,s=this.handlersMap[r];if(!(null===s||void 0===s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const o=Array.from(s).map(async e=>e(t.origin,i)),a=await function(e){return Promise.all(e.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Ps(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="";for(let r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}Is.receivers=[];class As{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const r="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,s;return new Promise((o,a)=>{const l=Ps("",20);r.port1.start();const c=setTimeout(()=>{a(new Error("unsupported_event"))},n);s={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(c),i=setTimeout(()=>{a(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),o(t.data.response);break;default:clearTimeout(c),clearTimeout(i),a(new Error("invalid_response"))}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[r.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}function Rs(){return window}function Ds(){return"undefined"!==typeof Rs().WorkerGlobalScope&&"function"===typeof Rs().importScripts}const Os="firebaseLocalStorageDb",js="firebaseLocalStorage",Ls="fbase_key";class Ms{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Fs(e,t){return e.transaction([js],t?"readwrite":"readonly").objectStore(js)}function Us(){const e=indexedDB.open(Os,1);return new Promise((t,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{const t=e.result;try{t.createObjectStore(js,{keyPath:Ls})}catch(NT){n(NT)}}),e.addEventListener("success",async()=>{const n=e.result;n.objectStoreNames.contains(js)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(Os);return new Ms(e).toPromise()}(),t(await Us()))})})}async function Vs(e,t,n){const r=Fs(e,!0).put({[Ls]:t,value:n});return new Ms(r).toPromise()}function zs(e,t){const n=Fs(e,!0).delete(t);return new Ms(n).toPromise()}class $s{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||(this.db=await Us()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(NT){if(t++>3)throw NT;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Ds()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Is._getInstance(Ds()?self:null),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new As(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Us();return await Vs(e,_s,"1"),await zs(e,_s),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>Vs(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(t=>async function(e,t){const n=Fs(e,!1).get(t),r=await new Ms(n).toPromise();return void 0===r?null:r.value}(t,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>zs(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(e=>{const t=Fs(e,!1).getAll();return new Ms(t).toPromise()});if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}$s.type="LOCAL";const qs=$s;function Bs(e,t){return Mr(e,"POST","/v2/accounts/mfaSignIn:start",Lr(e,t))}Ai("rcb"),new Pr(3e4,6e4);const Hs="recaptcha";async function Ws(e,t,n){var r;if(!e._getRecaptchaConfig())try{await Fi(e)}catch(E_){console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let i;if(i="string"===typeof t?{phoneNumber:t}:t,"session"in i){const t=i.session;if("phoneNumber"in i){Sr("enroll"===t.type,e,"internal-error");const r={idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"}},s=Mi(e,r,"mfaSmsEnrollment",async(e,t)=>{if(t.phoneEnrollmentInfo.captchaResponse===Oi){Sr((null===n||void 0===n?void 0:n.type)===Hs,e,"argument-error");return bs(e,await Ks(e,t,n))}return bs(e,t)},"PHONE_PROVIDER"),o=await s.catch(e=>Promise.reject(e));return o.phoneSessionInfo.sessionInfo}{Sr("signin"===t.type,e,"internal-error");const s=(null===(r=i.multiFactorHint)||void 0===r?void 0:r.uid)||i.multiFactorUid;Sr(s,e,"missing-multi-factor-info");const o={mfaPendingCredential:t.credential,mfaEnrollmentId:s,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}},a=Mi(e,o,"mfaSmsSignIn",async(e,t)=>{if(t.phoneSignInInfo.captchaResponse===Oi){Sr((null===n||void 0===n?void 0:n.type)===Hs,e,"argument-error");return Bs(e,await Ks(e,t,n))}return Bs(e,t)},"PHONE_PROVIDER"),l=await a.catch(e=>Promise.reject(e));return l.phoneResponseInfo.sessionInfo}}{const t={phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"},r=Mi(e,t,"sendVerificationCode",async(e,t)=>{if(t.captchaResponse===Oi){Sr((null===n||void 0===n?void 0:n.type)===Hs,e,"argument-error");return Qi(e,await Ks(e,t,n))}return Qi(e,t)},"PHONE_PROVIDER"),s=await r.catch(e=>Promise.reject(e));return s.sessionInfo}}finally{null===n||void 0===n||n._reset()}}async function Ks(e,t,n){Sr(n.type===Hs,e,"argument-error");const r=await n.verify();Sr("string"===typeof r,e,"argument-error");const i=Object.assign({},t);if("phoneEnrollmentInfo"in i){const e=i.phoneEnrollmentInfo.phoneNumber,t=i.phoneEnrollmentInfo.captchaResponse,n=i.phoneEnrollmentInfo.clientType,s=i.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(i,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:r,captchaResponse:t,clientType:n,recaptchaVersion:s}}),i}if("phoneSignInInfo"in i){const e=i.phoneSignInInfo.captchaResponse,t=i.phoneSignInInfo.clientType,n=i.phoneSignInInfo.recaptchaVersion;return Object.assign(i,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:e,clientType:t,recaptchaVersion:n}}),i}return Object.assign(i,{recaptchaToken:r}),i}class Gs{constructor(e){this.providerId=Gs.PROVIDER_ID,this.auth=Ci(e)}verifyPhoneNumber(e,t){return Ws(this.auth,e,Lt(t))}static credential(e,t){return Xi._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Gs.credentialFromTaggedObject(t)}static credentialFromError(e){return Gs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{phoneNumber:n,temporaryProof:r}=t;return n&&r?Xi._fromTokenResponse(n,r):null}}function Qs(e,t){return t?ai(t):(Sr(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}Gs.PROVIDER_ID="phone",Gs.PHONE_SIGN_IN_METHOD="phone";class Ys extends $i{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ki(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Ki(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Ki(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Xs(e){return fs(e.auth,new Ys(e),e.bypassAuthState)}function Js(e){const{auth:t,user:n}=e;return Sr(n,t,"internal-error"),hs(n,new Ys(e),e.bypassAuthState)}async function Zs(e){const{auth:t,user:n}=e;return Sr(n,t,"internal-error"),ds(n,new Ys(e),e.bypassAuthState)}class eo{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(NT){this.reject(NT)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:s,type:o}=e;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(NT){this.reject(NT)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Xs;case"linkViaPopup":case"linkViaRedirect":return Zs;case"reauthViaPopup":case"reauthViaRedirect":return Js;default:yr(this.auth,"internal-error")}}resolve(e){Tr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Tr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const to=new Pr(2e3,1e4);class no extends eo{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,no.currentPopupAction&&no.currentPopupAction.cancel(),no.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Sr(e,this.auth,"internal-error"),e}async onExecution(){Tr(1===this.filter.length,"Popup operations only handle one event");const e=Ps();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(br(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(br(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,no.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(br(this.auth,"popup-closed-by-user"))},8e3):this.pollId=window.setTimeout(e,to.get())};e()}}no.currentPopupAction=null;const ro=new Map;class io extends eo{constructor(e,t){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.eventId=null}async execute(){let e=ro.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=ao(t),r=oo(e);if(!await r._isAvailable())return!1;const i="true"===await r._get(n);return await r._remove(n),i}(this.resolver,this.auth),n=t?await super.execute():null;e=()=>Promise.resolve(n)}catch(NT){e=()=>Promise.reject(NT)}ro.set(this.auth._key(),e)}return this.bypassAuthState||ro.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function so(e,t){ro.set(e._key(),t)}function oo(e){return ai(e._redirectPersistence)}function ao(e){return ui("pendingRedirect",e.config.apiKey,e.name)}async function lo(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Qn(e.app))return Promise.reject(wr(e));const r=Ci(e),i=Qs(r,t),s=new io(r,i,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,t)),o}class co{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return ho(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!ho(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(br(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(uo(e))}saveEventToCache(e){this.cachedEventUids.add(uo(e)),this.lastProcessedEventTime=Date.now()}}function uo(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function ho(e){let{type:t,error:n}=e;return"unknown"===t&&"auth/no-auth-event"===(null===n||void 0===n?void 0:n.code)}const fo=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,po=/^https?/;async function mo(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e){return Mr(e,"GET","/v1/projects",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}(e);for(const r of t)try{if(go(r))return}catch(n){}yr(e,"unauthorized-domain")}function go(e){const t=Er(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!po.test(n))return!1;if(fo.test(e))return r===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const vo=new Pr(3e4,6e4);function yo(){const e=Rs().___jsl;if(null===e||void 0===e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function bo(e){return new Promise((t,n)=>{var r,i,s;function o(){yo(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{yo(),n(br(e,"network-request-failed"))},timeout:vo.get()})}if(null===(i=null===(r=Rs().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(s=Rs().gapi)||void 0===s?void 0:s.load)){const t=Ai("iframefcb");return Rs()[t]=()=>{gapi.load?o():n(br(e,"network-request-failed"))},Pi(`${Ii.gapiScript}?onload=${t}`).catch(e=>n(e))}o()}}).catch(e=>{throw _o=null,e})}let _o=null;const wo=new Pr(5e3,15e3),xo={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},So=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function ko(e){const t=e.config;Sr(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?Ar(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,r={apiKey:t.apiKey,appName:e.name,v:Jn},i=So.get(e.config.apiHost);i&&(r.eid=i);const s=e._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${Nt(r).slice(1)}`}async function To(e){const t=await function(e){return _o=_o||bo(e),_o}(e),n=Rs().gapi;return Sr(n,e,"internal-error"),t.open({where:document.body,url:ko(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:xo,dontclear:!0},t=>new Promise(async(n,r)=>{await t.restyle({setHideOnLeave:!1});const i=br(e,"network-request-failed"),s=Rs().setTimeout(()=>{r(i)},wo.get());function o(){Rs().clearTimeout(s),n(t)}t.ping(o).then(o,()=>{r(i)})}))}const Eo={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Co{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(NT){}}}function No(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},Eo),{width:r.toString(),height:i.toString(),top:s,left:o}),c=lt().toLowerCase();n&&(a=mi(c)?"_blank":n),fi(c)&&(t=t||"http://localhost",l.scrollbars="yes");const u=Object.entries(l).reduce((e,t)=>{let[n,r]=t;return`${e}${n}=${r},`},"");if(function(){var e;return _i(arguments.length>0&&void 0!==arguments[0]?arguments[0]:lt())&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(c)&&"_self"!==a)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",a),new Co(null);const d=window.open(t||"",a,u);Sr(d,e,"popup-blocked");try{d.focus()}catch(NT){}return new Co(d)}const Io="__/auth/handler",Po="emulator/auth/handler",Ao=encodeURIComponent("fac");async function Ro(e,t,n,r,i,s){Sr(e.config.authDomain,e,"auth-domain-config-required"),Sr(e.config.apiKey,e,"invalid-api-key");const o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:Jn,eventId:i};if(t instanceof es){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",kt(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(s||{}))o[e]=t}if(t instanceof ts){const e=t.getScopes().filter(e=>""!==e);e.length>0&&(o.scopes=e.join(","))}e.tenantId&&(o.tid=e.tenantId);const a=o;for(const u of Object.keys(a))void 0===a[u]&&delete a[u];const l=await e._getAppCheckToken(),c=l?`#${Ao}=${encodeURIComponent(l)}`:"";return`${function(e){let{config:t}=e;if(!t.emulator)return`https://${t.authDomain}/${Io}`;return Ar(t,Po)}(e)}?${Nt(a).slice(1)}${c}`}const Do="webStorageSupport";const Oo=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ns,this._completeRedirectFn=lo,this._overrideRedirectResult=so}async _openPopup(e,t,n,r){var i;Tr(null===(i=this.eventManagers[e._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()");return No(e,await Ro(e,t,n,Er(),r),Ps())}async _openRedirect(e,t,n,r){await this._originValidation(e);return function(e){Rs().location.href=e}(await Ro(e,t,n,Er(),r)),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(Tr(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await To(e),n=new co(e);return t.register("authEvent",t=>{Sr(null===t||void 0===t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Do,{type:Do},n=>{var r;const i=null===(r=null===n||void 0===n?void 0:n[0])||void 0===r?void 0:r[Do];void 0!==i&&t(!!i),yr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=mo(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return xi()||pi()||_i()}};var jo="@firebase/auth",Lo="1.10.8";class Mo{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(t=>{e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Sr(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const Fo=et("authIdTokenMaxAge")||300;let Uo=null;function Vo(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:er();const t=Gn(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=Gn(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(Et(n.getOptions(),null!==t&&void 0!==t?t:{}))return e;yr(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:Oo,persistence:[qs,Ss,Ns]}),r=et("authTokenSyncURL");if(r&&"boolean"===typeof isSecureContext&&isSecureContext){const e=new URL(r,location.origin);if(location.origin===e.origin){const t=(i=e.toString(),async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>Fo)return;const r=null===t||void 0===t?void 0:t.token;Uo!==r&&(Uo=r,await fetch(i,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))});!function(e,t,n){Lt(e).beforeAuthStateChanged(t,n)}(n,t,()=>t(n.currentUser)),function(e,t,n,r){Lt(e).onIdTokenChanged(t,n,r)}(n,e=>t(e))}}var i;const s=Xe("auth");return s&&Ui(n,`http://${s}`),n}var zo;!function(e){Ii=e}({loadJS:e=>new Promise((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=br("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="}),zo="Browser",Kn(new Mt("auth",(e,t)=>{let{options:n}=t;const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;Sr(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:zo,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Si(zo)},c=new Ei(r,i,s,l);return function(e,t){const n=(null===t||void 0===t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(ai);(null===t||void 0===t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null===t||void 0===t?void 0:t.popupRedirectResolver)}(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),Kn(new Mt("auth-internal",e=>(e=>new Mo(e))(Ci(e.getProvider("auth").getImmediate())),"PRIVATE").setInstantiationMode("EXPLICIT")),tr(jo,Lo,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(zo)),tr(jo,Lo,"esm2017");tr("firebase","11.10.0","app");var $o,qo,Bo="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},Ho={};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function n(e,t,n){n||(n=0);var r=Array(16);if("string"===typeof t)for(var i=0;16>i;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];var s=e.g[3],o=t+(s^n&(i^s))+r[0]+3614090360&4294967295;o=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=n+(o<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=t+(i^s&(n^i))+r[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=t+(n^i^s)+r[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=t+(i^(n|~s))+r[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=t+(i^(n|~s))+r[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=t+(i^(n|~s))+r[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(t=n+((o=t+(i^(n|~s))+r[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((i=s+((o=i+(t^(s|~n))+r[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+s&4294967295}function r(e,t){this.h=t;for(var n=[],r=!0,i=e.length-1;0<=i;i--){var s=0|e[i];r&&s==t||(n[i]=s,r=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.D=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.C=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}(t,function(){this.blockSize=-1}),t.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.u=function(e,t){void 0===t&&(t=e.length);for(var r=t-this.blockSize,i=this.B,s=this.h,o=0;o<t;){if(0==s)for(;o<=r;)n(this,e,o),o+=this.blockSize;if("string"===typeof e){for(;o<t;)if(i[s++]=e.charCodeAt(o++),s==this.blockSize){n(this,i),s=0;break}}else for(;o<t;)if(i[s++]=e[o++],s==this.blockSize){n(this,i),s=0;break}}this.h=s,this.o+=t},t.prototype.v=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.o;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.u(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var i={};function s(e){return-128<=e&&128>e?function(e,t){var n=i;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,function(e){return new r([0|e],0>e?-1:0)}):new r([0|e],0>e?-1:0)}function o(e){if(isNaN(e)||!isFinite(e))return a;if(0>e)return h(o(-e));for(var t=[],n=1,i=0;e>=n;i++)t[i]=e/n|0,n*=4294967296;return new r(t,0)}var a=s(0),l=s(1),c=s(16777216);function u(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function d(e){return-1==e.h}function h(e){for(var t=e.g.length,n=[],i=0;i<t;i++)n[i]=~e.g[i];return new r(n,~e.h).add(l)}function f(e,t){return e.add(h(t))}function p(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function m(e,t){this.g=e,this.h=t}function g(e,t){if(u(t))throw Error("division by zero");if(u(e))return new m(a,a);if(d(e))return t=g(h(e),t),new m(h(t.g),h(t.h));if(d(t))return t=g(e,h(t)),new m(h(t.g),t.h);if(30<e.g.length){if(d(e)||d(t))throw Error("slowDivide_ only works with positive integers.");for(var n=l,r=t;0>=r.l(e);)n=v(n),r=v(r);var i=y(n,1),s=y(r,1);for(r=y(r,2),n=y(n,2);!u(r);){var c=s.add(r);0>=c.l(e)&&(i=i.add(n),s=c),r=y(r,1),n=y(n,1)}return t=f(e,i.j(t)),new m(i,t)}for(i=a;0<=e.l(t);){for(n=Math.max(1,Math.floor(e.m()/t.m())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),c=(s=o(n)).j(t);d(c)||0<c.l(e);)c=(s=o(n-=r)).j(t);u(s)&&(s=l),i=i.add(s),e=f(e,c)}return new m(i,e)}function v(e){for(var t=e.g.length+1,n=[],i=0;i<t;i++)n[i]=e.i(i)<<1|e.i(i-1)>>>31;return new r(n,e.h)}function y(e,t){var n=t>>5;t%=32;for(var i=e.g.length-n,s=[],o=0;o<i;o++)s[o]=0<t?e.i(o+n)>>>t|e.i(o+n+1)<<32-t:e.i(o+n);return new r(s,e.h)}(e=r.prototype).m=function(){if(d(this))return-h(this).m();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.i(n);e+=(0<=r?r:4294967296+r)*t,t*=4294967296}return e},e.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(u(this))return"0";if(d(this))return"-"+h(this).toString(e);for(var t=o(Math.pow(e,6)),n=this,r="";;){var i=g(n,t).g,s=((0<(n=f(n,i.j(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(u(n=i))return s+r;for(;6>s.length;)s="0"+s;r=s+r}},e.i=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return d(e=f(this,e))?-1:u(e)?0:1},e.abs=function(){return d(this)?h(this):this},e.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0,s=0;s<=t;s++){var o=i+(65535&this.i(s))+(65535&e.i(s)),a=(o>>>16)+(this.i(s)>>>16)+(e.i(s)>>>16);i=a>>>16,o&=65535,a&=65535,n[s]=a<<16|o}return new r(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(u(this)||u(e))return a;if(d(this))return d(e)?h(this).j(h(e)):h(h(this).j(e));if(d(e))return h(this.j(h(e)));if(0>this.l(c)&&0>e.l(c))return o(this.m()*e.m());for(var t=this.g.length+e.g.length,n=[],i=0;i<2*t;i++)n[i]=0;for(i=0;i<this.g.length;i++)for(var s=0;s<e.g.length;s++){var l=this.i(i)>>>16,f=65535&this.i(i),m=e.i(s)>>>16,g=65535&e.i(s);n[2*i+2*s]+=f*g,p(n,2*i+2*s),n[2*i+2*s+1]+=l*g,p(n,2*i+2*s+1),n[2*i+2*s+1]+=f*m,p(n,2*i+2*s+1),n[2*i+2*s+2]+=l*m,p(n,2*i+2*s+2)}for(i=0;i<t;i++)n[i]=n[2*i+1]<<16|n[2*i];for(i=t;i<2*t;i++)n[i]=0;return new r(n,0)},e.A=function(e){return g(this,e).h},e.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.i(i)&e.i(i);return new r(n,this.h&e.h)},e.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.i(i)|e.i(i);return new r(n,this.h|e.h)},e.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.i(i)^e.i(i);return new r(n,this.h^e.h)},t.prototype.digest=t.prototype.v,t.prototype.reset=t.prototype.s,t.prototype.update=t.prototype.u,qo=Ho.Md5=t,r.prototype.add=r.prototype.add,r.prototype.multiply=r.prototype.j,r.prototype.modulo=r.prototype.A,r.prototype.compare=r.prototype.l,r.prototype.toNumber=r.prototype.m,r.prototype.toString=r.prototype.toString,r.prototype.getBits=r.prototype.i,r.fromNumber=o,r.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return h(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=o(Math.pow(n,8)),i=a,s=0;s<t.length;s+=8){var l=Math.min(8,t.length-s),c=parseInt(t.substring(s,s+l),n);8>l?(l=o(Math.pow(n,l)),i=i.j(l).add(o(c))):i=(i=i.j(r)).add(o(c))}return i},$o=Ho.Integer=r}).apply("undefined"!==typeof Bo?Bo:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});var Wo,Ko,Go,Qo,Yo,Xo,Jo,Zo,ea="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},ta={};(function(){var e,t="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};var n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof ea&&ea];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(e,r){if(r)e:{var i=n;e=e.split(".");for(var s=0;s<e.length-1;s++){var o=e[s];if(!(o in i))break e;i=i[o]}(r=r(s=i[e=e[e.length-1]]))!=s&&null!=r&&t(i,e,{configurable:!0,writable:!0,value:r})}}("Array.prototype.values",function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,r=!1,i={next:function(){if(!r&&n<e.length){var i=n++;return{value:t(i,e[i]),done:!1}}return r=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i}(this,function(e,t){return t})}});var r=r||{},i=this||self;function s(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function o(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function a(e,t,n){return e.call.apply(e.bind,arguments)}function l(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function c(e,t,n){return(c=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?a:l).apply(null,arguments)}function u(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function d(e,t){function n(){}n.prototype=t.prototype,e.aa=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Qb=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}function h(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function f(e,t){for(let n=1;n<arguments.length;n++){const t=arguments[n];if(s(t)){const n=e.length||0,r=t.length||0;e.length=n+r;for(let i=0;i<r;i++)e[n+i]=t[i]}else e.push(t)}}function p(e){return/^[\s\xa0]*$/.test(e)}function m(){var e=i.navigator;return e&&(e=e.userAgent)?e:""}function g(e){return g[" "](e),e}g[" "]=function(){};var v=-1!=m().indexOf("Gecko")&&!(-1!=m().toLowerCase().indexOf("webkit")&&-1==m().indexOf("Edge"))&&!(-1!=m().indexOf("Trident")||-1!=m().indexOf("MSIE"))&&-1==m().indexOf("Edge");function y(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function b(e){const t={};for(const n in e)t[n]=e[n];return t}const _="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function w(e,t){let n,r;for(let i=1;i<arguments.length;i++){for(n in r=arguments[i],r)e[n]=r[n];for(let t=0;t<_.length;t++)n=_[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function x(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function S(e){i.setTimeout(()=>{throw e},0)}function k(){var e=I;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var T=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new E,e=>e.reset());class E{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let C,N=!1,I=new class{constructor(){this.h=this.g=null}add(e,t){const n=T.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},P=()=>{const e=i.Promise.resolve(void 0);C=()=>{e.then(A)}};var A=()=>{for(var e;e=k();){try{e.h.call(e.g)}catch(OT){S(OT)}var t=T;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}N=!1};function R(){this.s=this.s,this.C=this.C}function D(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}R.prototype.s=!1,R.prototype.ma=function(){this.s||(this.s=!0,this.N())},R.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},D.prototype.h=function(){this.defaultPrevented=!0};var O=function(){if(!i.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};i.addEventListener("test",e,t),i.removeEventListener("test",e,t)}catch(OT){}return e}();function j(e,t){if(D.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(v){e:{try{g(t.nodeName);var i=!0;break e}catch(UT){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:L[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&j.aa.h.call(this)}}d(j,D);var L={2:"touch",3:"pen",4:"mouse"};j.prototype.h=function(){j.aa.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var M="closure_listenable_"+(1e6*Math.random()|0),F=0;function U(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=i,this.key=++F,this.da=this.fa=!1}function V(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function z(e){this.src=e,this.g={},this.h=0}function $(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],s=Array.prototype.indexOf.call(i,t,void 0);(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&(V(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function q(e,t,n,r){for(var i=0;i<e.length;++i){var s=e[i];if(!s.da&&s.listener==t&&s.capture==!!n&&s.ha==r)return i}return-1}z.prototype.add=function(e,t,n,r,i){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var o=q(e,t,r,i);return-1<o?(t=e[o],n||(t.fa=!1)):((t=new U(t,this.src,s,!!r,i)).fa=n,e.push(t)),t};var B="closure_lm_"+(1e6*Math.random()|0),H={};function W(e,t,n,r,i){if(r&&r.once)return G(e,t,n,r,i);if(Array.isArray(t)){for(var s=0;s<t.length;s++)W(e,t[s],n,r,i);return null}return n=te(n),e&&e[M]?e.K(t,n,o(r)?!!r.capture:!!r,i):K(e,t,n,!1,r,i)}function K(e,t,n,r,i,s){if(!t)throw Error("Invalid event type");var a=o(i)?!!i.capture:!!i,l=Z(e);if(l||(e[B]=l=new z(e)),(n=l.add(t,n,r,a,s)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=J;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)O||(i=a),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(X(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function G(e,t,n,r,i){if(Array.isArray(t)){for(var s=0;s<t.length;s++)G(e,t[s],n,r,i);return null}return n=te(n),e&&e[M]?e.L(t,n,o(r)?!!r.capture:!!r,i):K(e,t,n,!0,r,i)}function Q(e,t,n,r,i){if(Array.isArray(t))for(var s=0;s<t.length;s++)Q(e,t[s],n,r,i);else r=o(r)?!!r.capture:!!r,n=te(n),e&&e[M]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=q(s=e.g[t],n,r,i))&&(V(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete e.g[t],e.h--)))):e&&(e=Z(e))&&(t=e.g[t.toString()],e=-1,t&&(e=q(t,n,r,i)),(n=-1<e?t[e]:null)&&Y(n))}function Y(e){if("number"!==typeof e&&e&&!e.da){var t=e.src;if(t&&t[M])$(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(X(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Z(t))?($(n,e),0==n.h&&(n.src=null,t[B]=null)):V(e)}}}function X(e){return e in H?H[e]:H[e]="on"+e}function J(e,t){if(e.da)e=!0;else{t=new j(t,this);var n=e.listener,r=e.ha||e.src;e.fa&&Y(e),e=n.call(r,t)}return e}function Z(e){return(e=e[B])instanceof z?e:null}var ee="__closure_events_fn_"+(1e9*Math.random()>>>0);function te(e){return"function"===typeof e?e:(e[ee]||(e[ee]=function(t){return e.handleEvent(t)}),e[ee])}function ne(){R.call(this),this.i=new z(this),this.M=this,this.F=null}function re(e,t){var n,r=e.F;if(r)for(n=[];r;r=r.F)n.push(r);if(e=e.M,r=t.type||t,"string"===typeof t)t=new D(t,e);else if(t instanceof D)t.target=t.target||e;else{var i=t;w(t=new D(r,e),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=t.g=n[s];i=ie(o,r,!0,t)&&i}if(i=ie(o=t.g=e,r,!0,t)&&i,i=ie(o,r,!1,t)&&i,n)for(s=0;s<n.length;s++)i=ie(o=t.g=n[s],r,!1,t)&&i}function ie(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,s=0;s<t.length;++s){var o=t[s];if(o&&!o.da&&o.capture==n){var a=o.listener,l=o.ha||o.src;o.fa&&$(e.i,o),i=!1!==a.call(l,r)&&i}}return i&&!r.defaultPrevented}function se(e,t,n){if("function"===typeof e)n&&(e=c(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=c(e.handleEvent,e)}return 2147483647<Number(t)?-1:i.setTimeout(e,t||0)}function oe(e){e.g=se(()=>{e.g=null,e.i&&(e.i=!1,oe(e))},e.l);const t=e.h;e.h=null,e.m.apply(null,t)}d(ne,R),ne.prototype[M]=!0,ne.prototype.removeEventListener=function(e,t,n,r){Q(this,e,t,n,r)},ne.prototype.N=function(){if(ne.aa.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)V(n[r]);delete t.g[e],t.h--}}this.F=null},ne.prototype.K=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},ne.prototype.L=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};class ae extends R{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:oe(this)}N(){super.N(),this.g&&(i.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function le(e){R.call(this),this.h=e,this.g={}}d(le,R);var ce=[];function ue(e){y(e.g,function(e,t){this.g.hasOwnProperty(t)&&Y(e)},e),e.g={}}le.prototype.N=function(){le.aa.N.call(this),ue(this)},le.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var de=i.JSON.stringify,he=i.JSON.parse,fe=class{stringify(e){return i.JSON.stringify(e,void 0)}parse(e){return i.JSON.parse(e,void 0)}};function pe(){}function me(e){return e.h||(e.h=e.i())}function ge(){}pe.prototype.h=null;var ve={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ye(){D.call(this,"d")}function be(){D.call(this,"c")}d(ye,D),d(be,D);var _e={},we=null;function xe(){return we=we||new ne}function Se(e){D.call(this,_e.La,e)}function ke(e){const t=xe();re(t,new Se(t))}function Te(e,t){D.call(this,_e.STAT_EVENT,e),this.stat=t}function Ee(e){const t=xe();re(t,new Te(t,e))}function Ce(e,t){D.call(this,_e.Ma,e),this.size=t}function Ne(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return i.setTimeout(function(){e()},t)}function Ie(){this.g=!0}function Pe(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return de(n)}catch(a){return t}}(e,n)+(r?" "+r:"")})}_e.La="serverreachability",d(Se,D),_e.STAT_EVENT="statevent",d(Te,D),_e.Ma="timingevent",d(Ce,D),Ie.prototype.xa=function(){this.g=!1},Ie.prototype.info=function(){};var Ae,Re={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},De={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function Oe(){}function je(e,t,n,r){this.j=e,this.i=t,this.l=n,this.R=r||1,this.U=new le(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Le}function Le(){this.i=null,this.g="",this.h=!1}d(Oe,pe),Oe.prototype.g=function(){return new XMLHttpRequest},Oe.prototype.i=function(){return{}},Ae=new Oe;var Me={},Fe={};function Ue(e,t,n){e.L=1,e.v=dt(ot(t)),e.m=n,e.P=!0,Ve(e,null)}function Ve(e,t){e.F=Date.now(),qe(e),e.A=ot(e.v);var n=e.A,r=e.R;Array.isArray(r)||(r=[String(r)]),kt(n.i,"t",r),e.C=0,n=e.j.J,e.h=new Le,e.g=hn(e.j,n?t:null,!e.m),0<e.O&&(e.M=new ae(c(e.Y,e,e.g),e.O)),t=e.U,n=e.g,r=e.ca;var i="readystatechange";Array.isArray(i)||(i&&(ce[0]=i.toString()),i=ce);for(var s=0;s<i.length;s++){var o=W(n,i[s],r||t.handleEvent,!1,t.h||t);if(!o)break;t.g[o.key]=o}t=e.H?b(e.H):{},e.m?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.m,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),ke(),function(e,t,n,r,i,s){e.info(function(){if(e.g)if(s)for(var o="",a=s.split("&"),l=0;l<a.length;l++){var c=a[l].split("=");if(1<c.length){var u=c[0];c=c[1];var d=u.split("_");o=2<=d.length&&"type"==d[1]?o+(u+"=")+c+"&":o+(u+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o})}(e.i,e.u,e.A,e.l,e.R,e.m)}function ze(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.j.Ca)}function $e(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?Fe:(n=Number(t.substring(n,r)),isNaN(n)?Me:(r+=1)+n>t.length?Fe:(t=t.slice(r,r+n),e.C=r+n,t))}function qe(e){e.S=Date.now()+e.I,Be(e,e.I)}function Be(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Ne(c(e.ba,e),t)}function He(e){e.B&&(i.clearTimeout(e.B),e.B=null)}function We(e){0==e.j.G||e.J||an(e.j,e)}function Ke(e){He(e);var t=e.M;t&&"function"==typeof t.ma&&t.ma(),e.M=null,ue(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.ma())}function Ge(e,t){try{var n=e.j;if(0!=n.G&&(n.g==e||Ze(n.h,e)))if(!e.K&&Ze(n.h,e)&&3==n.G){try{var r=n.Da.g.parse(t)}catch(PT){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;on(n),Qt(n)}nn(n),Ee(18)}}else n.za=i[1],0<n.za-n.T&&37500>i[2]&&n.F&&0==n.v&&!n.C&&(n.C=Ne(c(n.Za,n),6e3));if(1>=Je(n.h)&&n.ca){try{n.ca()}catch(PT){}n.ca=void 0}}else cn(n,11)}else if((e.K||n.g==e)&&on(n),!p(t))for(i=n.Da.g.parse(t),t=0;t<i.length;t++){let c=i[t];if(n.T=c[0],c=c[1],2==n.G)if("c"==c[0]){n.K=c[1],n.ia=c[2];const t=c[3];null!=t&&(n.la=t,n.j.info("VER="+n.la));const i=c[4];null!=i&&(n.Aa=i,n.j.info("SVER="+n.Aa));const u=c[5];null!=u&&"number"===typeof u&&0<u&&(r=1.5*u,n.L=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const d=e.g;if(d){const e=d.g?d.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=r.h;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(et(s,s.h),s.h=null))}if(r.D){const e=d.g?d.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.ya=e,ut(r.I,r.D,e))}}n.G=3,n.l&&n.l.ua(),n.ba&&(n.R=Date.now()-e.F,n.j.info("Handshake RTT: "+n.R+"ms"));var o=e;if((r=n).qa=dn(r,r.J?r.ia:null,r.W),o.K){tt(r.h,o);var a=o,l=r.L;l&&(a.I=l),a.B&&(He(a),qe(a)),r.g=o}else tn(r);0<n.i.length&&Xt(n)}else"stop"!=c[0]&&"close"!=c[0]||cn(n,7);else 3==n.G&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?cn(n,7):Gt(n):"noop"!=c[0]&&n.l&&n.l.ta(c),n.v=0)}ke()}catch(PT){}}je.prototype.ca=function(e){e=e.target;const t=this.M;t&&3==Bt(e)?t.j():this.Y(e)},je.prototype.Y=function(e){try{if(e==this.g)e:{const h=Bt(this.g);var t=this.g.Ba();this.g.Z();if(!(3>h)&&(3!=h||this.g&&(this.h.h||this.g.oa()||Ht(this.g)))){this.J||4!=h||7==t||ke(),He(this);var n=this.g.Z();this.X=n;t:if(ze(this)){var r=Ht(this.g);e="";var s=r.length,o=4==Bt(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){Ke(this),We(this);var a="";break t}this.h.i=new i.TextDecoder}for(t=0;t<s;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:!(o&&t==s-1)});r.length=0,this.h.g+=e,this.C=0,a=this.h.g}else a=this.g.oa();if(this.o=200==n,function(e,t,n,r,i,s,o){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+s+" "+o})}(this.i,this.u,this.A,this.l,this.R,h,n),this.o){if(this.T&&!this.K){t:{if(this.g){var l,c=this.g;if((l=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!p(l)){var u=l;break t}}u=null}if(!(n=u)){this.o=!1,this.s=3,Ee(12),Ke(this),We(this);break e}Pe(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ge(this,n)}if(this.P){let e;for(n=!0;!this.J&&this.C<a.length;){if(e=$e(this,a),e==Fe){4==h&&(this.s=4,Ee(14),n=!1),Pe(this.i,this.l,null,"[Incomplete Response]");break}if(e==Me){this.s=4,Ee(15),Pe(this.i,this.l,a,"[Invalid Chunk]"),n=!1;break}Pe(this.i,this.l,e,null),Ge(this,e)}if(ze(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=h||0!=a.length||this.h.h||(this.s=1,Ee(16),n=!1),this.o=this.o&&n,n){if(0<a.length&&!this.W){this.W=!0;var d=this.j;d.g==this&&d.ba&&!d.M&&(d.j.info("Great, no buffering proxy detected. Bytes received: "+a.length),rn(d),d.M=!0,Ee(11))}}else Pe(this.i,this.l,a,"[Invalid Chunked Response]"),Ke(this),We(this)}else Pe(this.i,this.l,a,null),Ge(this,a);4==h&&Ke(this),this.o&&!this.J&&(4==h?an(this.j,this):(this.o=!1,qe(this)))}else(function(e){const t={};e=(e.g&&2<=Bt(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(p(e[r]))continue;var n=x(e[r]);const i=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const s=t[i]||[];t[i]=s,s.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,function(e){return e.join(", ")})})(this.g),400==n&&0<a.indexOf("Unknown SID")?(this.s=3,Ee(12)):(this.s=0,Ee(13)),Ke(this),We(this)}}}catch(h){}},je.prototype.cancel=function(){this.J=!0,Ke(this)},je.prototype.ba=function(){this.B=null;const e=Date.now();0<=e-this.S?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.i,this.A),2!=this.L&&(ke(),Ee(17)),Ke(this),this.s=2,We(this)):Be(this,this.S-e)};var Qe=class{constructor(e,t){this.g=e,this.map=t}};function Ye(e){this.l=e||10,i.PerformanceNavigationTiming?e=0<(e=i.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(i.chrome&&i.chrome.loadTimes&&i.chrome.loadTimes()&&i.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Xe(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Je(e){return e.h?1:e.g?e.g.size:0}function Ze(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function et(e,t){e.g?e.g.add(t):e.h=t}function tt(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function nt(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return h(e.i)}function rt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(s(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.na&&"function"==typeof e.na)return e.na();if(!e.V||"function"!=typeof e.V){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(s(e)||"string"===typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const r in e)t[n++]=r;return t}}}(e),r=function(e){if(e.V&&"function"==typeof e.V)return e.V();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(s(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length,o=0;o<i;o++)t.call(void 0,r[o],n&&n[o],e)}Ye.prototype.cancel=function(){if(this.i=nt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var it=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function st(e){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,e instanceof st){this.h=e.h,at(this,e.j),this.o=e.o,this.g=e.g,lt(this,e.s),this.l=e.l;var t=e.i,n=new _t;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),ct(this,n),this.m=e.m}else e&&(t=String(e).match(it))?(this.h=!1,at(this,t[1]||"",!0),this.o=ht(t[2]||""),this.g=ht(t[3]||"",!0),lt(this,t[4]),this.l=ht(t[5]||"",!0),ct(this,t[6]||"",!0),this.m=ht(t[7]||"")):(this.h=!1,this.i=new _t(null,this.h))}function ot(e){return new st(e)}function at(e,t,n){e.j=n?ht(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function lt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.s=t}else e.s=null}function ct(e,t,n){t instanceof _t?(e.i=t,function(e,t){t&&!e.j&&(wt(e),e.i=null,e.g.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(xt(this,t),kt(this,n,e))},e)),e.j=t}(e.i,e.h)):(n||(t=ft(t,yt)),e.i=new _t(t,e.h))}function ut(e,t,n){e.i.set(t,n)}function dt(e){return ut(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function ht(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function ft(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,pt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function pt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}st.prototype.toString=function(){var e=[],t=this.j;t&&e.push(ft(t,mt,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(ft(t,mt,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.s)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(ft(n,"/"==n.charAt(0)?vt:gt,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",ft(n,bt)),e.join("")};var mt=/[#\/\?@]/g,gt=/[#\?:]/g,vt=/[#\?]/g,yt=/[#\?@]/g,bt=/#/g;function _t(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function wt(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var s=e[n].substring(0,r);i=e[n].substring(r+1)}else s=e[n];t(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function xt(e,t){wt(e),t=Tt(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function St(e,t){return wt(e),t=Tt(e,t),e.g.has(t)}function kt(e,t,n){xt(e,t),0<n.length&&(e.i=null,e.g.set(Tt(e,t),h(n)),e.h+=n.length)}function Tt(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function Et(e,t,n,r,i){try{i&&(i.onload=null,i.onerror=null,i.onabort=null,i.ontimeout=null),r(n)}catch(UT){}}function Ct(){this.g=new fe}function Nt(e,t,n){const r=n||"";try{rt(e,function(e,n){let i=e;o(e)&&(i=de(e)),t.push(r+n+"="+encodeURIComponent(i))})}catch(NT){throw t.push(r+"type="+encodeURIComponent("_badmap")),NT}}function It(e){this.l=e.Ub||null,this.j=e.eb||!1}function Pt(e,t){ne.call(this),this.D=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function At(e){e.j.read().then(e.Pa.bind(e)).catch(e.ga.bind(e))}function Rt(e){e.readyState=4,e.l=null,e.j=null,e.v=null,Dt(e)}function Dt(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Ot(e){let t="";return y(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}function jt(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Ot(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):ut(e,t,n))}function Lt(e){ne.call(this),this.headers=new Map,this.o=e||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(e=_t.prototype).add=function(e,t){wt(this),this.i=null,e=Tt(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){wt(this),this.g.forEach(function(n,r){n.forEach(function(n){e.call(t,n,r,this)},this)},this)},e.na=function(){wt(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let r=0;r<t.length;r++){const i=e[r];for(let e=0;e<i.length;e++)n.push(t[r])}return n},e.V=function(e){wt(this);let t=[];if("string"===typeof e)St(this,e)&&(t=t.concat(this.g.get(Tt(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},e.set=function(e,t){return wt(this),this.i=null,St(this,e=Tt(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&0<(e=this.V(e)).length?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var r=t[n];const s=encodeURIComponent(String(r)),o=this.V(r);for(r=0;r<o.length;r++){var i=s;""!==o[r]&&(i+="="+encodeURIComponent(String(o[r]))),e.push(i)}}return this.i=e.join("&")},d(It,pe),It.prototype.g=function(){return new Pt(this.l,this.j)},It.prototype.i=function(e){return function(){return e}}({}),d(Pt,ne),(e=Pt.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=e,this.A=t,this.readyState=1,Dt(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.u,method:this.B,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||i).fetch(new Request(this.A,t)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Rt(this)),this.readyState=0},e.Sa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Dt(this)),this.g&&(this.readyState=3,Dt(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if("undefined"!==typeof i.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;At(this)}else e.text().then(this.Ra.bind(this),this.ga.bind(this))},e.Pa=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.v.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Rt(this):Dt(this),3==this.readyState&&At(this)}},e.Ra=function(e){this.g&&(this.response=this.responseText=e,Rt(this))},e.Qa=function(e){this.g&&(this.response=e,Rt(this))},e.ga=function(){this.g&&Rt(this)},e.setRequestHeader=function(e,t){this.u.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Pt.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),d(Lt,ne);var Mt=/^https?$/i,Ft=["POST","PUT"];function Ut(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.m=5,Vt(e),$t(e)}function Vt(e){e.A||(e.A=!0,re(e,"complete"),re(e,"error"))}function zt(e){if(e.h&&"undefined"!=typeof r&&(!e.v[1]||4!=Bt(e)||2!=e.Z()))if(e.u&&4==Bt(e))se(e.Ea,0,e);else if(re(e,"readystatechange"),4==Bt(e)){e.h=!1;try{const r=e.Z();e:switch(r){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var s;if(s=0===r){var o=String(e.D).match(it)[1]||null;!o&&i.self&&i.self.location&&(o=i.self.location.protocol.slice(0,-1)),s=!Mt.test(o?o.toLowerCase():"")}n=s}if(n)re(e,"complete"),re(e,"success");else{e.m=6;try{var a=2<Bt(e)?e.g.statusText:""}catch(l){a=""}e.l=a+" ["+e.Z()+"]",Vt(e)}}finally{$t(e)}}}function $t(e,t){if(e.g){qt(e);const n=e.g,r=e.v[0]?()=>{}:null;e.g=null,e.v=null,t||re(e,"ready");try{n.onreadystatechange=r}catch(NT){}}}function qt(e){e.I&&(i.clearTimeout(e.I),e.I=null)}function Bt(e){return e.g?e.g.readyState:0}function Ht(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.H){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function Wt(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Kt(e){this.Aa=0,this.i=[],this.j=new Ie,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Wt("failFast",!1,e),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Wt("baseRetryDelayMs",5e3,e),this.cb=Wt("retryDelaySeedMs",1e4,e),this.Wa=Wt("forwardChannelMaxRetries",2,e),this.wa=Wt("forwardChannelRequestTimeoutMs",2e4,e),this.pa=e&&e.xmlHttpFactory||void 0,this.Xa=e&&e.Tb||void 0,this.Ca=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.h=new Ye(e&&e.concurrentRequestLimit),this.Da=new Ct,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=e&&e.Rb||!1,e&&e.xa&&this.j.xa(),e&&e.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&e&&e.detectBufferingProxy||!1,this.ja=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ja=e.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function Gt(e){if(Yt(e),3==e.G){var t=e.U++,n=ot(e.I);if(ut(n,"SID",e.K),ut(n,"RID",t),ut(n,"TYPE","terminate"),Zt(e,n),(t=new je(e,e.j,t)).L=2,t.v=dt(ot(n)),n=!1,i.navigator&&i.navigator.sendBeacon)try{n=i.navigator.sendBeacon(t.v.toString(),"")}catch(FT){}!n&&i.Image&&((new Image).src=t.v,n=!0),n||(t.g=hn(t.j,null),t.g.ea(t.v)),t.F=Date.now(),qe(t)}un(e)}function Qt(e){e.g&&(rn(e),e.g.cancel(),e.g=null)}function Yt(e){Qt(e),e.u&&(i.clearTimeout(e.u),e.u=null),on(e),e.h.cancel(),e.s&&("number"===typeof e.s&&i.clearTimeout(e.s),e.s=null)}function Xt(e){if(!Xe(e.h)&&!e.s){e.s=!0;var t=e.Ga;C||P(),N||(C(),N=!0),I.add(t,e),e.B=0}}function Jt(e,t){var n;n=t?t.l:e.U++;const r=ot(e.I);ut(r,"SID",e.K),ut(r,"RID",n),ut(r,"AID",e.T),Zt(e,r),e.m&&e.o&&jt(r,e.m,e.o),n=new je(e,e.j,n,e.B+1),null===e.m&&(n.H=e.o),t&&(e.i=t.D.concat(e.i)),t=en(e,n,1e3),n.I=Math.round(.5*e.wa)+Math.round(.5*e.wa*Math.random()),et(e.h,n),Ue(n,r,t)}function Zt(e,t){e.H&&y(e.H,function(e,n){ut(t,n,e)}),e.l&&rt({},function(e,n){ut(t,n,e)})}function en(e,t,n){n=Math.min(e.i.length,n);var r=e.l?c(e.l.Na,e.l,e):null;e:{var i=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=i[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let o=!0;for(let a=0;a<n;a++){let n=i[a].g;const l=i[a].map;if(n-=t,0>n)t=Math.max(0,i[a].g-100),o=!1;else try{Nt(l,e,"req"+n+"_")}catch(s){r&&r(l)}}if(o){r=e.join("&");break e}}}return e=e.i.splice(0,n),t.D=e,r}function tn(e){if(!e.g&&!e.u){e.Y=1;var t=e.Fa;C||P(),N||(C(),N=!0),I.add(t,e),e.v=0}}function nn(e){return!(e.g||e.u||3<=e.v)&&(e.Y++,e.u=Ne(c(e.Fa,e),ln(e,e.v)),e.v++,!0)}function rn(e){null!=e.A&&(i.clearTimeout(e.A),e.A=null)}function sn(e){e.g=new je(e,e.j,"rpc",e.Y),null===e.m&&(e.g.H=e.o),e.g.O=0;var t=ot(e.qa);ut(t,"RID","rpc"),ut(t,"SID",e.K),ut(t,"AID",e.T),ut(t,"CI",e.F?"0":"1"),!e.F&&e.ja&&ut(t,"TO",e.ja),ut(t,"TYPE","xmlhttp"),Zt(e,t),e.m&&e.o&&jt(t,e.m,e.o),e.L&&(e.g.I=e.L);var n=e.g;e=e.ia,n.L=1,n.v=dt(ot(t)),n.m=null,n.P=!0,Ve(n,e)}function on(e){null!=e.C&&(i.clearTimeout(e.C),e.C=null)}function an(e,t){var n=null;if(e.g==t){on(e),rn(e),e.g=null;var r=2}else{if(!Ze(e.h,t))return;n=t.D,tt(e.h,t),r=1}if(0!=e.G)if(t.o)if(1==r){n=t.m?t.m.length:0,t=Date.now()-t.F;var i=e.B;re(r=xe(),new Ce(r,n)),Xt(e)}else tn(e);else if(3==(i=t.s)||0==i&&0<t.X||!(1==r&&function(e,t){return!(Je(e.h)>=e.h.j-(e.s?1:0))&&(e.s?(e.i=t.D.concat(e.i),!0):!(1==e.G||2==e.G||e.B>=(e.Va?0:e.Wa))&&(e.s=Ne(c(e.Ga,e,t),ln(e,e.B)),e.B++,!0))}(e,t)||2==r&&nn(e)))switch(n&&0<n.length&&(t=e.h,t.i=t.i.concat(n)),i){case 1:cn(e,5);break;case 4:cn(e,10);break;case 3:cn(e,6);break;default:cn(e,2)}}function ln(e,t){let n=e.Ta+Math.floor(Math.random()*e.cb);return e.isActive()||(n*=2),n*t}function cn(e,t){if(e.j.info("Error code "+t),2==t){var n=c(e.fb,e),r=e.Xa;const t=!r;r=new st(r||"//www.google.com/images/cleardot.gif"),i.location&&"http"==i.location.protocol||at(r,"https"),dt(r),t?function(e,t){const n=new Ie;if(i.Image){const r=new Image;r.onload=u(Et,n,"TestLoadImage: loaded",!0,t,r),r.onerror=u(Et,n,"TestLoadImage: error",!1,t,r),r.onabort=u(Et,n,"TestLoadImage: abort",!1,t,r),r.ontimeout=u(Et,n,"TestLoadImage: timeout",!1,t,r),i.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(r.toString(),n):function(e,t){new Ie;const n=new AbortController,r=setTimeout(()=>{n.abort(),Et(0,0,!1,t)},1e4);fetch(e,{signal:n.signal}).then(e=>{clearTimeout(r),e.ok?Et(0,0,!0,t):Et(0,0,!1,t)}).catch(()=>{clearTimeout(r),Et(0,0,!1,t)})}(r.toString(),n)}else Ee(2);e.G=0,e.l&&e.l.sa(t),un(e),Yt(e)}function un(e){if(e.G=0,e.ka=[],e.l){const t=nt(e.h);0==t.length&&0==e.i.length||(f(e.ka,t),f(e.ka,e.i),e.h.i.length=0,h(e.i),e.i.length=0),e.l.ra()}}function dn(e,t,n){var r=n instanceof st?ot(n):new st(n);if(""!=r.g)t&&(r.g=t+"."+r.g),lt(r,r.s);else{var s=i.location;r=s.protocol,t=t?t+"."+s.hostname:s.hostname,s=+s.port;var o=new st(null);r&&at(o,r),t&&(o.g=t),s&&lt(o,s),n&&(o.l=n),r=o}return n=e.D,t=e.ya,n&&t&&ut(r,n,t),ut(r,"VER",e.la),Zt(e,r),r}function hn(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ca&&!e.pa?new Lt(new It({eb:n})):new Lt(e.pa)).Ha(e.J),t}function fn(){}function pn(){}function mn(e,t){ne.call(this),this.g=new Kt(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.va&&(e?e["X-WebChannel-Client-Profile"]=t.va:e={"X-WebChannel-Client-Profile":t.va}),this.g.S=e,(e=t&&t.Sb)&&!p(e)&&(this.g.m=e),this.v=t&&t.supportsCrossDomainXhr||!1,this.u=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!p(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new yn(this)}function gn(e){ye.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function vn(){be.call(this),this.status=1}function yn(e){this.g=e}(e=Lt.prototype).Ha=function(e){this.J=e},e.ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ae.g(),this.v=this.o?me(this.o):me(Ae),this.g.onreadystatechange=c(this.Ea,this);try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(UT){return void Ut(this,UT)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var s in r)n.set(s,r[s]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find(e=>"content-type"==e.toLowerCase()),s=i.FormData&&e instanceof i.FormData,!(0<=Array.prototype.indexOf.call(Ft,t,void 0))||r||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,o]of n)this.g.setRequestHeader(i,o);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{qt(this),this.u=!0,this.g.send(e),this.u=!1}catch(UT){Ut(this,UT)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=e||7,re(this,"complete"),re(this,"abort"),$t(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),$t(this,!0)),Lt.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?zt(this):this.bb())},e.bb=function(){zt(this)},e.isActive=function(){return!!this.g},e.Z=function(){try{return 2<Bt(this)?this.g.status:-1}catch(AT){return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch(AT){return""}},e.Oa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),he(t)}},e.Ba=function(){return this.m},e.Ka=function(){return"string"===typeof this.l?this.l:String(this.l)},(e=Kt.prototype).la=8,e.G=1,e.connect=function(e,t,n,r){Ee(0),this.W=e,this.H=t||{},n&&void 0!==r&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.I=dn(this,null,this.W),Xt(this)},e.Ga=function(e){if(this.s)if(this.s=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;const i=new je(this,this.j,e);let s=this.o;if(this.S&&(s?(s=b(s),w(s,this.S)):s=this.S),null!==this.m||this.O||(i.H=s,s=null),this.P)e:{for(var t=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.map&&"string"===typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=en(this,i,t),ut(n=ot(this.I),"RID",e),ut(n,"CVER",22),this.D&&ut(n,"X-HTTP-Session-Id",this.D),Zt(this,n),s&&(this.O?t="headers="+encodeURIComponent(String(Ot(s)))+"&"+t:this.m&&jt(n,this.m,s)),et(this.h,i),this.Ua&&ut(n,"TYPE","init"),this.P?(ut(n,"$req",t),ut(n,"SID","null"),i.T=!0,Ue(i,n,null)):Ue(i,n,t),this.G=2}}else 3==this.G&&(e?Jt(this,e):0==this.i.length||Xe(this.h)||Jt(this))},e.Fa=function(){if(this.u=null,sn(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var e=2*this.R;this.j.info("BP detection timer enabled: "+e),this.A=Ne(c(this.ab,this),e)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ee(10),Qt(this),sn(this))},e.Za=function(){null!=this.C&&(this.C=null,Qt(this),nn(this),Ee(19))},e.fb=function(e){e?(this.j.info("Successfully pinged google.com"),Ee(2)):(this.j.info("Failed to ping google.com"),Ee(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=fn.prototype).ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){},pn.prototype.g=function(e,t){return new mn(e,t)},d(mn,ne),mn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},mn.prototype.close=function(){Gt(this.g)},mn.prototype.o=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.u&&((n={}).__data__=de(e),e=n);t.i.push(new Qe(t.Ya++,e)),3==t.G&&Xt(t)},mn.prototype.N=function(){this.g.l=null,delete this.j,Gt(this.g),delete this.g,mn.aa.N.call(this)},d(gn,ye),d(vn,be),d(yn,fn),yn.prototype.ua=function(){re(this.g,"a")},yn.prototype.ta=function(e){re(this.g,new gn(e))},yn.prototype.sa=function(e){re(this.g,new vn)},yn.prototype.ra=function(){re(this.g,"b")},pn.prototype.createWebChannel=pn.prototype.g,mn.prototype.send=mn.prototype.o,mn.prototype.open=mn.prototype.m,mn.prototype.close=mn.prototype.close,Zo=ta.createWebChannelTransport=function(){return new pn},Jo=ta.getStatEventTarget=function(){return xe()},Xo=ta.Event=_e,Yo=ta.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Re.NO_ERROR=0,Re.TIMEOUT=8,Re.HTTP_ERROR=6,Qo=ta.ErrorCode=Re,De.COMPLETE="complete",Go=ta.EventType=De,ge.EventType=ve,ve.OPEN="a",ve.CLOSE="b",ve.ERROR="c",ve.MESSAGE="d",ne.prototype.listen=ne.prototype.K,Ko=ta.WebChannel=ge,ta.FetchXmlHttpFactory=It,Lt.prototype.listenOnce=Lt.prototype.L,Lt.prototype.getLastError=Lt.prototype.Ka,Lt.prototype.getLastErrorCode=Lt.prototype.Ba,Lt.prototype.getStatus=Lt.prototype.Z,Lt.prototype.getResponseJson=Lt.prototype.Oa,Lt.prototype.getResponseText=Lt.prototype.oa,Lt.prototype.send=Lt.prototype.ea,Lt.prototype.setWithCredentials=Lt.prototype.Ha,Wo=ta.XhrIo=Lt}).apply("undefined"!==typeof ea?ea:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});const na="@firebase/firestore",ra="4.8.0";class ia{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ia.UNAUTHENTICATED=new ia(null),ia.GOOGLE_CREDENTIALS=new ia("google-credentials-uid"),ia.FIRST_PARTY=new ia("first-party-uid"),ia.MOCK_USER=new ia("mock-user");let sa="11.10.0";const oa=new Kt("@firebase/firestore");function aa(){return oa.logLevel}function la(e){if(oa.logLevel<=$t.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(da);oa.debug(`Firestore (${sa}): ${e}`,...i)}}function ca(e){if(oa.logLevel<=$t.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(da);oa.error(`Firestore (${sa}): ${e}`,...i)}}function ua(e){if(oa.logLevel<=$t.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(da);oa.warn(`Firestore (${sa}): ${e}`,...i)}}function da(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(IT){return e}}function ha(e,t,n){let r="Unexpected state";"string"==typeof t?r=t:n=t,fa(e,r,n)}function fa(e,t,n){let r=`FIRESTORE (${sa}) INTERNAL ASSERTION FAILED: ${t} (ID: ${e.toString(16)})`;if(void 0!==n)try{r+=" CONTEXT: "+JSON.stringify(n)}catch(e){r+=" CONTEXT: "+n}throw ca(r),new Error(r)}function pa(e,t,n,r){let i="Unexpected state";"string"==typeof n?i=n:r=n,e||fa(t,i,r)}function ma(e,t){return e}const ga={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class va extends gt{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class ya{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class ba{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class _a{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(ia.UNAUTHENTICATED))}shutdown(){}}class wa{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class xa{constructor(e){this.t=e,this.currentUser=ia.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){pa(void 0===this.o,42304);let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let i=new ya;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new ya,e.enqueueRetryable(()=>r(this.currentUser))};const s=()=>{const t=i;e.enqueueRetryable(async()=>{await t.promise,await r(this.currentUser)})},o=e=>{la("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(e=>o(e)),setTimeout(()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):(la("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new ya)}},0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(la("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(pa("string"==typeof t.accessToken,31837,{l:t}),new ba(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return pa(null===e||"string"==typeof e,2055,{h:e}),new ia(e)}}class Sa{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=ia.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class ka{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new Sa(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(ia.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Ta{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Ea{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Qn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){pa(void 0===this.o,3512);const n=e=>{null!=e.error&&la("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.m;return this.m=e.token,la("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>n(t))};const r=e=>{la("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(e=>r(e)),setTimeout(()=>{if(!this.appCheck){const e=this.V.getImmediate({optional:!0});e?r(e):la("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Ta(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(pa("string"==typeof e.token,44558,{tokenResult:e}),this.m=e.token,new Ta(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function Ca(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}function Na(){return new TextEncoder}class Ia{static newId(){const e=62*Math.floor(256/62);let t="";for(;t.length<20;){const n=Ca(40);for(let r=0;r<n.length;++r)t.length<20&&n[r]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[r]%62))}return t}}function Pa(e,t){return e<t?-1:e>t?1:0}function Aa(e,t){let n=0;for(;n<e.length&&n<t.length;){const r=e.codePointAt(n),i=t.codePointAt(n);if(r!==i){if(r<128&&i<128)return Pa(r,i);{const s=Na(),o=Da(s.encode(Ra(e,n)),s.encode(Ra(t,n)));return 0!==o?o:Pa(r,i)}}n+=r>65535?2:1}return Pa(e.length,t.length)}function Ra(e,t){return e.codePointAt(t)>65535?e.substring(t,t+2):e.substring(t,t+1)}function Da(e,t){for(let n=0;n<e.length&&n<t.length;++n)if(e[n]!==t[n])return Pa(e[n],t[n]);return Pa(e.length,t.length)}function Oa(e,t,n){return e.length===t.length&&e.every((e,r)=>n(e,t[r]))}function ja(e){return e+"\0"}const La="__name__";class Ma{constructor(e,t,n){void 0===t?t=0:t>e.length&&ha(637,{offset:t,range:e.length}),void 0===n?n=e.length-t:n>e.length-t&&ha(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===Ma.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ma?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=Ma.compareSegments(e.get(r),t.get(r));if(0!==n)return n}return Pa(e.length,t.length)}static compareSegments(e,t){const n=Ma.isNumericId(e),r=Ma.isNumericId(t);return n&&!r?-1:!n&&r?1:n&&r?Ma.extractNumericId(e).compare(Ma.extractNumericId(t)):Aa(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return $o.fromString(e.substring(4,e.length-2))}}class Fa extends Ma{construct(e,t,n){return new Fa(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n){if(i.indexOf("//")>=0)throw new va(ga.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);e.push(...i.split("/").filter(e=>e.length>0))}return new Fa(e)}static emptyPath(){return new Fa([])}}const Ua=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Va extends Ma{construct(e,t,n){return new Va(e,t,n)}static isValidIdentifier(e){return Ua.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Va.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===La}static keyField(){return new Va([La])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new va(ga.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let s=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new va(ga.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new va(ga.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(s=!s,r++):"."!==t||s?(n+=t,r++):(i(),r++)}if(i(),s)throw new va(ga.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Va(t)}static emptyPath(){return new Va([])}}class za{constructor(e){this.path=e}static fromPath(e){return new za(Fa.fromString(e))}static fromName(e){return new za(Fa.fromString(e).popFirst(5))}static empty(){return new za(Fa.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Fa.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Fa.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new za(new Fa(e.slice()))}}function $a(e,t,n){if(!n)throw new va(ga.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function qa(e){if(!za.isDocumentKey(e))throw new va(ga.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function Ba(e){if(za.isDocumentKey(e))throw new va(ga.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function Ha(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}function Wa(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":ha(12329,{type:typeof e})}function Ka(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new va(ga.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Wa(e);throw new va(ga.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function Ga(e,t){if(t<=0)throw new va(ga.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}function Qa(e,t){const n={typeString:e};return t&&(n.value=t),n}function Ya(e,t){if(!Ha(e))throw new va(ga.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in t)if(t[r]){const i=t[r].typeString,s="value"in t[r]?{value:t[r].value}:void 0;if(!(r in e)){n=`JSON missing required field: '${r}'`;break}const o=e[r];if(i&&typeof o!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(void 0!==s&&o!==s.value){n=`Expected '${r}' field to equal '${s.value}'`;break}}if(n)throw new va(ga.INVALID_ARGUMENT,n);return!0}const Xa=-62135596800,Ja=1e6;class Za{static now(){return Za.fromMillis(Date.now())}static fromDate(e){return Za.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*Ja);return new Za(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new va(ga.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new va(ga.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Xa)throw new va(ga.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new va(ga.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Ja}_compareTo(e){return this.seconds===e.seconds?Pa(this.nanoseconds,e.nanoseconds):Pa(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Za._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Ya(e,Za._jsonSchema))return new Za(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Xa;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Za._jsonSchemaVersion="firestore/timestamp/1.0",Za._jsonSchema={type:Qa("string",Za._jsonSchemaVersion),seconds:Qa("number"),nanoseconds:Qa("number")};class el{static fromTimestamp(e){return new el(e)}static min(){return new el(new Za(0,0))}static max(){return new el(new Za(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const tl=-1;class nl{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}function rl(e){return e.fields.find(e=>2===e.kind)}function il(e){return e.fields.filter(e=>2!==e.kind)}nl.UNKNOWN_ID=-1;class sl{constructor(e,t){this.fieldPath=e,this.kind=t}}class ol{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new ol(0,cl.min())}}function al(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=el.fromTimestamp(1e9===r?new Za(n+1,0):new Za(n,r));return new cl(i,za.empty(),t)}function ll(e){return new cl(e.readTime,e.key,tl)}class cl{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new cl(el.min(),za.empty(),tl)}static max(){return new cl(el.max(),za.empty(),tl)}}function ul(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=za.comparator(e.documentKey,t.documentKey),0!==n?n:Pa(e.largestBatchId,t.largestBatchId))}const dl="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class hl{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function fl(e){if(e.code!==ga.FAILED_PRECONDITION||e.message!==dl)throw e;la("LocalStore","Unexpectedly lost primary lease")}class pl{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ha(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new pl((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof pl?t:pl.resolve(t)}catch(e){return pl.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):pl.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):pl.reject(t)}static resolve(e){return new pl((t,n)=>{t(e)})}static reject(e){return new pl((t,n)=>{n(e)})}static waitFor(e){return new pl((t,n)=>{let r=0,i=0,s=!1;e.forEach(e=>{++r,e.next(()=>{++i,s&&i===r&&t()},e=>n(e))}),s=!0,i===r&&t()})}static or(e){let t=pl.resolve(!1);for(const n of e)t=t.next(e=>e?pl.resolve(e):n());return t}static forEach(e,t){const n=[];return e.forEach((e,r)=>{n.push(t.call(this,e,r))}),this.waitFor(n)}static mapArray(e,t){return new pl((n,r)=>{const i=e.length,s=new Array(i);let o=0;for(let a=0;a<i;a++){const l=a;t(e[l]).next(e=>{s[l]=e,++o,o===i&&n(s)},e=>r(e))}})}static doWhile(e,t){return new pl((n,r)=>{const i=()=>{!0===e()?t().next(()=>{i()},r):n()};i()})}}const ml="SimpleDb";class gl{static open(e,t,n,r){try{return new gl(t,e.transaction(r,n))}catch(e){throw new _l(t,e)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new ya,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new _l(e,t.error)):this.S.resolve()},this.transaction.onerror=t=>{const n=Tl(t.target.error);this.S.reject(new _l(e,n))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(la(ml,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}v(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new xl(t)}}class vl{static delete(e){return la(ml,"Removing database:",e),Sl(Qe().indexedDB.deleteDatabase(e)).toPromise()}static C(){if(!mt())return!1;if(vl.F())return!0;const e=lt(),t=vl.M(e),n=0<t&&t<10,r=yl(e),i=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||i)}static F(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.__PRIVATE_env)||void 0===e?void 0:e.O)}static N(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}constructor(e,t,n){this.name=e,this.version=t,this.B=n,this.L=null,12.2===vl.M(lt())&&ca("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async k(e){return this.db||(la(ml,"Opening database:",this.name),this.db=await new Promise((t,n)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=e=>{const n=e.target.result;t(n)},r.onblocked=()=>{n(new _l(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=t=>{const r=t.target.error;"VersionError"===r.name?n(new va(ga.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===r.name?n(new va(ga.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+r)):n(new _l(e,r))},r.onupgradeneeded=e=>{la(ml,'Database "'+this.name+'" requires upgrade from version:',e.oldVersion);const t=e.target.result;if(null!==this.L&&this.L!==e.oldVersion)throw new Error(`refusing to open IndexedDB database due to potential corruption of the IndexedDB database data; this corruption could be caused by clicking the "clear site data" button in a web browser; try reloading the web page to re-initialize the IndexedDB database: lastClosedDbVersion=${this.L}, event.oldVersion=${e.oldVersion}, event.newVersion=${e.newVersion}, db.version=${t.version}`);this.B.q(t,r.transaction,e.oldVersion,this.version).next(()=>{la(ml,"Database upgrade to version "+this.version+" complete")})}}),this.db.addEventListener("close",e=>{const t=e.target;this.L=t.version},{passive:!0})),this.db.addEventListener("versionchange",e=>{var t;null===e.newVersion&&(ua('Received "versionchange" event with newVersion===null; notifying the registered DatabaseDeletedListener, if any'),null===(t=this.databaseDeletedListener)||void 0===t||t.call(this))},{passive:!0}),this.db}setDatabaseDeletedListener(e){if(this.databaseDeletedListener)throw new Error("setDatabaseDeletedListener() may only be called once, and it has already been called");this.databaseDeletedListener=e}async runTransaction(e,t,n,r){const i="readonly"===t;let s=0;for(;;){++s;try{this.db=await this.k(e);const t=gl.open(this.db,e,i?"readonly":"readwrite",n),s=r(t).next(e=>(t.v(),e)).catch(e=>(t.abort(e),pl.reject(e))).toPromise();return s.catch(()=>{}),await t.D,s}catch(e){const t=e,n="FirebaseError"!==t.name&&s<3;if(la(ml,"Transaction failed with error:",t.message,"Retrying:",n),this.close(),!n)return Promise.reject(t)}}}close(){this.db&&this.db.close(),this.db=void 0}}function yl(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class bl{constructor(e){this.$=e,this.U=!1,this.K=null}get isDone(){return this.U}get W(){return this.K}set cursor(e){this.$=e}done(){this.U=!0}G(e){this.K=e}delete(){return Sl(this.$.delete())}}class _l extends va{constructor(e,t){super(ga.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function wl(e){return"IndexedDbTransactionError"===e.name}class xl{constructor(e){this.store=e}put(e,t){let n;return void 0!==t?(la(ml,"PUT",this.store.name,e,t),n=this.store.put(t,e)):(la(ml,"PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),Sl(n)}add(e){return la(ml,"ADD",this.store.name,e,e),Sl(this.store.add(e))}get(e){return Sl(this.store.get(e)).next(t=>(void 0===t&&(t=null),la(ml,"GET",this.store.name,e,t),t))}delete(e){return la(ml,"DELETE",this.store.name,e),Sl(this.store.delete(e))}count(){return la(ml,"COUNT",this.store.name),Sl(this.store.count())}j(e,t){const n=this.options(e,t),r=n.index?this.store.index(n.index):this.store;if("function"==typeof r.getAll){const e=r.getAll(n.range);return new pl((t,n)=>{e.onerror=e=>{n(e.target.error)},e.onsuccess=e=>{t(e.target.result)}})}{const e=this.cursor(n),t=[];return this.J(e,(e,n)=>{t.push(n)}).next(()=>t)}}H(e,t){const n=this.store.getAll(e,null===t?void 0:t);return new pl((e,t)=>{n.onerror=e=>{t(e.target.error)},n.onsuccess=t=>{e(t.target.result)}})}Y(e,t){la(ml,"DELETE ALL",this.store.name);const n=this.options(e,t);n.Z=!1;const r=this.cursor(n);return this.J(r,(e,t,n)=>n.delete())}X(e,t){let n;t?n=e:(n={},t=e);const r=this.cursor(n);return this.J(r,t)}ee(e){const t=this.cursor({});return new pl((n,r)=>{t.onerror=e=>{const t=Tl(e.target.error);r(t)},t.onsuccess=t=>{const r=t.target.result;r?e(r.primaryKey,r.value).next(e=>{e?r.continue():n()}):n()}})}J(e,t){const n=[];return new pl((r,i)=>{e.onerror=e=>{i(e.target.error)},e.onsuccess=e=>{const i=e.target.result;if(!i)return void r();const s=new bl(i),o=t(i.primaryKey,i.value,s);if(o instanceof pl){const e=o.catch(e=>(s.done(),pl.reject(e)));n.push(e)}s.isDone?r():null===s.W?i.continue():i.continue(s.W)}}).next(()=>pl.waitFor(n))}options(e,t){let n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.Z?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Sl(e){return new pl((t,n)=>{e.onsuccess=e=>{const n=e.target.result;t(n)},e.onerror=e=>{const t=Tl(e.target.error);n(t)}})}let kl=!1;function Tl(e){const t=vl.M(lt());if(t>=12.2&&t<13){const t="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(t)>=0){const e=new va("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return kl||(kl=!0,setTimeout(()=>{throw e},0)),e}}return e}const El="IndexBackfiller";class Cl{constructor(e,t){this.asyncQueue=e,this.te=t,this.task=null}start(){this.ne(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}ne(e){la(El,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const e=await this.te.re();la(El,`Documents written: ${e}`)}catch(e){wl(e)?la(El,"Ignoring IndexedDB error during index backfill: ",e):await fl(e)}await this.ne(6e4)})}}class Nl{constructor(e,t){this.localStore=e,this.persistence=t}async re(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.ie(t,e))}ie(e,t){const n=new Set;let r=t,i=!0;return pl.doWhile(()=>!0===i&&r>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(t=>{if(null!==t&&!n.has(t))return la(El,`Processing collection: ${t}`),this.se(e,t,r).next(e=>{r-=e,n.add(t)});i=!1})).next(()=>t-r)}se(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(r=>this.localStore.localDocuments.getNextDocuments(e,t,r,n).next(n=>{const i=n.changes;return this.localStore.indexManager.updateIndexEntries(e,i).next(()=>this.oe(r,n)).next(n=>(la(El,`Updating offset: ${n}`),this.localStore.indexManager.updateCollectionGroup(e,t,n))).next(()=>i.size)}))}oe(e,t){let n=e;return t.changes.forEach((e,t)=>{const r=ll(t);ul(r,n)>0&&(n=r)}),new cl(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}class Il{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this._e(e),this.ae=e=>t.writeSequenceNumber(e))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}Il.ue=-1;const Pl=-1;function Al(e){return null==e}function Rl(e){return 0===e&&1/e==-1/0}function Dl(e){return"number"==typeof e&&Number.isInteger(e)&&!Rl(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}const Ol="\x01";function jl(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=Ml(t)),t=Ll(e.get(n),t);return Ml(t)}function Ll(e,t){let n=t;const r=e.length;for(let i=0;i<r;i++){const t=e.charAt(i);switch(t){case"\0":n+="\x01\x10";break;case Ol:n+="\x01\x11";break;default:n+=t}}return n}function Ml(e){return e+Ol+"\x01"}function Fl(e){const t=e.length;if(pa(t>=2,64408,{path:e}),2===t)return pa(e.charAt(0)===Ol&&"\x01"===e.charAt(1),56145,{path:e}),Fa.emptyPath();const n=t-2,r=[];let i="";for(let s=0;s<t;){const t=e.indexOf(Ol,s);switch((t<0||t>n)&&ha(50515,{path:e}),e.charAt(t+1)){case"\x01":const n=e.substring(s,t);let o;0===i.length?o=n:(i+=n,o=i,i=""),r.push(o);break;case"\x10":i+=e.substring(s,t),i+="\0";break;case"\x11":i+=e.substring(s,t+1);break;default:ha(61167,{path:e})}s=t+2}return new Fa(r)}const Ul="remoteDocuments",Vl="owner",zl="owner",$l="mutationQueues",ql="mutations",Bl="batchId",Hl="userMutationsIndex",Wl=["userId","batchId"];function Kl(e,t){return[e,jl(t)]}function Gl(e,t,n){return[e,jl(t),n]}const Ql={},Yl="documentMutations",Xl="remoteDocumentsV14",Jl=["prefixPath","collectionGroup","readTime","documentId"],Zl="documentKeyIndex",ec=["prefixPath","collectionGroup","documentId"],tc="collectionGroupIndex",nc=["collectionGroup","readTime","prefixPath","documentId"],rc="remoteDocumentGlobal",ic="remoteDocumentGlobalKey",sc="targets",oc="queryTargetsIndex",ac=["canonicalId","targetId"],lc="targetDocuments",cc=["targetId","path"],uc="documentTargetsIndex",dc=["path","targetId"],hc="targetGlobalKey",fc="targetGlobal",pc="collectionParents",mc=["collectionId","parent"],gc="clientMetadata",vc="bundles",yc="namedQueries",bc="indexConfiguration",_c="collectionGroupIndex",wc="indexState",xc=["indexId","uid"],Sc="sequenceNumberIndex",kc=["uid","sequenceNumber"],Tc="indexEntries",Ec=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Cc="documentKeyIndex",Nc=["indexId","uid","orderedDocumentKey"],Ic="documentOverlays",Pc=["userId","collectionPath","documentId"],Ac="collectionPathOverlayIndex",Rc=["userId","collectionPath","largestBatchId"],Dc="collectionGroupOverlayIndex",Oc=["userId","collectionGroup","largestBatchId"],jc="globals",Lc=[$l,ql,Yl,Ul,sc,Vl,fc,lc,gc,rc,pc,vc,yc],Mc=[...Lc,Ic],Fc=[$l,ql,Yl,Xl,sc,Vl,fc,lc,gc,rc,pc,vc,yc,Ic],Uc=Fc,Vc=[...Uc,bc,wc,Tc],zc=Vc,$c=[...Vc,jc],qc=$c;class Bc extends hl{constructor(e,t){super(),this.ce=e,this.currentSequenceNumber=t}}function Hc(e,t){const n=ma(e);return vl.N(n.ce,t)}function Wc(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Kc(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Gc(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class Qc{constructor(e,t){this.comparator=e,this.root=t||Xc.EMPTY}insert(e,t){return new Qc(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Xc.BLACK,null,null))}remove(e){return new Qc(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Xc.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Yc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Yc(this.root,e,this.comparator,!1)}getReverseIterator(){return new Yc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Yc(this.root,e,this.comparator,!0)}}class Yc{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Xc{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:Xc.RED,this.left=null!=r?r:Xc.EMPTY,this.right=null!=i?i:Xc.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new Xc(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Xc.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return Xc.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Xc.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Xc.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ha(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ha(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ha(27949);return e+(this.isRed()?0:1)}}Xc.EMPTY=null,Xc.RED=!0,Xc.BLACK=!1,Xc.EMPTY=new class{constructor(){this.size=0}get key(){throw ha(57766)}get value(){throw ha(16141)}get color(){throw ha(16727)}get left(){throw ha(29726)}get right(){throw ha(36894)}copy(e,t,n,r,i){return this}insert(e,t,n){return new Xc(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Jc{constructor(e){this.comparator=e,this.data=new Qc(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Zc(this.data.getIterator())}getIteratorFrom(e){return new Zc(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof Jc))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Jc(this.comparator);return t.data=e,t}}class Zc{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function eu(e){return e.hasNext()?e.getNext():void 0}class tu{constructor(e){this.fields=e,e.sort(Va.comparator)}static empty(){return new tu([])}unionWith(e){let t=new Jc(Va.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new tu(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Oa(this.fields,e.fields,(e,t)=>e.isEqual(t))}}class nu extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class ru{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new nu("Invalid base64 string: "+e):e}}(e);return new ru(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new ru(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(e){return btoa(e)}(this.binaryString)}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Pa(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ru.EMPTY_BYTE_STRING=new ru("");const iu=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function su(e){if(pa(!!e,39018),"string"==typeof e){let t=0;const n=iu.exec(e);if(pa(!!n,46558,{timestamp:e}),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:ou(e.seconds),nanos:ou(e.nanos)}}function ou(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function au(e){return"string"==typeof e?ru.fromBase64String(e):ru.fromUint8Array(e)}const lu="server_timestamp",cu="__type__",uu="__previous_value__",du="__local_write_time__";function hu(e){var t,n;return(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{})[cu])||void 0===n?void 0:n.stringValue)===lu}function fu(e){const t=e.mapValue.fields[uu];return hu(t)?fu(t):t}function pu(e){const t=su(e.mapValue.fields[du].timestampValue);return new Za(t.seconds,t.nanos)}class mu{constructor(e,t,n,r,i,s,o,a,l,c){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=l,this.isUsingEmulator=c}}const gu="(default)";class vu{constructor(e,t){this.projectId=e,this.database=t||gu}static empty(){return new vu("","")}get isDefaultDatabase(){return this.database===gu}isEqual(e){return e instanceof vu&&e.projectId===this.projectId&&e.database===this.database}}const yu="__type__",bu="__max__",_u={mapValue:{fields:{__type__:{stringValue:bu}}}},wu="__vector__",xu="value",Su={nullValue:"NULL_VALUE"};function ku(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?hu(e)?4:zu(e)?9007199254740991:Uu(e)?10:11:ha(28295,{value:e})}function Tu(e,t){if(e===t)return!0;const n=ku(e);if(n!==ku(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return pu(e).isEqual(pu(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=su(e.timestampValue),r=su(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return au(e.bytesValue).isEqual(au(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return ou(e.geoPointValue.latitude)===ou(t.geoPointValue.latitude)&&ou(e.geoPointValue.longitude)===ou(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return ou(e.integerValue)===ou(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=ou(e.doubleValue),r=ou(t.doubleValue);return n===r?Rl(n)===Rl(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return Oa(e.arrayValue.values||[],t.arrayValue.values||[],Tu);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(Wc(n)!==Wc(r))return!1;for(const i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Tu(n[i],r[i])))return!1;return!0}(e,t);default:return ha(52216,{left:e})}}function Eu(e,t){return void 0!==(e.values||[]).find(e=>Tu(e,t))}function Cu(e,t){if(e===t)return 0;const n=ku(e),r=ku(t);if(n!==r)return Pa(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Pa(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=ou(e.integerValue||e.doubleValue),r=ou(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return Nu(e.timestampValue,t.timestampValue);case 4:return Nu(pu(e),pu(t));case 5:return Aa(e.stringValue,t.stringValue);case 6:return function(e,t){const n=au(e),r=au(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let i=0;i<n.length&&i<r.length;i++){const e=Pa(n[i],r[i]);if(0!==e)return e}return Pa(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=Pa(ou(e.latitude),ou(t.latitude));return 0!==n?n:Pa(ou(e.longitude),ou(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return Iu(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n,r,i,s;const o=e.fields||{},a=t.fields||{},l=null===(n=o[xu])||void 0===n?void 0:n.arrayValue,c=null===(r=a[xu])||void 0===r?void 0:r.arrayValue,u=Pa((null===(i=null==l?void 0:l.values)||void 0===i?void 0:i.length)||0,(null===(s=null==c?void 0:c.values)||void 0===s?void 0:s.length)||0);return 0!==u?u:Iu(l,c)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===_u.mapValue&&t===_u.mapValue)return 0;if(e===_u.mapValue)return 1;if(t===_u.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),i=t.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let o=0;o<r.length&&o<s.length;++o){const e=Aa(r[o],s[o]);if(0!==e)return e;const t=Cu(n[r[o]],i[s[o]]);if(0!==t)return t}return Pa(r.length,s.length)}(e.mapValue,t.mapValue);default:throw ha(23264,{le:n})}}function Nu(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return Pa(e,t);const n=su(e),r=su(t),i=Pa(n.seconds,r.seconds);return 0!==i?i:Pa(n.nanos,r.nanos)}function Iu(e,t){const n=e.values||[],r=t.values||[];for(let i=0;i<n.length&&i<r.length;++i){const e=Cu(n[i],r[i]);if(e)return e}return Pa(n.length,r.length)}function Pu(e){return Au(e)}function Au(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=su(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return au(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return za.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return`geo(${e.latitude},${e.longitude})`}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=Au(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+=`${i}:${Au(e.fields[i])}`;return n+"}"}(e.mapValue):ha(61005,{value:e})}function Ru(e){switch(ku(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=fu(e);return t?16+Ru(t):16;case 5:return 2*e.stringValue.length;case 6:return au(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(e){return(e.values||[]).reduce((e,t)=>e+Ru(t),0)}(e.arrayValue);case 10:case 11:return function(e){let t=0;return Kc(e.fields,(e,n)=>{t+=e.length+Ru(n)}),t}(e.mapValue);default:throw ha(13486,{value:e})}}function Du(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function Ou(e){return!!e&&"integerValue"in e}function ju(e){return!!e&&"arrayValue"in e}function Lu(e){return!!e&&"nullValue"in e}function Mu(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Fu(e){return!!e&&"mapValue"in e}function Uu(e){var t,n;return(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{})[yu])||void 0===n?void 0:n.stringValue)===wu}function Vu(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Kc(e.mapValue.fields,(e,n)=>t.mapValue.fields[e]=Vu(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Vu(e.arrayValue.values[n]);return t}return Object.assign({},e)}function zu(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===bu}const $u={mapValue:{fields:{[yu]:{stringValue:wu},[xu]:{arrayValue:{}}}}};function qu(e){return"nullValue"in e?Su:"booleanValue"in e?{booleanValue:!1}:"integerValue"in e||"doubleValue"in e?{doubleValue:NaN}:"timestampValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in e?{stringValue:""}:"bytesValue"in e?{bytesValue:""}:"referenceValue"in e?Du(vu.empty(),za.empty()):"geoPointValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in e?{arrayValue:{}}:"mapValue"in e?Uu(e)?$u:{mapValue:{}}:ha(35942,{value:e})}function Bu(e){return"nullValue"in e?{booleanValue:!1}:"booleanValue"in e?{doubleValue:NaN}:"integerValue"in e||"doubleValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in e?{stringValue:""}:"stringValue"in e?{bytesValue:""}:"bytesValue"in e?Du(vu.empty(),za.empty()):"referenceValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in e?{arrayValue:{}}:"arrayValue"in e?$u:"mapValue"in e?Uu(e)?{mapValue:{}}:_u:ha(61959,{value:e})}function Hu(e,t){const n=Cu(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?-1:!e.inclusive&&t.inclusive?1:0}function Wu(e,t){const n=Cu(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?1:!e.inclusive&&t.inclusive?-1:0}class Ku{constructor(e){this.value=e}static empty(){return new Ku({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Fu(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Vu(t)}setAll(e){let t=Va.emptyPath(),n={},r=[];e.forEach((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=Vu(e):r.push(i.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());Fu(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Tu(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];Fu(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){Kc(t,(t,n)=>e[t]=n);for(const r of n)delete e[r]}clone(){return new Ku(Vu(this.value))}}function Gu(e){const t=[];return Kc(e.fields,(e,n)=>{const r=new Va([e]);if(Fu(n)){const e=Gu(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)}),new tu(t)}class Qu{constructor(e,t,n,r,i,s,o){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=s,this.documentState=o}static newInvalidDocument(e){return new Qu(e,0,el.min(),el.min(),el.min(),Ku.empty(),0)}static newFoundDocument(e,t,n,r){return new Qu(e,1,t,el.min(),n,r,0)}static newNoDocument(e,t){return new Qu(e,2,t,el.min(),el.min(),Ku.empty(),0)}static newUnknownDocument(e,t){return new Qu(e,3,t,el.min(),el.min(),Ku.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(el.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ku.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ku.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=el.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Qu&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Qu(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Yu{constructor(e,t){this.position=e,this.inclusive=t}}function Xu(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],o=e.position[i];if(r=s.field.isKeyField()?za.comparator(za.fromName(o.referenceValue),n.key):Cu(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function Ju(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Tu(e.position[n],t.position[n]))return!1;return!0}class Zu{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function ed(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class td{}class nd extends td{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new hd(e,t,n):"array-contains"===t?new gd(e,n):"in"===t?new vd(e,n):"not-in"===t?new yd(e,n):"array-contains-any"===t?new bd(e,n):new nd(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new fd(e,n):new pd(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&void 0===t.nullValue&&this.matchesComparison(Cu(t,this.value)):null!==t&&ku(this.value)===ku(t)&&this.matchesComparison(Cu(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return ha(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class rd extends td{constructor(e,t){super(),this.filters=e,this.op=t,this.he=null}static create(e,t){return new rd(e,t)}matches(e){return id(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.he||(this.he=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function id(e){return"and"===e.op}function sd(e){return"or"===e.op}function od(e){return ad(e)&&id(e)}function ad(e){for(const t of e.filters)if(t instanceof rd)return!1;return!0}function ld(e){if(e instanceof nd)return e.field.canonicalString()+e.op.toString()+Pu(e.value);if(od(e))return e.filters.map(e=>ld(e)).join(",");{const t=e.filters.map(e=>ld(e)).join(",");return`${e.op}(${t})`}}function cd(e,t){return e instanceof nd?function(e,t){return t instanceof nd&&e.op===t.op&&e.field.isEqual(t.field)&&Tu(e.value,t.value)}(e,t):e instanceof rd?function(e,t){return t instanceof rd&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((e,n,r)=>e&&cd(n,t.filters[r]),!0)}(e,t):void ha(19439)}function ud(e,t){const n=e.filters.concat(t);return rd.create(n,e.op)}function dd(e){return e instanceof nd?function(e){return`${e.field.canonicalString()} ${e.op} ${Pu(e.value)}`}(e):e instanceof rd?function(e){return e.op.toString()+" {"+e.getFilters().map(dd).join(" ,")+"}"}(e):"Filter"}class hd extends nd{constructor(e,t,n){super(e,t,n),this.key=za.fromName(n.referenceValue)}matches(e){const t=za.comparator(e.key,this.key);return this.matchesComparison(t)}}class fd extends nd{constructor(e,t){super(e,"in",t),this.keys=md("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class pd extends nd{constructor(e,t){super(e,"not-in",t),this.keys=md("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function md(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(e=>za.fromName(e.referenceValue))}class gd extends nd{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return ju(t)&&Eu(t.arrayValue,this.value)}}class vd extends nd{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Eu(this.value.arrayValue,t)}}class yd extends nd{constructor(e,t){super(e,"not-in",t)}matches(e){if(Eu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&void 0===t.nullValue&&!Eu(this.value.arrayValue,t)}}class bd extends nd{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!ju(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>Eu(this.value.arrayValue,e))}}class _d{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.Pe=null}}function wd(e){return new _d(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function xd(e){const t=ma(e);if(null===t.Pe){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(e=>ld(e)).join(","),e+="|ob:",e+=t.orderBy.map(e=>function(e){return e.field.canonicalString()+e.dir}(e)).join(","),Al(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(e=>Pu(e)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(e=>Pu(e)).join(",")),t.Pe=e}return t.Pe}function Sd(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!ed(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!cd(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Ju(e.startAt,t.startAt)&&Ju(e.endAt,t.endAt)}function kd(e){return za.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function Td(e,t){return e.filters.filter(e=>e instanceof nd&&e.field.isEqual(t))}function Ed(e,t,n){let r=Su,i=!0;for(const s of Td(e,t)){let e=Su,t=!0;switch(s.op){case"<":case"<=":e=qu(s.value);break;case"==":case"in":case">=":e=s.value;break;case">":e=s.value,t=!1;break;case"!=":case"not-in":e=Su}Hu({value:r,inclusive:i},{value:e,inclusive:t})<0&&(r=e,i=t)}if(null!==n)for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){const e=n.position[s];Hu({value:r,inclusive:i},{value:e,inclusive:n.inclusive})<0&&(r=e,i=n.inclusive);break}return{value:r,inclusive:i}}function Cd(e,t,n){let r=_u,i=!0;for(const s of Td(e,t)){let e=_u,t=!0;switch(s.op){case">=":case">":e=Bu(s.value),t=!1;break;case"==":case"in":case"<=":e=s.value;break;case"<":e=s.value,t=!1;break;case"!=":case"not-in":e=_u}Wu({value:r,inclusive:i},{value:e,inclusive:t})>0&&(r=e,i=t)}if(null!==n)for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){const e=n.position[s];Wu({value:r,inclusive:i},{value:e,inclusive:n.inclusive})>0&&(r=e,i=n.inclusive);break}return{value:r,inclusive:i}}class Nd{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function Id(e,t,n,r,i,s,o,a){return new Nd(e,t,n,r,i,s,o,a)}function Pd(e){return new Nd(e)}function Ad(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function Rd(e){return null!==e.collectionGroup}function Dd(e){const t=ma(e);if(null===t.Te){t.Te=[];const e=new Set;for(const i of t.explicitOrderBy)t.Te.push(i),e.add(i.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",r=function(e){let t=new Jc(Va.comparator);return e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(t=t.add(e.field))})}),t}(t);r.forEach(r=>{e.has(r.canonicalString())||r.isKeyField()||t.Te.push(new Zu(r,n))}),e.has(Va.keyField().canonicalString())||t.Te.push(new Zu(Va.keyField(),n))}return t.Te}function Od(e){const t=ma(e);return t.Ie||(t.Ie=jd(t,Dd(e))),t.Ie}function jd(e,t){if("F"===e.limitType)return wd(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(e=>{const t="desc"===e.dir?"asc":"desc";return new Zu(e.field,t)});const n=e.endAt?new Yu(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new Yu(e.startAt.position,e.startAt.inclusive):null;return wd(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function Ld(e,t){const n=e.filters.concat([t]);return new Nd(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function Md(e,t,n){return new Nd(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Fd(e,t){return Sd(Od(e),Od(t))&&e.limitType===t.limitType}function Ud(e){return`${xd(Od(e))}|lt:${e.limitType}`}function Vd(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(e=>dd(e)).join(", ")}]`),Al(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e)).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>Pu(e)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>Pu(e)).join(",")),`Target(${t})`}(Od(e))}; limitType=${e.limitType})`}function zd(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):za.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of Dd(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=Xu(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,Dd(e),t))&&!(e.endAt&&!function(e,t,n){const r=Xu(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,Dd(e),t))}(e,t)}function $d(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function qd(e){return(t,n)=>{let r=!1;for(const i of Dd(e)){const e=Bd(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function Bd(e,t,n){const r=e.field.isKeyField()?za.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?Cu(r,i):ha(42886)}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return ha(19790,{direction:e.dir})}}class Hd{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,i]of n)if(this.equalsFn(r,e))return i}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Kc(this.inner,(t,n)=>{for(const[r,i]of n)e(r,i)})}isEmpty(){return Gc(this.inner)}size(){return this.innerSize}}const Wd=new Qc(za.comparator);function Kd(){return Wd}const Gd=new Qc(za.comparator);function Qd(){let e=Gd;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.insert(i.key,i);return e}function Yd(e){let t=Gd;return e.forEach((e,n)=>t=t.insert(e,n.overlayedDocument)),t}function Xd(){return Zd()}function Jd(){return Zd()}function Zd(){return new Hd(e=>e.toString(),(e,t)=>e.isEqual(t))}const eh=new Qc(za.comparator),th=new Jc(za.comparator);function nh(){let e=th;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.add(i);return e}const rh=new Jc(Pa);function ih(){return rh}function sh(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Rl(t)?"-0":t}}function oh(e){return{integerValue:""+e}}function ah(e,t){return Dl(t)?oh(t):sh(e,t)}class lh{constructor(){this._=void 0}}function ch(e,t,n){return e instanceof hh?function(e,t){const n={fields:{[cu]:{stringValue:lu},[du]:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&hu(t)&&(t=fu(t)),t&&(n.fields[uu]=t),{mapValue:n}}(n,t):e instanceof fh?ph(e,t):e instanceof mh?gh(e,t):function(e,t){const n=dh(e,t),r=yh(n)+yh(e.Ee);return Ou(n)&&Ou(e.Ee)?oh(r):sh(e.serializer,r)}(e,t)}function uh(e,t,n){return e instanceof fh?ph(e,t):e instanceof mh?gh(e,t):n}function dh(e,t){return e instanceof vh?function(e){return Ou(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class hh extends lh{}class fh extends lh{constructor(e){super(),this.elements=e}}function ph(e,t){const n=bh(t);for(const r of e.elements)n.some(e=>Tu(e,r))||n.push(r);return{arrayValue:{values:n}}}class mh extends lh{constructor(e){super(),this.elements=e}}function gh(e,t){let n=bh(t);for(const r of e.elements)n=n.filter(e=>!Tu(e,r));return{arrayValue:{values:n}}}class vh extends lh{constructor(e,t){super(),this.serializer=e,this.Ee=t}}function yh(e){return ou(e.integerValue||e.doubleValue)}function bh(e){return ju(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class _h{constructor(e,t){this.field=e,this.transform=t}}class wh{constructor(e,t){this.version=e,this.transformResults=t}}class xh{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new xh}static exists(e){return new xh(void 0,e)}static updateTime(e){return new xh(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Sh(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class kh{}function Th(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new jh(e.key,xh.none()):new Ph(e.key,e.data,xh.none());{const n=e.data,r=Ku.empty();let i=new Jc(Va.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),i=i.add(e)}return new Ah(e.key,r,new tu(i.toArray()),xh.none())}}function Eh(e,t,n){e instanceof Ph?function(e,t,n){const r=e.value.clone(),i=Dh(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof Ah?function(e,t,n){if(!Sh(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=Dh(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(Rh(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function Ch(e,t,n,r){return e instanceof Ph?function(e,t,n,r){if(!Sh(e.precondition,t))return n;const i=e.value.clone(),s=Oh(e.fieldTransforms,r,t);return i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof Ah?function(e,t,n,r){if(!Sh(e.precondition,t))return n;const i=Oh(e.fieldTransforms,r,t),s=t.data;return s.setAll(Rh(e)),s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,n,r):function(e,t,n){return Sh(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function Nh(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=dh(r.transform,e||null);null!=i&&(null===n&&(n=Ku.empty()),n.set(r.field,i))}return n||null}function Ih(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&Oa(e,t,(e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof fh&&t instanceof fh||e instanceof mh&&t instanceof mh?Oa(e.elements,t.elements,Tu):e instanceof vh&&t instanceof vh?Tu(e.Ee,t.Ee):e instanceof hh&&t instanceof hh}(e.transform,t.transform)}(e,t))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Ph extends kh{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Ah extends kh{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Rh(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}}),t}function Dh(e,t,n){const r=new Map;pa(e.length===n.length,32656,{Ae:n.length,Re:e.length});for(let i=0;i<n.length;i++){const s=e[i],o=s.transform,a=t.data.field(s.field);r.set(s.field,uh(o,a,n[i]))}return r}function Oh(e,t,n){const r=new Map;for(const i of e){const e=i.transform,s=n.data.field(i.field);r.set(i.field,ch(e,s,t))}return r}class jh extends kh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Lh extends kh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Mh{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&Eh(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Ch(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Ch(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Jd();return this.mutations.forEach(r=>{const i=e.get(r.key),s=i.overlayedDocument;let o=this.applyToLocalView(s,i.mutatedFields);o=t.has(r.key)?null:o;const a=Th(s,o);null!==a&&n.set(r.key,a),s.isValidDocument()||s.convertToNoDocument(el.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),nh())}isEqual(e){return this.batchId===e.batchId&&Oa(this.mutations,e.mutations,(e,t)=>Ih(e,t))&&Oa(this.baseMutations,e.baseMutations,(e,t)=>Ih(e,t))}}class Fh{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){pa(e.mutations.length===n.length,58842,{Ve:e.mutations.length,me:n.length});let r=eh;const i=e.mutations;for(let s=0;s<i.length;s++)r=r.insert(i[s].key,n[s].version);return new Fh(e,t,n,r)}}class Uh{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Vh{constructor(e,t){this.count=e,this.unchangedNames=t}}var zh,$h;function qh(e){switch(e){case ga.OK:return ha(64938);case ga.CANCELLED:case ga.UNKNOWN:case ga.DEADLINE_EXCEEDED:case ga.RESOURCE_EXHAUSTED:case ga.INTERNAL:case ga.UNAVAILABLE:case ga.UNAUTHENTICATED:return!1;case ga.INVALID_ARGUMENT:case ga.NOT_FOUND:case ga.ALREADY_EXISTS:case ga.PERMISSION_DENIED:case ga.FAILED_PRECONDITION:case ga.ABORTED:case ga.OUT_OF_RANGE:case ga.UNIMPLEMENTED:case ga.DATA_LOSS:return!0;default:return ha(15467,{code:e})}}function Bh(e){if(void 0===e)return ca("GRPC error has no .code"),ga.UNKNOWN;switch(e){case zh.OK:return ga.OK;case zh.CANCELLED:return ga.CANCELLED;case zh.UNKNOWN:return ga.UNKNOWN;case zh.DEADLINE_EXCEEDED:return ga.DEADLINE_EXCEEDED;case zh.RESOURCE_EXHAUSTED:return ga.RESOURCE_EXHAUSTED;case zh.INTERNAL:return ga.INTERNAL;case zh.UNAVAILABLE:return ga.UNAVAILABLE;case zh.UNAUTHENTICATED:return ga.UNAUTHENTICATED;case zh.INVALID_ARGUMENT:return ga.INVALID_ARGUMENT;case zh.NOT_FOUND:return ga.NOT_FOUND;case zh.ALREADY_EXISTS:return ga.ALREADY_EXISTS;case zh.PERMISSION_DENIED:return ga.PERMISSION_DENIED;case zh.FAILED_PRECONDITION:return ga.FAILED_PRECONDITION;case zh.ABORTED:return ga.ABORTED;case zh.OUT_OF_RANGE:return ga.OUT_OF_RANGE;case zh.UNIMPLEMENTED:return ga.UNIMPLEMENTED;case zh.DATA_LOSS:return ga.DATA_LOSS;default:return ha(39323,{code:e})}}($h=zh||(zh={}))[$h.OK=0]="OK",$h[$h.CANCELLED=1]="CANCELLED",$h[$h.UNKNOWN=2]="UNKNOWN",$h[$h.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",$h[$h.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",$h[$h.NOT_FOUND=5]="NOT_FOUND",$h[$h.ALREADY_EXISTS=6]="ALREADY_EXISTS",$h[$h.PERMISSION_DENIED=7]="PERMISSION_DENIED",$h[$h.UNAUTHENTICATED=16]="UNAUTHENTICATED",$h[$h.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",$h[$h.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",$h[$h.ABORTED=10]="ABORTED",$h[$h.OUT_OF_RANGE=11]="OUT_OF_RANGE",$h[$h.UNIMPLEMENTED=12]="UNIMPLEMENTED",$h[$h.INTERNAL=13]="INTERNAL",$h[$h.UNAVAILABLE=14]="UNAVAILABLE",$h[$h.DATA_LOSS=15]="DATA_LOSS";let Hh=null;const Wh=new $o([4294967295,4294967295],0);function Kh(e){const t=Na().encode(e),n=new qo;return n.update(t),new Uint8Array(n.digest())}function Gh(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new $o([n,r],0),new $o([i,s],0)]}class Qh{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Yh(`Invalid padding: ${t}`);if(n<0)throw new Yh(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new Yh(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new Yh(`Invalid padding when bitmap length is 0: ${t}`);this.fe=8*e.length-t,this.ge=$o.fromNumber(this.fe)}pe(e,t,n){let r=e.add(t.multiply($o.fromNumber(n)));return 1===r.compare(Wh)&&(r=new $o([r.getBits(0),r.getBits(1)],0)),r.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.fe)return!1;const t=Kh(e),[n,r]=Gh(t);for(let i=0;i<this.hashCount;i++){const e=this.pe(n,r,i);if(!this.ye(e))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),s=new Qh(i,r,t);return n.forEach(e=>s.insert(e)),s}insert(e){if(0===this.fe)return;const t=Kh(e),[n,r]=Gh(t);for(let i=0;i<this.hashCount;i++){const e=this.pe(n,r,i);this.we(e)}}we(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class Yh extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Xh{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,Jh.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new Xh(el.min(),r,new Qc(Pa),Kd(),nh())}}class Jh{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Jh(n,t,nh(),nh(),nh())}}class Zh{constructor(e,t,n,r){this.Se=e,this.removedTargetIds=t,this.key=n,this.be=r}}class ef{constructor(e,t){this.targetId=e,this.De=t}}class tf{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ru.EMPTY_BYTE_STRING,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class nf{constructor(){this.ve=0,this.Ce=of(),this.Fe=ru.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return 0!==this.ve}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=nh(),t=nh(),n=nh();return this.Ce.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:ha(38017,{changeType:i})}}),new Jh(this.Fe,this.Me,e,t,n)}ke(){this.xe=!1,this.Ce=of()}qe(e,t){this.xe=!0,this.Ce=this.Ce.insert(e,t)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,pa(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class rf{constructor(e){this.We=e,this.Ge=new Map,this.ze=Kd(),this.je=sf(),this.Je=sf(),this.He=new Qc(Pa)}Ye(e){for(const t of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(t,e.be):this.Xe(t,e.key,e.be);for(const t of e.removedTargetIds)this.Xe(t,e.key,e.be)}et(e){this.forEachTarget(e,t=>{const n=this.tt(t);switch(e.state){case 0:this.nt(t)&&n.Be(e.resumeToken);break;case 1:n.Ue(),n.Oe||n.ke(),n.Be(e.resumeToken);break;case 2:n.Ue(),n.Oe||this.removeTarget(t);break;case 3:this.nt(t)&&(n.Ke(),n.Be(e.resumeToken));break;case 4:this.nt(t)&&(this.rt(t),n.Be(e.resumeToken));break;default:ha(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ge.forEach((e,n)=>{this.nt(n)&&t(n)})}it(e){const t=e.targetId,n=e.De.count,r=this.st(t);if(r){const i=r.target;if(kd(i))if(0===n){const e=new za(i.path);this.Xe(t,e,Qu.newNoDocument(e,el.min()))}else pa(1===n,20013,{expectedCount:n});else{const r=this.ot(t);if(r!==n){const n=this._t(e),i=n?this.ut(n,e,r):1;if(0!==i){this.rt(t);const e=2===i?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(t,e)}null==Hh||Hh.ct(function(e,t,n,r,i){var s,o,a,l,c,u;const d={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},h=t.unchangedNames;return h&&(d.bloomFilter={applied:0===i,hashCount:null!==(s=null==h?void 0:h.hashCount)&&void 0!==s?s:0,bitmapLength:null!==(l=null===(a=null===(o=null==h?void 0:h.bits)||void 0===o?void 0:o.bitmap)||void 0===a?void 0:a.length)&&void 0!==l?l:0,padding:null!==(u=null===(c=null==h?void 0:h.bits)||void 0===c?void 0:c.padding)&&void 0!==u?u:0,mightContain:e=>{var t;return null!==(t=null==r?void 0:r.mightContain(e))&&void 0!==t&&t}}),d}(r,e.De,this.We.lt(),n,i))}}}}_t(e){const t=e.De.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:i=0}=t;let s,o;try{s=au(n).toUint8Array()}catch(e){if(e instanceof nu)return ua("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{o=new Qh(s,r,i)}catch(e){return ua(e instanceof Yh?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===o.fe?null:o}ut(e,t,n){return t.De.count===n-this.ht(e,t.targetId)?0:2}ht(e,t){const n=this.We.getRemoteKeysForTarget(t);let r=0;return n.forEach(n=>{const i=this.We.lt(),s=`projects/${i.projectId}/databases/${i.database}/documents/${n.path.canonicalString()}`;e.mightContain(s)||(this.Xe(t,n,null),r++)}),r}Pt(e){const t=new Map;this.Ge.forEach((n,r)=>{const i=this.st(r);if(i){if(n.current&&kd(i.target)){const t=new za(i.target.path);this.Tt(t).has(r)||this.It(r,t)||this.Xe(r,t,Qu.newNoDocument(t,e))}n.Ne&&(t.set(r,n.Le()),n.ke())}});let n=nh();this.Je.forEach((e,t)=>{let r=!0;t.forEachWhile(e=>{const t=this.st(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)}),r&&(n=n.add(e))}),this.ze.forEach((t,n)=>n.setReadTime(e));const r=new Xh(e,t,this.He,this.ze,n);return this.ze=Kd(),this.je=sf(),this.Je=sf(),this.He=new Qc(Pa),r}Ze(e,t){if(!this.nt(e))return;const n=this.It(e,t.key)?2:0;this.tt(e).qe(t.key,n),this.ze=this.ze.insert(t.key,t),this.je=this.je.insert(t.key,this.Tt(t.key).add(e)),this.Je=this.Je.insert(t.key,this.dt(t.key).add(e))}Xe(e,t,n){if(!this.nt(e))return;const r=this.tt(e);this.It(e,t)?r.qe(t,1):r.Qe(t),this.Je=this.Je.insert(t,this.dt(t).delete(e)),this.Je=this.Je.insert(t,this.dt(t).add(e)),n&&(this.ze=this.ze.insert(t,n))}removeTarget(e){this.Ge.delete(e)}ot(e){const t=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let t=this.Ge.get(e);return t||(t=new nf,this.Ge.set(e,t)),t}dt(e){let t=this.Je.get(e);return t||(t=new Jc(Pa),this.Je=this.Je.insert(e,t)),t}Tt(e){let t=this.je.get(e);return t||(t=new Jc(Pa),this.je=this.je.insert(e,t)),t}nt(e){const t=null!==this.st(e);return t||la("WatchChangeAggregator","Detected inactive target",e),t}st(e){const t=this.Ge.get(e);return t&&t.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new nf),this.We.getRemoteKeysForTarget(e).forEach(t=>{this.Xe(e,t,null)})}It(e,t){return this.We.getRemoteKeysForTarget(e).has(t)}}function sf(){return new Qc(za.comparator)}function of(){return new Qc(za.comparator)}const af={asc:"ASCENDING",desc:"DESCENDING"},lf={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},cf={and:"AND",or:"OR"};class uf{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function df(e,t){return e.useProto3Json||Al(t)?t:{value:t}}function hf(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function ff(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function pf(e,t){return hf(e,t.toTimestamp())}function mf(e){return pa(!!e,49232),el.fromTimestamp(function(e){const t=su(e);return new Za(t.seconds,t.nanos)}(e))}function gf(e,t){return vf(e,t).canonicalString()}function vf(e,t){const n=function(e){return new Fa(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function yf(e){const t=Fa.fromString(e);return pa(Vf(t),10190,{key:t.toString()}),t}function bf(e,t){return gf(e.databaseId,t.path)}function _f(e,t){const n=yf(t);if(n.get(1)!==e.databaseId.projectId)throw new va(ga.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new va(ga.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new za(kf(n))}function wf(e,t){return gf(e.databaseId,t)}function xf(e){const t=yf(e);return 4===t.length?Fa.emptyPath():kf(t)}function Sf(e){return new Fa(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function kf(e){return pa(e.length>4&&"documents"===e.get(4),29091,{key:e.toString()}),e.popFirst(5)}function Tf(e,t,n){return{name:bf(e,t),fields:n.value.mapValue.fields}}function Ef(e,t,n){const r=_f(e,t.name),i=mf(t.updateTime),s=t.createTime?mf(t.createTime):el.min(),o=new Ku({mapValue:{fields:t.fields}}),a=Qu.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function Cf(e,t){let n;if(t instanceof Ph)n={update:Tf(e,t.key,t.value)};else if(t instanceof jh)n={delete:bf(e,t.key)};else if(t instanceof Ah)n={update:Tf(e,t.key,t.data),updateMask:Uf(t.fieldMask)};else{if(!(t instanceof Lh))return ha(16599,{Rt:t.type});n={verify:bf(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(e=>function(e,t){const n=t.transform;if(n instanceof hh)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof fh)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof mh)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof vh)return{fieldPath:t.field.canonicalString(),increment:n.Ee};throw ha(20930,{transform:t.transform})}(0,e))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:pf(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:ha(27497)}(e,t.precondition)),n}function Nf(e,t){const n=t.currentDocument?function(e){return void 0!==e.updateTime?xh.updateTime(mf(e.updateTime)):void 0!==e.exists?xh.exists(e.exists):xh.none()}(t.currentDocument):xh.none(),r=t.updateTransforms?t.updateTransforms.map(t=>function(e,t){let n=null;if("setToServerValue"in t)pa("REQUEST_TIME"===t.setToServerValue,16630,{proto:t}),n=new hh;else if("appendMissingElements"in t){const e=t.appendMissingElements.values||[];n=new fh(e)}else if("removeAllFromArray"in t){const e=t.removeAllFromArray.values||[];n=new mh(e)}else"increment"in t?n=new vh(e,t.increment):ha(16584,{proto:t});const r=Va.fromServerFormat(t.fieldPath);return new _h(r,n)}(e,t)):[];if(t.update){t.update.name;const i=_f(e,t.update.name),s=new Ku({mapValue:{fields:t.update.fields}});if(t.updateMask){const e=function(e){const t=e.fieldPaths||[];return new tu(t.map(e=>Va.fromServerFormat(e)))}(t.updateMask);return new Ah(i,s,e,n,r)}return new Ph(i,s,n,r)}if(t.delete){const r=_f(e,t.delete);return new jh(r,n)}if(t.verify){const r=_f(e,t.verify);return new Lh(r,n)}return ha(1463,{proto:t})}function If(e,t){return{documents:[wf(e,t.path)]}}function Pf(e,t){const n={structuredQuery:{}},r=t.path;let i;null!==t.collectionGroup?(i=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=wf(e,i);const s=function(e){if(0!==e.length)return Ff(rd.create(e,"and"))}(t.filters);s&&(n.structuredQuery.where=s);const o=function(e){if(0!==e.length)return e.map(e=>function(e){return{field:Lf(e.field),direction:Df(e.dir)}}(e))}(t.orderBy);o&&(n.structuredQuery.orderBy=o);const a=df(e,t.limit);return null!==a&&(n.structuredQuery.limit=a),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{Vt:n,parent:i}}function Af(e){let t=xf(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){pa(1===r,65062);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=function(e){const t=Rf(e);return t instanceof rd&&od(t)?t.getFilters():[t]}(n.where));let o=[];n.orderBy&&(o=function(e){return e.map(e=>function(e){return new Zu(Mf(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e))}(n.orderBy));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,Al(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new Yu(n,t)}(n.startAt));let c=null;return n.endAt&&(c=function(e){const t=!e.before,n=e.values||[];return new Yu(n,t)}(n.endAt)),Id(t,i,o,s,a,"F",l,c)}function Rf(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Mf(e.unaryFilter.field);return nd.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=Mf(e.unaryFilter.field);return nd.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Mf(e.unaryFilter.field);return nd.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=Mf(e.unaryFilter.field);return nd.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ha(61313);default:return ha(60726)}}(e):void 0!==e.fieldFilter?function(e){return nd.create(Mf(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ha(58110);default:return ha(50506)}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return rd.create(e.compositeFilter.filters.map(e=>Rf(e)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return ha(1026)}}(e.compositeFilter.op))}(e):ha(30097,{filter:e})}function Df(e){return af[e]}function Of(e){return lf[e]}function jf(e){return cf[e]}function Lf(e){return{fieldPath:e.canonicalString()}}function Mf(e){return Va.fromServerFormat(e.fieldPath)}function Ff(e){return e instanceof nd?function(e){if("=="===e.op){if(Mu(e.value))return{unaryFilter:{field:Lf(e.field),op:"IS_NAN"}};if(Lu(e.value))return{unaryFilter:{field:Lf(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Mu(e.value))return{unaryFilter:{field:Lf(e.field),op:"IS_NOT_NAN"}};if(Lu(e.value))return{unaryFilter:{field:Lf(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Lf(e.field),op:Of(e.op),value:e.value}}}(e):e instanceof rd?function(e){const t=e.getFilters().map(e=>Ff(e));return 1===t.length?t[0]:{compositeFilter:{op:jf(e.op),filters:t}}}(e):ha(54877,{filter:e})}function Uf(e){const t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function Vf(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class zf{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:el.min(),s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:el.min(),o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:ru.EMPTY_BYTE_STRING,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o,this.expectedCount=a}withSequenceNumber(e){return new zf(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new zf(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new zf(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new zf(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class $f{constructor(e){this.gt=e}}function qf(e,t){const n=t.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Bf(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())r.document=function(e,t){return{name:bf(e,t.key),fields:t.data.value.mapValue.fields,updateTime:hf(e,t.version.toTimestamp()),createTime:hf(e,t.createTime.toTimestamp())}}(e.gt,t);else if(t.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Hf(t.version)};else{if(!t.isUnknownDocument())return ha(57904,{document:t});r.unknownDocument={path:n.path.toArray(),version:Hf(t.version)}}return r}function Bf(e){const t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function Hf(e){const t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function Wf(e){const t=new Za(e.seconds,e.nanoseconds);return el.fromTimestamp(t)}function Kf(e,t){const n=(t.baseMutations||[]).map(t=>Nf(e.gt,t));for(let s=0;s<t.mutations.length-1;++s){const e=t.mutations[s];if(s+1<t.mutations.length&&void 0!==t.mutations[s+1].transform){const n=t.mutations[s+1];e.updateTransforms=n.transform.fieldTransforms,t.mutations.splice(s+1,1),++s}}const r=t.mutations.map(t=>Nf(e.gt,t)),i=Za.fromMillis(t.localWriteTimeMs);return new Mh(t.batchId,i,n,r)}function Gf(e){const t=Wf(e.readTime),n=void 0!==e.lastLimboFreeSnapshotVersion?Wf(e.lastLimboFreeSnapshotVersion):el.min();let r;return r=function(e){return void 0!==e.documents}(e.query)?function(e){const t=e.documents.length;return pa(1===t,1966,{count:t}),Od(Pd(xf(e.documents[0])))}(e.query):function(e){return Od(Af(e))}(e.query),new zf(r,e.targetId,"TargetPurposeListen",e.lastListenSequenceNumber,t,n,ru.fromBase64String(e.resumeToken))}function Qf(e,t){const n=Hf(t.snapshotVersion),r=Hf(t.lastLimboFreeSnapshotVersion);let i;i=kd(t.target)?If(e.gt,t.target):Pf(e.gt,t.target).Vt;const s=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:xd(t.target),readTime:n,resumeToken:s,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function Yf(e){const t=Af({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?Md(t,t.limit,"L"):t}function Xf(e,t){return new Uh(t.largestBatchId,Nf(e.gt,t.overlayMutation))}function Jf(e,t){const n=t.path.lastSegment();return[e,jl(t.path.popLast()),n]}function Zf(e,t,n,r){return{indexId:e,uid:t,sequenceNumber:n,readTime:Hf(r.readTime),documentKey:jl(r.documentKey.path),largestBatchId:r.largestBatchId}}class ep{getBundleMetadata(e,t){return tp(e).get(t).next(e=>{if(e)return function(e){return{id:e.bundleId,createTime:Wf(e.createTime),version:e.version}}(e)})}saveBundleMetadata(e,t){return tp(e).put(function(e){return{bundleId:e.id,createTime:Hf(mf(e.createTime)),version:e.version}}(t))}getNamedQuery(e,t){return np(e).get(t).next(e=>{if(e)return function(e){return{name:e.name,query:Yf(e.bundledQuery),readTime:Wf(e.readTime)}}(e)})}saveNamedQuery(e,t){return np(e).put(function(e){return{name:e.name,readTime:Hf(mf(e.readTime)),bundledQuery:e.bundledQuery}}(t))}}function tp(e){return Hc(e,vc)}function np(e){return Hc(e,yc)}class rp{constructor(e,t){this.serializer=e,this.userId=t}static yt(e,t){const n=t.uid||"";return new rp(e,n)}getOverlay(e,t){return ip(e).get(Jf(this.userId,t)).next(e=>e?Xf(this.serializer,e):null)}getOverlays(e,t){const n=Xd();return pl.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){const r=[];return n.forEach((n,i)=>{const s=new Uh(t,i);r.push(this.wt(e,s))}),pl.waitFor(r)}removeOverlaysForBatchId(e,t,n){const r=new Set;t.forEach(e=>r.add(jl(e.getCollectionPath())));const i=[];return r.forEach(t=>{const r=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,n+1],!1,!0);i.push(ip(e).Y(Ac,r))}),pl.waitFor(i)}getOverlaysForCollection(e,t,n){const r=Xd(),i=jl(t),s=IDBKeyRange.bound([this.userId,i,n],[this.userId,i,Number.POSITIVE_INFINITY],!0);return ip(e).j(Ac,s).next(e=>{for(const t of e){const e=Xf(this.serializer,t);r.set(e.getKey(),e)}return r})}getOverlaysForCollectionGroup(e,t,n,r){const i=Xd();let s;const o=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return ip(e).X({index:Dc,range:o},(e,t,n)=>{const o=Xf(this.serializer,t);i.size()<r||o.largestBatchId===s?(i.set(o.getKey(),o),s=o.largestBatchId):n.done()}).next(()=>i)}wt(e,t){return ip(e).put(function(e,t,n){const[r,i,s]=Jf(t,n.mutation.key);return{userId:t,collectionPath:i,documentId:s,collectionGroup:n.mutation.key.getCollectionGroup(),largestBatchId:n.largestBatchId,overlayMutation:Cf(e.gt,n.mutation)}}(this.serializer,this.userId,t))}}function ip(e){return Hc(e,Ic)}class sp{St(e){return Hc(e,jc)}getSessionToken(e){return this.St(e).get("sessionToken").next(e=>{const t=null==e?void 0:e.value;return t?ru.fromUint8Array(t):ru.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.St(e).put({name:"sessionToken",value:t.toUint8Array()})}}class op{constructor(){}bt(e,t){this.Dt(e,t),t.vt()}Dt(e,t){if("nullValue"in e)this.Ct(t,5);else if("booleanValue"in e)this.Ct(t,10),t.Ft(e.booleanValue?1:0);else if("integerValue"in e)this.Ct(t,15),t.Ft(ou(e.integerValue));else if("doubleValue"in e){const n=ou(e.doubleValue);isNaN(n)?this.Ct(t,13):(this.Ct(t,15),Rl(n)?t.Ft(0):t.Ft(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Ct(t,20),"string"==typeof n&&(n=su(n)),t.Mt(`${n.seconds||""}`),t.Ft(n.nanos||0)}else if("stringValue"in e)this.xt(e.stringValue,t),this.Ot(t);else if("bytesValue"in e)this.Ct(t,30),t.Nt(au(e.bytesValue)),this.Ot(t);else if("referenceValue"in e)this.Bt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Ct(t,45),t.Ft(n.latitude||0),t.Ft(n.longitude||0)}else"mapValue"in e?zu(e)?this.Ct(t,Number.MAX_SAFE_INTEGER):Uu(e)?this.Lt(e.mapValue,t):(this.kt(e.mapValue,t),this.Ot(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Ot(t)):ha(19022,{Qt:e})}xt(e,t){this.Ct(t,25),this.$t(e,t)}$t(e,t){t.Mt(e)}kt(e,t){const n=e.fields||{};this.Ct(t,55);for(const r of Object.keys(n))this.xt(r,t),this.Dt(n[r],t)}Lt(e,t){var n,r;const i=e.fields||{};this.Ct(t,53);const s=xu,o=(null===(r=null===(n=i[s].arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.length)||0;this.Ct(t,15),t.Ft(ou(o)),this.xt(s,t),this.Dt(i[s],t)}qt(e,t){const n=e.values||[];this.Ct(t,50);for(const r of n)this.Dt(r,t)}Bt(e,t){this.Ct(t,37),za.fromName(e).path.forEach(e=>{this.Ct(t,60),this.$t(e,t)})}Ct(e,t){e.Ft(t)}Ot(e){e.Ft(2)}}op.Ut=new op;const ap=255;function lp(e){if(0===e)return 8;let t=0;return e>>4||(t+=4,e<<=4),e>>6||(t+=2,e<<=2),e>>7||(t+=1),t}function cp(e){const t=64-function(e){let t=0;for(let n=0;n<8;++n){const r=lp(255&e[n]);if(t+=r,8!==r)break}return t}(e);return Math.ceil(t/8)}class up{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Kt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Wt(n.value),n=t.next();this.Gt()}zt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.jt(n.value),n=t.next();this.Jt()}Ht(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.Wt(e);else if(e<2048)this.Wt(960|e>>>6),this.Wt(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.Wt(480|e>>>12),this.Wt(128|63&e>>>6),this.Wt(128|63&e);else{const e=t.codePointAt(0);this.Wt(240|e>>>18),this.Wt(128|63&e>>>12),this.Wt(128|63&e>>>6),this.Wt(128|63&e)}}this.Gt()}Yt(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.jt(e);else if(e<2048)this.jt(960|e>>>6),this.jt(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.jt(480|e>>>12),this.jt(128|63&e>>>6),this.jt(128|63&e);else{const e=t.codePointAt(0);this.jt(240|e>>>18),this.jt(128|63&e>>>12),this.jt(128|63&e>>>6),this.jt(128|63&e)}}this.Jt()}Zt(e){const t=this.Xt(e),n=cp(t);this.en(1+n),this.buffer[this.position++]=255&n;for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=255&t[r]}tn(e){const t=this.Xt(e),n=cp(t);this.en(1+n),this.buffer[this.position++]=~(255&n);for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}nn(){this.rn(ap),this.rn(255)}sn(){this._n(ap),this._n(255)}reset(){this.position=0}seed(e){this.en(e.length),this.buffer.set(e,this.position),this.position+=e.length}an(){return this.buffer.slice(0,this.position)}Xt(e){const t=function(e){const t=new DataView(new ArrayBuffer(8));return t.setFloat64(0,e,!1),new Uint8Array(t.buffer)}(e),n=!!(128&t[0]);t[0]^=n?255:128;for(let r=1;r<t.length;++r)t[r]^=n?255:0;return t}Wt(e){const t=255&e;0===t?(this.rn(0),this.rn(255)):t===ap?(this.rn(ap),this.rn(0)):this.rn(t)}jt(e){const t=255&e;0===t?(this._n(0),this._n(255)):t===ap?(this._n(ap),this._n(0)):this._n(e)}Gt(){this.rn(0),this.rn(1)}Jt(){this._n(0),this._n(1)}rn(e){this.en(1),this.buffer[this.position++]=e}_n(e){this.en(1),this.buffer[this.position++]=~e}en(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const r=new Uint8Array(n);r.set(this.buffer),this.buffer=r}}class dp{constructor(e){this.un=e}Nt(e){this.un.Kt(e)}Mt(e){this.un.Ht(e)}Ft(e){this.un.Zt(e)}vt(){this.un.nn()}}class hp{constructor(e){this.un=e}Nt(e){this.un.zt(e)}Mt(e){this.un.Yt(e)}Ft(e){this.un.tn(e)}vt(){this.un.sn()}}class fp{constructor(){this.un=new up,this.cn=new dp(this.un),this.ln=new hp(this.un)}seed(e){this.un.seed(e)}hn(e){return 0===e?this.cn:this.ln}an(){return this.un.an()}reset(){this.un.reset()}}class pp{constructor(e,t,n,r){this.Pn=e,this.Tn=t,this.In=n,this.dn=r}En(){const e=this.dn.length,t=0===e||255===this.dn[e-1]?e+1:e,n=new Uint8Array(t);return n.set(this.dn,0),t!==e?n.set([0],this.dn.length):++n[n.length-1],new pp(this.Pn,this.Tn,this.In,n)}An(e,t,n){return{indexId:this.Pn,uid:e,arrayValue:vp(this.In),directionalValue:vp(this.dn),orderedDocumentKey:vp(t),documentKey:n.path.toArray()}}Rn(e,t,n){const r=this.An(e,t,n);return[r.indexId,r.uid,r.arrayValue,r.directionalValue,r.orderedDocumentKey,r.documentKey]}}function mp(e,t){let n=e.Pn-t.Pn;return 0!==n?n:(n=gp(e.In,t.In),0!==n?n:(n=gp(e.dn,t.dn),0!==n?n:za.comparator(e.Tn,t.Tn)))}function gp(e,t){for(let n=0;n<e.length&&n<t.length;++n){const r=e[n]-t[n];if(0!==r)return r}return e.length-t.length}function vp(e){return pt()?function(e){let t="";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t}(e):e}function yp(e){return"string"!=typeof e?e:function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(e)}class bp{constructor(e){this.Vn=new Jc((e,t)=>Va.comparator(e.field,t.field)),this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.mn=e.orderBy,this.fn=[];for(const t of e.filters){const e=t;e.isInequality()?this.Vn=this.Vn.add(e):this.fn.push(e)}}get gn(){return this.Vn.size>1}pn(e){if(pa(e.collectionGroup===this.collectionId,49279),this.gn)return!1;const t=rl(e);if(void 0!==t&&!this.yn(t))return!1;const n=il(e);let r=new Set,i=0,s=0;for(;i<n.length&&this.yn(n[i]);++i)r=r.add(n[i].fieldPath.canonicalString());if(i===n.length)return!0;if(this.Vn.size>0){const e=this.Vn.getIterator().getNext();if(!r.has(e.field.canonicalString())){const t=n[i];if(!this.wn(e,t)||!this.Sn(this.mn[s++],t))return!1}++i}for(;i<n.length;++i){const e=n[i];if(s>=this.mn.length||!this.Sn(this.mn[s++],e))return!1}return!0}bn(){if(this.gn)return null;let e=new Jc(Va.comparator);const t=[];for(const n of this.fn)if(!n.field.isKeyField())if("array-contains"===n.op||"array-contains-any"===n.op)t.push(new sl(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new sl(n.field,0))}for(const n of this.mn)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new sl(n.field,"asc"===n.dir?0:1)));return new nl(nl.UNKNOWN_ID,this.collectionId,t,ol.empty())}yn(e){for(const t of this.fn)if(this.wn(t,e))return!0;return!1}wn(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;const n="array-contains"===e.op||"array-contains-any"===e.op;return 2===t.kind===n}Sn(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function _p(e){var t,n;if(pa(e instanceof nd||e instanceof rd,20012),e instanceof nd){if(e instanceof vd){const r=(null===(n=null===(t=e.value.arrayValue)||void 0===t?void 0:t.values)||void 0===n?void 0:n.map(t=>nd.create(e.field,"==",t)))||[];return rd.create(r,"or")}return e}const r=e.filters.map(e=>_p(e));return rd.create(r,e.op)}function wp(e){if(0===e.getFilters().length)return[];const t=Tp(_p(e));return pa(kp(t),7391),xp(t)||Sp(t)?[t]:t.getFilters()}function xp(e){return e instanceof nd}function Sp(e){return e instanceof rd&&od(e)}function kp(e){return xp(e)||Sp(e)||function(e){if(e instanceof rd&&sd(e)){for(const t of e.getFilters())if(!xp(t)&&!Sp(t))return!1;return!0}return!1}(e)}function Tp(e){if(pa(e instanceof nd||e instanceof rd,34018),e instanceof nd)return e;if(1===e.filters.length)return Tp(e.filters[0]);const t=e.filters.map(e=>Tp(e));let n=rd.create(t,e.op);return n=Np(n),kp(n)?n:(pa(n instanceof rd,64498),pa(id(n),40251),pa(n.filters.length>1,57927),n.filters.reduce((e,t)=>Ep(e,t)))}function Ep(e,t){let n;return pa(e instanceof nd||e instanceof rd,38388),pa(t instanceof nd||t instanceof rd,25473),n=e instanceof nd?t instanceof nd?function(e,t){return rd.create([e,t],"and")}(e,t):Cp(e,t):t instanceof nd?Cp(t,e):function(e,t){if(pa(e.filters.length>0&&t.filters.length>0,48005),id(e)&&id(t))return ud(e,t.getFilters());const n=sd(e)?e:t,r=sd(e)?t:e,i=n.filters.map(e=>Ep(e,r));return rd.create(i,"or")}(e,t),Np(n)}function Cp(e,t){if(id(t))return ud(t,e.getFilters());{const n=t.filters.map(t=>Ep(e,t));return rd.create(n,"or")}}function Np(e){if(pa(e instanceof nd||e instanceof rd,11850),e instanceof nd)return e;const t=e.getFilters();if(1===t.length)return Np(t[0]);if(ad(e))return e;const n=t.map(e=>Np(e)),r=[];return n.forEach(t=>{t instanceof nd?r.push(t):t instanceof rd&&(t.op===e.op?r.push(...t.filters):r.push(t))}),1===r.length?r[0]:rd.create(r,e.op)}class Ip{constructor(){this.Dn=new Pp}addToCollectionParentIndex(e,t){return this.Dn.add(t),pl.resolve()}getCollectionParents(e,t){return pl.resolve(this.Dn.getEntries(t))}addFieldIndex(e,t){return pl.resolve()}deleteFieldIndex(e,t){return pl.resolve()}deleteAllFieldIndexes(e){return pl.resolve()}createTargetIndexes(e,t){return pl.resolve()}getDocumentsMatchingTarget(e,t){return pl.resolve(null)}getIndexType(e,t){return pl.resolve(0)}getFieldIndexes(e,t){return pl.resolve([])}getNextCollectionGroupToUpdate(e){return pl.resolve(null)}getMinOffset(e,t){return pl.resolve(cl.min())}getMinOffsetFromCollectionGroup(e,t){return pl.resolve(cl.min())}updateCollectionGroup(e,t,n){return pl.resolve()}updateIndexEntries(e,t){return pl.resolve()}}class Pp{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Jc(Fa.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new Jc(Fa.comparator)).toArray()}}const Ap="IndexedDbIndexManager",Rp=new Uint8Array(0);class Dp{constructor(e,t){this.databaseId=t,this.vn=new Pp,this.Cn=new Hd(e=>xd(e),(e,t)=>Sd(e,t)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const n=t.lastSegment(),r=t.popLast();e.addOnCommittedListener(()=>{this.vn.add(t)});const i={collectionId:n,parent:jl(r)};return Op(e).put(i)}return pl.resolve()}getCollectionParents(e,t){const n=[],r=IDBKeyRange.bound([t,""],[ja(t),""],!1,!0);return Op(e).j(r).next(e=>{for(const r of e){if(r.collectionId!==t)break;n.push(Fl(r.parent))}return n})}addFieldIndex(e,t){const n=Lp(e),r=function(e){return{indexId:e.indexId,collectionGroup:e.collectionGroup,fields:e.fields.map(e=>[e.fieldPath.canonicalString(),e.kind])}}(t);delete r.indexId;const i=n.add(r);if(t.indexState){const n=Mp(e);return i.next(e=>{n.put(Zf(e,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return i.next()}deleteFieldIndex(e,t){const n=Lp(e),r=Mp(e),i=jp(e);return n.delete(t.indexId).next(()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=Lp(e),n=jp(e),r=Mp(e);return t.Y().next(()=>n.Y()).next(()=>r.Y())}createTargetIndexes(e,t){return pl.forEach(this.Fn(t),t=>this.getIndexType(e,t).next(n=>{if(0===n||1===n){const n=new bp(t).bn();if(null!=n)return this.addFieldIndex(e,n)}}))}getDocumentsMatchingTarget(e,t){const n=jp(e);let r=!0;const i=new Map;return pl.forEach(this.Fn(t),t=>this.Mn(e,t).next(e=>{r&&(r=!!e),i.set(t,e)})).next(()=>{if(r){let e=nh();const r=[];return pl.forEach(i,(i,s)=>{la(Ap,`Using index ${function(e){return`id=${e.indexId}|cg=${e.collectionGroup}|f=${e.fields.map(e=>`${e.fieldPath}:${e.kind}`).join(",")}`}(i)} to execute ${xd(t)}`);const o=function(e,t){const n=rl(t);if(void 0===n)return null;for(const r of Td(e,n.fieldPath))switch(r.op){case"array-contains-any":return r.value.arrayValue.values||[];case"array-contains":return[r.value]}return null}(s,i),a=function(e,t){const n=new Map;for(const r of il(t))for(const t of Td(e,r.fieldPath))switch(t.op){case"==":case"in":n.set(r.fieldPath.canonicalString(),t.value);break;case"not-in":case"!=":return n.set(r.fieldPath.canonicalString(),t.value),Array.from(n.values())}return null}(s,i),l=function(e,t){const n=[];let r=!0;for(const i of il(t)){const t=0===i.kind?Ed(e,i.fieldPath,e.startAt):Cd(e,i.fieldPath,e.startAt);n.push(t.value),r&&(r=t.inclusive)}return new Yu(n,r)}(s,i),c=function(e,t){const n=[];let r=!0;for(const i of il(t)){const t=0===i.kind?Cd(e,i.fieldPath,e.endAt):Ed(e,i.fieldPath,e.endAt);n.push(t.value),r&&(r=t.inclusive)}return new Yu(n,r)}(s,i),u=this.xn(i,s,l),d=this.xn(i,s,c),h=this.On(i,s,a),f=this.Nn(i.indexId,o,u,l.inclusive,d,c.inclusive,h);return pl.forEach(f,i=>n.H(i,t.limit).next(t=>{t.forEach(t=>{const n=za.fromSegments(t.documentKey);e.has(n)||(e=e.add(n),r.push(n))})}))}).next(()=>r)}return pl.resolve(null)})}Fn(e){let t=this.Cn.get(e);return t||(t=0===e.filters.length?[e]:wp(rd.create(e.filters,"and")).map(t=>wd(e.path,e.collectionGroup,e.orderBy,t.getFilters(),e.limit,e.startAt,e.endAt)),this.Cn.set(e,t),t)}Nn(e,t,n,r,i,s,o){const a=(null!=t?t.length:1)*Math.max(n.length,i.length),l=a/(null!=t?t.length:1),c=[];for(let u=0;u<a;++u){const a=t?this.Bn(t[u/l]):Rp,d=this.Ln(e,a,n[u%l],r),h=this.kn(e,a,i[u%l],s),f=o.map(t=>this.Ln(e,a,t,!0));c.push(...this.createRange(d,h,f))}return c}Ln(e,t,n,r){const i=new pp(e,za.empty(),t,n);return r?i:i.En()}kn(e,t,n,r){const i=new pp(e,za.empty(),t,n);return r?i.En():i}Mn(e,t){const n=new bp(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next(e=>{let t=null;for(const r of e)n.pn(r)&&(!t||r.fields.length>t.fields.length)&&(t=r);return t})}getIndexType(e,t){let n=2;const r=this.Fn(t);return pl.forEach(r,t=>this.Mn(e,t).next(e=>{e?0!==n&&e.fields.length<function(e){let t=new Jc(Va.comparator),n=!1;for(const r of e.filters)for(const e of r.getFlattenedFilters())e.field.isKeyField()||("array-contains"===e.op||"array-contains-any"===e.op?n=!0:t=t.add(e.field));for(const r of e.orderBy)r.field.isKeyField()||(t=t.add(r.field));return t.size+(n?1:0)}(t)&&(n=1):n=0})).next(()=>function(e){return null!==e.limit}(t)&&r.length>1&&2===n?1:n)}qn(e,t){const n=new fp;for(const r of il(e)){const e=t.data.field(r.fieldPath);if(null==e)return null;const i=n.hn(r.kind);op.Ut.bt(e,i)}return n.an()}Bn(e){const t=new fp;return op.Ut.bt(e,t.hn(0)),t.an()}Qn(e,t){const n=new fp;return op.Ut.bt(Du(this.databaseId,t),n.hn(function(e){const t=il(e);return 0===t.length?0:t[t.length-1].kind}(e))),n.an()}On(e,t,n){if(null===n)return[];let r=[];r.push(new fp);let i=0;for(const s of il(e)){const e=n[i++];for(const n of r)if(this.$n(t,s.fieldPath)&&ju(e))r=this.Un(r,s,e);else{const t=n.hn(s.kind);op.Ut.bt(e,t)}}return this.Kn(r)}xn(e,t,n){return this.On(e,t,n.position)}Kn(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].an();return t}Un(e,t,n){const r=[...e],i=[];for(const s of n.arrayValue.values||[])for(const e of r){const n=new fp;n.seed(e.an()),op.Ut.bt(s,n.hn(t.kind)),i.push(n)}return i}$n(e,t){return!!e.filters.find(e=>e instanceof nd&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op))}getFieldIndexes(e,t){const n=Lp(e),r=Mp(e);return(t?n.j(_c,IDBKeyRange.bound(t,t)):n.j()).next(e=>{const t=[];return pl.forEach(e,e=>r.get([e.indexId,this.uid]).next(n=>{t.push(function(e,t){const n=t?new ol(t.sequenceNumber,new cl(Wf(t.readTime),new za(Fl(t.documentKey)),t.largestBatchId)):ol.empty(),r=e.fields.map(e=>{let[t,n]=e;return new sl(Va.fromServerFormat(t),n)});return new nl(e.indexId,e.collectionGroup,r,n)}(e,n))})).next(()=>t)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(e=>0===e.length?null:(e.sort((e,t)=>{const n=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!==n?n:Pa(e.collectionGroup,t.collectionGroup)}),e[0].collectionGroup))}updateCollectionGroup(e,t,n){const r=Lp(e),i=Mp(e);return this.Wn(e).next(e=>r.j(_c,IDBKeyRange.bound(t,t)).next(t=>pl.forEach(t,t=>i.put(Zf(t.indexId,this.uid,e,n)))))}updateIndexEntries(e,t){const n=new Map;return pl.forEach(t,(t,r)=>{const i=n.get(t.collectionGroup);return(i?pl.resolve(i):this.getFieldIndexes(e,t.collectionGroup)).next(i=>(n.set(t.collectionGroup,i),pl.forEach(i,n=>this.Gn(e,t,n).next(t=>{const i=this.zn(r,n);return t.isEqual(i)?pl.resolve():this.jn(e,r,n,t,i)}))))})}Jn(e,t,n,r){return jp(e).put(r.An(this.uid,this.Qn(n,t.key),t.key))}Hn(e,t,n,r){return jp(e).delete(r.Rn(this.uid,this.Qn(n,t.key),t.key))}Gn(e,t,n){const r=jp(e);let i=new Jc(mp);return r.X({index:Cc,range:IDBKeyRange.only([n.indexId,this.uid,vp(this.Qn(n,t))])},(e,r)=>{i=i.add(new pp(n.indexId,t,yp(r.arrayValue),yp(r.directionalValue)))}).next(()=>i)}zn(e,t){let n=new Jc(mp);const r=this.qn(t,e);if(null==r)return n;const i=rl(t);if(null!=i){const s=e.data.field(i.fieldPath);if(ju(s))for(const i of s.arrayValue.values||[])n=n.add(new pp(t.indexId,e.key,this.Bn(i),r))}else n=n.add(new pp(t.indexId,e.key,Rp,r));return n}jn(e,t,n,r,i){la(Ap,"Updating index entries for document '%s'",t.key);const s=[];return function(e,t,n,r,i){const s=e.getIterator(),o=t.getIterator();let a=eu(s),l=eu(o);for(;a||l;){let e=!1,t=!1;if(a&&l){const r=n(a,l);r<0?t=!0:r>0&&(e=!0)}else null!=a?t=!0:e=!0;e?(r(l),l=eu(o)):t?(i(a),a=eu(s)):(a=eu(s),l=eu(o))}}(r,i,mp,r=>{s.push(this.Jn(e,t,n,r))},r=>{s.push(this.Hn(e,t,n,r))}),pl.waitFor(s)}Wn(e){let t=1;return Mp(e).X({index:Sc,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(e,n,r)=>{r.done(),t=n.sequenceNumber+1}).next(()=>t)}createRange(e,t,n){n=n.sort((e,t)=>mp(e,t)).filter((e,t,n)=>!t||0!==mp(e,n[t-1]));const r=[];r.push(e);for(const s of n){const n=mp(s,e),i=mp(s,t);if(0===n)r[0]=e.En();else if(n>0&&i<0)r.push(s),r.push(s.En());else if(i>0)break}r.push(t);const i=[];for(let s=0;s<r.length;s+=2){if(this.Yn(r[s],r[s+1]))return[];const e=r[s].Rn(this.uid,Rp,za.empty()),t=r[s+1].Rn(this.uid,Rp,za.empty());i.push(IDBKeyRange.bound(e,t))}return i}Yn(e,t){return mp(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Fp)}getMinOffset(e,t){return pl.mapArray(this.Fn(t),t=>this.Mn(e,t).next(e=>e||ha(44426))).next(Fp)}}function Op(e){return Hc(e,pc)}function jp(e){return Hc(e,Tc)}function Lp(e){return Hc(e,bc)}function Mp(e){return Hc(e,wc)}function Fp(e){pa(0!==e.length,28825);let t=e[0].indexState.offset,n=t.largestBatchId;for(let r=1;r<e.length;r++){const i=e[r].indexState.offset;ul(i,t)<0&&(t=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new cl(t.readTime,t.documentKey,n)}const Up={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Vp=41943040;class zp{static withCacheSize(e){return new zp(e,zp.DEFAULT_COLLECTION_PERCENTILE,zp.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}function $p(e,t,n){const r=e.store(ql),i=e.store(Yl),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=r.X({range:o},(e,t,n)=>(a++,n.delete()));s.push(l.next(()=>{pa(1===a,47070,{batchId:n.batchId})}));const c=[];for(const u of n.mutations){const e=Gl(t,u.key.path,n.batchId);s.push(i.delete(e)),c.push(u.key)}return pl.waitFor(s).next(()=>c)}function qp(e){if(!e)return 0;let t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw ha(14731);t=e.noDocument}return JSON.stringify(t).length}zp.DEFAULT_COLLECTION_PERCENTILE=10,zp.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,zp.DEFAULT=new zp(Vp,zp.DEFAULT_COLLECTION_PERCENTILE,zp.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),zp.DISABLED=new zp(-1,0,0);class Bp{constructor(e,t,n,r){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=r,this.Zn={}}static yt(e,t,n,r){pa(""!==e.uid,64387);const i=e.isAuthenticated()?e.uid:"";return new Bp(i,t,n,r)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Wp(e).X({index:Hl,range:n},(e,n,r)=>{t=!1,r.done()}).next(()=>t)}addMutationBatch(e,t,n,r){const i=Kp(e),s=Wp(e);return s.add({}).next(o=>{pa("number"==typeof o,49019);const a=new Mh(o,t,n,r),l=function(e,t,n){const r=n.baseMutations.map(t=>Cf(e.gt,t)),i=n.mutations.map(t=>Cf(e.gt,t));return{userId:t,batchId:n.batchId,localWriteTimeMs:n.localWriteTime.toMillis(),baseMutations:r,mutations:i}}(this.serializer,this.userId,a),c=[];let u=new Jc((e,t)=>Pa(e.canonicalString(),t.canonicalString()));for(const e of r){const t=Gl(this.userId,e.key.path,o);u=u.add(e.key.path.popLast()),c.push(s.put(l)),c.push(i.put(t,Ql))}return u.forEach(t=>{c.push(this.indexManager.addToCollectionParentIndex(e,t))}),e.addOnCommittedListener(()=>{this.Zn[o]=a.keys()}),pl.waitFor(c).next(()=>a)})}lookupMutationBatch(e,t){return Wp(e).get(t).next(e=>e?(pa(e.userId===this.userId,48,"Unexpected user for mutation batch",{userId:e.userId,batchId:t}),Kf(this.serializer,e)):null)}Xn(e,t){return this.Zn[t]?pl.resolve(this.Zn[t]):this.lookupMutationBatch(e,t).next(e=>{if(e){const n=e.keys();return this.Zn[t]=n,n}return null})}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=IDBKeyRange.lowerBound([this.userId,n]);let i=null;return Wp(e).X({index:Hl,range:r},(e,t,r)=>{t.userId===this.userId&&(pa(t.batchId>=n,47524,{er:n}),i=Kf(this.serializer,t)),r.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=Pl;return Wp(e).X({index:Hl,range:t,reverse:!0},(e,t,r)=>{n=t.batchId,r.done()}).next(()=>n)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Pl],[this.userId,Number.POSITIVE_INFINITY]);return Wp(e).j(Hl,t).next(e=>e.map(e=>Kf(this.serializer,e)))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=Kl(this.userId,t.path),r=IDBKeyRange.lowerBound(n),i=[];return Kp(e).X({range:r},(n,r,s)=>{const[o,a,l]=n,c=Fl(a);if(o===this.userId&&t.path.isEqual(c))return Wp(e).get(l).next(e=>{if(!e)throw ha(61480,{tr:n,batchId:l});pa(e.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:e.userId,batchId:l}),i.push(Kf(this.serializer,e))});s.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Jc(Pa);const r=[];return t.forEach(t=>{const i=Kl(this.userId,t.path),s=IDBKeyRange.lowerBound(i),o=Kp(e).X({range:s},(e,r,i)=>{const[s,o,a]=e,l=Fl(o);s===this.userId&&t.path.isEqual(l)?n=n.add(a):i.done()});r.push(o)}),pl.waitFor(r).next(()=>this.nr(e,n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1,i=Kl(this.userId,n),s=IDBKeyRange.lowerBound(i);let o=new Jc(Pa);return Kp(e).X({range:s},(e,t,i)=>{const[s,a,l]=e,c=Fl(a);s===this.userId&&n.isPrefixOf(c)?c.length===r&&(o=o.add(l)):i.done()}).next(()=>this.nr(e,o))}nr(e,t){const n=[],r=[];return t.forEach(t=>{r.push(Wp(e).get(t).next(e=>{if(null===e)throw ha(35274,{batchId:t});pa(e.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:e.userId,batchId:t}),n.push(Kf(this.serializer,e))}))}),pl.waitFor(r).next(()=>n)}removeMutationBatch(e,t){return $p(e.ce,this.userId,t).next(n=>(e.addOnCommittedListener(()=>{this.rr(t.batchId)}),pl.forEach(n,t=>this.referenceDelegate.markPotentiallyOrphaned(e,t))))}rr(e){delete this.Zn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return pl.resolve();const n=IDBKeyRange.lowerBound(function(e){return[e]}(this.userId)),r=[];return Kp(e).X({range:n},(e,t,n)=>{if(e[0]===this.userId){const t=Fl(e[1]);r.push(t)}else n.done()}).next(()=>{pa(0===r.length,56720,{ir:r.map(e=>e.canonicalString())})})})}containsKey(e,t){return Hp(e,this.userId,t)}sr(e){return Gp(e).get(this.userId).next(e=>e||{userId:this.userId,lastAcknowledgedBatchId:Pl,lastStreamToken:""})}}function Hp(e,t,n){const r=Kl(t,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return Kp(e).X({range:s,Z:!0},(e,n,r)=>{const[s,a,l]=e;s===t&&a===i&&(o=!0),r.done()}).next(()=>o)}function Wp(e){return Hc(e,ql)}function Kp(e){return Hc(e,Yl)}function Gp(e){return Hc(e,$l)}class Qp{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new Qp(0)}static ur(){return new Qp(-1)}}class Yp{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.cr(e).next(t=>{const n=new Qp(t.highestTargetId);return t.highestTargetId=n.next(),this.lr(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.cr(e).next(e=>el.fromTimestamp(new Za(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.cr(e).next(e=>e.highestListenSequenceNumber)}setTargetsMetadata(e,t,n){return this.cr(e).next(r=>(r.highestListenSequenceNumber=t,n&&(r.lastRemoteSnapshotVersion=n.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.lr(e,r)))}addTargetData(e,t){return this.hr(e,t).next(()=>this.cr(e).next(n=>(n.targetCount+=1,this.Pr(t,n),this.lr(e,n))))}updateTargetData(e,t){return this.hr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Xp(e).delete(t.targetId)).next(()=>this.cr(e)).next(t=>(pa(t.targetCount>0,8065),t.targetCount-=1,this.lr(e,t)))}removeTargets(e,t,n){let r=0;const i=[];return Xp(e).X((s,o)=>{const a=Gf(o);a.sequenceNumber<=t&&null===n.get(a.targetId)&&(r++,i.push(this.removeTargetData(e,a)))}).next(()=>pl.waitFor(i)).next(()=>r)}forEachTarget(e,t){return Xp(e).X((e,n)=>{const r=Gf(n);t(r)})}cr(e){return Jp(e).get(hc).next(e=>(pa(null!==e,2888),e))}lr(e,t){return Jp(e).put(hc,t)}hr(e,t){return Xp(e).put(Qf(this.serializer,t))}Pr(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.cr(e).next(e=>e.targetCount)}getTargetData(e,t){const n=xd(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let i=null;return Xp(e).X({range:r,index:oc},(e,n,r)=>{const s=Gf(n);Sd(t,s.target)&&(i=s,r.done())}).next(()=>i)}addMatchingKeys(e,t,n){const r=[],i=Zp(e);return t.forEach(t=>{const s=jl(t.path);r.push(i.put({targetId:n,path:s})),r.push(this.referenceDelegate.addReference(e,n,t))}),pl.waitFor(r)}removeMatchingKeys(e,t,n){const r=Zp(e);return pl.forEach(t,t=>{const i=jl(t.path);return pl.waitFor([r.delete([n,i]),this.referenceDelegate.removeReference(e,n,t)])})}removeMatchingKeysForTargetId(e,t){const n=Zp(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),r=Zp(e);let i=nh();return r.X({range:n,Z:!0},(e,t,n)=>{const r=Fl(e[1]),s=new za(r);i=i.add(s)}).next(()=>i)}containsKey(e,t){const n=jl(t.path),r=IDBKeyRange.bound([n],[ja(n)],!1,!0);let i=0;return Zp(e).X({index:uc,Z:!0,range:r},(e,t,n)=>{let[r,s]=e;0!==r&&(i++,n.done())}).next(()=>i>0)}Et(e,t){return Xp(e).get(t).next(e=>e?Gf(e):null)}}function Xp(e){return Hc(e,sc)}function Jp(e){return Hc(e,fc)}function Zp(e){return Hc(e,lc)}const em="LruGarbageCollector",tm=1048576;function nm(e,t){let[n,r]=e,[i,s]=t;const o=Pa(n,i);return 0===o?Pa(r,s):o}class rm{constructor(e){this.Tr=e,this.buffer=new Jc(nm),this.Ir=0}dr(){return++this.Ir}Er(e){const t=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();nm(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class im{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Ar=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return null!==this.Ar}Rr(e){la(em,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){wl(e)?la(em,"Ignoring IndexedDB error during garbage collection: ",e):await fl(e)}await this.Rr(3e5)})}}class sm{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.mr(e).next(e=>Math.floor(t/100*e))}nthSequenceNumber(e,t){if(0===t)return pl.resolve(Il.ue);const n=new rm(t);return this.Vr.forEachTarget(e,e=>n.Er(e.sequenceNumber)).next(()=>this.Vr.gr(e,e=>n.Er(e))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.Vr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(la("LruGarbageCollector","Garbage collection skipped; disabled"),pl.resolve(Up)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(la("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Up):this.pr(e,t))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,t){let n,r,i,s,o,a,l;const c=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(t=>(t>this.params.maximumSequenceNumbersToCollect?(la("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),r=this.params.maximumSequenceNumbersToCollect):r=t,s=Date.now(),this.nthSequenceNumber(e,r))).next(r=>(n=r,o=Date.now(),this.removeTargets(e,n,t))).next(t=>(i=t,a=Date.now(),this.removeOrphanedDocuments(e,n))).next(e=>(l=Date.now(),aa()<=$t.DEBUG&&la("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${s-c}ms\n\tDetermined least recently used ${r} in `+(o-s)+"ms\n"+`\tRemoved ${i} targets in `+(a-o)+"ms\n"+`\tRemoved ${e} documents in `+(l-a)+"ms\n"+`Total Duration: ${l-c}ms`),pl.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e})))}}function om(e,t){return new sm(e,t)}class am{constructor(e,t){this.db=e,this.garbageCollector=om(this,t)}mr(e){const t=this.yr(e);return this.db.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}yr(e){let t=0;return this.gr(e,e=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}gr(e,t){return this.wr(e,(e,n)=>t(n))}addReference(e,t,n){return lm(e,n)}removeReference(e,t,n){return lm(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return lm(e,t)}Sr(e,t){return function(e,t){let n=!1;return Gp(e).ee(r=>Hp(e,r,t).next(e=>(e&&(n=!0),pl.resolve(!e)))).next(()=>n)}(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let i=0;return this.wr(e,(s,o)=>{if(o<=t){const t=this.Sr(e,s).next(t=>{if(!t)return i++,n.getEntry(e,s).next(()=>(n.removeEntry(s,el.min()),Zp(e).delete(function(e){return[0,jl(e.path)]}(s))))});r.push(t)}}).next(()=>pl.waitFor(r)).next(()=>n.apply(e)).next(()=>i)}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return lm(e,t)}wr(e,t){const n=Zp(e);let r,i=Il.ue;return n.X({index:uc},(e,n)=>{let[s,o]=e,{path:a,sequenceNumber:l}=n;0===s?(i!==Il.ue&&t(new za(Fl(r)),i),i=l,r=a):i=Il.ue}).next(()=>{i!==Il.ue&&t(new za(Fl(r)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function lm(e,t){return Zp(e).put(function(e,t){return{targetId:0,path:jl(e.path),sequenceNumber:t}}(t,e.currentSequenceNumber))}class cm{constructor(){this.changes=new Hd(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Qu.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?pl.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class um{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return pm(e).put(n)}removeEntry(e,t,n){return pm(e).delete(function(e,t){const n=e.path.toArray();return[n.slice(0,n.length-2),n[n.length-2],Bf(t),n[n.length-1]]}(t,n))}updateMetadata(e,t){return this.getMetadata(e).next(n=>(n.byteSize+=t,this.br(e,n)))}getEntry(e,t){let n=Qu.newInvalidDocument(t);return pm(e).X({index:Zl,range:IDBKeyRange.only(mm(t))},(e,r)=>{n=this.Dr(t,r)}).next(()=>n)}vr(e,t){let n={size:0,document:Qu.newInvalidDocument(t)};return pm(e).X({index:Zl,range:IDBKeyRange.only(mm(t))},(e,r)=>{n={document:this.Dr(t,r),size:qp(r)}}).next(()=>n)}getEntries(e,t){let n=Kd();return this.Cr(e,t,(e,t)=>{const r=this.Dr(e,t);n=n.insert(e,r)}).next(()=>n)}Fr(e,t){let n=Kd(),r=new Qc(za.comparator);return this.Cr(e,t,(e,t)=>{const i=this.Dr(e,t);n=n.insert(e,i),r=r.insert(e,qp(t))}).next(()=>({documents:n,Mr:r}))}Cr(e,t,n){if(t.isEmpty())return pl.resolve();let r=new Jc(vm);t.forEach(e=>r=r.add(e));const i=IDBKeyRange.bound(mm(r.first()),mm(r.last())),s=r.getIterator();let o=s.getNext();return pm(e).X({index:Zl,range:i},(e,t,r)=>{const i=za.fromSegments([...t.prefixPath,t.collectionGroup,t.documentId]);for(;o&&vm(o,i)<0;)n(o,null),o=s.getNext();o&&o.isEqual(i)&&(n(o,t),o=s.hasNext()?s.getNext():null),o?r.G(mm(o)):r.done()}).next(()=>{for(;o;)n(o,null),o=s.hasNext()?s.getNext():null})}getDocumentsMatchingQuery(e,t,n,r,i){const s=t.path,o=[s.popLast().toArray(),s.lastSegment(),Bf(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],a=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return pm(e).j(IDBKeyRange.bound(o,a,!0)).next(e=>{null==i||i.incrementDocumentReadCount(e.length);let n=Kd();for(const i of e){const e=this.Dr(za.fromSegments(i.prefixPath.concat(i.collectionGroup,i.documentId)),i);e.isFoundDocument()&&(zd(t,e)||r.has(e.key))&&(n=n.insert(e.key,e))}return n})}getAllFromCollectionGroup(e,t,n,r){let i=Kd();const s=gm(t,n),o=gm(t,cl.max());return pm(e).X({index:tc,range:IDBKeyRange.bound(s,o,!0)},(e,t,n)=>{const s=this.Dr(za.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);i=i.insert(s.key,s),i.size===r&&n.done()}).next(()=>i)}newChangeBuffer(e){return new hm(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(e=>e.byteSize)}getMetadata(e){return fm(e).get(ic).next(e=>(pa(!!e,20021),e))}br(e,t){return fm(e).put(ic,t)}Dr(e,t){if(t){const e=function(e,t){let n;if(t.document)n=Ef(e.gt,t.document,!!t.hasCommittedMutations);else if(t.noDocument){const e=za.fromSegments(t.noDocument.path),r=Wf(t.noDocument.readTime);n=Qu.newNoDocument(e,r),t.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!t.unknownDocument)return ha(56709);{const e=za.fromSegments(t.unknownDocument.path),r=Wf(t.unknownDocument.version);n=Qu.newUnknownDocument(e,r)}}return t.readTime&&n.setReadTime(function(e){const t=new Za(e[0],e[1]);return el.fromTimestamp(t)}(t.readTime)),n}(this.serializer,t);if(!e.isNoDocument()||!e.version.isEqual(el.min()))return e}return Qu.newInvalidDocument(e)}}function dm(e){return new um(e)}class hm extends cm{constructor(e,t){super(),this.Or=e,this.trackRemovals=t,this.Nr=new Hd(e=>e.toString(),(e,t)=>e.isEqual(t))}applyChanges(e){const t=[];let n=0,r=new Jc((e,t)=>Pa(e.canonicalString(),t.canonicalString()));return this.changes.forEach((i,s)=>{const o=this.Nr.get(i);if(t.push(this.Or.removeEntry(e,i,o.readTime)),s.isValidDocument()){const a=qf(this.Or.serializer,s);r=r.add(i.path.popLast());const l=qp(a);n+=l-o.size,t.push(this.Or.addEntry(e,i,a))}else if(n-=o.size,this.trackRemovals){const n=qf(this.Or.serializer,s.convertToNoDocument(el.min()));t.push(this.Or.addEntry(e,i,n))}}),r.forEach(n=>{t.push(this.Or.indexManager.addToCollectionParentIndex(e,n))}),t.push(this.Or.updateMetadata(e,n)),pl.waitFor(t)}getFromCache(e,t){return this.Or.vr(e,t).next(e=>(this.Nr.set(t,{size:e.size,readTime:e.document.readTime}),e.document))}getAllFromCache(e,t){return this.Or.Fr(e,t).next(e=>{let{documents:t,Mr:n}=e;return n.forEach((e,n)=>{this.Nr.set(e,{size:n,readTime:t.get(e).readTime})}),t})}}function fm(e){return Hc(e,rc)}function pm(e){return Hc(e,Xl)}function mm(e){const t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function gm(e,t){const n=t.documentKey.path.toArray();return[e,Bf(t.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function vm(e,t){const n=e.path.toArray(),r=t.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=Pa(n[s],r[s]),i)return i;return i=Pa(n.length,r.length),i||(i=Pa(n[n.length-2],r[r.length-2]),i||Pa(n[n.length-1],r[r.length-1]))}class ym{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class bm{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==n&&Ch(n.mutation,e,tu.empty(),Za.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,nh()).next(()=>t))}getLocalViewOfDocuments(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:nh();const r=Xd();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(e=>{let t=Qd();return e.forEach((e,n)=>{t=t.insert(e,n.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){const n=Xd();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,nh()))}populateOverlays(e,t,n){const r=[];return n.forEach(e=>{t.has(e)||r.push(e)}),this.documentOverlayCache.getOverlays(e,r).next(e=>{e.forEach((e,n)=>{t.set(e,n)})})}computeViews(e,t,n,r){let i=Kd();const s=Zd(),o=Zd();return t.forEach((e,t)=>{const o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof Ah)?i=i.insert(t.key,t):void 0!==o?(s.set(t.key,o.mutation.getFieldMask()),Ch(o.mutation,t,o.mutation.getFieldMask(),Za.now())):s.set(t.key,tu.empty())}),this.recalculateAndSaveOverlays(e,i).next(e=>(e.forEach((e,t)=>s.set(e,t)),t.forEach((e,t)=>{var n;return o.set(e,new ym(t,null!==(n=s.get(e))&&void 0!==n?n:null))}),o))}recalculateAndSaveOverlays(e,t){const n=Zd();let r=new Qc((e,t)=>e-t),i=nh();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(const i of e)i.keys().forEach(e=>{const s=t.get(e);if(null===s)return;let o=n.get(e)||tu.empty();o=i.applyToLocalView(s,o),n.set(e,o);const a=(r.get(i.batchId)||nh()).add(e);r=r.insert(i.batchId,a)})}).next(()=>{const s=[],o=r.getReverseIterator();for(;o.hasNext();){const r=o.getNext(),a=r.key,l=r.value,c=Jd();l.forEach(e=>{if(!i.has(e)){const r=Th(t.get(e),n.get(e));null!==r&&c.set(e,r),i=i.add(e)}}),s.push(this.documentOverlayCache.saveOverlays(e,a,c))}return pl.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return za.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Rd(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(i=>{const s=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):pl.resolve(Xd());let o=tl,a=i;return s.next(t=>pl.forEach(t,(t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),i.get(t)?pl.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{a=a.insert(t,e)}))).next(()=>this.populateOverlays(e,t,i)).next(()=>this.computeViews(e,a,t,nh())).next(e=>({batchId:o,changes:Yd(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new za(t)).next(e=>{let t=Qd();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const i=t.collectionGroup;let s=Qd();return this.indexManager.getCollectionParents(e,i).next(o=>pl.forEach(o,o=>{const a=function(e,t){return new Nd(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,o.child(i));return this.getDocumentsMatchingCollectionQuery(e,a,n,r).next(e=>{e.forEach((e,t)=>{s=s.insert(e,t)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,r))).next(e=>{i.forEach((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,Qu.newInvalidDocument(r)))});let n=Qd();return e.forEach((e,r)=>{const s=i.get(e);void 0!==s&&Ch(s.mutation,r,tu.empty(),Za.now()),zd(t,r)&&(n=n.insert(e,r))}),n})}}class _m{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,t){return pl.resolve(this.Br.get(t))}saveBundleMetadata(e,t){return this.Br.set(t.id,function(e){return{id:e.id,version:e.version,createTime:mf(e.createTime)}}(t)),pl.resolve()}getNamedQuery(e,t){return pl.resolve(this.Lr.get(t))}saveNamedQuery(e,t){return this.Lr.set(t.name,function(e){return{name:e.name,query:Yf(e.bundledQuery),readTime:mf(e.readTime)}}(t)),pl.resolve()}}class wm{constructor(){this.overlays=new Qc(za.comparator),this.kr=new Map}getOverlay(e,t){return pl.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Xd();return pl.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((n,r)=>{this.wt(e,t,r)}),pl.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.kr.get(n);return void 0!==r&&(r.forEach(e=>this.overlays=this.overlays.remove(e)),this.kr.delete(n)),pl.resolve()}getOverlaysForCollection(e,t,n){const r=Xd(),i=t.length+1,s=new za(t.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const e=o.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return pl.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new Qc((e,t)=>e-t);const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=Xd(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const o=Xd(),a=i.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach((e,t)=>o.set(e,t)),!(o.size()>=r)););return pl.resolve(o)}wt(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.kr.get(r.largestBatchId).delete(n.key);this.kr.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new Uh(t,n));let i=this.kr.get(t);void 0===i&&(i=nh(),this.kr.set(t,i)),this.kr.set(t,i.add(n.key))}}class xm{constructor(){this.sessionToken=ru.EMPTY_BYTE_STRING}getSessionToken(e){return pl.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,pl.resolve()}}class Sm{constructor(){this.qr=new Jc(km.Qr),this.$r=new Jc(km.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,t){const n=new km(e,t);this.qr=this.qr.add(n),this.$r=this.$r.add(n)}Kr(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.Wr(new km(e,t))}Gr(e,t){e.forEach(e=>this.removeReference(e,t))}zr(e){const t=new za(new Fa([])),n=new km(t,e),r=new km(t,e+1),i=[];return this.$r.forEachInRange([n,r],e=>{this.Wr(e),i.push(e.key)}),i}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const t=new za(new Fa([])),n=new km(t,e),r=new km(t,e+1);let i=nh();return this.$r.forEachInRange([n,r],e=>{i=i.add(e.key)}),i}containsKey(e){const t=new km(e,0),n=this.qr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class km{constructor(e,t){this.key=e,this.Hr=t}static Qr(e,t){return za.comparator(e.key,t.key)||Pa(e.Hr,t.Hr)}static Ur(e,t){return Pa(e.Hr,t.Hr)||za.comparator(e.key,t.key)}}class Tm{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.er=1,this.Yr=new Jc(km.Qr)}checkEmpty(e){return pl.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const i=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new Mh(i,t,n,r);this.mutationQueue.push(s);for(const o of r)this.Yr=this.Yr.add(new km(o.key,i)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return pl.resolve(s)}lookupMutationBatch(e,t){return pl.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.Xr(n),i=r<0?0:r;return pl.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return pl.resolve(0===this.mutationQueue.length?Pl:this.er-1)}getAllMutationBatches(e){return pl.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new km(t,0),r=new km(t,Number.POSITIVE_INFINITY),i=[];return this.Yr.forEachInRange([n,r],e=>{const t=this.Zr(e.Hr);i.push(t)}),pl.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Jc(Pa);return t.forEach(e=>{const t=new km(e,0),r=new km(e,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([t,r],e=>{n=n.add(e.Hr)})}),pl.resolve(this.ei(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;za.isDocumentKey(i)||(i=i.child(""));const s=new km(new za(i),0);let o=new Jc(Pa);return this.Yr.forEachWhile(e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.Hr)),!0)},s),pl.resolve(this.ei(o))}ei(e){const t=[];return e.forEach(e=>{const n=this.Zr(e);null!==n&&t.push(n)}),t}removeMutationBatch(e,t){pa(0===this.ti(t.batchId,"removed"),55003),this.mutationQueue.shift();let n=this.Yr;return pl.forEach(t.mutations,r=>{const i=new km(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Yr=n})}rr(e){}containsKey(e,t){const n=new km(t,0),r=this.Yr.firstAfterOrEqual(n);return pl.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,pl.resolve()}ti(e,t){return this.Xr(e)}Xr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Em{constructor(e){this.ni=e,this.docs=new Qc(za.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,s=this.ni(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return pl.resolve(n?n.document.mutableCopy():Qu.newInvalidDocument(t))}getEntries(e,t){let n=Kd();return t.forEach(e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():Qu.newInvalidDocument(e))}),pl.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=Kd();const s=t.path,o=new za(s.child("__id-9223372036854775808__")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:e,value:{document:o}}=a.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||ul(ll(o),n)<=0||(r.has(o.key)||zd(t,o))&&(i=i.insert(o.key,o.mutableCopy()))}return pl.resolve(i)}getAllFromCollectionGroup(e,t,n,r){ha(9500)}ri(e,t){return pl.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new Cm(this)}getSize(e){return pl.resolve(this.size)}}class Cm extends cm{constructor(e){super(),this.Or=e}applyChanges(e){const t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.Or.addEntry(e,r)):this.Or.removeEntry(n)}),pl.waitFor(t)}getFromCache(e,t){return this.Or.getEntry(e,t)}getAllFromCache(e,t){return this.Or.getEntries(e,t)}}class Nm{constructor(e){this.persistence=e,this.ii=new Hd(e=>xd(e),Sd),this.lastRemoteSnapshotVersion=el.min(),this.highestTargetId=0,this.si=0,this.oi=new Sm,this.targetCount=0,this._i=Qp.ar()}forEachTarget(e,t){return this.ii.forEach((e,n)=>t(n)),pl.resolve()}getLastRemoteSnapshotVersion(e){return pl.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return pl.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),pl.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.si&&(this.si=t),pl.resolve()}hr(e){this.ii.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this._i=new Qp(t),this.highestTargetId=t),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,t){return this.hr(t),this.targetCount+=1,pl.resolve()}updateTargetData(e,t){return this.hr(t),pl.resolve()}removeTargetData(e,t){return this.ii.delete(t.target),this.oi.zr(t.targetId),this.targetCount-=1,pl.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.ii.forEach((s,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.ii.delete(s),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)}),pl.waitFor(i).next(()=>r)}getTargetCount(e){return pl.resolve(this.targetCount)}getTargetData(e,t){const n=this.ii.get(t)||null;return pl.resolve(n)}addMatchingKeys(e,t,n){return this.oi.Kr(t,n),pl.resolve()}removeMatchingKeys(e,t,n){this.oi.Gr(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(t=>{i.push(r.markPotentiallyOrphaned(e,t))}),pl.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.oi.zr(t),pl.resolve()}getMatchingKeysForTargetId(e,t){const n=this.oi.Jr(t);return pl.resolve(n)}containsKey(e,t){return pl.resolve(this.oi.containsKey(t))}}class Im{constructor(e,t){this.ai={},this.overlays={},this.ui=new Il(0),this.ci=!1,this.ci=!0,this.li=new xm,this.referenceDelegate=e(this),this.hi=new Nm(this),this.indexManager=new Ip,this.remoteDocumentCache=function(e){return new Em(e)}(e=>this.referenceDelegate.Pi(e)),this.serializer=new $f(t),this.Ti=new _m(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new wm,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ai[e.toKey()];return n||(n=new Tm(t,this.referenceDelegate),this.ai[e.toKey()]=n),n}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,t,n){la("MemoryPersistence","Starting transaction:",e);const r=new Pm(this.ui.next());return this.referenceDelegate.Ii(),n(r).next(e=>this.referenceDelegate.di(r).next(()=>e)).toPromise().then(e=>(r.raiseOnCommittedEvent(),e))}Ei(e,t){return pl.or(Object.values(this.ai).map(n=>()=>n.containsKey(e,t)))}}class Pm extends hl{constructor(e){super(),this.currentSequenceNumber=e}}class Am{constructor(e){this.persistence=e,this.Ai=new Sm,this.Ri=null}static Vi(e){return new Am(e)}get mi(){if(this.Ri)return this.Ri;throw ha(60996)}addReference(e,t,n){return this.Ai.addReference(n,t),this.mi.delete(n.toString()),pl.resolve()}removeReference(e,t,n){return this.Ai.removeReference(n,t),this.mi.add(n.toString()),pl.resolve()}markPotentiallyOrphaned(e,t){return this.mi.add(t.toString()),pl.resolve()}removeTarget(e,t){this.Ai.zr(t.targetId).forEach(e=>this.mi.add(e.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.mi.add(e.toString()))}).next(()=>n.removeTargetData(e,t))}Ii(){this.Ri=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return pl.forEach(this.mi,n=>{const r=za.fromPath(n);return this.fi(e,r).next(e=>{e||t.removeEntry(r,el.min())})}).next(()=>(this.Ri=null,t.apply(e)))}updateLimboDocument(e,t){return this.fi(e,t).next(e=>{e?this.mi.delete(t.toString()):this.mi.add(t.toString())})}Pi(e){return 0}fi(e,t){return pl.or([()=>pl.resolve(this.Ai.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class Rm{constructor(e,t){this.persistence=e,this.gi=new Hd(e=>jl(e.path),(e,t)=>e.isEqual(t)),this.garbageCollector=om(this,t)}static Vi(e,t){return new Rm(e,t)}Ii(){}di(e){return pl.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}mr(e){const t=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}yr(e){let t=0;return this.gr(e,e=>{t++}).next(()=>t)}gr(e,t){return pl.forEach(this.gi,(n,r)=>this.Sr(e,n,r).next(e=>e?pl.resolve():t(r)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.ri(e,r=>this.Sr(e,r,t).next(e=>{e||(n++,i.removeEntry(r,el.min()))})).next(()=>i.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.gi.set(t,e.currentSequenceNumber),pl.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.gi.set(n,e.currentSequenceNumber),pl.resolve()}removeReference(e,t,n){return this.gi.set(n,e.currentSequenceNumber),pl.resolve()}updateLimboDocument(e,t){return this.gi.set(t,e.currentSequenceNumber),pl.resolve()}Pi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Ru(e.data.value)),t}Sr(e,t,n){return pl.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const e=this.gi.get(t);return pl.resolve(void 0!==e&&e>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Dm{constructor(e){this.serializer=e}q(e,t,n,r){const i=new gl("createOrUpgrade",t);n<1&&r>=1&&(function(e){e.createObjectStore(Vl)}(e),function(e){e.createObjectStore($l,{keyPath:"userId"});e.createObjectStore(ql,{keyPath:Bl,autoIncrement:!0}).createIndex(Hl,Wl,{unique:!0}),e.createObjectStore(Yl)}(e),Om(e),function(e){e.createObjectStore(Ul)}(e));let s=pl.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore(lc),e.deleteObjectStore(sc),e.deleteObjectStore(fc)}(e),Om(e)),s=s.next(()=>function(e){const t=e.store(fc),n={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:el.min().toTimestamp(),targetCount:0};return t.put(hc,n)}(i))),n<4&&r>=4&&(0!==n&&(s=s.next(()=>function(e,t){return t.store(ql).j().next(n=>{e.deleteObjectStore(ql),e.createObjectStore(ql,{keyPath:Bl,autoIncrement:!0}).createIndex(Hl,Wl,{unique:!0});const r=t.store(ql),i=n.map(e=>r.put(e));return pl.waitFor(i)})}(e,i))),s=s.next(()=>{!function(e){e.createObjectStore(gc,{keyPath:"clientId"})}(e)})),n<5&&r>=5&&(s=s.next(()=>this.pi(i))),n<6&&r>=6&&(s=s.next(()=>(function(e){e.createObjectStore(rc)}(e),this.yi(i)))),n<7&&r>=7&&(s=s.next(()=>this.wi(i))),n<8&&r>=8&&(s=s.next(()=>this.Si(e,i))),n<9&&r>=9&&(s=s.next(()=>{!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e)})),n<10&&r>=10&&(s=s.next(()=>this.bi(i))),n<11&&r>=11&&(s=s.next(()=>{!function(e){e.createObjectStore(vc,{keyPath:"bundleId"})}(e),function(e){e.createObjectStore(yc,{keyPath:"name"})}(e)})),n<12&&r>=12&&(s=s.next(()=>{!function(e){const t=e.createObjectStore(Ic,{keyPath:Pc});t.createIndex(Ac,Rc,{unique:!1}),t.createIndex(Dc,Oc,{unique:!1})}(e)})),n<13&&r>=13&&(s=s.next(()=>function(e){const t=e.createObjectStore(Xl,{keyPath:Jl});t.createIndex(Zl,ec),t.createIndex(tc,nc)}(e)).next(()=>this.Di(e,i)).next(()=>e.deleteObjectStore(Ul))),n<14&&r>=14&&(s=s.next(()=>this.Ci(e,i))),n<15&&r>=15&&(s=s.next(()=>function(e){e.createObjectStore(bc,{keyPath:"indexId",autoIncrement:!0}).createIndex(_c,"collectionGroup",{unique:!1});e.createObjectStore(wc,{keyPath:xc}).createIndex(Sc,kc,{unique:!1});e.createObjectStore(Tc,{keyPath:Ec}).createIndex(Cc,Nc,{unique:!1})}(e))),n<16&&r>=16&&(s=s.next(()=>{t.objectStore(wc).clear()}).next(()=>{t.objectStore(Tc).clear()})),n<17&&r>=17&&(s=s.next(()=>{!function(e){e.createObjectStore(jc,{keyPath:"name"})}(e)})),n<18&&r>=18&&pt()&&(s=s.next(()=>{t.objectStore(wc).clear()}).next(()=>{t.objectStore(Tc).clear()})),s}yi(e){let t=0;return e.store(Ul).X((e,n)=>{t+=qp(n)}).next(()=>{const n={byteSize:t};return e.store(rc).put(ic,n)})}pi(e){const t=e.store($l),n=e.store(ql);return t.j().next(t=>pl.forEach(t,t=>{const r=IDBKeyRange.bound([t.userId,Pl],[t.userId,t.lastAcknowledgedBatchId]);return n.j(Hl,r).next(n=>pl.forEach(n,n=>{pa(n.userId===t.userId,18650,"Cannot process batch from unexpected user",{batchId:n.batchId});const r=Kf(this.serializer,n);return $p(e,t.userId,r).next(()=>{})}))}))}wi(e){const t=e.store(lc),n=e.store(Ul);return e.store(fc).get(hc).next(e=>{const r=[];return n.X((n,i)=>{const s=new Fa(n),o=function(e){return[0,jl(e)]}(s);r.push(t.get(o).next(n=>n?pl.resolve():(n=>t.put({targetId:0,path:jl(n),sequenceNumber:e.highestListenSequenceNumber}))(s)))}).next(()=>pl.waitFor(r))})}Si(e,t){e.createObjectStore(pc,{keyPath:mc});const n=t.store(pc),r=new Pp,i=e=>{if(r.add(e)){const t=e.lastSegment(),r=e.popLast();return n.put({collectionId:t,parent:jl(r)})}};return t.store(Ul).X({Z:!0},(e,t)=>{const n=new Fa(e);return i(n.popLast())}).next(()=>t.store(Yl).X({Z:!0},(e,t)=>{let[n,r,s]=e;const o=Fl(r);return i(o.popLast())}))}bi(e){const t=e.store(sc);return t.X((e,n)=>{const r=Gf(n),i=Qf(this.serializer,r);return t.put(i)})}Di(e,t){const n=t.store(Ul),r=[];return n.X((e,n)=>{const i=t.store(Xl),s=function(e){return e.document?new za(Fa.fromString(e.document.name).popFirst(5)):e.noDocument?za.fromSegments(e.noDocument.path):e.unknownDocument?za.fromSegments(e.unknownDocument.path):ha(36783)}(n).path.toArray(),o={prefixPath:s.slice(0,s.length-2),collectionGroup:s[s.length-2],documentId:s[s.length-1],readTime:n.readTime||[0,0],unknownDocument:n.unknownDocument,noDocument:n.noDocument,document:n.document,hasCommittedMutations:!!n.hasCommittedMutations};r.push(i.put(o))}).next(()=>pl.waitFor(r))}Ci(e,t){const n=t.store(ql),r=dm(this.serializer),i=new Im(Am.Vi,this.serializer.gt);return n.j().next(e=>{const n=new Map;return e.forEach(e=>{var t;let r=null!==(t=n.get(e.userId))&&void 0!==t?t:nh();Kf(this.serializer,e).keys().forEach(e=>r=r.add(e)),n.set(e.userId,r)}),pl.forEach(n,(e,n)=>{const s=new ia(n),o=rp.yt(this.serializer,s),a=i.getIndexManager(s),l=Bp.yt(s,this.serializer,a,i.referenceDelegate);return new bm(r,l,o,a).recalculateAndSaveOverlaysForDocumentKeys(new Bc(t,Il.ue),e).next()})})}}function Om(e){e.createObjectStore(lc,{keyPath:cc}).createIndex(uc,dc,{unique:!0}),e.createObjectStore(sc,{keyPath:"targetId"}).createIndex(oc,ac,{unique:!0}),e.createObjectStore(fc)}const jm="IndexedDbPersistence",Lm=18e5,Mm=5e3,Fm="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Um="main";class Vm{constructor(e,t,n,r,i,s,o,a,l,c){let u=arguments.length>10&&void 0!==arguments[10]?arguments[10]:18;if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.Fi=i,this.window=s,this.document=o,this.Mi=l,this.xi=c,this.Oi=u,this.ui=null,this.ci=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Ni=null,this.inForeground=!1,this.Bi=null,this.Li=null,this.ki=Number.NEGATIVE_INFINITY,this.qi=e=>Promise.resolve(),!Vm.C())throw new va(ga.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new am(this,r),this.Qi=t+Um,this.serializer=new $f(a),this.$i=new vl(this.Qi,this.Oi,new Dm(this.serializer)),this.li=new sp,this.hi=new Yp(this.referenceDelegate,this.serializer),this.remoteDocumentCache=dm(this.serializer),this.Ti=new ep,this.window&&this.window.localStorage?this.Ui=this.window.localStorage:(this.Ui=null,!1===c&&ca(jm,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ki().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new va(ga.FAILED_PRECONDITION,Fm);return this.Wi(),this.Gi(),this.zi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.hi.getHighestSequenceNumber(e))}).then(e=>{this.ui=new Il(e,this.Mi)}).then(()=>{this.ci=!0}).catch(e=>(this.$i&&this.$i.close(),Promise.reject(e)))}ji(e){return this.qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.$i.setDatabaseDeletedListener(e)}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Fi.enqueueAndForget(async()=>{this.started&&await this.Ki()}))}Ki(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>$m(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Ji(e).next(e=>{e||(this.isPrimary=!1,this.Fi.enqueueRetryable(()=>this.qi(!1)))})}).next(()=>this.Hi(e)).next(t=>this.isPrimary&&!t?this.Yi(e).next(()=>!1):!!t&&this.Zi(e).next(()=>!0))).catch(e=>{if(wl(e))return la(jm,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return la(jm,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Fi.enqueueRetryable(()=>this.qi(e)),this.isPrimary=e})}Ji(e){return zm(e).get(zl).next(e=>pl.resolve(this.Xi(e)))}es(e){return $m(e).delete(this.clientId)}async ts(){if(this.isPrimary&&!this.ns(this.ki,Lm)){this.ki=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",e=>{const t=Hc(e,gc);return t.j().next(e=>{const n=this.rs(e,Lm),r=e.filter(e=>-1===n.indexOf(e));return pl.forEach(r,e=>t.delete(e.clientId)).next(()=>r)})}).catch(()=>[]);if(this.Ui)for(const t of e)this.Ui.removeItem(this.ss(t.clientId))}}zi(){this.Li=this.Fi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Ki().then(()=>this.ts()).then(()=>this.zi()))}Xi(e){return!!e&&e.ownerId===this.clientId}Hi(e){return this.xi?pl.resolve(!0):zm(e).get(zl).next(t=>{if(null!==t&&this.ns(t.leaseTimestampMs,Mm)&&!this._s(t.ownerId)){if(this.Xi(t)&&this.networkEnabled)return!0;if(!this.Xi(t)){if(!t.allowTabSynchronization)throw new va(ga.FAILED_PRECONDITION,Fm);return!1}}return!(!this.networkEnabled||!this.inForeground)||$m(e).j().next(e=>void 0===this.rs(e,Mm).find(e=>{if(this.clientId!==e.clientId){const t=!this.networkEnabled&&e.networkEnabled,n=!this.inForeground&&e.inForeground,r=this.networkEnabled===e.networkEnabled;if(t||n&&r)return!0}return!1}))}).next(e=>(this.isPrimary!==e&&la(jm,`Client ${e?"is":"is not"} eligible for a primary lease.`),e))}async shutdown(){this.ci=!1,this.us(),this.Li&&(this.Li.cancel(),this.Li=null),this.cs(),this.ls(),await this.$i.runTransaction("shutdown","readwrite",[Vl,gc],e=>{const t=new Bc(e,Il.ue);return this.Yi(t).next(()=>this.es(t))}),this.$i.close(),this.hs()}rs(e,t){return e.filter(e=>this.ns(e.updateTimeMs,t)&&!this._s(e.clientId))}Ps(){return this.runTransaction("getActiveClients","readonly",e=>$m(e).j().next(e=>this.rs(e,Lm).map(e=>e.clientId)))}get started(){return this.ci}getGlobalsCache(){return this.li}getMutationQueue(e,t){return Bp.yt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Dp(e,this.serializer.gt.databaseId)}getDocumentOverlayCache(e){return rp.yt(this.serializer,e)}getBundleCache(){return this.Ti}runTransaction(e,t,n){la(jm,"Starting transaction:",e);const r="readonly"===t?"readonly":"readwrite",i=function(e){return 18===e?qc:17===e?$c:16===e?zc:15===e?Vc:14===e?Uc:13===e?Fc:12===e?Mc:11===e?Lc:void ha(60245)}(this.Oi);let s;return this.$i.runTransaction(e,r,i,r=>(s=new Bc(r,this.ui?this.ui.next():Il.ue),"readwrite-primary"===t?this.Ji(s).next(e=>!!e||this.Hi(s)).next(t=>{if(!t)throw ca(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Fi.enqueueRetryable(()=>this.qi(!1)),new va(ga.FAILED_PRECONDITION,dl);return n(s)}).next(e=>this.Zi(s).next(()=>e)):this.Ts(s).next(()=>n(s)))).then(e=>(s.raiseOnCommittedEvent(),e))}Ts(e){return zm(e).get(zl).next(e=>{if(null!==e&&this.ns(e.leaseTimestampMs,Mm)&&!this._s(e.ownerId)&&!this.Xi(e)&&!(this.xi||this.allowTabSynchronization&&e.allowTabSynchronization))throw new va(ga.FAILED_PRECONDITION,Fm)})}Zi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return zm(e).put(zl,t)}static C(){return vl.C()}Yi(e){const t=zm(e);return t.get(zl).next(e=>this.Xi(e)?(la(jm,"Releasing primary lease."),t.delete(zl)):pl.resolve())}ns(e,t){const n=Date.now();return!(e<n-t)&&(!(e>n)||(ca(`Detected an update time that is in the future: ${e} > ${n}`),!1))}Wi(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Bi=()=>{this.Fi.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.Ki()))},this.document.addEventListener("visibilitychange",this.Bi),this.inForeground="visible"===this.document.visibilityState)}cs(){this.Bi&&(this.document.removeEventListener("visibilitychange",this.Bi),this.Bi=null)}Gi(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.Ni=()=>{this.us();const e=/(?:Version|Mobile)\/1[456]/;ft()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Fi.enterRestrictedMode(!0),this.Fi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Ni))}ls(){this.Ni&&(this.window.removeEventListener("pagehide",this.Ni),this.Ni=null)}_s(e){var t;try{const n=null!==(null===(t=this.Ui)||void 0===t?void 0:t.getItem(this.ss(e)));return la(jm,`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(e){return ca(jm,"Failed to get zombied client id.",e),!1}}us(){if(this.Ui)try{this.Ui.setItem(this.ss(this.clientId),String(Date.now()))}catch(NT){ca("Failed to set zombie client id.",NT)}}hs(){if(this.Ui)try{this.Ui.removeItem(this.ss(this.clientId))}catch(NT){}}ss(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function zm(e){return Hc(e,Vl)}function $m(e){return Hc(e,gc)}function qm(e,t){let n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"}class Bm{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Is=n,this.ds=r}static Es(e,t){let n=nh(),r=nh();for(const i of t.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new Bm(e,t.fromCache,n,r)}}class Hm{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class Wm{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=ft()?8:yl(lt())>0?6:4}initialize(e,t){this.gs=e,this.indexManager=t,this.As=!0}getDocumentsMatchingQuery(e,t,n,r){const i={result:null};return this.ps(e,t).next(e=>{i.result=e}).next(()=>{if(!i.result)return this.ys(e,t,r,n).next(e=>{i.result=e})}).next(()=>{if(i.result)return;const n=new Hm;return this.ws(e,t,n).next(r=>{if(i.result=r,this.Rs)return this.Ss(e,t,n,r.size)})}).next(()=>i.result)}Ss(e,t,n,r){return n.documentReadCount<this.Vs?(aa()<=$t.DEBUG&&la("QueryEngine","SDK will not create cache indexes for query:",Vd(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),pl.resolve()):(aa()<=$t.DEBUG&&la("QueryEngine","Query:",Vd(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.fs*r?(aa()<=$t.DEBUG&&la("QueryEngine","The SDK decides to create cache indexes for query:",Vd(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Od(t))):pl.resolve())}ps(e,t){if(Ad(t))return pl.resolve(null);let n=Od(t);return this.indexManager.getIndexType(e,n).next(r=>0===r?null:(null!==t.limit&&1===r&&(t=Md(t,null,"F"),n=Od(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(r=>{const i=nh(...r);return this.gs.getDocuments(e,i).next(r=>this.indexManager.getMinOffset(e,n).next(n=>{const s=this.bs(t,r);return this.Ds(t,s,i,n.readTime)?this.ps(e,Md(t,null,"F")):this.vs(e,s,t,n)}))})))}ys(e,t,n,r){return Ad(t)||r.isEqual(el.min())?pl.resolve(null):this.gs.getDocuments(e,n).next(i=>{const s=this.bs(t,i);return this.Ds(t,s,n,r)?pl.resolve(null):(aa()<=$t.DEBUG&&la("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Vd(t)),this.vs(e,s,t,al(r,tl)).next(e=>e))})}bs(e,t){let n=new Jc(qd(e));return t.forEach((t,r)=>{zd(e,r)&&(n=n.add(r))}),n}Ds(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}ws(e,t,n){return aa()<=$t.DEBUG&&la("QueryEngine","Using full collection scan to execute query:",Vd(t)),this.gs.getDocumentsMatchingQuery(e,t,cl.min(),n)}vs(e,t,n,r){return this.gs.getDocumentsMatchingQuery(e,n,r).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}const Km="LocalStore";class Gm{constructor(e,t,n,r){this.persistence=e,this.Cs=t,this.serializer=r,this.Fs=new Qc(Pa),this.Ms=new Hd(e=>xd(e),Sd),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(n)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new bm(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Fs))}}function Qm(e,t,n,r){return new Gm(e,t,n,r)}async function Ym(e,t){const n=ma(e);return await n.persistence.runTransaction("Handle user change","readonly",e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next(i=>(r=i,n.Ns(t),n.mutationQueue.getAllMutationBatches(e))).next(t=>{const i=[],s=[];let o=nh();for(const e of r){i.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next(e=>({Bs:e,removedBatchIds:i,addedBatchIds:s}))})})}function Xm(e){const t=ma(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.hi.getLastRemoteSnapshotVersion(e))}function Jm(e,t,n){let r=nh(),i=nh();return n.forEach(e=>r=r.add(e)),t.getEntries(e,r).next(e=>{let r=Kd();return n.forEach((n,s)=>{const o=e.get(n);s.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),s.isNoDocument()&&s.version.isEqual(el.min())?(t.removeEntry(n,s.readTime),r=r.insert(n,s)):!o.isValidDocument()||s.version.compareTo(o.version)>0||0===s.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(s),r=r.insert(n,s)):la(Km,"Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",s.version)}),{Ls:r,ks:i}})}function Zm(e,t){const n=ma(e);return n.persistence.runTransaction("Get next mutation batch","readonly",e=>(void 0===t&&(t=Pl),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)))}function eg(e,t){const n=ma(e);return n.persistence.runTransaction("Allocate target","readwrite",e=>{let r;return n.hi.getTargetData(e,t).next(i=>i?(r=i,pl.resolve(r)):n.hi.allocateTargetId(e).next(i=>(r=new zf(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.hi.addTargetData(e,r).next(()=>r))))}).then(e=>{const r=n.Fs.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Fs=n.Fs.insert(e.targetId,e),n.Ms.set(t,e.targetId)),e})}async function tg(e,t,n){const r=ma(e),i=r.Fs.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,e=>r.persistence.referenceDelegate.removeTarget(e,i))}catch(e){if(!wl(e))throw e;la(Km,`Failed to update sequence numbers for target ${t}: ${e}`)}r.Fs=r.Fs.remove(t),r.Ms.delete(i.target)}function ng(e,t,n){const r=ma(e);let i=el.min(),s=nh();return r.persistence.runTransaction("Execute query","readwrite",e=>function(e,t,n){const r=ma(e),i=r.Ms.get(n);return void 0!==i?pl.resolve(r.Fs.get(i)):r.hi.getTargetData(t,n)}(r,e,Od(t)).next(t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.hi.getMatchingKeysForTargetId(e,t.targetId).next(e=>{s=e})}).next(()=>r.Cs.getDocumentsMatchingQuery(e,t,n?i:el.min(),n?s:nh())).next(e=>(sg(r,$d(t),e),{documents:e,qs:s})))}function rg(e,t){const n=ma(e),r=ma(n.hi),i=n.Fs.get(t);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",e=>r.Et(e,t).next(e=>e?e.target:null))}function ig(e,t){const n=ma(e),r=n.xs.get(t)||el.min();return n.persistence.runTransaction("Get new document changes","readonly",e=>n.Os.getAllFromCollectionGroup(e,t,al(r,tl),Number.MAX_SAFE_INTEGER)).then(e=>(sg(n,t,e),e))}function sg(e,t,n){let r=e.xs.get(t)||el.min();n.forEach((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)}),e.xs.set(t,r)}const og="firestore_clients";function ag(e,t){return`${og}_${e}_${t}`}const lg="firestore_mutations";function cg(e,t,n){let r=`${lg}_${e}_${n}`;return t.isAuthenticated()&&(r+=`_${t.uid}`),r}const ug="firestore_targets";function dg(e,t){return`${ug}_${e}_${t}`}const hg="SharedClientState";class fg{constructor(e,t,n,r){this.user=e,this.batchId=t,this.state=n,this.error=r}static Ks(e,t,n){const r=JSON.parse(n);let i,s="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return s&&r.error&&(s="string"==typeof r.error.message&&"string"==typeof r.error.code,s&&(i=new va(r.error.code,r.error.message))),s?new fg(e,t,r.state,i):(ca(hg,`Failed to parse mutation state for ID '${t}': ${n}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class pg{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static Ks(e,t){const n=JSON.parse(t);let r,i="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error);return i&&n.error&&(i="string"==typeof n.error.message&&"string"==typeof n.error.code,i&&(r=new va(n.error.code,n.error.message))),i?new pg(e,n.state,r):(ca(hg,`Failed to parse target state for ID '${e}': ${t}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class mg{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ks(e,t){const n=JSON.parse(t);let r="object"==typeof n&&n.activeTargetIds instanceof Array,i=ih();for(let s=0;r&&s<n.activeTargetIds.length;++s)r=Dl(n.activeTargetIds[s]),i=i.add(n.activeTargetIds[s]);return r?new mg(e,i):(ca(hg,`Failed to parse client data for instance '${e}': ${t}`),null)}}class gg{constructor(e,t){this.clientId=e,this.onlineState=t}static Ks(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new gg(t.clientId,t.onlineState):(ca(hg,`Failed to parse online state: ${e}`),null)}}class vg{constructor(){this.activeTargetIds=ih()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class yg{constructor(e,t,n,r,i){this.window=e,this.Fi=t,this.persistenceKey=n,this.js=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Js=this.Hs.bind(this),this.Ys=new Qc(Pa),this.started=!1,this.Zs=[];const s=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Xs=ag(this.persistenceKey,this.js),this.eo=function(e){return`firestore_sequence_number_${e}`}(this.persistenceKey),this.Ys=this.Ys.insert(this.js,new vg),this.no=new RegExp(`^${og}_${s}_([^_]*)$`),this.ro=new RegExp(`^${lg}_${s}_(\\d+)(?:_(.*))?$`),this.io=new RegExp(`^${ug}_${s}_(\\d+)$`),this.so=function(e){return`firestore_online_state_${e}`}(this.persistenceKey),this.oo=function(e){return`firestore_bundle_loaded_v2_${e}`}(this.persistenceKey),this.window.addEventListener("storage",this.Js)}static C(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Ps();for(const n of e){if(n===this.js)continue;const e=this.getItem(ag(this.persistenceKey,n));if(e){const t=mg.Ks(n,e);t&&(this.Ys=this.Ys.insert(t.clientId,t))}}this._o();const t=this.storage.getItem(this.so);if(t){const e=this.ao(t);e&&this.uo(e)}for(const n of this.Zs)this.Hs(n);this.Zs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.eo,JSON.stringify(e))}getAllActiveQueryTargets(){return this.co(this.Ys)}isActiveQueryTarget(e){let t=!1;return this.Ys.forEach((n,r)=>{r.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.lo(e,"pending")}updateMutationState(e,t,n){this.lo(e,t,n),this.ho(e)}addLocalQueryTarget(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n="not-current";if(this.isActiveQueryTarget(e)){const t=this.storage.getItem(dg(this.persistenceKey,e));if(t){const r=pg.Ks(e,t);r&&(n=r.state)}}return t&&this.Po.Gs(e),this._o(),n}removeLocalQueryTarget(e){this.Po.zs(e),this._o()}isLocalQueryTarget(e){return this.Po.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(dg(this.persistenceKey,e))}updateQueryState(e,t,n){this.To(e,t,n)}handleUserChange(e,t,n){t.forEach(e=>{this.ho(e)}),this.currentUser=e,n.forEach(e=>{this.addPendingMutation(e)})}setOnlineState(e){this.Io(e)}notifyBundleLoaded(e){this.Eo(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Js),this.removeItem(this.Xs),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return la(hg,"READ",e,t),t}setItem(e,t){la(hg,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){la(hg,"REMOVE",e),this.storage.removeItem(e)}Hs(e){const t=e;if(t.storageArea===this.storage){if(la(hg,"EVENT",t.key,t.newValue),t.key===this.Xs)return void ca("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Fi.enqueueRetryable(async()=>{if(this.started){if(null!==t.key)if(this.no.test(t.key)){if(null==t.newValue){const e=this.Ao(t.key);return this.Ro(e,null)}{const e=this.Vo(t.key,t.newValue);if(e)return this.Ro(e.clientId,e)}}else if(this.ro.test(t.key)){if(null!==t.newValue){const e=this.mo(t.key,t.newValue);if(e)return this.fo(e)}}else if(this.io.test(t.key)){if(null!==t.newValue){const e=this.po(t.key,t.newValue);if(e)return this.yo(e)}}else if(t.key===this.so){if(null!==t.newValue){const e=this.ao(t.newValue);if(e)return this.uo(e)}}else if(t.key===this.eo){const e=function(e){let t=Il.ue;if(null!=e)try{const n=JSON.parse(e);pa("number"==typeof n,30636,{wo:e}),t=n}catch(e){ca(hg,"Failed to read sequence number from WebStorage",e)}return t}(t.newValue);e!==Il.ue&&this.sequenceNumberHandler(e)}else if(t.key===this.oo){const e=this.So(t.newValue);await Promise.all(e.map(e=>this.syncEngine.bo(e)))}}else this.Zs.push(t)})}}get Po(){return this.Ys.get(this.js)}_o(){this.setItem(this.Xs,this.Po.Ws())}lo(e,t,n){const r=new fg(this.currentUser,e,t,n),i=cg(this.persistenceKey,this.currentUser,e);this.setItem(i,r.Ws())}ho(e){const t=cg(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Io(e){const t={clientId:this.js,onlineState:e};this.storage.setItem(this.so,JSON.stringify(t))}To(e,t,n){const r=dg(this.persistenceKey,e),i=new pg(e,t,n);this.setItem(r,i.Ws())}Eo(e){const t=JSON.stringify(Array.from(e));this.setItem(this.oo,t)}Ao(e){const t=this.no.exec(e);return t?t[1]:null}Vo(e,t){const n=this.Ao(e);return mg.Ks(n,t)}mo(e,t){const n=this.ro.exec(e),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return fg.Ks(new ia(i),r,t)}po(e,t){const n=this.io.exec(e),r=Number(n[1]);return pg.Ks(r,t)}ao(e){return gg.Ks(e)}So(e){return JSON.parse(e)}async fo(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Do(e.batchId,e.state,e.error);la(hg,`Ignoring mutation for non-active user ${e.user.uid}`)}yo(e){return this.syncEngine.vo(e.targetId,e.state,e.error)}Ro(e,t){const n=t?this.Ys.insert(e,t):this.Ys.remove(e),r=this.co(this.Ys),i=this.co(n),s=[],o=[];return i.forEach(e=>{r.has(e)||s.push(e)}),r.forEach(e=>{i.has(e)||o.push(e)}),this.syncEngine.Co(s,o).then(()=>{this.Ys=n})}uo(e){this.Ys.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}co(e){let t=ih();return e.forEach((e,n)=>{t=t.unionWith(n.activeTargetIds)}),t}}class bg{constructor(){this.Fo=new vg,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,t,n){this.Mo[e]=t}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new vg,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class _g{xo(e){}shutdown(){}}const wg="ConnectivityMonitor";class xg{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){la(wg,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){la(wg,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Sg=null;function kg(){return null===Sg?Sg=268435456+Math.round(2147483648*Math.random()):Sg++,"0x"+Sg.toString(16)}const Tg="RestConnection",Eg={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Cg{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.$o=t+"://"+e.host,this.Uo=`projects/${n}/databases/${r}`,this.Ko=this.databaseId.database===gu?`project_id=${n}`:`project_id=${n}&database_id=${r}`}Wo(e,t,n,r,i){const s=kg(),o=this.Go(e,t.toUriEncodedString());la(Tg,`Sending RPC '${e}' ${s}:`,o,n);const a={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(a,r,i);const{host:l}=new URL(o),c=nt(l);return this.jo(e,o,a,n,c).then(t=>(la(Tg,`Received RPC '${e}' ${s}: `,t),t),t=>{throw ua(Tg,`RPC '${e}' ${s} failed with error: `,t,"url: ",o,"request:",n),t})}Jo(e,t,n,r,i,s){return this.Wo(e,t,n,r,i)}zo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+sa,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,n)=>e[n]=t),n&&n.headers.forEach((t,n)=>e[n]=t)}Go(e,t){const n=Eg[e];return`${this.$o}/v1/${t}:${n}`}terminate(){}}class Ng{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}const Ig="WebChannelConnection";class Pg extends Cg{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,t,n,r,i){const s=kg();return new Promise((i,o)=>{const a=new Wo;a.setWithCredentials(!0),a.listenOnce(Go.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case Qo.NO_ERROR:const t=a.getResponseJson();la(Ig,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(t)),i(t);break;case Qo.TIMEOUT:la(Ig,`RPC '${e}' ${s} timed out`),o(new va(ga.DEADLINE_EXCEEDED,"Request time out"));break;case Qo.HTTP_ERROR:const n=a.getStatus();if(la(Ig,`RPC '${e}' ${s} failed with status:`,n,"response text:",a.getResponseText()),n>0){let e=a.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(ga).indexOf(t)>=0?t:ga.UNKNOWN}(t.status);o(new va(e,t.message))}else o(new va(ga.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new va(ga.UNAVAILABLE,"Connection failed."));break;default:ha(9055,{c_:e,streamId:s,l_:a.getLastErrorCode(),h_:a.getLastError()})}}finally{la(Ig,`RPC '${e}' ${s} completed.`)}});const l=JSON.stringify(r);la(Ig,`RPC '${e}' ${s} sending request:`,r),a.send(t,"POST",l,n,15)})}P_(e,t,n){const r=kg(),i=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=Zo(),o=Jo(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(a.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(a.useFetchStreams=!0),this.zo(a.initMessageHeaders,t,n),a.encodeInitMessageHeaders=!0;const c=i.join("");la(Ig,`Creating RPC '${e}' stream ${r}: ${c}`,a);const u=s.createWebChannel(c,a);this.T_(u);let d=!1,h=!1;const f=new Ng({Ho:t=>{h?la(Ig,`Not sending because RPC '${e}' stream ${r} is closed:`,t):(d||(la(Ig,`Opening RPC '${e}' stream ${r} transport.`),u.open(),d=!0),la(Ig,`RPC '${e}' stream ${r} sending:`,t),u.send(t))},Yo:()=>u.close()}),p=(e,t,n)=>{e.listen(t,e=>{try{n(e)}catch(e){setTimeout(()=>{throw e},0)}})};return p(u,Ko.EventType.OPEN,()=>{h||(la(Ig,`RPC '${e}' stream ${r} transport opened.`),f.s_())}),p(u,Ko.EventType.CLOSE,()=>{h||(h=!0,la(Ig,`RPC '${e}' stream ${r} transport closed`),f.__(),this.I_(u))}),p(u,Ko.EventType.ERROR,t=>{h||(h=!0,ua(Ig,`RPC '${e}' stream ${r} transport errored. Name:`,t.name,"Message:",t.message),f.__(new va(ga.UNAVAILABLE,"The operation could not be completed")))}),p(u,Ko.EventType.MESSAGE,t=>{var n;if(!h){const i=t.data[0];pa(!!i,16349);const s=i,o=(null==s?void 0:s.error)||(null===(n=s[0])||void 0===n?void 0:n.error);if(o){la(Ig,`RPC '${e}' stream ${r} received error:`,o);const t=o.status;let n=function(e){const t=zh[e];if(void 0!==t)return Bh(t)}(t),i=o.message;void 0===n&&(n=ga.INTERNAL,i="Unknown error status: "+t+" with message "+o.message),h=!0,f.__(new va(n,i)),u.close()}else la(Ig,`RPC '${e}' stream ${r} received:`,i),f.a_(i)}}),p(o,Xo.STAT_EVENT,t=>{t.stat===Yo.PROXY?la(Ig,`RPC '${e}' stream ${r} detected buffering proxy`):t.stat===Yo.NOPROXY&&la(Ig,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{f.o_()},0),f}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(t=>t===e)}}function Ag(){return"undefined"!=typeof window?window:null}function Rg(){return"undefined"!=typeof document?document:null}function Dg(e){return new uf(e,!0)}class Og{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.Fi=e,this.timerId=t,this.d_=n,this.E_=r,this.A_=i,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const t=Math.floor(this.R_+this.p_()),n=Math.max(0,Date.now()-this.m_),r=Math.max(0,t-n);r>0&&la("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.R_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,r,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){null!==this.V_&&(this.V_.skipDelay(),this.V_=null)}cancel(){null!==this.V_&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}const jg="PersistentStream";class Lg{constructor(e,t,n,r,i,s,o,a){this.Fi=e,this.w_=n,this.S_=r,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new Og(e,t)}M_(){return 1===this.state||5===this.state||this.x_()}x_(){return 2===this.state||3===this.state}start(){this.C_=0,4!==this.state?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&null===this.D_&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,4!==e?this.F_.reset():t&&t.code===ga.RESOURCE_EXHAUSTED?(ca(t.toString()),ca("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):t&&t.code===ga.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(t)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),t=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(e=>{let[n,r]=e;this.b_===t&&this.W_(n,r)},t=>{e(()=>{const e=new va(ga.UNKNOWN,"Fetching auth token failed: "+t.message);return this.G_(e)})})}W_(e,t){const n=this.K_(this.b_);this.stream=this.z_(e,t),this.stream.Zo(()=>{n(()=>this.listener.Zo())}),this.stream.e_(()=>{n(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(e=>{n(()=>this.G_(e))}),this.stream.onMessage(e=>{n(()=>1==++this.C_?this.j_(e):this.onNext(e))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(e){return la(jg,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return t=>{this.Fi.enqueueAndForget(()=>this.b_===e?t():(la(jg,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Mg extends Lg{constructor(e,t,n,r,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}z_(e,t){return this.connection.P_("Listen",e,t)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:ha(39313,{state:e})}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(e,t){return e.useProto3Json?(pa(void 0===t||"string"==typeof t,58123),ru.fromBase64String(t||"")):(pa(void 0===t||t instanceof Buffer||t instanceof Uint8Array,16193),ru.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(e){const t=void 0===e.code?ga.UNKNOWN:Bh(e.code);return new va(t,e.message||"")}(o);n=new tf(r,i,s,a||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=_f(e,r.document.name),s=mf(r.document.updateTime),o=r.document.createTime?mf(r.document.createTime):el.min(),a=new Ku({mapValue:{fields:r.document.fields}}),l=Qu.newFoundDocument(i,s,o,a),c=r.targetIds||[],u=r.removedTargetIds||[];n=new Zh(c,u,l.key,l)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=_f(e,r.document),s=r.readTime?mf(r.readTime):el.min(),o=Qu.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Zh([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=_f(e,r.document),s=r.removedTargetIds||[];n=new Zh([],s,i,null)}else{if(!("filter"in t))return ha(11601,{At:t});{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:i}=e,s=new Vh(r,i),o=e.targetId;n=new ef(o,s)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return el.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?el.min():t.readTime?mf(t.readTime):el.min()}(e);return this.listener.J_(t,n)}H_(e){const t={};t.database=Sf(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=kd(r)?{documents:If(e,r)}:{query:Pf(e,r).Vt},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=ff(e,t.resumeToken);const r=df(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(el.min())>0){n.readTime=hf(e,t.snapshotVersion.toTimestamp());const r=df(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ha(28987,{purpose:e})}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.k_(t)}Y_(e){const t={};t.database=Sf(this.serializer),t.removeTarget=e,this.k_(t)}}class Fg extends Lg{constructor(e,t,n,r,i,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,t){return this.connection.P_("Write",e,t)}j_(e){return pa(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,pa(!e.writeResults||0===e.writeResults.length,55816),this.listener.ea()}onNext(e){pa(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const t=function(e,t){return e&&e.length>0?(pa(void 0!==t,14353),e.map(e=>function(e,t){let n=e.updateTime?mf(e.updateTime):mf(t);return n.isEqual(el.min())&&(n=mf(t)),new wh(n,e.transformResults||[])}(e,t))):[]}(e.writeResults,e.commitTime),n=mf(e.commitTime);return this.listener.ta(n,t)}na(){const e={};e.database=Sf(this.serializer),this.k_(e)}X_(e){const t={streamToken:this.lastStreamToken,writes:e.map(e=>Cf(this.serializer,e))};this.k_(t)}}class Ug{}class Vg extends Ug{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.ra=!1}ia(){if(this.ra)throw new va(ga.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,n,r){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(i=>{let[s,o]=i;return this.connection.Wo(e,vf(t,n),r,s,o)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===ga.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new va(ga.UNKNOWN,e.toString())})}Jo(e,t,n,r,i){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(s=>{let[o,a]=s;return this.connection.Jo(e,vf(t,n),r,o,a,i)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===ga.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new va(ga.UNKNOWN,e.toString())})}terminate(){this.ra=!0,this.connection.terminate()}}class zg{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){0===this.sa&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){"Online"===this.state?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,"Online"===e&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(ca(t),this._a=!1):la("OnlineStateTracker",t)}ha(){null!==this.oa&&(this.oa.cancel(),this.oa=null)}}const $g="RemoteStore";class qg{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=i,this.Ea.xo(e=>{n.enqueueAndForget(async()=>{Jg(this)&&(la($g,"Restarting streams for network reachability change."),await async function(e){const t=ma(e);t.Ia.add(4),await Hg(t),t.Aa.set("Unknown"),t.Ia.delete(4),await Bg(t)}(this))})}),this.Aa=new zg(n,r)}}async function Bg(e){if(Jg(e))for(const t of e.da)await t(!0)}async function Hg(e){for(const t of e.da)await t(!1)}function Wg(e,t){const n=ma(e);n.Ta.has(t.targetId)||(n.Ta.set(t.targetId,t),Xg(n)?Yg(n):vv(n).x_()&&Gg(n,t))}function Kg(e,t){const n=ma(e),r=vv(n);n.Ta.delete(t),r.x_()&&Qg(n,t),0===n.Ta.size&&(r.x_()?r.B_():Jg(n)&&n.Aa.set("Unknown"))}function Gg(e,t){if(e.Ra.$e(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(el.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}vv(e).H_(t)}function Qg(e,t){e.Ra.$e(t),vv(e).Y_(t)}function Yg(e){e.Ra=new rf({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),Et:t=>e.Ta.get(t)||null,lt:()=>e.datastore.serializer.databaseId}),vv(e).start(),e.Aa.aa()}function Xg(e){return Jg(e)&&!vv(e).M_()&&e.Ta.size>0}function Jg(e){return 0===ma(e).Ia.size}function Zg(e){e.Ra=void 0}async function ev(e){e.Aa.set("Online")}async function tv(e){e.Ta.forEach((t,n)=>{Gg(e,t)})}async function nv(e,t){Zg(e),Xg(e)?(e.Aa.la(t),Yg(e)):e.Aa.set("Unknown")}async function rv(e,t,n){if(e.Aa.set("Online"),t instanceof tf&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.Ta.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.Ta.delete(r),e.Ra.removeTarget(r))}(e,t)}catch(n){la($g,"Failed to remove targets %s: %s ",t.targetIds.join(","),n),await iv(e,n)}else if(t instanceof Zh?e.Ra.Ye(t):t instanceof ef?e.Ra.it(t):e.Ra.et(t),!n.isEqual(el.min()))try{const t=await Xm(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Ra.Pt(t);return n.targetChanges.forEach((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.Ta.get(r);i&&e.Ta.set(r,i.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach((t,n)=>{const r=e.Ta.get(t);if(!r)return;e.Ta.set(t,r.withResumeToken(ru.EMPTY_BYTE_STRING,r.snapshotVersion)),Qg(e,t);const i=new zf(r.target,t,n,r.sequenceNumber);Gg(e,i)}),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){la($g,"Failed to raise snapshot:",t),await iv(e,t)}}async function iv(e,t,n){if(!wl(t))throw t;e.Ia.add(1),await Hg(e),e.Aa.set("Offline"),n||(n=()=>Xm(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{la($g,"Retrying IndexedDB access"),await n(),e.Ia.delete(1),await Bg(e)})}function sv(e,t){return t().catch(n=>iv(e,n,t))}async function ov(e){const t=ma(e),n=yv(t);let r=t.Pa.length>0?t.Pa[t.Pa.length-1].batchId:Pl;for(;av(t);)try{const e=await Zm(t.localStore,r);if(null===e){0===t.Pa.length&&n.B_();break}r=e.batchId,lv(t,e)}catch(e){await iv(t,e)}cv(t)&&uv(t)}function av(e){return Jg(e)&&e.Pa.length<10}function lv(e,t){e.Pa.push(t);const n=yv(e);n.x_()&&n.Z_&&n.X_(t.mutations)}function cv(e){return Jg(e)&&!yv(e).M_()&&e.Pa.length>0}function uv(e){yv(e).start()}async function dv(e){yv(e).na()}async function hv(e){const t=yv(e);for(const n of e.Pa)t.X_(n.mutations)}async function fv(e,t,n){const r=e.Pa.shift(),i=Fh.from(r,t,n);await sv(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),await ov(e)}async function pv(e,t){t&&yv(e).Z_&&await async function(e,t){if(function(e){return qh(e)&&e!==ga.ABORTED}(t.code)){const n=e.Pa.shift();yv(e).N_(),await sv(e,()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t)),await ov(e)}}(e,t),cv(e)&&uv(e)}async function mv(e,t){const n=ma(e);n.asyncQueue.verifyOperationInProgress(),la($g,"RemoteStore received new credentials");const r=Jg(n);n.Ia.add(3),await Hg(n),r&&n.Aa.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.Ia.delete(3),await Bg(n)}async function gv(e,t){const n=ma(e);t?(n.Ia.delete(2),await Bg(n)):t||(n.Ia.add(2),await Hg(n),n.Aa.set("Unknown"))}function vv(e){return e.Va||(e.Va=function(e,t,n){const r=ma(e);return r.ia(),new Mg(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Zo:ev.bind(null,e),e_:tv.bind(null,e),n_:nv.bind(null,e),J_:rv.bind(null,e)}),e.da.push(async t=>{t?(e.Va.N_(),Xg(e)?Yg(e):e.Aa.set("Unknown")):(await e.Va.stop(),Zg(e))})),e.Va}function yv(e){return e.ma||(e.ma=function(e,t,n){const r=ma(e);return r.ia(),new Fg(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Zo:()=>Promise.resolve(),e_:dv.bind(null,e),n_:pv.bind(null,e),ea:hv.bind(null,e),ta:fv.bind(null,e)}),e.da.push(async t=>{t?(e.ma.N_(),await ov(e)):(await e.ma.stop(),e.Pa.length>0&&(la($g,`Stopping write stream with ${e.Pa.length} pending writes`),e.Pa=[]))})),e.ma}class bv{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new ya,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,i){const s=Date.now()+n,o=new bv(e,t,s,r,i);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new va(ga.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function _v(e,t){if(ca("AsyncQueue",`${t}: ${e}`),wl(e))return new va(ga.UNAVAILABLE,`${t}: ${e}`);throw e}class wv{static emptySet(e){return new wv(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||za.comparator(t.key,n.key):(e,t)=>za.comparator(e.key,t.key),this.keyedMap=Qd(),this.sortedSet=new Qc(this.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof wv))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new wv;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class xv{constructor(){this.fa=new Qc(za.comparator)}track(e){const t=e.doc.key,n=this.fa.get(t);n?0!==e.type&&3===n.type?this.fa=this.fa.insert(t,e):3===e.type&&1!==n.type?this.fa=this.fa.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.fa=this.fa.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.fa=this.fa.remove(t):1===e.type&&2===n.type?this.fa=this.fa.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):ha(63341,{At:e,ga:n}):this.fa=this.fa.insert(t,e)}pa(){const e=[];return this.fa.inorderTraversal((t,n)=>{e.push(n)}),e}}class Sv{constructor(e,t,n,r,i,s,o,a,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,r,i){const s=[];return t.forEach(e=>{s.push({type:0,doc:e})}),new Sv(e,t,wv.emptySet(t),s,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Fd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class kv{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(e=>e.ba())}}class Tv{constructor(){this.queries=Ev(),this.onlineState="Unknown",this.Da=new Set}terminate(){!function(e,t){const n=ma(e),r=n.queries;n.queries=Ev(),r.forEach((e,n)=>{for(const r of n.wa)r.onError(t)})}(this,new va(ga.ABORTED,"Firestore shutting down"))}}function Ev(){return new Hd(e=>Ud(e),Fd)}async function Cv(e,t){const n=ma(e);let r=3;const i=t.query;let s=n.queries.get(i);s?!s.Sa()&&t.ba()&&(r=2):(s=new kv,r=t.ba()?0:1);try{switch(r){case 0:s.ya=await n.onListen(i,!0);break;case 1:s.ya=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(e){const n=_v(e,`Initialization of query '${Vd(t.query)}' failed`);return void t.onError(n)}n.queries.set(i,s),s.wa.push(t),t.va(n.onlineState),s.ya&&t.Ca(s.ya)&&Av(n)}async function Nv(e,t){const n=ma(e),r=t.query;let i=3;const s=n.queries.get(r);if(s){const e=s.wa.indexOf(t);e>=0&&(s.wa.splice(e,1),0===s.wa.length?i=t.ba()?0:1:!s.Sa()&&t.ba()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Iv(e,t){const n=ma(e);let r=!1;for(const i of t){const e=i.query,t=n.queries.get(e);if(t){for(const e of t.wa)e.Ca(i)&&(r=!0);t.ya=i}}r&&Av(n)}function Pv(e,t,n){const r=ma(e),i=r.queries.get(t);if(i)for(const s of i.wa)s.onError(n);r.queries.delete(t)}function Av(e){e.Da.forEach(e=>{e.next()})}var Rv,Dv;(Dv=Rv||(Rv={})).Fa="default",Dv.Cache="cache";class Ov{constructor(e,t,n){this.query=e,this.Ma=t,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=n||{}}Ca(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new Sv(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),t=!0):this.Ba(e,this.onlineState)&&(this.La(e),t=!0),this.Oa=e,t}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let t=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),t=!0),t}Ba(e,t){if(!e.fromCache)return!0;if(!this.ba())return!0;const n="Offline"!==t;return(!this.options.ka||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Na(e){if(e.docChanges.length>0)return!0;const t=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}La(e){e=Sv.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==Rv.Cache}}class jv{constructor(e){this.key=e}}class Lv{constructor(e){this.key=e}}class Mv{constructor(e,t){this.query=e,this.Ha=t,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=nh(),this.mutatedKeys=nh(),this.Xa=qd(e),this.eu=new wv(this.Xa)}get tu(){return this.Ha}nu(e,t){const n=t?t.ru:new xv,r=t?t.eu:this.eu;let i=t?t.mutatedKeys:this.mutatedKeys,s=r,o=!1;const a="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,l="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((e,t)=>{const c=r.get(e),u=zd(this.query,t)?t:null,d=!!c&&this.mutatedKeys.has(c.key),h=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let f=!1;c&&u?c.data.isEqual(u.data)?d!==h&&(n.track({type:3,doc:u}),f=!0):this.iu(c,u)||(n.track({type:2,doc:u}),f=!0,(a&&this.Xa(u,a)>0||l&&this.Xa(u,l)<0)&&(o=!0)):!c&&u?(n.track({type:0,doc:u}),f=!0):c&&!u&&(n.track({type:1,doc:c}),f=!0,(a||l)&&(o=!0)),f&&(u?(s=s.add(u),i=h?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))}),null!==this.query.limit)for(;s.size>this.query.limit;){const e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{eu:s,ru:n,Ds:o,mutatedKeys:i}}iu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const i=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const s=e.ru.pa();s.sort((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ha(20277,{At:e})}};return n(e)-n(t)}(e.type,t.type)||this.Xa(e.doc,t.doc)),this.su(n),r=null!=r&&r;const o=t&&!r?this.ou():[],a=0===this.Za.size&&this.current&&!r?1:0,l=a!==this.Ya;return this.Ya=a,0!==s.length||l?{snapshot:new Sv(this.query,e.eu,i,s,e.mutatedKeys,0===a,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),_u:o}:{_u:o}}va(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({eu:this.eu,ru:new xv,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach(e=>this.Ha=this.Ha.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Ha=this.Ha.delete(e)),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=nh(),this.eu.forEach(e=>{this.au(e.key)&&(this.Za=this.Za.add(e.key))});const t=[];return e.forEach(e=>{this.Za.has(e)||t.push(new Lv(e))}),this.Za.forEach(n=>{e.has(n)||t.push(new jv(n))}),t}uu(e){this.Ha=e.qs,this.Za=nh();const t=this.nu(e.documents);return this.applyChanges(t,!0)}cu(){return Sv.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,0===this.Ya,this.hasCachedResults)}}const Fv="SyncEngine";class Uv{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class Vv{constructor(e){this.key=e,this.lu=!1}}class zv{constructor(e,t,n,r,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.hu={},this.Pu=new Hd(e=>Ud(e),Fd),this.Tu=new Map,this.Iu=new Set,this.du=new Qc(za.comparator),this.Eu=new Map,this.Au=new Sm,this.Ru={},this.Vu=new Map,this.mu=Qp.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return!0===this.fu}}async function $v(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=vy(e);let i;const s=r.Pu.get(t);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.cu()):i=await Bv(r,t,n,!0),i}async function qv(e,t){const n=vy(e);await Bv(n,t,!0,!1)}async function Bv(e,t,n,r){const i=await eg(e.localStore,Od(t)),s=i.targetId,o=e.sharedClientState.addLocalQueryTarget(s,n);let a;return r&&(a=await Hv(e,t,s,"current"===o,i.resumeToken)),e.isPrimaryClient&&n&&Wg(e.remoteStore,i),a}async function Hv(e,t,n,r,i){e.gu=(t,n,r)=>async function(e,t,n,r){let i=t.view.nu(n);i.Ds&&(i=await ng(e.localStore,t.query,!1).then(e=>{let{documents:n}=e;return t.view.nu(n,i)}));const s=r&&r.targetChanges.get(t.targetId),o=r&&null!=r.targetMismatches.get(t.targetId),a=t.view.applyChanges(i,e.isPrimaryClient,s,o);return ry(e,t.targetId,a._u),a.snapshot}(e,t,n,r);const s=await ng(e.localStore,t,!0),o=new Mv(t,s.qs),a=o.nu(s.documents),l=Jh.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,i),c=o.applyChanges(a,e.isPrimaryClient,l);ry(e,n,c._u);const u=new Uv(t,n,o);return e.Pu.set(t,u),e.Tu.has(n)?e.Tu.get(n).push(t):e.Tu.set(n,[t]),c.snapshot}async function Wv(e,t,n){const r=ma(e),i=r.Pu.get(t),s=r.Tu.get(i.targetId);if(s.length>1)return r.Tu.set(i.targetId,s.filter(e=>!Fd(e,t))),void r.Pu.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await tg(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Kg(r.remoteStore,i.targetId),ty(r,i.targetId)}).catch(fl)):(ty(r,i.targetId),await tg(r.localStore,i.targetId,!0))}async function Kv(e,t){const n=ma(e),r=n.Pu.get(t),i=n.Tu.get(r.targetId);n.isPrimaryClient&&1===i.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Kg(n.remoteStore,r.targetId))}async function Gv(e,t){const n=ma(e);try{const e=await function(e,t){const n=ma(e),r=t.snapshotVersion;let i=n.Fs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{const s=n.Os.newChangeBuffer({trackRemovals:!0});i=n.Fs;const o=[];t.targetChanges.forEach((s,a)=>{const l=i.get(a);if(!l)return;o.push(n.hi.removeMatchingKeys(e,s.removedDocuments,a).next(()=>n.hi.addMatchingKeys(e,s.addedDocuments,a)));let c=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(a)?c=c.withResumeToken(ru.EMPTY_BYTE_STRING,el.min()).withLastLimboFreeSnapshotVersion(el.min()):s.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(s.resumeToken,r)),i=i.insert(a,c),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||(t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)}(l,c,s)&&o.push(n.hi.updateTargetData(e,c))});let a=Kd(),l=nh();if(t.documentUpdates.forEach(r=>{t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),o.push(Jm(e,s,t.documentUpdates).next(e=>{a=e.Ls,l=e.ks})),!r.isEqual(el.min())){const t=n.hi.getLastRemoteSnapshotVersion(e).next(t=>n.hi.setTargetsMetadata(e,e.currentSequenceNumber,r));o.push(t)}return pl.waitFor(o).next(()=>s.apply(e)).next(()=>n.localDocuments.getLocalViewOfDocuments(e,a,l)).next(()=>a)}).then(e=>(n.Fs=i,e))}(n.localStore,t);t.targetChanges.forEach((e,t)=>{const r=n.Eu.get(t);r&&(pa(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1,22616),e.addedDocuments.size>0?r.lu=!0:e.modifiedDocuments.size>0?pa(r.lu,14607):e.removedDocuments.size>0&&(pa(r.lu,42227),r.lu=!1))}),await oy(n,e,t)}catch(e){await fl(e)}}function Qv(e,t,n){const r=ma(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.Pu.forEach((n,r)=>{const i=r.view.va(t);i.snapshot&&e.push(i.snapshot)}),function(e,t){const n=ma(e);n.onlineState=t;let r=!1;n.queries.forEach((e,n)=>{for(const i of n.wa)i.va(t)&&(r=!0)}),r&&Av(n)}(r.eventManager,t),e.length&&r.hu.J_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function Yv(e,t,n){const r=ma(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.Eu.get(t),s=i&&i.key;if(s){let e=new Qc(za.comparator);e=e.insert(s,Qu.newNoDocument(s,el.min()));const n=nh().add(s),i=new Xh(el.min(),new Map,new Qc(Pa),e,n);await Gv(r,i),r.du=r.du.remove(s),r.Eu.delete(t),sy(r)}else await tg(r.localStore,t,!1).then(()=>ty(r,t,n)).catch(fl)}async function Xv(e,t){const n=ma(e),r=t.batch.batchId;try{const e=await function(e,t){const n=ma(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{const r=t.batch.keys(),i=n.Os.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,s=i.keys();let o=pl.resolve();return s.forEach(e=>{o=o.next(()=>r.getEntry(t,e)).next(t=>{const s=n.docVersions.get(e);pa(null!==s,48541),t.version.compareTo(s)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))})}),o.next(()=>e.mutationQueue.removeMutationBatch(t,i))}(n,e,t,i).next(()=>i.apply(e)).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=nh();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))).next(()=>n.localDocuments.getDocuments(e,r))})}(n.localStore,t);ey(n,r,null),Zv(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await oy(n,e)}catch(e){await fl(e)}}async function Jv(e,t,n){const r=ma(e);try{const e=await function(e,t){const n=ma(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next(t=>(pa(null!==t,37113),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t))).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)).next(()=>n.localDocuments.getDocuments(e,r))})}(r.localStore,t);ey(r,t,n),Zv(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await oy(r,e)}catch(n){await fl(n)}}function Zv(e,t){(e.Vu.get(t)||[]).forEach(e=>{e.resolve()}),e.Vu.delete(t)}function ey(e,t,n){const r=ma(e);let i=r.Ru[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.Ru[r.currentUser.toKey()]=i}}function ty(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Tu.get(t))e.Pu.delete(r),n&&e.hu.pu(r,n);e.Tu.delete(t),e.isPrimaryClient&&e.Au.zr(t).forEach(t=>{e.Au.containsKey(t)||ny(e,t)})}function ny(e,t){e.Iu.delete(t.path.canonicalString());const n=e.du.get(t);null!==n&&(Kg(e.remoteStore,n),e.du=e.du.remove(t),e.Eu.delete(n),sy(e))}function ry(e,t,n){for(const r of n)r instanceof jv?(e.Au.addReference(r.key,t),iy(e,r)):r instanceof Lv?(la(Fv,"Document no longer in limbo: "+r.key),e.Au.removeReference(r.key,t),e.Au.containsKey(r.key)||ny(e,r.key)):ha(19791,{yu:r})}function iy(e,t){const n=t.key,r=n.path.canonicalString();e.du.get(n)||e.Iu.has(r)||(la(Fv,"New document in limbo: "+n),e.Iu.add(r),sy(e))}function sy(e){for(;e.Iu.size>0&&e.du.size<e.maxConcurrentLimboResolutions;){const t=e.Iu.values().next().value;e.Iu.delete(t);const n=new za(Fa.fromString(t)),r=e.mu.next();e.Eu.set(r,new Vv(n)),e.du=e.du.insert(n,r),Wg(e.remoteStore,new zf(Od(Pd(n.path)),r,"TargetPurposeLimboResolution",Il.ue))}}async function oy(e,t,n){const r=ma(e),i=[],s=[],o=[];r.Pu.isEmpty()||(r.Pu.forEach((e,a)=>{o.push(r.gu(a,t,n).then(e=>{var t;if((e||n)&&r.isPrimaryClient){const i=e?!e.fromCache:null===(t=null==n?void 0:n.targetChanges.get(a.targetId))||void 0===t?void 0:t.current;r.sharedClientState.updateQueryState(a.targetId,i?"current":"not-current")}if(e){i.push(e);const t=Bm.Es(a.targetId,e);s.push(t)}}))}),await Promise.all(o),r.hu.J_(i),await async function(e,t){const n=ma(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>pl.forEach(t,t=>pl.forEach(t.Is,r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r)).next(()=>pl.forEach(t.ds,r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))}catch(e){if(!wl(e))throw e;la(Km,"Failed to update sequence numbers: "+e)}for(const r of t){const e=r.targetId;if(!r.fromCache){const t=n.Fs.get(e),r=t.snapshotVersion,i=t.withLastLimboFreeSnapshotVersion(r);n.Fs=n.Fs.insert(e,i)}}}(r.localStore,s))}async function ay(e,t){const n=ma(e);if(!n.currentUser.isEqual(t)){la(Fv,"User change. New user:",t.toKey());const e=await Ym(n.localStore,t);n.currentUser=t,function(e,t){e.Vu.forEach(e=>{e.forEach(e=>{e.reject(new va(ga.CANCELLED,t))})}),e.Vu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await oy(n,e.Bs)}}function ly(e,t){const n=ma(e),r=n.Eu.get(t);if(r&&r.lu)return nh().add(r.key);{let e=nh();const r=n.Tu.get(t);if(!r)return e;for(const t of r){const r=n.Pu.get(t);e=e.unionWith(r.view.tu)}return e}}async function cy(e,t){const n=ma(e),r=await ng(n.localStore,t.query,!0),i=t.view.uu(r);return n.isPrimaryClient&&ry(n,t.targetId,i._u),i}async function uy(e,t){const n=ma(e);return ig(n.localStore,t).then(e=>oy(n,e))}async function dy(e,t,n,r){const i=ma(e),s=await function(e,t){const n=ma(e),r=ma(n.mutationQueue);return n.persistence.runTransaction("Lookup mutation documents","readonly",e=>r.Xn(e,t).next(t=>t?n.localDocuments.getDocuments(e,t):pl.resolve(null)))}(i.localStore,t);null!==s?("pending"===n?await ov(i.remoteStore):"acknowledged"===n||"rejected"===n?(ey(i,t,r||null),Zv(i,t),function(e,t){ma(ma(e).mutationQueue).rr(t)}(i.localStore,t)):ha(6720,"Unknown batchState",{wu:n}),await oy(i,s)):la(Fv,"Cannot apply mutation batch with id: "+t)}async function hy(e,t,n){const r=ma(e),i=[],s=[];for(const o of t){let e;const t=r.Tu.get(o);if(t&&0!==t.length){e=await eg(r.localStore,Od(t[0]));for(const e of t){const t=r.Pu.get(e),n=await cy(r,t);n.snapshot&&s.push(n.snapshot)}}else{const t=await rg(r.localStore,o);e=await eg(r.localStore,t),await Hv(r,fy(t),o,!1,e.resumeToken)}i.push(e)}return r.hu.J_(s),i}function fy(e){return Id(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function py(e){return function(e){return ma(ma(e).persistence).Ps()}(ma(e).localStore)}async function my(e,t,n,r){const i=ma(e);if(i.fu)return void la(Fv,"Ignoring unexpected query state notification.");const s=i.Tu.get(t);if(s&&s.length>0)switch(n){case"current":case"not-current":{const e=await ig(i.localStore,$d(s[0])),r=Xh.createSynthesizedRemoteEventForCurrentChange(t,"current"===n,ru.EMPTY_BYTE_STRING);await oy(i,e,r);break}case"rejected":await tg(i.localStore,t,!0),ty(i,t,r);break;default:ha(64155,n)}}async function gy(e,t,n){const r=vy(e);if(r.fu){for(const e of t){if(r.Tu.has(e)&&r.sharedClientState.isActiveQueryTarget(e)){la(Fv,"Adding an already active target "+e);continue}const t=await rg(r.localStore,e),n=await eg(r.localStore,t);await Hv(r,fy(t),n.targetId,!1,n.resumeToken),Wg(r.remoteStore,n)}for(const e of n)r.Tu.has(e)&&await tg(r.localStore,e,!1).then(()=>{Kg(r.remoteStore,e),ty(r,e)}).catch(fl)}}function vy(e){const t=ma(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Gv.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=ly.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Yv.bind(null,t),t.hu.J_=Iv.bind(null,t.eventManager),t.hu.pu=Pv.bind(null,t.eventManager),t}function yy(e){const t=ma(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Xv.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Jv.bind(null,t),t}class by{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Dg(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,t){return null}Fu(e,t){return null}vu(e){return Qm(this.persistence,new Wm,e.initialUser,this.serializer)}Du(e){return new Im(Am.Vi,this.serializer)}bu(e){return new bg}async terminate(){var e,t;null===(e=this.gcScheduler)||void 0===e||e.stop(),null===(t=this.indexBackfillerScheduler)||void 0===t||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}by.provider={build:()=>new by};class _y extends by{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,t){pa(this.persistence.referenceDelegate instanceof Rm,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new im(n,e.asyncQueue,t)}Du(e){const t=void 0!==this.cacheSizeBytes?zp.withCacheSize(this.cacheSizeBytes):zp.DEFAULT;return new Im(e=>Rm.Vi(e,t),this.serializer)}}class wy extends by{constructor(e,t,n){super(),this.Mu=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Mu.initialize(this,e),await yy(this.Mu.syncEngine),await ov(this.Mu.remoteStore),await this.persistence.ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){return Qm(this.persistence,new Wm,e.initialUser,this.serializer)}Cu(e,t){const n=this.persistence.referenceDelegate.garbageCollector;return new im(n,e.asyncQueue,t)}Fu(e,t){const n=new Nl(t,this.persistence);return new Cl(e.asyncQueue,n)}Du(e){const t=qm(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?zp.withCacheSize(this.cacheSizeBytes):zp.DEFAULT;return new Vm(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,Ag(),Rg(),this.serializer,this.sharedClientState,!!this.forceOwnership)}bu(e){return new bg}}class xy extends wy{constructor(e,t){super(e,t,!1),this.Mu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.Mu.syncEngine;this.sharedClientState instanceof yg&&(this.sharedClientState.syncEngine={Do:dy.bind(null,t),vo:my.bind(null,t),Co:gy.bind(null,t),Ps:py.bind(null,t),bo:uy.bind(null,t)},await this.sharedClientState.start()),await this.persistence.ji(async e=>{await async function(e,t){const n=ma(e);if(vy(n),yy(n),!0===t&&!0!==n.fu){const e=n.sharedClientState.getAllActiveQueryTargets(),t=await hy(n,e.toArray());n.fu=!0,await gv(n.remoteStore,!0);for(const r of t)Wg(n.remoteStore,r)}else if(!1===t&&!1!==n.fu){const e=[];let t=Promise.resolve();n.Tu.forEach((r,i)=>{n.sharedClientState.isLocalQueryTarget(i)?e.push(i):t=t.then(()=>(ty(n,i),tg(n.localStore,i,!0))),Kg(n.remoteStore,i)}),await t,await hy(n,e),function(e){const t=ma(e);t.Eu.forEach((e,n)=>{Kg(t.remoteStore,n)}),t.Au.jr(),t.Eu=new Map,t.du=new Qc(za.comparator)}(n),n.fu=!1,await gv(n.remoteStore,!1)}}(this.Mu.syncEngine,e),this.gcScheduler&&(e&&!this.gcScheduler.started?this.gcScheduler.start():e||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(e&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():e||this.indexBackfillerScheduler.stop())})}bu(e){const t=Ag();if(!yg.C(t))throw new va(ga.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const n=qm(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new yg(t,e.asyncQueue,n,e.clientId,e.initialUser)}}class Sy{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>Qv(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=ay.bind(null,this.syncEngine),await gv(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new Tv}createDatastore(e){const t=Dg(e.databaseInfo.databaseId),n=function(e){return new Pg(e)}(e.databaseInfo);return function(e,t,n,r){return new Vg(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,i){return new qg(e,t,n,r,i)}(this.localStore,this.datastore,e.asyncQueue,e=>Qv(this.syncEngine,e,0),xg.C()?new xg:new _g)}createSyncEngine(e,t){return function(e,t,n,r,i,s,o){const a=new zv(e,t,n,r,i,s);return o&&(a.fu=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(e){const t=ma(e);la($g,"RemoteStore shutting down."),t.Ia.add(5),await Hg(t),t.Ea.shutdown(),t.Aa.set("Unknown")}(this.remoteStore),null===(e=this.datastore)||void 0===e||e.terminate(),null===(t=this.eventManager)||void 0===t||t.terminate()}}Sy.provider={build:()=>new Sy};class ky{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):ca("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}const Ty="FirestoreClient";class Ey{constructor(e,t,n,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=ia.UNAUTHENTICATED,this.clientId=Ia.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,async e=>{la(Ty,"Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(n,e=>(la(Ty,"Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ya;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(IT){const n=_v(IT,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Cy(e,t){e.asyncQueue.verifyOperationInProgress(),la(Ty,"Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(async e=>{r.isEqual(e)||(await Ym(t.localStore,e),r=e)}),t.persistence.setDatabaseDeletedListener(()=>{ua("Terminating Firestore due to IndexedDb database deletion"),e.terminate().then(()=>{la("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(e=>{ua("Terminating Firestore due to IndexedDb database deletion failed",e)})}),e._offlineComponents=t}async function Ny(e,t){e.asyncQueue.verifyOperationInProgress();const n=await Iy(e);la(Ty,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(e=>mv(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,n)=>mv(t.remoteStore,n)),e._onlineComponents=t}async function Iy(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){la(Ty,"Using user provided OfflineComponentProvider");try{await Cy(e,e._uninitializedComponentsProvider._offline)}catch(IT){const n=IT;if(!function(e){return"FirebaseError"===e.name?e.code===ga.FAILED_PRECONDITION||e.code===ga.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(n))throw n;ua("Error using user provided cache. Falling back to memory cache: "+n),await Cy(e,new by)}}else la(Ty,"Using default OfflineComponentProvider"),await Cy(e,new _y(void 0));return e._offlineComponents}async function Py(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(la(Ty,"Using user provided OnlineComponentProvider"),await Ny(e,e._uninitializedComponentsProvider._online)):(la(Ty,"Using default OnlineComponentProvider"),await Ny(e,new Sy))),e._onlineComponents}function Ay(e){return Py(e).then(e=>e.syncEngine)}async function Ry(e){const t=await Py(e),n=t.eventManager;return n.onListen=$v.bind(null,t.syncEngine),n.onUnlisten=Wv.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=qv.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=Kv.bind(null,t.syncEngine),n}function Dy(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new ya;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,r,i){const s=new ky({next:a=>{s.Ou(),t.enqueueAndForget(()=>Nv(e,o));const l=a.docs.has(n);!l&&a.fromCache?i.reject(new va(ga.UNAVAILABLE,"Failed to get document because the client is offline.")):l&&a.fromCache&&r&&"server"===r.source?i.reject(new va(ga.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(a)},error:e=>i.reject(e)}),o=new Ov(Pd(n.path),s,{includeMetadataChanges:!0,ka:!0});return Cv(e,o)}(await Ry(e),e.asyncQueue,t,n,r)),r.promise}function Oy(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new ya;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,r,i){const s=new ky({next:n=>{s.Ou(),t.enqueueAndForget(()=>Nv(e,o)),n.fromCache&&"server"===r.source?i.reject(new va(ga.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:e=>i.reject(e)}),o=new Ov(n,s,{includeMetadataChanges:!0,ka:!0});return Cv(e,o)}(await Ry(e),e.asyncQueue,t,n,r)),r.promise}function jy(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const Ly=new Map,My="firestore.googleapis.com",Fy=!0;class Uy{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new va(ga.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=My,this.ssl=Fy}else this.host=e.host,this.ssl=null!==(t=e.ssl)&&void 0!==t?t:Fy;if(this.isUsingEmulator=void 0!==e.emulatorOptions,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=Vp;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<tm)throw new va(ga.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,r){if(!0===t&&!0===r)throw new va(ga.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=jy(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new va(ga.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new va(ga.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new va(ga.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Vy{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Uy({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new va(ga.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new va(ga.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Uy(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new _a;switch(e.type){case"firstParty":return new ka(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new va(ga.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Ly.get(e);t&&(la("ComponentProvider","Removing Datastore"),Ly.delete(e),t.terminate())}(this),Promise.resolve()}}class zy{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new zy(this.firestore,e,this._query)}}class $y{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new qy(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new $y(this.firestore,e,this._key)}toJSON(){return{type:$y._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(Ya(t,$y._jsonSchema))return new $y(e,n||null,new za(Fa.fromString(t.referencePath)))}}$y._jsonSchemaVersion="firestore/documentReference/1.0",$y._jsonSchema={type:Qa("string",$y._jsonSchemaVersion),referencePath:Qa("string")};class qy extends zy{constructor(e,t,n){super(e,t,Pd(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new $y(this.firestore,null,new za(e))}withConverter(e){return new qy(this.firestore,e,this._path)}}function By(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=Lt(e),$a("collection","path",t),e instanceof Vy){const n=Fa.fromString(t,...r);return Ba(n),new qy(e,null,n)}{if(!(e instanceof $y||e instanceof qy))throw new va(ga.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Fa.fromString(t,...r));return Ba(n),new qy(e.firestore,null,n)}}function Hy(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=Lt(e),1===arguments.length&&(t=Ia.newId()),$a("doc","path",t),e instanceof Vy){const n=Fa.fromString(t,...r);return qa(n),new $y(e,null,new za(n))}{if(!(e instanceof $y||e instanceof qy))throw new va(ga.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Fa.fromString(t,...r));return qa(n),new $y(e.firestore,e instanceof qy?e.converter:null,new za(n))}}const Wy="AsyncQueue";class Ky{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new Og(this,"async_queue_retry"),this.oc=()=>{const e=Rg();e&&la(Wy,"Visibility state changed to "+e.visibilityState),this.F_.y_()},this._c=e;const t=Rg();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const t=Rg();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});const t=new ya;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}async cc(){if(0!==this.Zu.length){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(NT){if(!wl(NT))throw NT;la(Wy,"Operation failed with retryable error: "+NT)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(e){const t=this._c.then(()=>(this.nc=!0,e().catch(e=>{throw this.tc=e,this.nc=!1,ca("INTERNAL UNHANDLED ERROR: ",Gy(e)),e}).then(e=>(this.nc=!1,e))));return this._c=t,t}enqueueAfterDelay(e,t,n){this.ac(),this.sc.indexOf(e)>-1&&(t=0);const r=bv.createAndSchedule(this,e,t,n,e=>this.lc(e));return this.ec.push(r),r}ac(){this.tc&&ha(47125,{hc:Gy(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do{e=this._c,await e}while(e!==this._c)}Tc(e){for(const t of this.ec)if(t.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{this.ec.sort((e,t)=>e.targetTimeMs-t.targetTimeMs);for(const t of this.ec)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){const t=this.ec.indexOf(e);this.ec.splice(t,1)}}function Gy(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}function Qy(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const r of t)if(r in n&&"function"==typeof n[r])return!0;return!1}(e,["next","error","complete"])}class Yy extends Vy{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new Ky,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Ky(e),this._firestoreClient=void 0,await e}}}function Xy(e){if(e._terminated)throw new va(ga.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||Jy(e),e._firestoreClient}function Jy(e){var t,n,r;const i=e._freezeSettings(),s=function(e,t,n,r){return new mu(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,jy(r.experimentalLongPollingOptions),r.useFetchStreams,r.isUsingEmulator)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,i);e._componentsProvider||(null===(n=i.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=i.localCache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),e._firestoreClient=new Ey(e._authCredentials,e._appCheckCredentials,e._queue,s,e._componentsProvider&&function(e){const t=null==e?void 0:e._online.build();return{_offline:null==e?void 0:e._offline.build(t),_online:t}}(e._componentsProvider))}function Zy(e,t,n){if((e=Ka(e,Yy))._firestoreClient||e._terminated)throw new va(ga.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(e._componentsProvider||e._getSettings().localCache)throw new va(ga.FAILED_PRECONDITION,"SDK cache is already specified.");e._componentsProvider={_online:t,_offline:n},Jy(e)}class eb{constructor(e){this._byteString=e}static fromBase64String(e){try{return new eb(ru.fromBase64String(e))}catch(e){throw new va(ga.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new eb(ru.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:eb._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Ya(e,eb._jsonSchema))return eb.fromBase64String(e.bytes)}}eb._jsonSchemaVersion="firestore/bytes/1.0",eb._jsonSchema={type:Qa("string",eb._jsonSchemaVersion),bytes:Qa("string")};class tb{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let r=0;r<t.length;++r)if(0===t[r].length)throw new va(ga.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Va(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class nb{constructor(e){this._methodName=e}}class rb{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new va(ga.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new va(ga.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Pa(this._lat,e._lat)||Pa(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:rb._jsonSchemaVersion}}static fromJSON(e){if(Ya(e,rb._jsonSchema))return new rb(e.latitude,e.longitude)}}rb._jsonSchemaVersion="firestore/geoPoint/1.0",rb._jsonSchema={type:Qa("string",rb._jsonSchemaVersion),latitude:Qa("number"),longitude:Qa("number")};class ib{constructor(e){this._values=(e||[]).map(e=>e)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}toJSON(){return{type:ib._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Ya(e,ib._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(e=>"number"==typeof e))return new ib(e.vectorValues);throw new va(ga.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ib._jsonSchemaVersion="firestore/vectorValue/1.0",ib._jsonSchema={type:Qa("string",ib._jsonSchemaVersion),vectorValues:Qa("object")};const sb=/^__.*__$/;class ob{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new Ah(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ph(e,this.data,t,this.fieldTransforms)}}class ab{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Ah(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function lb(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ha(40011,{Ec:e})}}class cb{constructor(e,t,n,r,i,s){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Ac(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new cb(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Rc({path:n,mc:!1});return r.fc(e),r}gc(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Rc({path:n,mc:!1});return r.Ac(),r}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return kb(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(0===e.length)throw this.wc("Document fields must not be empty");if(lb(this.Ec)&&sb.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class ub{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||Dg(e)}Dc(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new cb({Ec:e,methodName:t,bc:n,path:Va.emptyPath(),mc:!1,Sc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function db(e){const t=e._freezeSettings(),n=Dg(e._databaseId);return new ub(e._databaseId,!!t.ignoreUndefinedProperties,n)}function hb(e,t,n,r,i){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const o=e.Dc(s.merge||s.mergeFields?2:0,t,n,i);_b("Data must be an object, but it was:",o,r);const a=yb(r,o);let l,c;if(s.merge)l=new tu(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const e=[];for(const r of s.mergeFields){const i=wb(t,r,n);if(!o.contains(i))throw new va(ga.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);Tb(e,i)||e.push(i)}l=new tu(e),c=o.fieldTransforms.filter(e=>l.covers(e.field))}else l=null,c=o.fieldTransforms;return new ob(new Ku(a),l,c)}class fb extends nb{_toFieldTransform(e){if(2!==e.Ec)throw 1===e.Ec?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof fb}}function pb(e,t,n,r){const i=e.Dc(1,t,n);_b("Data must be an object, but it was:",i,r);const s=[],o=Ku.empty();Kc(r,(e,r)=>{const a=Sb(t,e,n);r=Lt(r);const l=i.gc(a);if(r instanceof fb)s.push(a);else{const e=vb(r,l);null!=e&&(s.push(a),o.set(a,e))}});const a=new tu(s);return new ab(o,a,i.fieldTransforms)}function mb(e,t,n,r,i,s){const o=e.Dc(1,t,n),a=[wb(t,r,n)],l=[i];if(s.length%2!=0)throw new va(ga.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<s.length;h+=2)a.push(wb(t,s[h])),l.push(s[h+1]);const c=[],u=Ku.empty();for(let h=a.length-1;h>=0;--h)if(!Tb(c,a[h])){const e=a[h];let t=l[h];t=Lt(t);const n=o.gc(e);if(t instanceof fb)c.push(e);else{const r=vb(t,n);null!=r&&(c.push(e),u.set(e,r))}}const d=new tu(c);return new ab(u,d,o.fieldTransforms)}function gb(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return vb(n,e.Dc(r?4:3,t))}function vb(e,t){if(bb(e=Lt(e)))return _b("Unsupported field value:",t,e),yb(e,t);if(e instanceof nb)return function(e,t){if(!lb(t.Ec))throw t.wc(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.wc(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.mc&&4!==t.Ec)throw t.wc("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=vb(i,t.yc(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=Lt(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return ah(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=Za.fromDate(e);return{timestampValue:hf(t.serializer,n)}}if(e instanceof Za){const n=new Za(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:hf(t.serializer,n)}}if(e instanceof rb)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof eb)return{bytesValue:ff(t.serializer,e._byteString)};if(e instanceof $y){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.wc(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:gf(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof ib)return function(e,t){return{mapValue:{fields:{[yu]:{stringValue:wu},[xu]:{arrayValue:{values:e.toArray().map(e=>{if("number"!=typeof e)throw t.wc("VectorValues must only contain numeric values.");return sh(t.serializer,e)})}}}}}}(e,t);throw t.wc(`Unsupported field value: ${Wa(e)}`)}(e,t)}function yb(e,t){const n={};return Gc(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Kc(e,(e,r)=>{const i=vb(r,t.Vc(e));null!=i&&(n[e]=i)}),{mapValue:{fields:n}}}function bb(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Za||e instanceof rb||e instanceof eb||e instanceof $y||e instanceof nb||e instanceof ib)}function _b(e,t,n){if(!bb(n)||!Ha(n)){const r=Wa(n);throw"an object"===r?t.wc(e+" a custom object"):t.wc(e+" "+r)}}function wb(e,t,n){if((t=Lt(t))instanceof tb)return t._internalPath;if("string"==typeof t)return Sb(e,t);throw kb("Field path arguments must be of type string or ",e,!1,void 0,n)}const xb=new RegExp("[~\\*/\\[\\]]");function Sb(e,t,n){if(t.search(xb)>=0)throw kb(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new tb(...t.split("."))._internalPath}catch(r){throw kb(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function kb(e,t,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new va(ga.INVALID_ARGUMENT,a+e+l)}function Tb(e,t){return e.some(e=>e.isEqual(t))}class Eb{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new $y(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new Cb(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Nb("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class Cb extends Eb{data(){return super.data()}}function Nb(e,t){return"string"==typeof t?Sb(e,t):t instanceof tb?t._internalPath:t._delegate._internalPath}function Ib(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new va(ga.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Pb{}class Ab extends Pb{}function Rb(e,t){let n=[];for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];t instanceof Pb&&n.push(t),n=n.concat(i),function(e){const t=e.filter(e=>e instanceof jb).length,n=e.filter(e=>e instanceof Db).length;if(t>1||t>0&&n>0)throw new va(ga.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const o of n)e=o._apply(e);return e}class Db extends Ab{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new Db(e,t,n)}_apply(e){const t=this._parse(e);return Vb(e._query,t),new zy(e.firestore,e.converter,Ld(e._query,t))}_parse(e){const t=db(e.firestore),n=function(e,t,n,r,i,s,o){let a;if(i.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new va(ga.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on documentId().`);if("in"===s||"not-in"===s){Ub(o,s);const t=[];for(const n of o)t.push(Fb(r,e,n));a={arrayValue:{values:t}}}else a=Fb(r,e,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||Ub(o,s),a=gb(n,t,o,"in"===s||"not-in"===s);return nd.create(i,s,a)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return n}}function Ob(e,t,n){const r=t,i=Nb("where",e);return Db._create(i,r,n)}class jb extends Pb{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new jb(e,t)}_parse(e){const t=this._queryConstraints.map(t=>t._parse(e)).filter(e=>e.getFilters().length>0);return 1===t.length?t[0]:rd.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const i of r)Vb(n,i),n=Ld(n,i)}(e._query,t),new zy(e.firestore,e.converter,Ld(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class Lb extends Ab{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Lb(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new va(ga.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new va(ga.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Zu(t,n)}(e._query,this._field,this._direction);return new zy(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new Nd(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}class Mb extends Ab{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new Mb(e,t,n)}_apply(e){return new zy(e.firestore,e.converter,Md(e._query,this._limit,this._limitType))}}function Fb(e,t,n){if("string"==typeof(n=Lt(n))){if(""===n)throw new va(ga.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Rd(t)&&-1!==n.indexOf("/"))throw new va(ga.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=t.path.child(Fa.fromString(n));if(!za.isDocumentKey(r))throw new va(ga.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Du(e,new za(r))}if(n instanceof $y)return Du(e,n._key);throw new va(ga.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Wa(n)}.`)}function Ub(e,t){if(!Array.isArray(e)||0===e.length)throw new va(ga.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function Vb(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new va(ga.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new va(ga.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}class zb{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(ku(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ou(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(au(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw ha(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const n={};return Kc(e,(e,r)=>{n[e]=this.convertValue(r,t)}),n}convertVectorValue(e){var t,n,r;const i=null===(r=null===(n=null===(t=e.fields)||void 0===t?void 0:t[xu].arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.map(e=>ou(e.doubleValue));return new ib(i)}convertGeoPoint(e){return new rb(ou(e.latitude),ou(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=fu(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(pu(e));default:return null}}convertTimestamp(e){const t=su(e);return new Za(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Fa.fromString(e);pa(Vf(n),9688,{name:e});const r=new vu(n.get(1),n.get(3)),i=new za(n.popFirst(5));return r.isEqual(t)||ca(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}function $b(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class qb{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Bb extends Eb{constructor(e,t,n,r,i,s){super(e,t,n,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new Hb(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(Nb("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new va(ga.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Bb._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),e&&e.isValidDocument()&&e.isFoundDocument()?(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t):t}}Bb._jsonSchemaVersion="firestore/documentSnapshot/1.0",Bb._jsonSchema={type:Qa("string",Bb._jsonSchemaVersion),bundleSource:Qa("string","DocumentSnapshot"),bundleName:Qa("string"),bundle:Qa("string")};class Hb extends Bb{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class Wb{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new qb(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new Hb(this._firestore,this._userDataWriter,n.key,n,new qb(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new va(ga.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(n=>{const r=new Hb(e._firestore,e._userDataWriter,n.doc.key,n.doc,new qb(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}})}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{const r=new Hb(e._firestore,e._userDataWriter,t.doc.key,t.doc,new qb(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,s=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),s=n.indexOf(t.doc.key)),{type:Kb(t.type),doc:r,oldIndex:i,newIndex:s}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new va(ga.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Wb._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Ia.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],r=[];return this.docs.forEach(e=>{null!==e._document&&(t.push(e._document),n.push(this._userDataWriter.convertObjectMap(e._document.data.value.mapValue.fields,"previous")),r.push(e.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Kb(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ha(61501,{type:e})}}function Gb(e){e=Ka(e,$y);const t=Ka(e.firestore,Yy);return Dy(Xy(t),e._key).then(n=>r_(t,e,n))}Wb._jsonSchemaVersion="firestore/querySnapshot/1.0",Wb._jsonSchema={type:Qa("string",Wb._jsonSchemaVersion),bundleSource:Qa("string","QuerySnapshot"),bundleName:Qa("string"),bundle:Qa("string")};class Qb extends zb{constructor(e){super(),this.firestore=e}convertBytes(e){return new eb(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new $y(this.firestore,null,t)}}function Yb(e){e=Ka(e,zy);const t=Ka(e.firestore,Yy),n=Xy(t),r=new Qb(t);return Ib(e._query),Oy(n,e._query).then(n=>new Wb(t,r,e,n))}function Xb(e,t,n){e=Ka(e,$y);const r=Ka(e.firestore,Yy),i=$b(e.converter,t,n);return n_(r,[hb(db(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,xh.none())])}function Jb(e,t,n){e=Ka(e,$y);const r=Ka(e.firestore,Yy),i=db(r);let s;for(var o=arguments.length,a=new Array(o>3?o-3:0),l=3;l<o;l++)a[l-3]=arguments[l];return s="string"==typeof(t=Lt(t))||t instanceof tb?mb(i,"updateDoc",e._key,t,n,a):pb(i,"updateDoc",e._key,t),n_(r,[s.toMutation(e._key,xh.exists(!0))])}function Zb(e){return n_(Ka(e.firestore,Yy),[new jh(e._key,xh.none())])}function e_(e,t){const n=Ka(e.firestore,Yy),r=Hy(e),i=$b(e.converter,t);return n_(n,[hb(db(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,xh.exists(!1))]).then(()=>r)}function t_(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i,s,o;e=Lt(e);let a={includeMetadataChanges:!1,source:"default"},l=0;"object"!=typeof n[l]||Qy(n[l])||(a=n[l++]);const c={includeMetadataChanges:a.includeMetadataChanges,source:a.source};if(Qy(n[l])){const e=n[l];n[l]=null===(i=e.next)||void 0===i?void 0:i.bind(e),n[l+1]=null===(s=e.error)||void 0===s?void 0:s.bind(e),n[l+2]=null===(o=e.complete)||void 0===o?void 0:o.bind(e)}let u,d,h;if(e instanceof $y)d=Ka(e.firestore,Yy),h=Pd(e._key.path),u={next:t=>{n[l]&&n[l](r_(d,e,t))},error:n[l+1],complete:n[l+2]};else{const t=Ka(e,zy);d=Ka(t.firestore,Yy),h=t._query;const r=new Qb(d);u={next:e=>{n[l]&&n[l](new Wb(d,r,t,e))},error:n[l+1],complete:n[l+2]},Ib(e._query)}return function(e,t,n,r){const i=new ky(r),s=new Ov(t,i,n);return e.asyncQueue.enqueueAndForget(async()=>Cv(await Ry(e),s)),()=>{i.Ou(),e.asyncQueue.enqueueAndForget(async()=>Nv(await Ry(e),s))}}(Xy(d),h,c,u)}function n_(e,t){return function(e,t){const n=new ya;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t,n){const r=yy(e);try{const e=await function(e,t){const n=ma(e),r=Za.now(),i=t.reduce((e,t)=>e.add(t.key),nh());let s,o;return n.persistence.runTransaction("Locally write mutations","readwrite",e=>{let a=Kd(),l=nh();return n.Os.getEntries(e,i).next(e=>{a=e,a.forEach((e,t)=>{t.isValidDocument()||(l=l.add(e))})}).next(()=>n.localDocuments.getOverlayedDocuments(e,a)).next(i=>{s=i;const o=[];for(const e of t){const t=Nh(e,s.get(e.key).overlayedDocument);null!=t&&o.push(new Ah(e.key,t,Gu(t.value.mapValue),xh.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,o,t)}).next(t=>{o=t;const r=t.applyToLocalDocumentSet(s,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)})}).then(()=>({batchId:o.batchId,changes:Yd(s)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Ru[e.currentUser.toKey()];r||(r=new Qc(Pa)),r=r.insert(t,n),e.Ru[e.currentUser.toKey()]=r}(r,e.batchId,n),await oy(r,e.changes),await ov(r.remoteStore)}catch(e){const t=_v(e,"Failed to persist write");n.reject(t)}}(await Ay(e),t,n)),n.promise}(Xy(e),t)}function r_(e,t,n){const r=n.docs.get(t._key),i=new Qb(e);return new Bb(e,i,t._key,r,new qb(n.hasPendingWrites,n.fromCache),t.converter)}class i_{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=db(e)}set(e,t,n){this._verifyNotCommitted();const r=s_(e,this._firestore),i=$b(r.converter,t,n),s=hb(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(s.toMutation(r._key,xh.none())),this}update(e,t,n){this._verifyNotCommitted();const r=s_(e,this._firestore);let i;for(var s=arguments.length,o=new Array(s>3?s-3:0),a=3;a<s;a++)o[a-3]=arguments[a];return i="string"==typeof(t=Lt(t))||t instanceof tb?mb(this._dataReader,"WriteBatch.update",r._key,t,n,o):pb(this._dataReader,"WriteBatch.update",r._key,t),this._mutations.push(i.toMutation(r._key,xh.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=s_(e,this._firestore);return this._mutations=this._mutations.concat(new jh(t._key,xh.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new va(ga.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function s_(e,t){if((e=Lt(e)).firestore!==t)throw new va(ga.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}function o_(){return new fb("deleteField")}function a_(e){return Xy(e=Ka(e,Yy)),new i_(e,t=>n_(e,t))}new WeakMap;!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){sa=e}(Jn),Kn(new Mt("firestore",(e,n)=>{let{instanceIdentifier:r,options:i}=n;const s=e.getProvider("app").getImmediate(),o=new Yy(new xa(e.getProvider("auth-internal")),new Ea(s,e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new va(ga.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new vu(e.options.projectId,t)}(s,r),s);return i=Object.assign({useFetchStreams:t},i),o._setSettings(i),o},"PUBLIC").setMultipleInstances(!0)),tr(na,ra,e),tr(na,ra,"esm2017")}();const l_="@firebase/database",c_="1.0.20";let u_="";function d_(e){u_=e}class h_{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),_t(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:bt(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class f_{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return xt(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const p_=function(e){try{if("undefined"!==typeof window&&"undefined"!==typeof window[e]){const t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new h_(t)}}catch(NT){}return new f_},m_=p_("localStorage"),g_=p_("sessionStorage"),v_=new Kt("@firebase/database"),y_=function(){let e=1;return function(){return e++}}(),b_=function(e){const t=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);if(i>=55296&&i<=56319){const t=i-55296;r++,Fe(r<e.length,"Surrogate pair missing trail surrogate."),i=65536+(t<<10)+(e.charCodeAt(r)-56320)}i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):i<65536?(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t}(e),n=new At;n.update(t);const r=n.digest();return ze.encodeByteArray(r)},__=function(){let e="";for(let t=0;t<arguments.length;t++){const n=t<0||arguments.length<=t?void 0:arguments[t];Array.isArray(n)||n&&"object"===typeof n&&"number"===typeof n.length?e+=__.apply(null,n):e+="object"===typeof n?_t(n):n,e+=" "}return e};let w_=null,x_=!0;const S_=function(e,t){Fe(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(v_.logLevel=$t.VERBOSE,w_=v_.log.bind(v_),t&&g_.set("logging_enabled",!0)):"function"===typeof e?w_=e:(w_=null,g_.remove("logging_enabled"))},k_=function(){if(!0===x_&&(x_=!1,null===w_&&!0===g_.get("logging_enabled")&&S_(!0)),w_){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=__.apply(null,t);w_(r)}},T_=function(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];k_(e,...n)}},E_=function(){const e="FIREBASE INTERNAL ERROR: "+__(...arguments);v_.error(e)},C_=function(){const e=`FIREBASE FATAL ERROR: ${__(...arguments)}`;throw v_.error(e),new Error(e)},N_=function(){const e="FIREBASE WARNING: "+__(...arguments);v_.warn(e)},I_=function(e){return"number"===typeof e&&(e!==e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},P_="[MIN_NAME]",A_="[MAX_NAME]",R_=function(e,t){if(e===t)return 0;if(e===P_||t===A_)return-1;if(t===P_||e===A_)return 1;{const n=V_(e),r=V_(t);return null!==n?null!==r?n-r===0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1}},D_=function(e,t){return e===t?0:e<t?-1:1},O_=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+_t(t))},j_=function(e){if("object"!==typeof e||null===e)return _t(e);const t=[];for(const r in e)t.push(r);t.sort();let n="{";for(let r=0;r<t.length;r++)0!==r&&(n+=","),n+=_t(t[r]),n+=":",n+=j_(e[t[r]]);return n+="}",n},L_=function(e,t){const n=e.length;if(n<=t)return[e];const r=[];for(let i=0;i<n;i+=t)i+t>n?r.push(e.substring(i,n)):r.push(e.substring(i,i+t));return r};function M_(e,t){for(const n in e)e.hasOwnProperty(n)&&t(n,e[n])}const F_=function(e){Fe(!I_(e),"Invalid JSON number");const t=1023;let n,r,i,s,o;0===e?(r=0,i=0,n=1/e===-1/0?1:0):(n=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(s=Math.min(Math.floor(Math.log(e)/Math.LN2),t),r=s+t,i=Math.round(e*Math.pow(2,52-s)-Math.pow(2,52))):(r=0,i=Math.round(e/Math.pow(2,-1074))));const a=[];for(o=52;o;o-=1)a.push(i%2?1:0),i=Math.floor(i/2);for(o=11;o;o-=1)a.push(r%2?1:0),r=Math.floor(r/2);a.push(n?1:0),a.reverse();const l=a.join("");let c="";for(o=0;o<64;o+=8){let e=parseInt(l.substr(o,8),2).toString(16);1===e.length&&(e="0"+e),c+=e}return c.toLowerCase()};const U_=new RegExp("^-?(0*)\\d{1,10}$"),V_=function(e){if(U_.test(e)){const t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},z_=function(e){try{e()}catch(NT){setTimeout(()=>{const t=NT.stack||"";throw N_("Exception was thrown by user callback.",t),NT},Math.floor(0))}},$_=function(e,t){const n=setTimeout(e,t);return"number"===typeof n&&"undefined"!==typeof Deno&&Deno.unrefTimer?Deno.unrefTimer(n):"object"===typeof n&&n.unref&&n.unref(),n};class q_{constructor(e,t){this.appCheckProvider=t,this.appName=e.name,Qn(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=null===t||void 0===t?void 0:t.getImmediate({optional:!0}),this.appCheck||null===t||void 0===t||t.get().then(e=>this.appCheck=e)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((t,n)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,n):t(null)},0)})}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then(t=>t.addTokenListener(e))}notifyForInvalidToken(){N_(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}class B_{constructor(e,t,n){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit(e=>this.auth_=e)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(e=>e&&"auth/token-not-initialized"===e.code?(k_("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)):new Promise((t,n)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,n):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',N_(e)}}class H_{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}H_.OWNER="owner";const W_="5",K_=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,G_="ac",Q_="websocket",Y_="long_polling";class X_{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],a=arguments.length>7&&void 0!==arguments[7]&&arguments[7],l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null;this.secure=t,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=s,this.includeNamespaceInQueryParams=o,this.isUsingEmulator=a,this.emulatorOptions=l,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=m_.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&m_.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function J_(e,t,n){let r;if(Fe("string"===typeof t,"typeof type must == string"),Fe("object"===typeof n,"typeof params must == object"),t===Q_)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==Y_)throw new Error("Unknown connection type: "+t);r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);const i=[];return M_(n,(e,t)=>{i.push(e+"="+t)}),r+i.join("&")}class Z_{constructor(){this.counters_={}}incrementCounter(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;xt(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return We(this.counters_)}}const ew={},tw={};function nw(e){const t=e.toString();return ew[t]||(ew[t]=new Z_),ew[t]}class rw{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const e=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let t=0;t<e.length;++t)e[t]&&z_(()=>{this.onMessage_(e[t])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}const iw="start";class sw{constructor(e,t,n,r,i,s,o){this.connId=e,this.repoInfo=t,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.transportSessionId=s,this.lastSessionId=o,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=T_(e),this.stats_=nw(t),this.urlFn=e=>(this.appCheckToken&&(e[G_]=this.appCheckToken),J_(t,Y_,e))}open(e,t){var n=this;this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new rw(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(3e4)),function(e){if(ht()||"complete"===document.readyState)e();else{let t=!1;const n=function(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&n()}),window.attachEvent("onload",n))}}(()=>{if(this.isClosed_)return;this.scriptTagHolder=new ow(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const[i,s,o,a,l]=t;if(n.incrementIncomingBytes_(t),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,i===iw)n.id=s,n.password=o;else{if("close"!==i)throw new Error("Unrecognized command received: "+i);s?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(s,()=>{n.onClosed_()})):n.onClosed_()}},function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const[i,s]=t;n.incrementIncomingBytes_(t),n.myPacketOrderer.handleResponse(i,s)},()=>{this.onClosed_()},this.urlFn);const e={};e[iw]="t",e.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=this.scriptTagHolder.uniqueCallbackIdentifier),e.v=W_,this.transportSessionId&&(e.s=this.transportSessionId),this.lastSessionId&&(e.ls=this.lastSessionId),this.applicationId&&(e.p=this.applicationId),this.appCheckToken&&(e[G_]=this.appCheckToken),"undefined"!==typeof location&&location.hostname&&K_.test(location.hostname)&&(e.r="f");const t=this.urlFn(e);this.log_("Connecting via long-poll to "+t),this.scriptTagHolder.addTag(t,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){sw.forceAllow_=!0}static forceDisallow(){sw.forceDisallow_=!0}static isAvailable(){return!ht()&&(!!sw.forceAllow_||!sw.forceDisallow_&&"undefined"!==typeof document&&null!=document.createElement&&!("object"===typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))&&!("object"===typeof Windows&&"object"===typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=_t(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=qe(t),r=L_(n,1840);for(let i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if(ht())return;this.myDisconnFrame=document.createElement("iframe");const n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=_t(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class ow{constructor(e,t,n,r){if(this.onDisconnect=n,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,ht())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=y_(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=ow.createIFrame_();let n="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)){n='<script>document.domain="'+document.domain+'";<\/script>'}const r="<html><body>"+n+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(r),this.myIFrame.doc.close()}catch(NT){k_("frame writing exception"),NT.stack&&k_(NT.stack),k_(NT)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||k_("No IE domain setting required")}catch(NT){const n=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),n="",r=0;for(;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+n.length<=1870))break;{const e=this.pendingSegs.shift();n=n+"&seg"+r+"="+e.seg+"&ts"+r+"="+e.ts+"&d"+r+"="+e.d,r++}}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const n=()=>{this.outstandingRequests.delete(t),this.newRequest_()},r=setTimeout(n,Math.floor(25e3));this.addTag(e,()=>{clearTimeout(r),n()})}addTag(e,t){ht()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(){const e=n.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),t())},n.onerror=()=>{k_("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch(NT){}},Math.floor(1))}}let aw=null;"undefined"!==typeof MozWebSocket?aw=MozWebSocket:"undefined"!==typeof WebSocket&&(aw=WebSocket);class lw{constructor(e,t,n,r,i,s,o){this.connId=e,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=T_(this.connId),this.stats_=nw(t),this.connURL=lw.connectionURL_(t,s,o,r,n),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,n,r,i){const s={};return s.v=W_,!ht()&&"undefined"!==typeof location&&location.hostname&&K_.test(location.hostname)&&(s.r="f"),t&&(s.s=t),n&&(s.ls=n),r&&(s[G_]=r),i&&(s.p=i),J_(e,Q_,s)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,m_.set("previous_websocket_failure",!0);try{let e;if(ht()){const t=this.nodeAdmin?"AdminNode":"Node";e={headers:{"User-Agent":`Firebase/${W_}/${u_}/${process.platform}/${t}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(e.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(e.headers["X-Firebase-AppCheck"]=this.appCheckToken);const n={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0},r=0===this.connURL.indexOf("wss://")?n.HTTPS_PROXY||n.https_proxy:n.HTTP_PROXY||n.http_proxy;r&&(e.proxy={origin:r})}this.mySock=new aw(this.connURL,[],e)}catch(NT){this.log_("Error instantiating WebSocket.");const t=NT.message||NT.data;return t&&this.log_(t),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=e=>{this.handleIncomingFrame(e)},this.mySock.onerror=e=>{this.log_("WebSocket error.  Closing connection.");const t=e.message||e.data;t&&this.log_(t),this.onClosed_()}}start(){}static forceDisallow(){lw.forceDisallow_=!0}static isAvailable(){let e=!1;if("undefined"!==typeof navigator&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(t);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==aw&&!lw.forceDisallow_}static previouslyFailed(){return m_.isInMemoryStorage||!0===m_.get("previous_websocket_failure")}markConnectionHealthy(){m_.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const e=this.frames.join("");this.frames=null;const t=bt(e);this.onMessage(t)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(Fe(null===this.frames,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(null===this.mySock)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{const e=this.extractFrameCount_(t);null!==e&&this.appendFrame_(e)}}send(e){this.resetKeepAlive();const t=_t(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=L_(t,16384);n.length>1&&this.sendString_(String(n.length));for(let r=0;r<n.length;r++)this.sendString_(n[r])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(45e3))}sendString_(e){try{this.mySock.send(e)}catch(NT){this.log_("Exception thrown from WebSocket.send():",NT.message||NT.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}lw.responsesRequiredToBeHealthy=2,lw.healthyTimeout=3e4;class cw{static get ALL_TRANSPORTS(){return[sw,lw]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const t=lw&&lw.isAvailable();let n=t&&!lw.previouslyFailed();if(e.webSocketOnly&&(t||N_("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[lw];else{const e=this.transports_=[];for(const t of cw.ALL_TRANSPORTS)t&&t.isAvailable()&&e.push(t);cw.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}cw.globalTransportInitialized_=!1;class uw{constructor(e,t,n,r,i,s,o,a,l,c){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=s,this.onReady_=o,this.onDisconnect_=a,this.onKill_=l,this.lastSessionId=c,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=T_("c:"+this.id+":"),this.transportManager_=new cw(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,n)},Math.floor(0));const r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=$_(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=O_("t",e),n=O_("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=O_("t",e),n=O_("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=O_("t",e);if("d"in e){const n=e.d;if("h"===t){const e=Object.assign({},n);this.repoInfo_.isUsingEmulator&&(e.h=this.repoInfo_.host),this.onHandshake_(e)}else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let e=0;e<this.pendingDataMessages.length;++e)this.onDataMessage_(this.pendingDataMessages[e]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?E_("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):E_("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),W_!==n&&N_("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,n),$_(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):$_(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(m_.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class dw{put(e,t,n,r){}merge(e,t,n,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,n){}onDisconnectMerge(e,t,n){}onDisconnectCancel(e,t){}reportStats(e){}}class hw{constructor(e){this.allowedEvents_=e,this.listeners_={},Fe(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e){if(Array.isArray(this.listeners_[e])){const i=[...this.listeners_[e]];for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(let e=0;e<i.length;e++)i[e].callback.apply(i[e].context,n)}}on(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});const r=this.getInitialEvent(e);r&&t.apply(n,r)}off(e,t,n){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let i=0;i<r.length;i++)if(r[i].callback===t&&(!n||n===r[i].context))return void r.splice(i,1)}validateEventType_(e){Fe(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}class fw extends hw{static getInstance(){return new fw}constructor(){super(["online"]),this.online_=!0,"undefined"===typeof window||"undefined"===typeof window.addEventListener||ct()||(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return Fe("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}class pw{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let t=0;for(let e=0;e<this.pieces_.length;e++)this.pieces_[e].length>0&&(this.pieces_[t]=this.pieces_[e],t++);this.pieces_.length=t,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function mw(){return new pw("")}function gw(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function vw(e){return e.pieces_.length-e.pieceNum_}function yw(e){let t=e.pieceNum_;return t<e.pieces_.length&&t++,new pw(e.pieces_,t)}function bw(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function _w(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.pieces_.slice(e.pieceNum_+t)}function ww(e){if(e.pieceNum_>=e.pieces_.length)return null;const t=[];for(let n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new pw(t,0)}function xw(e,t){const n=[];for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);if(t instanceof pw)for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);else{const e=t.split("/");for(let t=0;t<e.length;t++)e[t].length>0&&n.push(e[t])}return new pw(n,0)}function Sw(e){return e.pieceNum_>=e.pieces_.length}function kw(e,t){const n=gw(e),r=gw(t);if(null===n)return t;if(n===r)return kw(yw(e),yw(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function Tw(e,t){if(vw(e)!==vw(t))return!1;for(let n=e.pieceNum_,r=t.pieceNum_;n<=e.pieces_.length;n++,r++)if(e.pieces_[n]!==t.pieces_[r])return!1;return!0}function Ew(e,t){let n=e.pieceNum_,r=t.pieceNum_;if(vw(e)>vw(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[r])return!1;++n,++r}return!0}class Cw{constructor(e,t){this.errorPrefix_=t,this.parts_=_w(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let n=0;n<this.parts_.length;n++)this.byteLength_+=jt(this.parts_[n]);Nw(this)}}function Nw(e){if(e.byteLength_>768)throw new Error(e.errorPrefix_+"has a key path longer than 768 bytes ("+e.byteLength_+").");if(e.parts_.length>32)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+Iw(e))}function Iw(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}class Pw extends hw{static getInstance(){return new Pw}constructor(){let e,t;super(["visible"]),"undefined"!==typeof document&&"undefined"!==typeof document.addEventListener&&("undefined"!==typeof document.hidden?(t="visibilitychange",e="hidden"):"undefined"!==typeof document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):"undefined"!==typeof document.msHidden?(t="msvisibilitychange",e="msHidden"):"undefined"!==typeof document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const t=!document[e];t!==this.visible_&&(this.visible_=t,this.trigger("visible",t))},!1)}getInitialEvent(e){return Fe("visible"===e,"Unknown event type: "+e),[this.visible_]}}const Aw=1e3;class Rw extends dw{constructor(e,t,n,r,i,s,o,a){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=n,this.onConnectStatus_=r,this.onServerInfoUpdate_=i,this.authTokenProvider_=s,this.appCheckTokenProvider_=o,this.authOverride_=a,this.id=Rw.nextPersistentConnectionId_++,this.log_=T_("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Aw,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,a&&!ht())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Pw.getInstance().on("visible",this.onVisible_,this),-1===e.host.indexOf("fblocal")&&fw.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,n){const r=++this.requestNumber_,i={r:r,a:e,b:t};this.log_(_t(i)),Fe(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)}get(e){this.initConnection_();const t=new tt,n={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:e=>{const n=e.d;"ok"===e.s?t.resolve(n):t.reject(n)}};this.outstandingGets_.push(n),this.outstandingGetCount_++;const r=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(r),t.promise}listen(e,t,n,r){this.initConnection_();const i=e._queryIdentifier,s=e._path.toString();this.log_("Listen called for "+s+" "+i),this.listens.has(s)||this.listens.set(s,new Map),Fe(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),Fe(!this.listens.get(s).has(i),"listen() called twice for same path/queryId.");const o={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(s).set(i,o),this.connected_&&this.sendListen_(o)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,n=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(n)})}sendListen_(e){const t=e.query,n=t._path.toString(),r=t._queryIdentifier;this.log_("Listen on "+n+" for "+r);const i={p:n};e.tag&&(i.q=t._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest("q",i,i=>{const s=i.d,o=i.s;Rw.warnOnListenWarnings_(s,t);(this.listens.get(n)&&this.listens.get(n).get(r))===e&&(this.log_("listen response",i),"ok"!==o&&this.removeListen_(n,r),e.onComplete&&e.onComplete(o,s))})}static warnOnListenWarnings_(e,t){if(e&&"object"===typeof e&&xt(e,"w")){const n=St(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const e='".indexOn": "'+t._queryParams.getIndex().toString()+'"',n=t._path.toString();N_(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${e} at ${n} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&40===e.length||function(e){const t=wt(e).claims;return"object"===typeof t&&!0===t.admin}(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=function(e){const t=wt(e).claims;return!!t&&"object"===typeof t&&t.hasOwnProperty("iat")}(e)?"auth":"gauth",n={cred:e};null===this.authOverride_?n.noauth=!0:"object"===typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(t,n,t=>{const n=t.s,r=t.d||"error";this.authToken_===e&&("ok"===n?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(n,r))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const t=e.s,n=e.d||"error";"ok"===t?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,n)})}unlisten(e,t){const n=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),Fe(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query");this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e._queryObject,t)}sendUnlisten_(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);const i={p:e};r&&(i.q=n,i.t=r),this.sendRequest("n",i)}onDisconnectPut(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}onDisconnectMerge(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,n,r){const i={p:t,d:n};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,e=>{r&&setTimeout(()=>{r(e.s,e.d)},Math.floor(0))})}put(e,t,n,r){this.putInternal("p",e,t,n,r)}merge(e,t,n,r){this.putInternal("m",e,t,n,r)}putInternal(e,t,n,r,i){this.initConnection_();const s={p:t,d:n};void 0!==i&&(s.h=i),this.outstandingPuts_.push({action:e,request:s,onComplete:r}),this.outstandingPutCount_++;const o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,n=this.outstandingPuts_[e].request,r=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,n,n=>{this.log_(t+" response",n),delete this.outstandingPuts_[e],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),r&&r(n.s,n.d)})}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,e=>{if("ok"!==e.s){const t=e.d;this.log_("reportStats","Error sending stats: "+t)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+_t(e));const t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):E_("Unrecognized action received from server: "+_t(e)+"\nAre you using the latest client?")}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){Fe(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Aw,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Aw,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=Aw),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();const e=Math.max(0,(new Date).getTime()-this.lastConnectionAttemptTime_);let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+Rw.nextConnectionId_++,i=this.lastSessionId;let s=!1,o=null;const a=function(){o?o.close():(s=!0,n())},l=function(e){Fe(o,"sendRequest call when we're not connected not allowed."),o.sendRequest(e)};this.realtime_={close:a,sendRequest:l};const c=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[a,l]=await Promise.all([this.authTokenProvider_.getToken(c),this.appCheckTokenProvider_.getToken(c)]);s?k_("getToken() completed but was canceled"):(k_("getToken() completed. Creating connection."),this.authToken_=a&&a.accessToken,this.appCheckToken_=l&&l.token,o=new uw(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,n,e=>{N_(e+" ("+this.repoInfo_.toString()+")"),this.interrupt("server_kill")},i))}catch(E_){this.log_("Failed to get token: "+E_),s||(this.repoInfo_.nodeAdmin&&N_(E_),a())}}}interrupt(e){k_("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){k_("Resuming connection for reason: "+e),delete this.interruptReasons_[e],kt(this.interruptReasons_)&&(this.reconnectDelay_=Aw,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let n;n=t?t.map(e=>j_(e)).join("$"):"default";const r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(e,t){const n=new pw(e).toString();let r;if(this.listens.has(n)){const e=this.listens.get(n);r=e.get(t),e.delete(t),0===e.size&&this.listens.delete(n)}else r=void 0;return r}onAuthRevoked_(e,t){k_("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){k_("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";ht()&&(t=this.repoInfo_.nodeAdmin?"admin_node":"node"),e["sdk."+t+"."+u_.replace(/\./g,"-")]=1,ct()?e["framework.cordova"]=1:dt()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=fw.getInstance().currentlyOnline();return kt(this.interruptReasons_)&&e}}Rw.nextPersistentConnectionId_=0,Rw.nextConnectionId_=0;class Dw{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new Dw(e,t)}}class Ow{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const n=new Dw(P_,e),r=new Dw(P_,t);return 0!==this.compare(n,r)}minPost(){return Dw.MIN}}let jw;class Lw extends Ow{static get __EMPTY_NODE(){return jw}static set __EMPTY_NODE(e){jw=e}compare(e,t){return R_(e.name,t.name)}isDefinedOn(e){throw Ue("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Dw.MIN}maxPost(){return new Dw(A_,jw)}makePost(e,t){return Fe("string"===typeof e,"KeyIndex indexValue must always be a string."),new Dw(e,jw)}toString(){return".key"}}const Mw=new Lw;class Fw{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,r&&(s*=-1),s<0)e=this.isReverse_?e.left:e.right;else{if(0===s){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Uw{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:Uw.RED,this.left=null!=r?r:Vw.EMPTY_NODE,this.right=null!=i?i:Vw.EMPTY_NODE}copy(e,t,n,r,i){return new Uw(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp_()}removeMin_(){if(this.left.isEmpty())return Vw.EMPTY_NODE;let e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let n,r;if(n=this,t(e,n.key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return Vw.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Uw.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Uw.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Uw.RED=!0,Uw.BLACK=!1;class Vw{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Vw.EMPTY_NODE;this.comparator_=e,this.root_=t}insert(e,t){return new Vw(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Uw.BLACK,null,null))}remove(e){return new Vw(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Uw.BLACK,null,null))}get(e){let t,n=this.root_;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t)return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}getPredecessorKey(e){let t,n=this.root_,r=null;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Fw(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Fw(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Fw(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Fw(this.root_,null,this.comparator_,!0,e)}}function zw(e,t){return R_(e.name,t.name)}function $w(e,t){return R_(e,t)}let qw;Vw.EMPTY_NODE=new class{copy(e,t,n,r,i){return this}insert(e,t,n){return new Uw(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const Bw=function(e){return"number"===typeof e?"number:"+F_(e):"string:"+e},Hw=function(e){if(e.isLeafNode()){const t=e.val();Fe("string"===typeof t||"number"===typeof t||"object"===typeof t&&xt(t,".sv"),"Priority must be a string or number.")}else Fe(e===qw||e.isEmpty(),"priority of unexpected type.");Fe(e===qw||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let Ww,Kw,Gw;class Qw{static set __childrenNodeConstructor(e){Ww=e}static get __childrenNodeConstructor(){return Ww}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qw.__childrenNodeConstructor.EMPTY_NODE;this.value_=e,this.priorityNode_=t,this.lazyHash_=null,Fe(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),Hw(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new Qw(this.value_,e)}getImmediateChild(e){return".priority"===e?this.priorityNode_:Qw.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return Sw(e)?this:".priority"===gw(e)?this.priorityNode_:Qw.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return".priority"===e?this.updatePriority(t):t.isEmpty()&&".priority"!==e?this:Qw.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const n=gw(e);return null===n?t:t.isEmpty()&&".priority"!==n?this:(Fe(".priority"!==n||1===vw(e),".priority must be the last token in a path"),this.updateImmediateChild(n,Qw.__childrenNodeConstructor.EMPTY_NODE.updateChild(yw(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+Bw(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",e+="number"===t?F_(this.value_):this.value_,this.lazyHash_=b_(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===Qw.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof Qw.__childrenNodeConstructor?-1:(Fe(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,n=typeof this.value_,r=Qw.VALUE_TYPE_ORDER.indexOf(t),i=Qw.VALUE_TYPE_ORDER.indexOf(n);return Fe(r>=0,"Unknown leaf type: "+t),Fe(i>=0,"Unknown leaf type: "+n),r===i?"object"===n?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-r}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}Qw.VALUE_TYPE_ORDER=["object","boolean","number","string"];const Yw=new class extends Ow{compare(e,t){const n=e.node.getPriority(),r=t.node.getPriority(),i=n.compareTo(r);return 0===i?R_(e.name,t.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Dw.MIN}maxPost(){return new Dw(A_,new Qw("[PRIORITY-POST]",Gw))}makePost(e,t){const n=Kw(e);return new Dw(t,new Qw("[PRIORITY-POST]",n))}toString(){return".priority"}},Xw=Math.log(2);class Jw{constructor(e){var t;this.count=(t=e+1,parseInt(Math.log(t)/Xw,10)),this.current_=this.count-1;const n=(r=this.count,parseInt(Array(r+1).join("1"),2));var r;this.bits_=e+1&n}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Zw=function(e,t,n,r){e.sort(t);const i=function(t,r){const s=r-t;let o,a;if(0===s)return null;if(1===s)return o=e[t],a=n?n(o):o,new Uw(a,o.node,Uw.BLACK,null,null);{const l=parseInt(s/2,10)+t,c=i(t,l),u=i(l+1,r);return o=e[l],a=n?n(o):o,new Uw(a,o.node,Uw.BLACK,c,u)}},s=function(t){let r=null,s=null,o=e.length;const a=function(t,r){const s=o-t,a=o;o-=t;const c=i(s+1,a),u=e[s],d=n?n(u):u;l(new Uw(d,u.node,r,null,c))},l=function(e){r?(r.left=e,r=e):(s=e,r=e)};for(let e=0;e<t.count;++e){const n=t.nextBitIsOne(),r=Math.pow(2,t.count-(e+1));n?a(r,Uw.BLACK):(a(r,Uw.BLACK),a(r,Uw.RED))}return s}(new Jw(e.length));return new Vw(r||t,s)};let ex;const tx={};class nx{static get Default(){return Fe(tx&&Yw,"ChildrenNode.ts has not been loaded"),ex=ex||new nx({".priority":tx},{".priority":Yw}),ex}constructor(e,t){this.indexes_=e,this.indexSet_=t}get(e){const t=St(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Vw?t:null}hasIndex(e){return xt(this.indexSet_,e.toString())}addIndex(e,t){Fe(e!==Mw,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const n=[];let r=!1;const i=t.getIterator(Dw.Wrap);let s,o=i.getNext();for(;o;)r=r||e.isDefinedOn(o.node),n.push(o),o=i.getNext();s=r?Zw(n,e.getCompare()):tx;const a=e.toString(),l=Object.assign({},this.indexSet_);l[a]=e;const c=Object.assign({},this.indexes_);return c[a]=s,new nx(c,l)}addToIndexes(e,t){const n=Tt(this.indexes_,(n,r)=>{const i=St(this.indexSet_,r);if(Fe(i,"Missing index implementation for "+r),n===tx){if(i.isDefinedOn(e.node)){const n=[],r=t.getIterator(Dw.Wrap);let s=r.getNext();for(;s;)s.name!==e.name&&n.push(s),s=r.getNext();return n.push(e),Zw(n,i.getCompare())}return tx}{const r=t.get(e.name);let i=n;return r&&(i=i.remove(new Dw(e.name,r))),i.insert(e,e.node)}});return new nx(n,this.indexSet_)}removeFromIndexes(e,t){const n=Tt(this.indexes_,n=>{if(n===tx)return n;{const r=t.get(e.name);return r?n.remove(new Dw(e.name,r)):n}});return new nx(n,this.indexSet_)}}let rx;class ix{static get EMPTY_NODE(){return rx||(rx=new ix(new Vw($w),null,nx.Default))}constructor(e,t,n){this.children_=e,this.priorityNode_=t,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&Hw(this.priorityNode_),this.children_.isEmpty()&&Fe(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||rx}updatePriority(e){return this.children_.isEmpty()?this:new ix(this.children_,e,this.indexMap_)}getImmediateChild(e){if(".priority"===e)return this.getPriority();{const t=this.children_.get(e);return null===t?rx:t}}getChild(e){const t=gw(e);return null===t?this:this.getImmediateChild(t).getChild(yw(e))}hasChild(e){return null!==this.children_.get(e)}updateImmediateChild(e,t){if(Fe(t,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(t);{const n=new Dw(e,t);let r,i;t.isEmpty()?(r=this.children_.remove(e),i=this.indexMap_.removeFromIndexes(n,this.children_)):(r=this.children_.insert(e,t),i=this.indexMap_.addToIndexes(n,this.children_));const s=r.isEmpty()?rx:this.priorityNode_;return new ix(r,s,i)}}updateChild(e,t){const n=gw(e);if(null===n)return t;{Fe(".priority"!==gw(e)||1===vw(e),".priority must be the last token in a path");const r=this.getImmediateChild(n).updateChild(yw(e),t);return this.updateImmediateChild(n,r)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let n=0,r=0,i=!0;if(this.forEachChild(Yw,(s,o)=>{t[s]=o.val(e),n++,i&&ix.INTEGER_REGEXP_.test(s)?r=Math.max(r,Number(s)):i=!1}),!e&&i&&r<2*n){const e=[];for(const n in t)e[n]=t[n];return e}return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(null===this.lazyHash_){let e="";this.getPriority().isEmpty()||(e+="priority:"+Bw(this.getPriority().val())+":"),this.forEachChild(Yw,(t,n)=>{const r=n.hash();""!==r&&(e+=":"+t+":"+r)}),this.lazyHash_=""===e?"":b_(e)}return this.lazyHash_}getPredecessorChildName(e,t,n){const r=this.resolveIndex_(n);if(r){const n=r.getPredecessorKey(new Dw(e,t));return n?n.name:null}return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.minKey();return e&&e.name}return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new Dw(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.maxKey();return e&&e.name}return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new Dw(t,this.children_.get(t)):null}forEachChild(e,t){const n=this.resolveIndex_(e);return n?n.inorderTraversal(e=>t(e.name,e.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,e=>e);{const n=this.children_.getIteratorFrom(e.name,Dw.Wrap);let r=n.peek();for(;null!=r&&t.compare(r,e)<0;)n.getNext(),r=n.peek();return n}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,e=>e);{const n=this.children_.getReverseIteratorFrom(e.name,Dw.Wrap);let r=n.peek();for(;null!=r&&t.compare(r,e)>0;)n.getNext(),r=n.peek();return n}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===sx?-1:0}withIndex(e){if(e===Mw||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new ix(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===Mw||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){const e=this.getIterator(Yw),n=t.getIterator(Yw);let r=e.getNext(),i=n.getNext();for(;r&&i;){if(r.name!==i.name||!r.node.equals(i.node))return!1;r=e.getNext(),i=n.getNext()}return null===r&&null===i}return!1}return!1}}resolveIndex_(e){return e===Mw?null:this.indexMap_.get(e.toString())}}ix.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;const sx=new class extends ix{constructor(){super(new Vw($w),ix.EMPTY_NODE,nx.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return ix.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(Dw,{MIN:{value:new Dw(P_,ix.EMPTY_NODE)},MAX:{value:new Dw(A_,sx)}}),Lw.__EMPTY_NODE=ix.EMPTY_NODE,Qw.__childrenNodeConstructor=ix,qw=sx,function(e){Gw=e}(sx);function ox(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null===e)return ix.EMPTY_NODE;if("object"===typeof e&&".priority"in e&&(t=e[".priority"]),Fe(null===t||"string"===typeof t||"number"===typeof t||"object"===typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"===typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!==typeof e||".sv"in e){return new Qw(e,ox(t))}if(e instanceof Array){let n=ix.EMPTY_NODE;return M_(e,(t,r)=>{if(xt(e,t)&&"."!==t.substring(0,1)){const e=ox(r);!e.isLeafNode()&&e.isEmpty()||(n=n.updateImmediateChild(t,e))}}),n.updatePriority(ox(t))}{const n=[];let r=!1;if(M_(e,(e,t)=>{if("."!==e.substring(0,1)){const i=ox(t);i.isEmpty()||(r=r||!i.getPriority().isEmpty(),n.push(new Dw(e,i)))}}),0===n.length)return ix.EMPTY_NODE;const i=Zw(n,zw,e=>e.name,$w);if(r){const e=Zw(n,Yw.getCompare());return new ix(i,ox(t),new nx({".priority":e},{".priority":Yw}))}return new ix(i,ox(t),nx.Default)}}!function(e){Kw=e}(ox);class ax extends Ow{constructor(e){super(),this.indexPath_=e,Fe(!Sw(e)&&".priority"!==gw(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const n=this.extractChild(e.node),r=this.extractChild(t.node),i=n.compareTo(r);return 0===i?R_(e.name,t.name):i}makePost(e,t){const n=ox(e),r=ix.EMPTY_NODE.updateChild(this.indexPath_,n);return new Dw(t,r)}maxPost(){const e=ix.EMPTY_NODE.updateChild(this.indexPath_,sx);return new Dw(A_,e)}toString(){return _w(this.indexPath_,0).join("/")}}const lx=new class extends Ow{compare(e,t){const n=e.node.compareTo(t.node);return 0===n?R_(e.name,t.name):n}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Dw.MIN}maxPost(){return Dw.MAX}makePost(e,t){const n=ox(e);return new Dw(t,n)}toString(){return".value"}};function cx(e){return{type:"value",snapshotNode:e}}function ux(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function dx(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function hx(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}class fx{constructor(e){this.index_=e}updateChild(e,t,n,r,i,s){Fe(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const o=e.getImmediateChild(t);return o.getChild(r).equals(n.getChild(r))&&o.isEmpty()===n.isEmpty()?e:(null!=s&&(n.isEmpty()?e.hasChild(t)?s.trackChildChange(dx(t,o)):Fe(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):o.isEmpty()?s.trackChildChange(ux(t,n)):s.trackChildChange(hx(t,n,o))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_))}updateFullNode(e,t,n){return null!=n&&(e.isLeafNode()||e.forEachChild(Yw,(e,r)=>{t.hasChild(e)||n.trackChildChange(dx(e,r))}),t.isLeafNode()||t.forEachChild(Yw,(t,r)=>{if(e.hasChild(t)){const i=e.getImmediateChild(t);i.equals(r)||n.trackChildChange(hx(t,r,i))}else n.trackChildChange(ux(t,r))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?ix.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class px{constructor(e){this.indexedFilter_=new fx(e.getIndex()),this.index_=e.getIndex(),this.startPost_=px.getStartPost_(e),this.endPost_=px.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,n=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&n}updateChild(e,t,n,r,i,s){return this.matches(new Dw(t,n))||(n=ix.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,r,i,s)}updateFullNode(e,t,n){t.isLeafNode()&&(t=ix.EMPTY_NODE);let r=t.withIndex(this.index_);r=r.updatePriority(ix.EMPTY_NODE);const i=this;return t.forEachChild(Yw,(e,t)=>{i.matches(new Dw(e,t))||(r=r.updateImmediateChild(e,ix.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,r,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}class mx{constructor(e){this.withinDirectionalStart=e=>this.reverse_?this.withinEndPost(e):this.withinStartPost(e),this.withinDirectionalEnd=e=>this.reverse_?this.withinStartPost(e):this.withinEndPost(e),this.withinStartPost=e=>{const t=this.index_.compare(this.rangedFilter_.getStartPost(),e);return this.startIsInclusive_?t<=0:t<0},this.withinEndPost=e=>{const t=this.index_.compare(e,this.rangedFilter_.getEndPost());return this.endIsInclusive_?t<=0:t<0},this.rangedFilter_=new px(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,n,r,i,s){return this.rangedFilter_.matches(new Dw(t,n))||(n=ix.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,r,i,s):this.fullLimitUpdateChild_(e,t,n,i,s)}updateFullNode(e,t,n){let r;if(t.isLeafNode()||t.isEmpty())r=ix.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let e;r=ix.EMPTY_NODE.withIndex(this.index_),e=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let n=0;for(;e.hasNext()&&n<this.limit_;){const t=e.getNext();if(this.withinDirectionalStart(t)){if(!this.withinDirectionalEnd(t))break;r=r.updateImmediateChild(t.name,t.node),n++}}}else{let e;r=t.withIndex(this.index_),r=r.updatePriority(ix.EMPTY_NODE),e=this.reverse_?r.getReverseIterator(this.index_):r.getIterator(this.index_);let n=0;for(;e.hasNext();){const t=e.getNext();n<this.limit_&&this.withinDirectionalStart(t)&&this.withinDirectionalEnd(t)?n++:r=r.updateImmediateChild(t.name,ix.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,n,r,i){let s;if(this.reverse_){const e=this.index_.getCompare();s=(t,n)=>e(n,t)}else s=this.index_.getCompare();const o=e;Fe(o.numChildren()===this.limit_,"");const a=new Dw(t,n),l=this.reverse_?o.getFirstChild(this.index_):o.getLastChild(this.index_),c=this.rangedFilter_.matches(a);if(o.hasChild(t)){const e=o.getImmediateChild(t);let u=r.getChildAfterChild(this.index_,l,this.reverse_);for(;null!=u&&(u.name===t||o.hasChild(u.name));)u=r.getChildAfterChild(this.index_,u,this.reverse_);const d=null==u?1:s(u,a);if(c&&!n.isEmpty()&&d>=0)return null!=i&&i.trackChildChange(hx(t,n,e)),o.updateImmediateChild(t,n);{null!=i&&i.trackChildChange(dx(t,e));const n=o.updateImmediateChild(t,ix.EMPTY_NODE);return null!=u&&this.rangedFilter_.matches(u)?(null!=i&&i.trackChildChange(ux(u.name,u.node)),n.updateImmediateChild(u.name,u.node)):n}}return n.isEmpty()?e:c&&s(l,a)>=0?(null!=i&&(i.trackChildChange(dx(l.name,l.node)),i.trackChildChange(ux(t,n))),o.updateImmediateChild(t,n).updateImmediateChild(l.name,ix.EMPTY_NODE)):e}}class gx{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Yw}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return Fe(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return Fe(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:P_}hasEnd(){return this.endSet_}getIndexEndValue(){return Fe(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return Fe(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:A_}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return Fe(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Yw}copy(){const e=new gx;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function vx(e){const t={};if(e.isDefault())return t;let n;if(e.index_===Yw?n="$priority":e.index_===lx?n="$value":e.index_===Mw?n="$key":(Fe(e.index_ instanceof ax,"Unrecognized index type!"),n=e.index_.toString()),t.orderBy=_t(n),e.startSet_){const n=e.startAfterSet_?"startAfter":"startAt";t[n]=_t(e.indexStartValue_),e.startNameSet_&&(t[n]+=","+_t(e.indexStartName_))}if(e.endSet_){const n=e.endBeforeSet_?"endBefore":"endAt";t[n]=_t(e.indexEndValue_),e.endNameSet_&&(t[n]+=","+_t(e.indexEndName_))}return e.limitSet_&&(e.isViewFromLeft()?t.limitToFirst=e.limit_:t.limitToLast=e.limit_),t}function yx(e){const t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_),t.sin=!e.startAfterSet_),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_),t.ein=!e.endBeforeSet_),e.limitSet_){t.l=e.limit_;let n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==Yw&&(t.i=e.index_.toString()),t}class bx extends dw{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:(Fe(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,t,n,r){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=n,this.appCheckTokenProvider_=r,this.log_=T_("p:rest:"),this.listens_={}}listen(e,t,n,r){const i=e._path.toString();this.log_("Listen called for "+i+" "+e._queryIdentifier);const s=bx.getListenId_(e,n),o={};this.listens_[s]=o;const a=vx(e._queryParams);this.restRequest_(i+".json",a,(e,t)=>{let a=t;if(404===e&&(a=null,e=null),null===e&&this.onDataUpdate_(i,a,!1,n),St(this.listens_,s)===o){let t;t=e?401===e?"permission_denied":"rest_error:"+e:"ok",r(t,null)}})}unlisten(e,t){const n=bx.getListenId_(e,t);delete this.listens_[n]}get(e){const t=vx(e._queryParams),n=e._path.toString(),r=new tt;return this.restRequest_(n+".json",t,(e,t)=>{let i=t;404===e&&(i=null,e=null),null===e?(this.onDataUpdate_(n,i,!1,null),r.resolve(i)):r.reject(new Error(i))}),r.promise}refreshAuthToken(e){}restRequest_(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(r=>{let[i,s]=r;i&&i.accessToken&&(t.auth=i.accessToken),s&&s.token&&(t.ac=s.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Nt(t);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(n&&4===a.readyState){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let e=null;if(a.status>=200&&a.status<300){try{e=bt(a.responseText)}catch(NT){N_("Failed to parse JSON response for "+o+": "+a.responseText)}n(null,e)}else 401!==a.status&&404!==a.status&&N_("Got unsuccessful REST response for "+o+" Status: "+a.status),n(a.status);n=null}},a.open("GET",o,!0),a.send()})}}class _x{constructor(){this.rootNode_=ix.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function wx(){return{value:null,children:new Map}}function xx(e,t,n){if(Sw(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{const r=gw(t);e.children.has(r)||e.children.set(r,wx());xx(e.children.get(r),t=yw(t),n)}}function Sx(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach((e,n)=>{t(n,e)})}(e,(e,r)=>{Sx(r,new pw(t.toString()+"/"+e),n)})}class kx{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&M_(this.last_,(e,n)=>{t[e]=t[e]-n}),this.last_=e,t}}class Tx{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new kx(e);const n=1e4+2e4*Math.random();$_(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){const e=this.statsListener_.get(),t={};let n=!1;M_(e,(e,r)=>{r>0&&xt(this.statsToReport_,e)&&(t[e]=r,n=!0)}),n&&this.server_.reportStats(t),$_(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var Ex;function Cx(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}!function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(Ex||(Ex={}));class Nx{constructor(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=Ex.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(Sw(this.path)){if(null!=this.affectedTree.value)return Fe(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new pw(e));return new Nx(mw(),t,this.revert)}}return Fe(gw(this.path)===e,"operationForChild called for unrelated child."),new Nx(yw(this.path),this.affectedTree,this.revert)}}class Ix{constructor(e,t){this.source=e,this.path=t,this.type=Ex.LISTEN_COMPLETE}operationForChild(e){return Sw(this.path)?new Ix(this.source,mw()):new Ix(this.source,yw(this.path))}}class Px{constructor(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=Ex.OVERWRITE}operationForChild(e){return Sw(this.path)?new Px(this.source,mw(),this.snap.getImmediateChild(e)):new Px(this.source,yw(this.path),this.snap)}}class Ax{constructor(e,t,n){this.source=e,this.path=t,this.children=n,this.type=Ex.MERGE}operationForChild(e){if(Sw(this.path)){const t=this.children.subtree(new pw(e));return t.isEmpty()?null:t.value?new Px(this.source,mw(),t.value):new Ax(this.source,mw(),t)}return Fe(gw(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Ax(this.source,yw(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class Rx{constructor(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Sw(e))return this.isFullyInitialized()&&!this.filtered_;const t=gw(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class Dx{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function Ox(e,t,n,r,i,s){const o=r.filter(e=>e.type===n);o.sort((t,n)=>function(e,t,n){if(null==t.childName||null==n.childName)throw Ue("Should only compare child_ events.");const r=new Dw(t.childName,t.snapshotNode),i=new Dw(n.childName,n.snapshotNode);return e.index_.compare(r,i)}(e,t,n)),o.forEach(n=>{const r=function(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,n,s);i.forEach(i=>{i.respondsTo(n.type)&&t.push(i.createEvent(r,e.query_))})})}function jx(e,t){return{eventCache:e,serverCache:t}}function Lx(e,t,n,r){return jx(new Rx(t,n,r),e.serverCache)}function Mx(e,t,n,r){return jx(e.eventCache,new Rx(t,n,r))}function Fx(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function Ux(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}let Vx;class zx{static fromObject(e){let t=new zx(null);return M_(e,(e,n)=>{t=t.set(new pw(e),n)}),t}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(Vx||(Vx=new Vw(D_)),Vx);this.value=e,this.children=t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:mw(),value:this.value};if(Sw(e))return null;{const n=gw(e),r=this.children.get(n);if(null!==r){const i=r.findRootMostMatchingPathAndValue(yw(e),t);if(null!=i){return{path:xw(new pw(n),i.path),value:i.value}}return null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(Sw(e))return this;{const t=gw(e),n=this.children.get(t);return null!==n?n.subtree(yw(e)):new zx(null)}}set(e,t){if(Sw(e))return new zx(t,this.children);{const n=gw(e),r=(this.children.get(n)||new zx(null)).set(yw(e),t),i=this.children.insert(n,r);return new zx(this.value,i)}}remove(e){if(Sw(e))return this.children.isEmpty()?new zx(null):new zx(null,this.children);{const t=gw(e),n=this.children.get(t);if(n){const r=n.remove(yw(e));let i;return i=r.isEmpty()?this.children.remove(t):this.children.insert(t,r),null===this.value&&i.isEmpty()?new zx(null):new zx(this.value,i)}return this}}get(e){if(Sw(e))return this.value;{const t=gw(e),n=this.children.get(t);return n?n.get(yw(e)):null}}setTree(e,t){if(Sw(e))return t;{const n=gw(e),r=(this.children.get(n)||new zx(null)).setTree(yw(e),t);let i;return i=r.isEmpty()?this.children.remove(n):this.children.insert(n,r),new zx(this.value,i)}}fold(e){return this.fold_(mw(),e)}fold_(e,t){const n={};return this.children.inorderTraversal((r,i)=>{n[r]=i.fold_(xw(e,r),t)}),t(e,this.value,n)}findOnPath(e,t){return this.findOnPath_(e,mw(),t)}findOnPath_(e,t,n){const r=!!this.value&&n(t,this.value);if(r)return r;if(Sw(e))return null;{const r=gw(e),i=this.children.get(r);return i?i.findOnPath_(yw(e),xw(t,r),n):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,mw(),t)}foreachOnPath_(e,t,n){if(Sw(e))return this;{this.value&&n(t,this.value);const r=gw(e),i=this.children.get(r);return i?i.foreachOnPath_(yw(e),xw(t,r),n):new zx(null)}}foreach(e){this.foreach_(mw(),e)}foreach_(e,t){this.children.inorderTraversal((n,r)=>{r.foreach_(xw(e,n),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,n)=>{n.value&&e(t,n.value)})}}class $x{constructor(e){this.writeTree_=e}static empty(){return new $x(new zx(null))}}function qx(e,t,n){if(Sw(t))return new $x(new zx(n));{const r=e.writeTree_.findRootMostValueAndPath(t);if(null!=r){const i=r.path;let s=r.value;const o=kw(i,t);return s=s.updateChild(o,n),new $x(e.writeTree_.set(i,s))}{const r=new zx(n),i=e.writeTree_.setTree(t,r);return new $x(i)}}}function Bx(e,t,n){let r=e;return M_(n,(e,n)=>{r=qx(r,xw(t,e),n)}),r}function Hx(e,t){if(Sw(t))return $x.empty();{const n=e.writeTree_.setTree(t,new zx(null));return new $x(n)}}function Wx(e,t){return null!=Kx(e,t)}function Kx(e,t){const n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(kw(n.path,t)):null}function Gx(e){const t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(Yw,(e,n)=>{t.push(new Dw(e,n))}):e.writeTree_.children.inorderTraversal((e,n)=>{null!=n.value&&t.push(new Dw(e,n.value))}),t}function Qx(e,t){if(Sw(t))return e;{const n=Kx(e,t);return new $x(null!=n?new zx(n):e.writeTree_.subtree(t))}}function Yx(e){return e.writeTree_.isEmpty()}function Xx(e,t){return Jx(mw(),e.writeTree_,t)}function Jx(e,t,n){if(null!=t.value)return n.updateChild(e,t.value);{let r=null;return t.children.inorderTraversal((t,i)=>{".priority"===t?(Fe(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):n=Jx(xw(e,t),i,n)}),n.getChild(e).isEmpty()||null===r||(n=n.updateChild(xw(e,".priority"),r)),n}}function Zx(e,t){return hS(t,e)}function eS(e,t){const n=e.allWrites.findIndex(e=>e.writeId===t);Fe(n>=0,"removeWrite called with nonexistent writeId.");const r=e.allWrites[n];e.allWrites.splice(n,1);let i=r.visible,s=!1,o=e.allWrites.length-1;for(;i&&o>=0;){const t=e.allWrites[o];t.visible&&(o>=n&&tS(t,r.path)?i=!1:Ew(r.path,t.path)&&(s=!0)),o--}if(i){if(s)return function(e){e.visibleWrites=rS(e.allWrites,nS,mw()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}(e),!0;if(r.snap)e.visibleWrites=Hx(e.visibleWrites,r.path);else{M_(r.children,t=>{e.visibleWrites=Hx(e.visibleWrites,xw(r.path,t))})}return!0}return!1}function tS(e,t){if(e.snap)return Ew(e.path,t);for(const n in e.children)if(e.children.hasOwnProperty(n)&&Ew(xw(e.path,n),t))return!0;return!1}function nS(e){return e.visible}function rS(e,t,n){let r=$x.empty();for(let i=0;i<e.length;++i){const s=e[i];if(t(s)){const e=s.path;let t;if(s.snap)Ew(n,e)?(t=kw(n,e),r=qx(r,t,s.snap)):Ew(e,n)&&(t=kw(e,n),r=qx(r,mw(),s.snap.getChild(t)));else{if(!s.children)throw Ue("WriteRecord should have .snap or .children");if(Ew(n,e))t=kw(n,e),r=Bx(r,t,s.children);else if(Ew(e,n))if(t=kw(e,n),Sw(t))r=Bx(r,mw(),s.children);else{const e=St(s.children,gw(t));if(e){const n=e.getChild(yw(t));r=qx(r,mw(),n)}}}}}return r}function iS(e,t,n,r,i){if(r||i){const s=Qx(e.visibleWrites,t);if(!i&&Yx(s))return n;if(i||null!=n||Wx(s,mw())){const s=function(e){return(e.visible||i)&&(!r||!~r.indexOf(e.writeId))&&(Ew(e.path,t)||Ew(t,e.path))};return Xx(rS(e.allWrites,s,t),n||ix.EMPTY_NODE)}return null}{const r=Kx(e.visibleWrites,t);if(null!=r)return r;{const r=Qx(e.visibleWrites,t);if(Yx(r))return n;if(null!=n||Wx(r,mw())){return Xx(r,n||ix.EMPTY_NODE)}return null}}}function sS(e,t,n,r){return iS(e.writeTree,e.treePath,t,n,r)}function oS(e,t){return function(e,t,n){let r=ix.EMPTY_NODE;const i=Kx(e.visibleWrites,t);if(i)return i.isLeafNode()||i.forEachChild(Yw,(e,t)=>{r=r.updateImmediateChild(e,t)}),r;if(n){const i=Qx(e.visibleWrites,t);return n.forEachChild(Yw,(e,t)=>{const n=Xx(Qx(i,new pw(e)),t);r=r.updateImmediateChild(e,n)}),Gx(i).forEach(e=>{r=r.updateImmediateChild(e.name,e.node)}),r}return Gx(Qx(e.visibleWrites,t)).forEach(e=>{r=r.updateImmediateChild(e.name,e.node)}),r}(e.writeTree,e.treePath,t)}function aS(e,t,n,r){return function(e,t,n,r,i){Fe(r||i,"Either existingEventSnap or existingServerSnap must exist");const s=xw(t,n);if(Wx(e.visibleWrites,s))return null;{const t=Qx(e.visibleWrites,s);return Yx(t)?i.getChild(n):Xx(t,i.getChild(n))}}(e.writeTree,e.treePath,t,n,r)}function lS(e,t){return function(e,t){return Kx(e.visibleWrites,t)}(e.writeTree,xw(e.treePath,t))}function cS(e,t,n,r,i,s){return function(e,t,n,r,i,s,o){let a;const l=Qx(e.visibleWrites,t),c=Kx(l,mw());if(null!=c)a=c;else{if(null==n)return[];a=Xx(l,n)}if(a=a.withIndex(o),a.isEmpty()||a.isLeafNode())return[];{const e=[],t=o.getCompare(),n=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o);let l=n.getNext();for(;l&&e.length<i;)0!==t(l,r)&&e.push(l),l=n.getNext();return e}}(e.writeTree,e.treePath,t,n,r,i,s)}function uS(e,t,n){return function(e,t,n,r){const i=xw(t,n),s=Kx(e.visibleWrites,i);if(null!=s)return s;if(r.isCompleteForChild(n))return Xx(Qx(e.visibleWrites,i),r.getNode().getImmediateChild(n));return null}(e.writeTree,e.treePath,t,n)}function dS(e,t){return hS(xw(e.treePath,t),e.writeTree)}function hS(e,t){return{treePath:e,writeTree:t}}class fS{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,n=e.childName;Fe("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),Fe(".priority"!==n,"Only non-priority child changes can be tracked.");const r=this.changeMap.get(n);if(r){const i=r.type;if("child_added"===t&&"child_removed"===i)this.changeMap.set(n,hx(n,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===i)this.changeMap.set(n,dx(n,r.oldSnap));else if("child_changed"===t&&"child_added"===i)this.changeMap.set(n,ux(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==i)throw Ue("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(n,hx(n,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,e)}getChanges(){return Array.from(this.changeMap.values())}}const pS=new class{getCompleteChild(e){return null}getChildAfterChild(e,t,n){return null}};class mS{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const t=null!=this.optCompleteServerCache_?new Rx(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return uS(this.writes_,e,t)}}getChildAfterChild(e,t,n){const r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Ux(this.viewCache_),i=cS(this.writes_,r,t,1,n,e);return 0===i.length?null:i[0]}}function gS(e,t,n,r,i){const s=new fS;let o,a;if(n.type===Ex.OVERWRITE){const l=n;l.source.fromUser?o=bS(e,t,l.path,l.snap,r,i,s):(Fe(l.source.fromServer,"Unknown source."),a=l.source.tagged||t.serverCache.isFiltered()&&!Sw(l.path),o=yS(e,t,l.path,l.snap,r,i,a,s))}else if(n.type===Ex.MERGE){const l=n;l.source.fromUser?o=function(e,t,n,r,i,s,o){let a=t;return r.foreach((r,l)=>{const c=xw(n,r);_S(t,gw(c))&&(a=bS(e,a,c,l,i,s,o))}),r.foreach((r,l)=>{const c=xw(n,r);_S(t,gw(c))||(a=bS(e,a,c,l,i,s,o))}),a}(e,t,l.path,l.children,r,i,s):(Fe(l.source.fromServer,"Unknown source."),a=l.source.tagged||t.serverCache.isFiltered(),o=xS(e,t,l.path,l.children,r,i,a,s))}else if(n.type===Ex.ACK_USER_WRITE){const a=n;o=a.revert?function(e,t,n,r,i,s){let o;if(null!=lS(r,n))return t;{const a=new mS(r,t,i),l=t.eventCache.getNode();let c;if(Sw(n)||".priority"===gw(n)){let n;if(t.serverCache.isFullyInitialized())n=sS(r,Ux(t));else{const e=t.serverCache.getNode();Fe(e instanceof ix,"serverChildren would be complete if leaf node"),n=oS(r,e)}c=e.filter.updateFullNode(l,n,s)}else{const i=gw(n);let u=uS(r,i,t.serverCache);null==u&&t.serverCache.isCompleteForChild(i)&&(u=l.getImmediateChild(i)),c=null!=u?e.filter.updateChild(l,i,u,yw(n),a,s):t.eventCache.getNode().hasChild(i)?e.filter.updateChild(l,i,ix.EMPTY_NODE,yw(n),a,s):l,c.isEmpty()&&t.serverCache.isFullyInitialized()&&(o=sS(r,Ux(t)),o.isLeafNode()&&(c=e.filter.updateFullNode(c,o,s)))}return o=t.serverCache.isFullyInitialized()||null!=lS(r,mw()),Lx(t,c,o,e.filter.filtersNodes())}}(e,t,a.path,r,i,s):function(e,t,n,r,i,s,o){if(null!=lS(i,n))return t;const a=t.serverCache.isFiltered(),l=t.serverCache;if(null!=r.value){if(Sw(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return yS(e,t,n,l.getNode().getChild(n),i,s,a,o);if(Sw(n)){let r=new zx(null);return l.getNode().forEachChild(Mw,(e,t)=>{r=r.set(new pw(e),t)}),xS(e,t,n,r,i,s,a,o)}return t}{let c=new zx(null);return r.foreach((e,t)=>{const r=xw(n,e);l.isCompleteForPath(r)&&(c=c.set(e,l.getNode().getChild(r)))}),xS(e,t,n,c,i,s,a,o)}}(e,t,a.path,a.affectedTree,r,i,s)}else{if(n.type!==Ex.LISTEN_COMPLETE)throw Ue("Unknown operation type: "+n.type);o=function(e,t,n,r,i){const s=t.serverCache,o=Mx(t,s.getNode(),s.isFullyInitialized()||Sw(n),s.isFiltered());return vS(e,o,n,r,pS,i)}(e,t,n.path,r,s)}const l=s.getChanges();return function(e,t,n){const r=t.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=Fx(e);(n.length>0||!e.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push(cx(Fx(t)))}}(t,o,l),{viewCache:o,changes:l}}function vS(e,t,n,r,i,s){const o=t.eventCache;if(null!=lS(r,n))return t;{let a,l;if(Sw(n))if(Fe(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const n=Ux(t),i=oS(r,n instanceof ix?n:ix.EMPTY_NODE);a=e.filter.updateFullNode(t.eventCache.getNode(),i,s)}else{const n=sS(r,Ux(t));a=e.filter.updateFullNode(t.eventCache.getNode(),n,s)}else{const c=gw(n);if(".priority"===c){Fe(1===vw(n),"Can't have a priority with additional path components");const i=o.getNode();l=t.serverCache.getNode();const s=aS(r,n,i,l);a=null!=s?e.filter.updatePriority(i,s):o.getNode()}else{const u=yw(n);let d;if(o.isCompleteForChild(c)){l=t.serverCache.getNode();const e=aS(r,n,o.getNode(),l);d=null!=e?o.getNode().getImmediateChild(c).updateChild(u,e):o.getNode().getImmediateChild(c)}else d=uS(r,c,t.serverCache);a=null!=d?e.filter.updateChild(o.getNode(),c,d,u,i,s):o.getNode()}}return Lx(t,a,o.isFullyInitialized()||Sw(n),e.filter.filtersNodes())}}function yS(e,t,n,r,i,s,o,a){const l=t.serverCache;let c;const u=o?e.filter:e.filter.getIndexedFilter();if(Sw(n))c=u.updateFullNode(l.getNode(),r,null);else if(u.filtersNodes()&&!l.isFiltered()){const e=l.getNode().updateChild(n,r);c=u.updateFullNode(l.getNode(),e,null)}else{const e=gw(n);if(!l.isCompleteForPath(n)&&vw(n)>1)return t;const i=yw(n),s=l.getNode().getImmediateChild(e).updateChild(i,r);c=".priority"===e?u.updatePriority(l.getNode(),s):u.updateChild(l.getNode(),e,s,i,pS,null)}const d=Mx(t,c,l.isFullyInitialized()||Sw(n),u.filtersNodes());return vS(e,d,n,i,new mS(i,d,s),a)}function bS(e,t,n,r,i,s,o){const a=t.eventCache;let l,c;const u=new mS(i,t,s);if(Sw(n))c=e.filter.updateFullNode(t.eventCache.getNode(),r,o),l=Lx(t,c,!0,e.filter.filtersNodes());else{const i=gw(n);if(".priority"===i)c=e.filter.updatePriority(t.eventCache.getNode(),r),l=Lx(t,c,a.isFullyInitialized(),a.isFiltered());else{const s=yw(n),c=a.getNode().getImmediateChild(i);let d;if(Sw(s))d=r;else{const e=u.getCompleteChild(i);d=null!=e?".priority"===bw(s)&&e.getChild(ww(s)).isEmpty()?e:e.updateChild(s,r):ix.EMPTY_NODE}if(c.equals(d))l=t;else{l=Lx(t,e.filter.updateChild(a.getNode(),i,d,s,u,o),a.isFullyInitialized(),e.filter.filtersNodes())}}}return l}function _S(e,t){return e.eventCache.isCompleteForChild(t)}function wS(e,t,n){return n.foreach((e,n)=>{t=t.updateChild(e,n)}),t}function xS(e,t,n,r,i,s,o,a){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let l,c=t;l=Sw(n)?r:new zx(null).setTree(n,r);const u=t.serverCache.getNode();return l.children.inorderTraversal((n,r)=>{if(u.hasChild(n)){const l=wS(0,t.serverCache.getNode().getImmediateChild(n),r);c=yS(e,c,new pw(n),l,i,s,o,a)}}),l.children.inorderTraversal((n,r)=>{const l=!t.serverCache.isCompleteForChild(n)&&null===r.value;if(!u.hasChild(n)&&!l){const l=wS(0,t.serverCache.getNode().getImmediateChild(n),r);c=yS(e,c,new pw(n),l,i,s,o,a)}}),c}class SS{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const n=this.query_._queryParams,r=new fx(n.getIndex()),i=(s=n).loadsAllData()?new fx(s.getIndex()):s.hasLimit()?new mx(s):new px(s);var s;this.processor_=function(e){return{filter:e}}(i);const o=t.serverCache,a=t.eventCache,l=r.updateFullNode(ix.EMPTY_NODE,o.getNode(),null),c=i.updateFullNode(ix.EMPTY_NODE,a.getNode(),null),u=new Rx(l,o.isFullyInitialized(),r.filtersNodes()),d=new Rx(c,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=jx(d,u),this.eventGenerator_=new Dx(this.query_)}get query(){return this.query_}}function kS(e,t){const n=Ux(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!Sw(t)&&!n.getImmediateChild(gw(t)).isEmpty())?n.getChild(t):null}function TS(e){return 0===e.eventRegistrations_.length}function ES(e,t,n){const r=[];if(n){Fe(null==t,"A cancel should cancel all event registrations.");const i=e.query._path;e.eventRegistrations_.forEach(e=>{const t=e.createCancelEvent(n,i);t&&r.push(t)})}if(t){let n=[];for(let r=0;r<e.eventRegistrations_.length;++r){const i=e.eventRegistrations_[r];if(i.matches(t)){if(t.hasAnyCallback()){n=n.concat(e.eventRegistrations_.slice(r+1));break}}else n.push(i)}e.eventRegistrations_=n}else e.eventRegistrations_=[];return r}function CS(e,t,n,r){t.type===Ex.MERGE&&null!==t.source.queryId&&(Fe(Ux(e.viewCache_),"We should always have a full cache before handling merges"),Fe(Fx(e.viewCache_),"Missing event cache, even though we have a server cache"));const i=e.viewCache_,s=gS(e.processor_,i,t,n,r);var o,a;return o=e.processor_,a=s.viewCache,Fe(a.eventCache.getNode().isIndexed(o.filter.getIndex()),"Event snap not indexed"),Fe(a.serverCache.getNode().isIndexed(o.filter.getIndex()),"Server snap not indexed"),Fe(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=s.viewCache,NS(e,s.changes,s.viewCache.eventCache.getNode(),null)}function NS(e,t,n,r){const i=r?[r]:e.eventRegistrations_;return function(e,t,n,r){const i=[],s=[];return t.forEach(t=>{var n;"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&s.push((n=t.childName,{type:"child_moved",snapshotNode:t.snapshotNode,childName:n}))}),Ox(e,i,"child_removed",t,r,n),Ox(e,i,"child_added",t,r,n),Ox(e,i,"child_moved",s,r,n),Ox(e,i,"child_changed",t,r,n),Ox(e,i,"value",t,r,n),i}(e.eventGenerator_,t,n,i)}let IS,PS;class AS{constructor(){this.views=new Map}}function RS(e,t,n,r){const i=t.source.queryId;if(null!==i){const s=e.views.get(i);return Fe(null!=s,"SyncTree gave us an op for an invalid query."),CS(s,t,n,r)}{let i=[];for(const s of e.views.values())i=i.concat(CS(s,t,n,r));return i}}function DS(e,t,n,r,i){const s=t._queryIdentifier,o=e.views.get(s);if(!o){let e=sS(n,i?r:null),s=!1;e?s=!0:r instanceof ix?(e=oS(n,r),s=!1):(e=ix.EMPTY_NODE,s=!1);const o=jx(new Rx(e,s,!1),new Rx(r,i,!1));return new SS(t,o)}return o}function OS(e,t,n,r,i,s){const o=DS(e,t,r,i,s);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,o),function(e,t){e.eventRegistrations_.push(t)}(o,n),function(e,t){const n=e.viewCache_.eventCache,r=[];n.getNode().isLeafNode()||n.getNode().forEachChild(Yw,(e,t)=>{r.push(ux(e,t))});return n.isFullyInitialized()&&r.push(cx(n.getNode())),NS(e,r,n.getNode(),t)}(o,n)}function jS(e,t,n,r){const i=t._queryIdentifier,s=[];let o=[];const a=VS(e);if("default"===i)for(const[l,c]of e.views.entries())o=o.concat(ES(c,n,r)),TS(c)&&(e.views.delete(l),c.query._queryParams.loadsAllData()||s.push(c.query));else{const t=e.views.get(i);t&&(o=o.concat(ES(t,n,r)),TS(t)&&(e.views.delete(i),t.query._queryParams.loadsAllData()||s.push(t.query)))}return a&&!VS(e)&&s.push(new(Fe(IS,"Reference.ts has not been loaded"),IS)(t._repo,t._path)),{removed:s,events:o}}function LS(e){const t=[];for(const n of e.views.values())n.query._queryParams.loadsAllData()||t.push(n);return t}function MS(e,t){let n=null;for(const r of e.views.values())n=n||kS(r,t);return n}function FS(e,t){if(t._queryParams.loadsAllData())return zS(e);{const n=t._queryIdentifier;return e.views.get(n)}}function US(e,t){return null!=FS(e,t)}function VS(e){return null!=zS(e)}function zS(e){for(const t of e.views.values())if(t.query._queryParams.loadsAllData())return t;return null}let $S=1;class qS{constructor(e){this.listenProvider_=e,this.syncPointTree_=new zx(null),this.pendingWriteTree_={visibleWrites:$x.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function BS(e,t,n,r,i){return function(e,t,n,r,i){Fe(r>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),e.allWrites.push({path:t,snap:n,writeId:r,visible:i}),i&&(e.visibleWrites=qx(e.visibleWrites,t,n)),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r,i),i?XS(e,new Px({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,n)):[]}function HS(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=function(e,t){for(let n=0;n<e.allWrites.length;n++){const r=e.allWrites[n];if(r.writeId===t)return r}return null}(e.pendingWriteTree_,t);if(eS(e.pendingWriteTree_,t)){let t=new zx(null);return null!=r.snap?t=t.set(mw(),!0):M_(r.children,e=>{t=t.set(new pw(e),!0)}),XS(e,new Nx(r.path,t,n))}return[]}function WS(e,t,n){return XS(e,new Px({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,n))}function KS(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const s=t._path,o=e.syncPointTree_.get(s);let a=[];if(o&&("default"===t._queryIdentifier||US(o,t))){const l=jS(o,t,n,r);0===o.views.size&&(e.syncPointTree_=e.syncPointTree_.remove(s));const c=l.removed;if(a=l.events,!i){const n=-1!==c.findIndex(e=>e._queryParams.loadsAllData()),i=e.syncPointTree_.findOnPath(s,(e,t)=>VS(t));if(n&&!i){const t=e.syncPointTree_.subtree(s);if(!t.isEmpty()){const n=function(e){return e.fold((e,t,n)=>{if(t&&VS(t)){return[zS(t)]}{let e=[];return t&&(e=LS(t)),M_(n,(t,n)=>{e=e.concat(n)}),e}})}(t);for(let t=0;t<n.length;++t){const r=n[t],i=r.query,s=ek(e,r);e.listenProvider_.startListening(ok(i),tk(e,i),s.hashFn,s.onComplete)}}}if(!i&&c.length>0&&!r)if(n){const n=null;e.listenProvider_.stopListening(ok(t),n)}else c.forEach(t=>{const n=e.queryToTagMap.get(nk(t));e.listenProvider_.stopListening(ok(t),n)})}!function(e,t){for(let n=0;n<t.length;++n){const r=t[n];if(!r._queryParams.loadsAllData()){const t=nk(r),n=e.queryToTagMap.get(t);e.queryToTagMap.delete(t),e.tagToQueryMap.delete(n)}}}(e,c)}return a}function GS(e,t,n,r){const i=rk(e,r);if(null!=i){const r=ik(i),s=r.path,o=r.queryId,a=kw(s,t);return sk(e,s,new Px(Cx(o),a,n))}return[]}function QS(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=t._path;let s=null,o=!1;e.syncPointTree_.foreachOnPath(i,(e,t)=>{const n=kw(e,i);s=s||MS(t,n),o=o||VS(t)});let a,l=e.syncPointTree_.get(i);if(l?(o=o||VS(l),s=s||MS(l,mw())):(l=new AS,e.syncPointTree_=e.syncPointTree_.set(i,l)),null!=s)a=!0;else{a=!1,s=ix.EMPTY_NODE;e.syncPointTree_.subtree(i).foreachChild((e,t)=>{const n=MS(t,mw());n&&(s=s.updateImmediateChild(e,n))})}const c=US(l,t);if(!c&&!t._queryParams.loadsAllData()){const n=nk(t);Fe(!e.queryToTagMap.has(n),"View does not exist, but we have a tag");const r=$S++;e.queryToTagMap.set(n,r),e.tagToQueryMap.set(r,n)}let u=OS(l,t,n,Zx(e.pendingWriteTree_,i),s,a);if(!c&&!o&&!r){const n=FS(l,t);u=u.concat(function(e,t,n){const r=t._path,i=tk(e,t),s=ek(e,n),o=e.listenProvider_.startListening(ok(t),i,s.hashFn,s.onComplete),a=e.syncPointTree_.subtree(r);if(i)Fe(!VS(a.value),"If we're adding a query, it shouldn't be shadowed");else{const t=a.fold((e,t,n)=>{if(!Sw(e)&&t&&VS(t))return[zS(t).query];{let e=[];return t&&(e=e.concat(LS(t).map(e=>e.query))),M_(n,(t,n)=>{e=e.concat(n)}),e}});for(let n=0;n<t.length;++n){const r=t[n];e.listenProvider_.stopListening(ok(r),tk(e,r))}}return o}(e,t,n))}return u}function YS(e,t,n){const r=e.pendingWriteTree_,i=e.syncPointTree_.findOnPath(t,(e,n)=>{const r=MS(n,kw(e,t));if(r)return r});return iS(r,t,i,n,!0)}function XS(e,t){return JS(t,e.syncPointTree_,null,Zx(e.pendingWriteTree_,mw()))}function JS(e,t,n,r){if(Sw(e.path))return ZS(e,t,n,r);{const i=t.get(mw());null==n&&null!=i&&(n=MS(i,mw()));let s=[];const o=gw(e.path),a=e.operationForChild(o),l=t.children.get(o);if(l&&a){const e=n?n.getImmediateChild(o):null,t=dS(r,o);s=s.concat(JS(a,l,e,t))}return i&&(s=s.concat(RS(i,e,r,n))),s}}function ZS(e,t,n,r){const i=t.get(mw());null==n&&null!=i&&(n=MS(i,mw()));let s=[];return t.children.inorderTraversal((t,i)=>{const o=n?n.getImmediateChild(t):null,a=dS(r,t),l=e.operationForChild(t);l&&(s=s.concat(ZS(l,i,o,a)))}),i&&(s=s.concat(RS(i,e,r,n))),s}function ek(e,t){const n=t.query,r=tk(e,n);return{hashFn:()=>{const e=function(e){return e.viewCache_.serverCache.getNode()}(t)||ix.EMPTY_NODE;return e.hash()},onComplete:t=>{if("ok"===t)return r?function(e,t,n){const r=rk(e,n);if(r){const n=ik(r),i=n.path,s=n.queryId,o=kw(i,t);return sk(e,i,new Ix(Cx(s),o))}return[]}(e,n._path,r):function(e,t){return XS(e,new Ix({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t))}(e,n._path);{const r=function(e,t){let n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?n="Client doesn't have permission to access the desired data.":"unavailable"===e&&(n="The service is unavailable");const r=new Error(e+" at "+t._path.toString()+": "+n);return r.code=e.toUpperCase(),r}(t,n);return KS(e,n,null,r)}}}}function tk(e,t){const n=nk(t);return e.queryToTagMap.get(n)}function nk(e){return e._path.toString()+"$"+e._queryIdentifier}function rk(e,t){return e.tagToQueryMap.get(t)}function ik(e){const t=e.indexOf("$");return Fe(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new pw(e.substr(0,t))}}function sk(e,t,n){const r=e.syncPointTree_.get(t);Fe(r,"Missing sync point for query tag that we're tracking");return RS(r,n,Zx(e.pendingWriteTree_,t),null)}function ok(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new(Fe(PS,"Reference.ts has not been loaded"),PS)(e._repo,e._path):e}class ak{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new ak(t)}node(){return this.node_}}class lk{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=xw(this.path_,e);return new lk(this.syncTree_,t)}node(){return YS(this.syncTree_,this.path_)}}const ck=function(e,t,n){return e&&"object"===typeof e?(Fe(".sv"in e,"Unexpected leaf node or priority contents"),"string"===typeof e[".sv"]?uk(e[".sv"],t,n):"object"===typeof e[".sv"]?dk(e[".sv"],t):void Fe(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},uk=function(e,t,n){if("timestamp"===e)return n.timestamp;Fe(!1,"Unexpected server value: "+e)},dk=function(e,t,n){e.hasOwnProperty("increment")||Fe(!1,"Unexpected server value: "+JSON.stringify(e,null,2));const r=e.increment;"number"!==typeof r&&Fe(!1,"Unexpected increment value: "+r);const i=t.node();if(Fe(null!==i&&"undefined"!==typeof i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const s=i.getValue();return"number"!==typeof s?r:s+r},hk=function(e,t,n,r){return pk(t,new lk(n,e),r)},fk=function(e,t,n){return pk(e,new ak(t),n)};function pk(e,t,n){const r=e.getPriority().val(),i=ck(r,t.getImmediateChild(".priority"),n);let s;if(e.isLeafNode()){const r=e,s=ck(r.getValue(),t,n);return s!==r.getValue()||i!==r.getPriority().val()?new Qw(s,ox(i)):e}{const r=e;return s=r,i!==r.getPriority().val()&&(s=s.updatePriority(new Qw(i))),r.forEachChild(Yw,(e,r)=>{const i=pk(r,t.getImmediateChild(e),n);i!==r&&(s=s.updateImmediateChild(e,i))}),s}}class mk{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{children:{},childCount:0};this.name=e,this.parent=t,this.node=n}}function gk(e,t){let n=t instanceof pw?t:new pw(t),r=e,i=gw(n);for(;null!==i;){const e=St(r.node.children,i)||{children:{},childCount:0};r=new mk(i,r,e),n=yw(n),i=gw(n)}return r}function vk(e){return e.node.value}function yk(e,t){e.node.value=t,Sk(e)}function bk(e){return e.node.childCount>0}function _k(e,t){M_(e.node.children,(n,r)=>{t(new mk(n,e,r))})}function wk(e,t,n,r){n&&!r&&t(e),_k(e,e=>{wk(e,t,!0,r)}),n&&r&&t(e)}function xk(e){return new pw(null===e.parent?e.name:xk(e.parent)+"/"+e.name)}function Sk(e){null!==e.parent&&function(e,t,n){const r=function(e){return void 0===vk(e)&&!bk(e)}(n),i=xt(e.node.children,t);r&&i?(delete e.node.children[t],e.node.childCount--,Sk(e)):r||i||(e.node.children[t]=n.node,e.node.childCount++,Sk(e))}(e.parent,e.name,e)}const kk=/[\[\].#$\/\u0000-\u001F\u007F]/,Tk=/[\[\].#$\u0000-\u001F\u007F]/,Ek=10485760,Ck=function(e){return"string"===typeof e&&0!==e.length&&!kk.test(e)},Nk=function(e){return"string"===typeof e&&0!==e.length&&!Tk.test(e)},Ik=function(e,t,n){const r=n instanceof pw?new Cw(n,e):n;if(void 0===t)throw new Error(e+"contains undefined "+Iw(r));if("function"===typeof t)throw new Error(e+"contains a function "+Iw(r)+" with contents = "+t.toString());if(I_(t))throw new Error(e+"contains "+t.toString()+" "+Iw(r));if("string"===typeof t&&t.length>Ek/3&&jt(t)>Ek)throw new Error(e+"contains a string greater than "+Ek+" utf8 bytes "+Iw(r)+" ('"+t.substring(0,50)+"...')");if(t&&"object"===typeof t){let n=!1,i=!1;if(M_(t,(t,s)=>{if(".value"===t)n=!0;else if(".priority"!==t&&".sv"!==t&&(i=!0,!Ck(t)))throw new Error(e+" contains an invalid key ("+t+") "+Iw(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');!function(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=jt(t),Nw(e)}(r,t),Ik(e,s,r),function(e){const t=e.parts_.pop();e.byteLength_-=jt(t),e.parts_.length>0&&(e.byteLength_-=1)}(r)}),n&&i)throw new Error(e+' contains ".value" child '+Iw(r)+" in addition to actual children.")}},Pk=function(e,t,n,r){if((!r||void 0!==n)&&!Nk(n))throw new Error(Ot(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Ak=function(e,t){const n=t.path.toString();if("string"!==typeof t.repoInfo.host||0===t.repoInfo.host.length||!Ck(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),Nk(e)}(n))throw new Error(Ot(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class Rk{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Dk(e,t){let n=null;for(let r=0;r<t.length;r++){const i=t[r],s=i.getPath();null===n||Tw(s,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:s}),n.events.push(i)}n&&e.eventLists_.push(n)}function Ok(e,t,n){Dk(e,n),Lk(e,e=>Tw(e,t))}function jk(e,t,n){Dk(e,n),Lk(e,e=>Ew(e,t)||Ew(t,e))}function Lk(e,t){e.recursionDepth_++;let n=!0;for(let r=0;r<e.eventLists_.length;r++){const i=e.eventLists_[r];if(i){t(i.path)?(Mk(e.eventLists_[r]),e.eventLists_[r]=null):n=!1}}n&&(e.eventLists_=[]),e.recursionDepth_--}function Mk(e){for(let t=0;t<e.events.length;t++){const n=e.events[t];if(null!==n){e.events[t]=null;const r=n.getEventRunner();w_&&k_("event: "+n.toString()),z_(r)}}}const Fk="repo_interrupt";class Uk{constructor(e,t,n,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=n,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Rk,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=wx(),this.transactionQueueTree_=new mk,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function Vk(e,t,n){if(e.stats_=nw(e.repoInfo_),e.forceRestClient_||("object"===typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new bx(e.repoInfo_,(t,n,r,i)=>{qk(e,t,n,r,i)},e.authTokenProvider_,e.appCheckProvider_),setTimeout(()=>Bk(e,!0),0);else{if("undefined"!==typeof n&&null!==n){if("object"!==typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{_t(n)}catch(NT){throw new Error("Invalid authOverride provided: "+NT)}}e.persistentConnection_=new Rw(e.repoInfo_,t,(t,n,r,i)=>{qk(e,t,n,r,i)},t=>{Bk(e,t)},t=>{!function(e,t){M_(t,(t,n)=>{Hk(e,t,n)})}(e,t)},e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener(t=>{e.server_.refreshAuthToken(t)}),e.appCheckProvider_.addTokenChangeListener(t=>{e.server_.refreshAppCheckToken(t.token)}),e.statsReporter_=function(e,t){const n=e.toString();return tw[n]||(tw[n]=t()),tw[n]}(e.repoInfo_,()=>new Tx(e.stats_,e.server_)),e.infoData_=new _x,e.infoSyncTree_=new qS({startListening:(t,n,r,i)=>{let s=[];const o=e.infoData_.getNode(t._path);return o.isEmpty()||(s=WS(e.infoSyncTree_,t._path,o),setTimeout(()=>{i("ok")},0)),s},stopListening:()=>{}}),Hk(e,"connected",!1),e.serverSyncTree_=new qS({startListening:(t,n,r,i)=>(e.server_.listen(t,r,n,(n,r)=>{const s=i(n,r);jk(e.eventQueue_,t._path,s)}),[]),stopListening:(t,n)=>{e.server_.unlisten(t,n)}})}function zk(e){const t=e.infoData_.getNode(new pw(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function $k(e){return(t=(t={timestamp:zk(e)})||{}).timestamp=t.timestamp||(new Date).getTime(),t;var t}function qk(e,t,n,r,i){e.dataUpdateCount++;const s=new pw(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;let o=[];if(i)if(r){const t=Tt(n,e=>ox(e));o=function(e,t,n,r){const i=rk(e,r);if(i){const r=ik(i),s=r.path,o=r.queryId,a=kw(s,t),l=zx.fromObject(n);return sk(e,s,new Ax(Cx(o),a,l))}return[]}(e.serverSyncTree_,s,t,i)}else{const t=ox(n);o=GS(e.serverSyncTree_,s,t,i)}else if(r){const t=Tt(n,e=>ox(e));o=function(e,t,n){const r=zx.fromObject(n);return XS(e,new Ax({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,r))}(e.serverSyncTree_,s,t)}else{const t=ox(n);o=WS(e.serverSyncTree_,s,t)}let a=s;o.length>0&&(a=Jk(e,s)),jk(e.eventQueue_,a,o)}function Bk(e,t){Hk(e,"connected",t),!1===t&&function(e){Qk(e,"onDisconnectEvents");const t=$k(e),n=wx();Sx(e.onDisconnect_,mw(),(r,i)=>{const s=hk(r,i,e.serverSyncTree_,t);xx(n,r,s)});let r=[];Sx(n,mw(),(t,n)=>{r=r.concat(WS(e.serverSyncTree_,t,n));const i=rT(e,t);Jk(e,i)}),e.onDisconnect_=wx(),jk(e.eventQueue_,mw(),r)}(e)}function Hk(e,t,n){const r=new pw("/.info/"+t),i=ox(n);e.infoData_.updateSnapshot(r,i);const s=WS(e.infoSyncTree_,r,i);jk(e.eventQueue_,r,s)}function Wk(e){return e.nextWriteId_++}function Kk(e,t,n){let r;r=".info"===gw(t._path)?KS(e.infoSyncTree_,t,n):KS(e.serverSyncTree_,t,n),Ok(e.eventQueue_,t._path,r)}function Gk(e){e.persistentConnection_&&e.persistentConnection_.interrupt(Fk)}function Qk(e){let t="";e.persistentConnection_&&(t=e.persistentConnection_.id+":");for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];k_(t,...r)}function Yk(e,t,n){return YS(e.serverSyncTree_,t,n)||ix.EMPTY_NODE}function Xk(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.transactionQueueTree_;if(t||nT(e,t),vk(t)){const n=eT(e,t);Fe(n.length>0,"Sending zero length transaction queue");n.every(e=>0===e.status)&&function(e,t,n){const r=n.map(e=>e.currentWriteId),i=Yk(e,t,r);let s=i;const o=i.hash();for(let c=0;c<n.length;c++){const e=n[c];Fe(0===e.status,"tryToSendTransactionQueue_: items in queue should all be run."),e.status=1,e.retryCount++;const r=kw(t,e.path);s=s.updateChild(r,e.currentOutputSnapshotRaw)}const a=s.val(!0),l=t;e.server_.put(l.toString(),a,r=>{Qk(e,"transaction put response",{path:l.toString(),status:r});let i=[];if("ok"===r){const r=[];for(let t=0;t<n.length;t++)n[t].status=2,i=i.concat(HS(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&r.push(()=>n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved)),n[t].unwatcher();nT(e,gk(e.transactionQueueTree_,t)),Xk(e,e.transactionQueueTree_),jk(e.eventQueue_,t,i);for(let e=0;e<r.length;e++)z_(r[e])}else{if("datastale"===r)for(let e=0;e<n.length;e++)3===n[e].status?n[e].status=4:n[e].status=0;else{N_("transaction at "+l.toString()+" failed: "+r);for(let e=0;e<n.length;e++)n[e].status=4,n[e].abortReason=r}Jk(e,t)}},o)}(e,xk(t),n)}else bk(t)&&_k(t,t=>{Xk(e,t)})}function Jk(e,t){const n=Zk(e,t),r=xk(n);return function(e,t,n){if(0===t.length)return;const r=[];let i=[];const s=t.filter(e=>0===e.status),o=s.map(e=>e.currentWriteId);for(let a=0;a<t.length;a++){const s=t[a],l=kw(n,s.path);let c,u=!1;if(Fe(null!==l,"rerunTransactionsUnderNode_: relativePath should not be null."),4===s.status)u=!0,c=s.abortReason,i=i.concat(HS(e.serverSyncTree_,s.currentWriteId,!0));else if(0===s.status)if(s.retryCount>=25)u=!0,c="maxretry",i=i.concat(HS(e.serverSyncTree_,s.currentWriteId,!0));else{const n=Yk(e,s.path,o);s.currentInputSnapshot=n;const r=t[a].update(n.val());if(void 0!==r){Ik("transaction failed: Data returned ",r,s.path);let t=ox(r);"object"===typeof r&&null!=r&&xt(r,".priority")||(t=t.updatePriority(n.getPriority()));const a=s.currentWriteId,l=$k(e),c=fk(t,n,l);s.currentOutputSnapshotRaw=t,s.currentOutputSnapshotResolved=c,s.currentWriteId=Wk(e),o.splice(o.indexOf(a),1),i=i.concat(BS(e.serverSyncTree_,s.path,c,s.currentWriteId,s.applyLocally)),i=i.concat(HS(e.serverSyncTree_,a,!0))}else u=!0,c="nodata",i=i.concat(HS(e.serverSyncTree_,s.currentWriteId,!0))}jk(e.eventQueue_,n,i),i=[],u&&(t[a].status=2,function(e){setTimeout(e,Math.floor(0))}(t[a].unwatcher),t[a].onComplete&&("nodata"===c?r.push(()=>t[a].onComplete(null,!1,t[a].currentInputSnapshot)):r.push(()=>t[a].onComplete(new Error(c),!1,null))))}nT(e,e.transactionQueueTree_);for(let a=0;a<r.length;a++)z_(r[a]);Xk(e,e.transactionQueueTree_)}(e,eT(e,n),r),r}function Zk(e,t){let n,r=e.transactionQueueTree_;for(n=gw(t);null!==n&&void 0===vk(r);)r=gk(r,n),n=gw(t=yw(t));return r}function eT(e,t){const n=[];return tT(e,t,n),n.sort((e,t)=>e.order-t.order),n}function tT(e,t,n){const r=vk(t);if(r)for(let i=0;i<r.length;i++)n.push(r[i]);_k(t,t=>{tT(e,t,n)})}function nT(e,t){const n=vk(t);if(n){let e=0;for(let t=0;t<n.length;t++)2!==n[t].status&&(n[e]=n[t],e++);n.length=e,yk(t,n.length>0?n:void 0)}_k(t,t=>{nT(e,t)})}function rT(e,t){const n=xk(Zk(e,t)),r=gk(e.transactionQueueTree_,t);return function(e,t,n){let r=n?e:e.parent;for(;null!==r;){if(t(r))return!0;r=r.parent}}(r,t=>{iT(e,t)}),iT(e,r),wk(r,t=>{iT(e,t)}),n}function iT(e,t){const n=vk(t);if(n){const r=[];let i=[],s=-1;for(let t=0;t<n.length;t++)3===n[t].status||(1===n[t].status?(Fe(s===t-1,"All SENT items should be at beginning of queue."),s=t,n[t].status=3,n[t].abortReason="set"):(Fe(0===n[t].status,"Unexpected transaction status in abort"),n[t].unwatcher(),i=i.concat(HS(e.serverSyncTree_,n[t].currentWriteId,!0)),n[t].onComplete&&r.push(n[t].onComplete.bind(null,new Error("set"),!1,null))));-1===s?yk(t,void 0):n.length=s+1,jk(e.eventQueue_,xk(t),i);for(let e=0;e<r.length;e++)z_(r[e])}}const sT=function(e,t){const n=oT(e),r=n.namespace;"firebase.com"===n.domain&&C_(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||C_("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!==typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&N_("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");const i="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new X_(n.host,n.secure,r,i,t,"",r!==n.subdomain),path:new pw(n.pathString)}},oT=function(e){let t="",n="",r="",i="",s="",o=!0,a="https",l=443;if("string"===typeof e){let c=e.indexOf("//");c>=0&&(a=e.substring(0,c-1),e=e.substring(c+2));let u=e.indexOf("/");-1===u&&(u=e.length);let d=e.indexOf("?");-1===d&&(d=e.length),t=e.substring(0,Math.min(u,d)),u<d&&(i=function(e){let t="";const n=e.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let e=n[r];try{e=decodeURIComponent(e.replace(/\+/g," "))}catch(NT){}t+="/"+e}return t}(e.substring(u,d)));const h=function(e){const t={};"?"===e.charAt(0)&&(e=e.substring(1));for(const n of e.split("&")){if(0===n.length)continue;const r=n.split("=");2===r.length?t[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):N_(`Invalid query segment '${n}' in query '${e}'`)}return t}(e.substring(Math.min(e.length,d)));c=t.indexOf(":"),c>=0?(o="https"===a||"wss"===a,l=parseInt(t.substring(c+1),10)):c=t.length;const f=t.slice(0,c);if("localhost"===f.toLowerCase())n="localhost";else if(f.split(".").length<=2)n=f;else{const e=t.indexOf(".");r=t.substring(0,e).toLowerCase(),n=t.substring(e+1),s=r}"ns"in h&&(s=h.ns)}return{host:t,port:l,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}},aT="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz";!function(){let e=0;const t=[]}();class lT{constructor(e,t,n,r){this.eventType=e,this.eventRegistration=t,this.snapshot=n,this.prevName=r}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+_t(this.snapshot.exportVal())}}class cT{constructor(e,t,n){this.eventRegistration=e,this.error=t,this.path=n}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class uT{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return Fe(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class dT{constructor(e,t,n,r){this._repo=e,this._path=t,this._queryParams=n,this._orderByCalled=r}get key(){return Sw(this._path)?null:bw(this._path)}get ref(){return new hT(this._repo,this._path)}get _queryIdentifier(){const e=yx(this._queryParams),t=j_(e);return"{}"===t?"default":t}get _queryObject(){return yx(this._queryParams)}isEqual(e){if(!((e=Lt(e))instanceof dT))return!1;const t=this._repo===e._repo,n=Tw(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return t&&n&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+function(e){let t="";for(let n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)}}class hT extends dT{constructor(e,t){super(e,t,new gx,!1)}get parent(){const e=ww(this._path);return null===e?null:new hT(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class fT{constructor(e,t,n){this._node=e,this.ref=t,this._index=n}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new pw(e),n=mT(this.ref,e);return new fT(this._node.getChild(t),n,Yw)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){if(this._node.isLeafNode())return!1;return!!this._node.forEachChild(this._index,(t,n)=>e(new fT(n,mT(this.ref,t),Yw)))}hasChild(e){const t=new pw(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function pT(e,t){return(e=Lt(e))._checkNotDeleted("ref"),void 0!==t?mT(e._root,t):e._root}function mT(e,t){var n,r,i,s;return null===gw((e=Lt(e))._path)?(n="child",r="path",s=!1,(i=t)&&(i=i.replace(/^\/*\.info(\/|$)/,"/")),Pk(n,r,i,s)):Pk("child","path",t,!1),new hT(e._repo,xw(e._path,t))}class gT{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){const n=t._queryParams.getIndex();return new lT("value",this,new fT(e.snapshotNode,new hT(t._repo,t._path),n))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new cT(this,e,t):null}matches(e){return e instanceof gT&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class vT{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new cT(this,e,t):null}createEvent(e,t){Fe(null!=e.childName,"Child events should have a childName.");const n=mT(new hT(t._repo,t._path),e.childName),r=t._queryParams.getIndex();return new lT(e.type,this,new fT(e.snapshotNode,n,r),e.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof vT&&(this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)))}hasAnyCallback(){return!!this.callbackContext}}function yT(e,t,n,r,i){let s;if("object"===typeof r&&(s=void 0,i=r),"function"===typeof r&&(s=r),i&&i.onlyOnce){const t=n,r=(n,r)=>{Kk(e._repo,e,a),t(n,r)};r.userCallback=n.userCallback,r.context=n.context,n=r}const o=new uT(n,s||void 0),a="value"===t?new gT(o):new vT(t,o);return function(e,t,n){let r;r=".info"===gw(t._path)?QS(e.infoSyncTree_,t,n):QS(e.serverSyncTree_,t,n),Ok(e.eventQueue_,t._path,r)}(e._repo,e,a),()=>Kk(e._repo,e,a)}function bT(e,t,n,r){return yT(e,"value",t,n,r)}!function(e){Fe(!IS,"__referenceConstructor has already been defined"),IS=e}(hT),function(e){Fe(!PS,"__referenceConstructor has already been defined"),PS=e}(hT);const _T={};let wT=!1;function xT(e,t,n,r,i){let s=r||e.options.databaseURL;void 0===s&&(e.options.projectId||C_("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),k_("Using default host for project ",e.options.projectId),s=`${e.options.projectId}-default-rtdb.firebaseio.com`);let o,a,l=sT(s,i),c=l.repoInfo;"undefined"!==typeof process&&(a={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.FIREBASE_DATABASE_EMULATOR_HOST),a?(o=!0,s=`http://${a}?ns=${c.namespace}`,l=sT(s,i),c=l.repoInfo):o=!l.repoInfo.secure;const u=i&&o?new H_(H_.OWNER):new B_(e.name,e.options,t);Ak("Invalid Firebase Database URL",l),Sw(l.path)||C_("Database URL must point to the root of a Firebase Database (not including a child path).");const d=function(e,t,n,r){let i=_T[t.name];i||(i={},_T[t.name]=i);let s=i[e.toURLString()];s&&C_("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.");return s=new Uk(e,wT,n,r),i[e.toURLString()]=s,s}(c,e,u,new q_(e,n));return new ST(d,e)}class ST{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(Vk(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new hT(this._repo,mw())),this._rootInternal}_delete(){return null!==this._rootInternal&&(!function(e,t){const n=_T[t];n&&n[e.key]===e||C_(`Database ${t}(${e.repoInfo_}) has already been deleted.`),Gk(e),delete n[e.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&C_("Cannot call "+e+" on a deleted database.")}}Rw.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},Rw.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};!function(e){d_(Jn),Kn(new Mt("database",(e,t)=>{let{instanceIdentifier:n}=t;return xT(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),n)},"PUBLIC").setMultipleInstances(!0)),tr(l_,c_,e),tr(l_,c_,"esm2017")}();const kT=Zn({apiKey:"AIzaSyCIMWfYFDtmQ0VcCd9Gcb4eo4lukXZYodI",authDomain:"spaceengineeringchallenge.firebaseapp.com",projectId:"spaceengineeringchallenge",storageBucket:"spaceengineeringchallenge.firebasestorage.app",messagingSenderId:"45731512584",appId:"1:45731512584:web:0801466b1972c457122cbd",measurementId:"G-MQFSL13HW7",databaseURL:"https://spaceengineeringchallenge-default-rtdb.europe-west1.firebasedatabase.app"}),TT=Vo(kT),ET=function(e,t){const n="object"==typeof e?e:er(),r="string"==typeof e?e:t||gu,i=Gn(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const e=Je("firestore");e&&function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var i;e=Ka(e,Vy);const s=nt(t),o=e._getSettings(),a=Object.assign(Object.assign({},o),{emulatorOptions:e._getEmulatorOptions()}),l=`${t}:${n}`;s&&(rt(`https://${l}`),at("Firestore",!0)),o.host!==My&&o.host!==l&&ua("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c=Object.assign(Object.assign({},o),{host:l,ssl:s,emulatorOptions:r});if(!Et(c,a)&&(e._setSettings(c),r.mockUserToken)){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=ia.MOCK_USER;else{t=it(r.mockUserToken,null===(i=e._app)||void 0===i?void 0:i.options.projectId);const s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new va(ga.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new ia(s)}e._authCredentials=new wa(new ba(t,n))}}(i,...e)}return i}(kT),CT=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:er(),t=arguments.length>1?arguments[1]:void 0;const n=Gn(e,"database").getImmediate({identifier:t});if(!n._instanceStarted){const e=Je("database");e&&function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e=Lt(e),e._checkNotDeleted("useEmulator");const i=`${t}:${n}`,s=e._repoInternal;if(e._instanceStarted){if(i===e._repoInternal.repoInfo_.host&&Et(r,s.repoInfo_.emulatorOptions))return;C_("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let o;if(s.repoInfo_.nodeAdmin)r.mockUserToken&&C_('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new H_(H_.OWNER);else if(r.mockUserToken){const t="string"===typeof r.mockUserToken?r.mockUserToken:it(r.mockUserToken,e.app.options.projectId);o=new H_(t)}nt(t)&&(rt(t),at("Database",!0));!function(e,t,n,r){const i=t.lastIndexOf(":"),s=nt(t.substring(0,i));e.repoInfo_=new X_(t,s,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams,!0,n),r&&(e.authTokenProvider_=r)}(s,i,r,o)}(n,...e)}return n}(kT);"undefined"!==typeof window&&async function(e){ua("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=e._freezeSettings();Zy(e,Sy.provider,{build:e=>new xy(e,t.cacheSizeBytes)})}(ET).catch(e=>{"failed-precondition"!==(null===e||void 0===e?void 0:e.code)&&"unimplemented"!==(null===e||void 0===e?void 0:e.code)&&console.error("Firestore persistence error:",e)});let NT={data:""},IT=e=>"object"==typeof window?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||NT,PT=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,AT=/\/\*[^]*?\*\/|  +/g,RT=/\n+/g,DT=(e,t)=>{let n="",r="",i="";for(let s in e){let o=e[s];"@"==s[0]?"i"==s[1]?n=s+" "+o+";":r+="f"==s[1]?DT(o,s):s+"{"+DT(o,"k"==s[1]?"":t)+"}":"object"==typeof o?r+=DT(o,t?t.replace(/([^,])+/g,e=>s.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,t=>/&/.test(t)?t.replace(/&/g,e):e?e+" "+t:t)):s):null!=o&&(s=/^--/.test(s)?s:s.replace(/[A-Z]/g,"-$&").toLowerCase(),i+=DT.p?DT.p(s,o):s+":"+o+";")}return n+(t&&i?t+"{"+i+"}":i)+r},OT={},jT=e=>{if("object"==typeof e){let t="";for(let n in e)t+=n+jT(e[n]);return t}return e},LT=(e,t,n,r,i)=>{let s=jT(e),o=OT[s]||(OT[s]=(e=>{let t=0,n=11;for(;t<e.length;)n=101*n+e.charCodeAt(t++)>>>0;return"go"+n})(s));if(!OT[o]){let t=s!==e?e:(e=>{let t,n,r=[{}];for(;t=PT.exec(e.replace(AT,""));)t[4]?r.shift():t[3]?(n=t[3].replace(RT," ").trim(),r.unshift(r[0][n]=r[0][n]||{})):r[0][t[1]]=t[2].replace(RT," ").trim();return r[0]})(e);OT[o]=DT(i?{["@keyframes "+o]:t}:t,n?"":"."+o)}let a=n&&OT.g?OT.g:null;return n&&(OT.g=OT[o]),((e,t,n,r)=>{r?t.data=t.data.replace(r,e):-1===t.data.indexOf(e)&&(t.data=n?e+t.data:t.data+e)})(OT[o],t,r,a),o};function MT(e){let t=this||{},n=e.call?e(t.p):e;return LT(n.unshift?n.raw?((e,t,n)=>e.reduce((e,r,i)=>{let s=t[i];if(s&&s.call){let e=s(n),t=e&&e.props&&e.props.className||/^go/.test(e)&&e;s=t?"."+t:e&&"object"==typeof e?e.props?"":DT(e,""):!1===e?"":e}return e+r+(null==s?"":s)},""))(n,[].slice.call(arguments,1),t.p):n.reduce((e,n)=>Object.assign(e,n&&n.call?n(t.p):n),{}):n,IT(t.target),t.g,t.o,t.k)}MT.bind({g:1});let FT,UT,VT,zT=MT.bind({k:1});function $T(e,t){let n=this||{};return function(){let r=arguments;function i(s,o){let a=Object.assign({},s),l=a.className||i.className;n.p=Object.assign({theme:UT&&UT()},a),n.o=/ *go\d+/.test(l),a.className=MT.apply(n,r)+(l?" "+l:""),t&&(a.ref=o);let c=e;return e[0]&&(c=a.as||e,delete a.as),VT&&c[0]&&VT(a),FT(c,a)}return t?t(i):i}}var qT=(e,t)=>(e=>"function"==typeof e)(e)?e(t):e,BT=(()=>{let e=0;return()=>(++e).toString()})(),HT=(()=>{let e;return()=>{if(void 0===e&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),WT=(e,t)=>{switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,20)};case 1:return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case 2:let{toast:n}=t;return WT(e,{type:e.toasts.find(e=>e.id===n.id)?1:0,toast:n});case 3:let{toastId:r}=t;return{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,dismissed:!0,visible:!1}:e)};case 4:return void 0===t.toastId?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)};case 5:return{...e,pausedAt:t.time};case 6:let i=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(e=>({...e,pauseDuration:e.pauseDuration+i}))}}},KT=[],GT={toasts:[],pausedAt:void 0},QT=e=>{GT=WT(GT,e),KT.forEach(e=>{e(GT)})},YT={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},XT=e=>(t,n)=>{let r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"blank",n=arguments.length>2?arguments[2]:void 0;return{createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...n,id:(null==n?void 0:n.id)||BT()}}(t,e,n);return QT({type:2,toast:r}),r.id},JT=(e,t)=>XT("blank")(e,t);JT.error=XT("error"),JT.success=XT("success"),JT.loading=XT("loading"),JT.custom=XT("custom"),JT.dismiss=e=>{QT({type:3,toastId:e})},JT.remove=e=>QT({type:4,toastId:e}),JT.promise=(e,t,n)=>{let r=JT.loading(t.loading,{...n,...null==n?void 0:n.loading});return"function"==typeof e&&(e=e()),e.then(e=>{let i=t.success?qT(t.success,e):void 0;return i?JT.success(i,{id:r,...n,...null==n?void 0:n.success}):JT.dismiss(r),e}).catch(e=>{let i=t.error?qT(t.error,e):void 0;i?JT.error(i,{id:r,...n,...null==n?void 0:n.error}):JT.dismiss(r)}),e};var ZT=(e,t)=>{QT({type:1,toast:{id:e,height:t}})},eE=()=>{QT({type:5,time:Date.now()})},tE=new Map,nE=e=>{let{toasts:t,pausedAt:n}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[t,n]=(0,i.useState)(GT),r=(0,i.useRef)(GT);(0,i.useEffect)(()=>(r.current!==GT&&n(GT),KT.push(n),()=>{let e=KT.indexOf(n);e>-1&&KT.splice(e,1)}),[]);let s=t.toasts.map(t=>{var n,r,i;return{...e,...e[t.type],...t,removeDelay:t.removeDelay||(null==(n=e[t.type])?void 0:n.removeDelay)||(null==e?void 0:e.removeDelay),duration:t.duration||(null==(r=e[t.type])?void 0:r.duration)||(null==e?void 0:e.duration)||YT[t.type],style:{...e.style,...null==(i=e[t.type])?void 0:i.style,...t.style}}});return{...t,toasts:s}}(e);(0,i.useEffect)(()=>{if(n)return;let e=Date.now(),r=t.map(t=>{if(t.duration===1/0)return;let n=(t.duration||0)+t.pauseDuration-(e-t.createdAt);if(!(n<0))return setTimeout(()=>JT.dismiss(t.id),n);t.visible&&JT.dismiss(t.id)});return()=>{r.forEach(e=>e&&clearTimeout(e))}},[t,n]);let r=(0,i.useCallback)(()=>{n&&QT({type:6,time:Date.now()})},[n]),s=(0,i.useCallback)((e,n)=>{let{reverseOrder:r=!1,gutter:i=8,defaultPosition:s}=n||{},o=t.filter(t=>(t.position||s)===(e.position||s)&&t.height),a=o.findIndex(t=>t.id===e.id),l=o.filter((e,t)=>t<a&&e.visible).length;return o.filter(e=>e.visible).slice(...r?[l+1]:[0,l]).reduce((e,t)=>e+(t.height||0)+i,0)},[t]);return(0,i.useEffect)(()=>{t.forEach(e=>{if(e.dismissed)!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;if(tE.has(e))return;let n=setTimeout(()=>{tE.delete(e),QT({type:4,toastId:e})},t);tE.set(e,n)}(e.id,e.removeDelay);else{let t=tE.get(e.id);t&&(clearTimeout(t),tE.delete(e.id))}})},[t]),{toasts:t,handlers:{updateHeight:ZT,startPause:eE,endPause:r,calculateOffset:s}}},rE=zT`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,iE=zT`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,sE=zT`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,oE=$T("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${rE} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${iE} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${sE} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,aE=zT`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,lE=$T("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${aE} 1s linear infinite;
`,cE=zT`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,uE=zT`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,dE=$T("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${cE} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${uE} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,hE=$T("div")`
  position: absolute;
`,fE=$T("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,pE=zT`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,mE=$T("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${pE} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,gE=e=>{let{toast:t}=e,{icon:n,type:r,iconTheme:s}=t;return void 0!==n?"string"==typeof n?i.createElement(mE,null,n):n:"blank"===r?null:i.createElement(fE,null,i.createElement(lE,{...s}),"loading"!==r&&i.createElement(hE,null,"error"===r?i.createElement(oE,{...s}):i.createElement(dE,{...s})))},vE=e=>`\n0% {transform: translate3d(0,${-200*e}%,0) scale(.6); opacity:.5;}\n100% {transform: translate3d(0,0,0) scale(1); opacity:1;}\n`,yE=e=>`\n0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}\n100% {transform: translate3d(0,${-150*e}%,-1px) scale(.6); opacity:0;}\n`,bE=$T("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,_E=$T("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,wE=i.memo(e=>{let{toast:t,position:n,style:r,children:s}=e,o=t.height?((e,t)=>{let n=e.includes("top")?1:-1,[r,i]=HT()?["0%{opacity:0;} 100%{opacity:1;}","0%{opacity:1;} 100%{opacity:0;}"]:[vE(n),yE(n)];return{animation:t?`${zT(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${zT(i)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}})(t.position||n||"top-center",t.visible):{opacity:0},a=i.createElement(gE,{toast:t}),l=i.createElement(_E,{...t.ariaProps},qT(t.message,t));return i.createElement(bE,{className:t.className,style:{...o,...r,...t.style}},"function"==typeof s?s({icon:a,message:l}):i.createElement(i.Fragment,null,a,l))});!function(e,t,n,r){DT.p=t,FT=e,UT=n,VT=r}(i.createElement);var xE=e=>{let{id:t,className:n,style:r,onHeightUpdate:s,children:o}=e,a=i.useCallback(e=>{if(e){let n=()=>{let n=e.getBoundingClientRect().height;s(t,n)};n(),new MutationObserver(n).observe(e,{subtree:!0,childList:!0,characterData:!0})}},[t,s]);return i.createElement("div",{ref:a,className:n,style:r},o)},SE=MT`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,kE=e=>{let{reverseOrder:t,position:n="top-center",toastOptions:r,gutter:s,children:o,containerStyle:a,containerClassName:l}=e,{toasts:c,handlers:u}=nE(r);return i.createElement("div",{id:"_rht_toaster",style:{position:"fixed",zIndex:9999,top:16,left:16,right:16,bottom:16,pointerEvents:"none",...a},className:l,onMouseEnter:u.startPause,onMouseLeave:u.endPause},c.map(e=>{let r=e.position||n,a=((e,t)=>{let n=e.includes("top"),r=n?{top:0}:{bottom:0},i=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:HT()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${t*(n?1:-1)}px)`,...r,...i}})(r,u.calculateOffset(e,{reverseOrder:t,gutter:s,defaultPosition:n}));return i.createElement(xE,{id:e.id,key:e.id,onHeightUpdate:u.updateHeight,className:e.visible?SE:"",style:a},"custom"===e.type?qT(e.message,e):o?o(e):i.createElement(wE,{toast:e,position:r}))}))},TE=JT;function EE(){const[e,t]=(0,i.useState)(""),[n,r]=(0,i.useState)(""),[s,o]=(0,i.useState)(!1),a=ee();return(0,De.jsx)("div",{className:"min-h-screen bg-slate-900 text-white flex items-center justify-center px-4",children:(0,De.jsxs)("form",{onSubmit:async t=>{t.preventDefault();const r=e.trim();if(!r||!n)return TE.error("Please enter both email and password.");try{var i;o(!0);const e=await function(e,t,n){return Qn(e.app)?Promise.reject(wr(e)):ps(Lt(e),Zi.credential(t,n)).catch(async t=>{throw"auth/password-does-not-meet-requirements"===t.code&&gs(e),t})}(TT,r,n),t=e.user.uid,s=null===(i=(await Gb(Hy(ET,"users",t))).data())||void 0===i?void 0:i.role;TE.success("Logged in successfully!"),a("admin"===s?"/admin":"professor"===s?"/professor":"team"===s?"/team":"/dashboard")}catch(E_){const t=(null===E_||void 0===E_?void 0:E_.code)||"";if("auth/invalid-credential"===t||"auth/user-not-found"===t||"auth/wrong-password"===t){try{const e=await vs(TT,r);e&&0!==e.length?e.includes("password")?TE.error("Incorrect password."):TE.error("This email is registered with a different sign-in method."):TE.error("No account found for this email.")}catch{TE.error("Login failed. Please check your email and password.")}return void o(!1)}const n={"auth/invalid-email":"Invalid email address.","auth/too-many-requests":"Too many attempts. Please try again later or reset your password.","auth/network-request-failed":"Network error. Please check your connection and try again."};TE.error(n[t]||`Login failed: ${E_.message}`)}finally{o(!1)}},className:"bg-slate-800 p-8 rounded-xl shadow-md w-full max-w-md",children:[(0,De.jsx)("h2",{className:"text-3xl font-bold mb-6 text-center",children:"\ud83d\ude80 Login"}),(0,De.jsx)("label",{className:"text-sm mb-1 block",children:"Email address"}),(0,De.jsx)("input",{type:"email",className:"w-full mb-4 px-4 py-2 bg-slate-700 border border-slate-600 rounded-md placeholder-slate-400",placeholder:"you@example.com",value:e,onChange:e=>t(e.target.value),required:!0}),(0,De.jsx)("label",{className:"text-sm mb-1 block",children:"Password"}),(0,De.jsx)("input",{type:"password",className:"w-full mb-6 px-4 py-2 bg-slate-700 border border-slate-600 rounded-md placeholder-slate-400",placeholder:"Your password",value:n,onChange:e=>r(e.target.value),required:!0}),(0,De.jsx)("button",{type:"submit",disabled:s,className:"w-full py-2 rounded-md font-semibold "+(s?"bg-indigo-400 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-700"),children:s?"Logging in...":"Login"}),(0,De.jsxs)("div",{className:"mt-6 text-center text-sm text-slate-400",children:["Don't have an account?"," ",(0,De.jsx)(Ie,{to:"/signup",className:"text-indigo-400 underline",children:"Sign up"})]}),(0,De.jsx)("div",{className:"mt-2 text-center text-sm text-slate-400",children:(0,De.jsx)(Ie,{to:"/",className:"text-slate-400 underline",children:"\u2190 Back to landing page"})})]})})}const CE="https://spaceengineeringchallenge.web.app";function NE(){const[e,t]=(0,i.useState)(""),[n,r]=(0,i.useState)(""),[s,o]=(0,i.useState)(""),[a,l]=(0,i.useState)("team"),[c,u]=(0,i.useState)(""),[d,h]=(0,i.useState)([{firstName:"",lastName:""}]),[f,p]=(0,i.useState)(""),[m,g]=(0,i.useState)(""),v=ee(),y=(()=>{const e="undefined"!==typeof process&&{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}&&({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_URL||{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.APP_URL)||"";return e||("undefined"!==typeof window?window.location.origin.includes("localhost")?CE:window.location.origin:CE)})(),b=(e,t,n)=>h(r=>r.map((r,i)=>i===e?{...r,[t]:n}:r));return(0,De.jsx)("div",{className:"min-h-screen bg-slate-900 text-white flex items-center justify-center px-4",children:(0,De.jsxs)("form",{onSubmit:async t=>{if(t.preventDefault(),!e||!n||!s)return TE.error("Please fill in all required fields.");if(n!==s)return TE.error("Passwords do not match.");if(!(/[A-Z]/.test(r=n)&&/\d/.test(r)&&/[!@#$%^&*(),.?":{}|<>]/.test(r)&&r.length>=6))return TE.error("Password must have: 1 uppercase, 1 number, 1 special character, min 6 characters.");var r;if("team"===a){if(!c.trim())return TE.error("Please enter team name.");if(d.some(e=>!e.firstName.trim()||!e.lastName.trim()))return TE.error("Please fill out all member names.")}if("organizer"===a&&(!f.trim()||!m.trim()))return TE.error("Please enter your first and last name.");try{const t=await async function(e,t,n){if(Qn(e.app))return Promise.reject(wr(e));const r=Ci(e),i=Mi(r,{returnSecureToken:!0,email:t,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",os,"EMAIL_PASSWORD_PROVIDER"),s=await i.catch(t=>{throw"auth/password-does-not-meet-requirements"===t.code&&gs(e),t}),o=await as._fromIdTokenResponse(r,"signIn",s);return await r._updateCurrentUser(o.user),o}(TT,e,n),r=t.user.uid;try{await ys(t.user,{url:`${y}/login`,handleCodeInApp:!0})}catch(bc){console.warn("sendEmailVerification failed:",bc)}if("team"===a){const t=c.trim().toLowerCase().replace(/\s+/g,"-");await Xb(Hy(ET,"users",r),{email:e,role:"pending_team",createdAt:new Date,emailVerified:!1,status:"pending",pendingTeam:{teamId:t,teamName:c.trim(),members:d}},{merge:!0})}else await Xb(Hy(ET,"users",r),{email:e,role:"pending_professor",firstName:f.trim(),lastName:m.trim(),createdAt:new Date,emailVerified:!1,status:"pending"},{merge:!0});TE.success("Account created. Please verify your email."),v("/verify-email")}catch(i){const e={"auth/email-already-in-use":"An account with this email already exists.","auth/invalid-email":"Invalid email address.","auth/weak-password":"Password is too weak. Use at least 6 characters with uppercase, number and special."};TE.error(e[i.code]||`Signup failed: ${i.message}`)}},className:"bg-slate-800 p-8 rounded-xl shadow-md w-full max-w-md",children:[(0,De.jsx)("h2",{className:"text-3xl font-bold mb-6 text-center",children:"\ud83e\uddd1\u200d\ud83d\ude80 Sign Up"}),(0,De.jsx)("label",{className:"text-sm mb-1 block",children:"Email address"}),(0,De.jsx)("input",{type:"email",className:"w-full mb-4 px-4 py-2 bg-slate-700 border border-slate-600 rounded-md",placeholder:"you@example.com",value:e,onChange:e=>t(e.target.value),required:!0}),(0,De.jsx)("label",{className:"text-sm mb-1 block",children:"Password"}),(0,De.jsx)("input",{type:"password",className:"w-full mb-4 px-4 py-2 bg-slate-700 border border-slate-600 rounded-md",placeholder:"Password",value:n,onChange:e=>r(e.target.value),required:!0}),(0,De.jsx)("label",{className:"text-sm mb-1 block",children:"Confirm Password"}),(0,De.jsx)("input",{type:"password",className:"w-full mb-4 px-4 py-2 bg-slate-700 border border-slate-600 rounded-md",placeholder:"Confirm Password",value:s,onChange:e=>o(e.target.value),required:!0}),(0,De.jsx)("label",{className:"text-sm mb-1 block",children:"Select Role"}),(0,De.jsxs)("select",{className:"w-full mb-4 px-4 py-2 bg-slate-700 border border-slate-600 rounded-md",value:a,onChange:e=>l(e.target.value),children:[(0,De.jsx)("option",{value:"team",children:"Team"}),(0,De.jsx)("option",{value:"organizer",children:"Organizer"})]}),"team"===a?(0,De.jsxs)(De.Fragment,{children:[(0,De.jsx)("label",{className:"text-sm mb-1 block",children:"Team Name"}),(0,De.jsx)("input",{type:"text",placeholder:"Team name",className:"w-full mb-4 px-4 py-2 bg-slate-700 border border-slate-600 rounded-md",value:c,onChange:e=>u(e.target.value),required:!0}),d.map((e,t)=>(0,De.jsxs)("div",{className:"mb-4 relative",children:[(0,De.jsxs)("label",{className:"text-sm mb-1 block",children:["Member ",t+1]}),(0,De.jsx)("input",{type:"text",placeholder:"First Name",className:"w-full mb-2 px-4 py-2 bg-slate-700 border border-slate-600 rounded-md",value:e.firstName,onChange:e=>b(t,"firstName",e.target.value),required:!0}),(0,De.jsx)("input",{type:"text",placeholder:"Last Name",className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-md",value:e.lastName,onChange:e=>b(t,"lastName",e.target.value),required:!0}),d.length>1&&(0,De.jsx)("button",{type:"button",onClick:()=>(e=>h(t=>t.filter((t,n)=>n!==e)))(t),className:"absolute top-0 right-0 text-sm text-red-400 hover:text-red-600",title:"Remove member",children:"\u274c"})]},t)),d.length<3&&(0,De.jsx)("button",{type:"button",onClick:()=>{if(d.length>=3)return TE.error("Maximum 3 members allowed.");h([...d,{firstName:"",lastName:""}])},className:"mb-4 bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded-md text-white font-semibold",children:"\u2795 Add Member"})]}):(0,De.jsxs)(De.Fragment,{children:[(0,De.jsx)("label",{className:"text-sm mb-1 block",children:"First Name"}),(0,De.jsx)("input",{type:"text",className:"w-full mb-4 px-4 py-2 bg-slate-700 border border-slate-600 rounded-md",placeholder:"First Name",value:f,onChange:e=>p(e.target.value),required:!0}),(0,De.jsx)("label",{className:"text-sm mb-1 block",children:"Last Name"}),(0,De.jsx)("input",{type:"text",className:"w-full mb-4 px-4 py-2 bg-slate-700 border border-slate-600 rounded-md",placeholder:"Last Name",value:m,onChange:e=>g(e.target.value),required:!0})]}),(0,De.jsx)("button",{type:"submit",className:"w-full bg-indigo-600 hover:bg-indigo-700 py-2 rounded-md font-semibold transition",children:"Create Account"}),(0,De.jsxs)("div",{className:"mt-6 text-center text-sm text-slate-400",children:["Already have an account? ",(0,De.jsx)(Ie,{to:"/login",className:"text-indigo-400 underline",children:"Login"})]}),(0,De.jsx)("div",{className:"mt-2 text-center text-sm text-slate-400",children:(0,De.jsx)(Ie,{to:"/",className:"text-slate-400 underline",children:"\u2190 Back to landing page"})})]})})}const IE=(0,i.createContext)(),PE=e=>{let{children:t}=e;const[n,r]=(0,i.useState)(null),[s,o]=(0,i.useState)(null),[a,l]=(0,i.useState)(!0);return(0,i.useEffect)(()=>{const e=function(e,t,n,r){return Lt(e).onAuthStateChanged(t,n,r)}(TT,async e=>{if(r(e),e){const t=await Gb(Hy(ET,"users",e.uid));t.exists()&&o(t.data())}else o(null);l(!1)});return()=>e()},[]),(0,De.jsx)(IE.Provider,{value:{currentUser:n,userData:s,loading:a},children:t})},AE=()=>(0,i.useContext)(IE);function RE(){const e=ee();return(0,De.jsx)("header",{className:"sticky top-0 z-40 bg-slate-900/90 backdrop-blur supports-[backdrop-filter]:bg-slate-900/70 border-b border-slate-800 shadow-sm",children:(0,De.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6",children:(0,De.jsxs)("div",{className:"h-16 md:h-20 flex items-center justify-between",children:[(0,De.jsxs)("div",{className:"flex items-center gap-3",children:[(0,De.jsx)("img",{src:"/logo192.png",alt:"Logo",className:"w-9 h-9 rounded-lg ring-1 ring-slate-700/60"}),(0,De.jsx)("span",{className:"text-xl md:text-2xl font-semibold tracking-tight text-slate-100",children:"Score App"})]}),(0,De.jsx)("button",{onClick:async()=>{try{await function(e){return Lt(e).signOut()}(TT),e("/login")}catch(NT){console.error("Logout failed:",NT),e("/login")}},className:"inline-flex items-center gap-2 rounded-lg bg-indigo-600 px-4 md:px-5 py-2.5 md:py-3 text-sm md:text-base font-semibold text-white shadow hover:bg-indigo-500 active:bg-indigo-700 transition","aria-label":"Logout",title:"Logout",children:"Logout"})]})})})}function DE(){const{userData:e,loading:t}=AE(),n=ee();if((0,i.useEffect)(()=>{t||"admin"!==(null===e||void 0===e?void 0:e.role)||n("/admin")},[t,e,n]),t)return(0,De.jsx)("div",{className:"text-center text-white mt-10",children:"Loading..."});if(!e)return(0,De.jsx)("div",{className:"text-center text-red-400 mt-10",children:"User data not found"});const{role:r}=e;return(0,De.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 to-slate-950 text-white",children:[(0,De.jsx)(RE,{}),(0,De.jsxs)("div",{className:"p-6",children:[(0,De.jsxs)("h1",{className:"text-3xl font-bold mb-8 text-indigo-400",children:["\ud83d\ude80 Dashboard (",r,")"]}),"team"===r&&(0,De.jsxs)("div",{className:"bg-slate-800 p-6 rounded-xl shadow-lg border border-slate-700",children:[(0,De.jsx)("h2",{className:"text-2xl font-semibold mb-4",children:"Team View"}),(0,De.jsx)("p",{children:"\ud83d\udce1 Robot progress: 3 / 7 checkpoints"}),(0,De.jsx)("p",{children:"\ud83c\udfc1 Final score: not available yet"})]}),"professor"===r&&(0,De.jsxs)("div",{className:"bg-slate-800 p-6 rounded-xl shadow-lg border border-slate-700",children:[(0,De.jsx)("h2",{className:"text-2xl font-semibold mb-4",children:"Professor Panel"}),(0,De.jsxs)("ul",{className:"list-disc list-inside space-y-2 text-slate-300 mb-4",children:[(0,De.jsx)("li",{children:"\u2705 View team scores"}),(0,De.jsx)("li",{children:"\ud83d\udcdd Edit scores / add evaluations"}),(0,De.jsx)("li",{children:"\ud83d\udd0e Review robot logs"})]}),(0,De.jsx)("button",{onClick:()=>n("/professor"),className:"px-4 py-2 rounded-md bg-indigo-600 hover:bg-indigo-500 text-white text-sm font-medium",children:"Deschide Professor Panel"})]}),"pending_professor"===r&&(0,De.jsx)("div",{className:"bg-yellow-200 text-yellow-900 p-4 rounded-lg mt-4 border border-yellow-300",children:"\u23f3 Contul t\u0103u de profesor este \xeen a\u0219teptare pentru aprobare."})]})]})}function OE(){const[e,t]=(0,i.useState)([]);(0,i.useEffect)(()=>{(async()=>{const e=Rb(By(ET,"users"),Ob("role","==","pending_professor")),n=(await Yb(e)).docs.map(e=>({id:e.id,...e.data()}));t(n)})()},[]);return(0,De.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 to-slate-950 text-white",children:[(0,De.jsx)(RE,{})," ",(0,De.jsxs)("div",{className:"p-8",children:[(0,De.jsx)("h1",{className:"text-3xl font-bold mb-6 text-indigo-400",children:"Admin Panel \u2013 Approve Professors"}),0===e.length?(0,De.jsx)("p",{className:"text-slate-400",children:"\u2705 No pending requests"}):(0,De.jsx)("ul",{className:"space-y-4",children:e.map(n=>(0,De.jsxs)("li",{className:"bg-slate-800 border border-slate-700 rounded-xl p-4 flex justify-between items-center",children:[(0,De.jsxs)("div",{children:[(0,De.jsx)("p",{className:"font-semibold",children:n.email}),(0,De.jsxs)("p",{className:"text-sm text-slate-400",children:["ID: ",n.id]})]}),(0,De.jsx)("button",{onClick:()=>(async n=>{await Jb(Hy(ET,"users",n),{role:"professor"}),t(e.filter(e=>e.id!==n))})(n.id),className:"bg-green-500 hover:bg-green-600 px-4 py-2 rounded-md font-semibold transition",children:"\u2705 Approve"})]},n.id))})]})]})}function jE(e){var t,n,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(n=jE(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}const LE=function(){for(var e,t,n=0,r="",i=arguments.length;n<i;n++)(e=arguments[n])&&(t=jE(e))&&(r&&(r+=" "),r+=t);return r};!function(e){if(!e||"undefined"==typeof document)return;let t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",t.firstChild?t.insertBefore(n,t.firstChild):t.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}(':root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}\n');var ME=e=>"number"==typeof e&&!isNaN(e),FE=e=>"string"==typeof e,UE=e=>"function"==typeof e,VE=e=>FE(e)||UE(e)?e:null,zE=(e,t)=>!1===e||ME(e)&&e>0?e:t,$E=e=>(0,i.isValidElement)(e)||FE(e)||UE(e)||ME(e);function qE(e){let{enter:t,exit:n,appendPosition:r=!1,collapse:s=!0,collapseDuration:o=300}=e;return function(e){let{children:a,position:l,preventExitTransition:c,done:u,nodeRef:d,isIn:h,playToast:f}=e,p=r?`${t}--${l}`:t,m=r?`${n}--${l}`:n,g=(0,i.useRef)(0);return(0,i.useLayoutEffect)(()=>{let e=d.current,t=p.split(" "),n=r=>{r.target===d.current&&(f(),e.removeEventListener("animationend",n),e.removeEventListener("animationcancel",n),0===g.current&&"animationcancel"!==r.type&&e.classList.remove(...t))};e.classList.add(...t),e.addEventListener("animationend",n),e.addEventListener("animationcancel",n)},[]),(0,i.useEffect)(()=>{let e=d.current,t=()=>{e.removeEventListener("animationend",t),s?function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:300,{scrollHeight:r,style:i}=e;requestAnimationFrame(()=>{i.minHeight="initial",i.height=r+"px",i.transition=`all ${n}ms`,requestAnimationFrame(()=>{i.height="0",i.padding="0",i.margin="0",setTimeout(t,n)})})}(e,u,o):u()};h||(c?t():(g.current=1,e.className+=` ${m}`,e.addEventListener("animationend",t)))},[h]),i.createElement(i.Fragment,null,a)}}function BE(e,t){return{content:HE(e.content,e.props),containerId:e.props.containerId,id:e.props.toastId,theme:e.props.theme,type:e.props.type,data:e.props.data||{},isLoading:e.props.isLoading,icon:e.props.icon,reason:e.removalReason,status:t}}function HE(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,i.isValidElement)(e)&&!FE(e.type)?(0,i.cloneElement)(e,{closeToast:t.closeToast,toastProps:t,data:t.data,isPaused:n}):UE(e)?e({closeToast:t.closeToast,toastProps:t,data:t.data,isPaused:n}):e}function WE(e){let{delay:t,isRunning:n,closeToast:r,type:s="default",hide:o,className:a,controlledProgress:l,progress:c,rtl:u,isIn:d,theme:h}=e,f=o||l&&0===c,p={animationDuration:`${t}ms`,animationPlayState:n?"running":"paused"};l&&(p.transform=`scaleX(${c})`);let m=LE("Toastify__progress-bar",l?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${h}`,`Toastify__progress-bar--${s}`,{"Toastify__progress-bar--rtl":u}),g=UE(a)?a({rtl:u,type:s,defaultClassName:m}):LE(m,a),v={[l&&c>=1?"onTransitionEnd":"onAnimationEnd"]:l&&c<1?null:()=>{d&&r()}};return i.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":f},i.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${h} Toastify__progress-bar--${s}`}),i.createElement("div",{role:"progressbar","aria-hidden":f?"true":"false","aria-label":"notification timer",className:g,style:p,...v}))}var KE=1,GE=()=>""+KE++;function QE(e,t,n){let r=1,i=0,s=[],o=[],a=t,l=new Map,c=new Set,u=()=>{o=Array.from(l.values()),c.forEach(e=>e())},d=e=>{var t,n;null==(n=null==(t=e.props)?void 0:t.onClose)||n.call(t,e.removalReason),e.isActive=!1},h=e=>{if(null==e)l.forEach(d);else{let t=l.get(e);t&&d(t)}u()},f=e=>{var t,r;let{toastId:i,updateId:s}=e.props,o=null==s;e.staleId&&l.delete(e.staleId),e.isActive=!0,l.set(i,e),u(),n(BE(e,o?"added":"updated")),o&&(null==(r=(t=e.props).onOpen)||r.call(t))};return{id:e,props:a,observe:e=>(c.add(e),()=>c.delete(e)),toggle:(e,t)=>{l.forEach(n=>{var r;(null==t||t===n.props.toastId)&&(null==(r=n.toggle)||r.call(n,e))})},removeToast:h,toasts:l,clearQueue:()=>{i-=s.length,s=[]},buildToast:(t,o)=>{if((t=>{let{containerId:n,toastId:r,updateId:i}=t,s=n?n!==e:1!==e,o=l.has(r)&&null==i;return s||o})(o))return;let{toastId:c,updateId:d,data:p,staleId:m,delay:g}=o,v=null==d;v&&i++;let y={...a,style:a.toastStyle,key:r++,...Object.fromEntries(Object.entries(o).filter(e=>{let[t,n]=e;return null!=n})),toastId:c,updateId:d,data:p,isIn:!1,className:VE(o.className||a.toastClassName),progressClassName:VE(o.progressClassName||a.progressClassName),autoClose:!o.isLoading&&zE(o.autoClose,a.autoClose),closeToast(e){l.get(c).removalReason=e,h(c)},deleteToast(){let e=l.get(c);if(null!=e){if(n(BE(e,"removed")),l.delete(c),i--,i<0&&(i=0),s.length>0)return void f(s.shift());u()}}};y.closeButton=a.closeButton,!1===o.closeButton||$E(o.closeButton)?y.closeButton=o.closeButton:!0===o.closeButton&&(y.closeButton=!$E(a.closeButton)||a.closeButton);let b={content:t,props:y,staleId:m};a.limit&&a.limit>0&&i>a.limit&&v?s.push(b):ME(g)?setTimeout(()=>{f(b)},g):f(b)},setProps(e){a=e},setToggle:(e,t)=>{let n=l.get(e);n&&(n.toggle=t)},isToastActive:e=>{var t;return null==(t=l.get(e))?void 0:t.isActive},getSnapshot:()=>o}}var YE=new Map,XE=[],JE=new Set,ZE=e=>JE.forEach(t=>t(e)),eC=()=>YE.size>0;function tC(e,t){var n;if(t)return!(null==(n=YE.get(t))||!n.isToastActive(e));let r=!1;return YE.forEach(t=>{t.isToastActive(e)&&(r=!0)}),r}function nC(e){if(eC()){if(null==e||(e=>FE(e)||ME(e))(e))YE.forEach(t=>{t.removeToast(e)});else if(e&&("containerId"in e||"id"in e)){let t=YE.get(e.containerId);t?t.removeToast(e.id):YE.forEach(t=>{t.removeToast(e.id)})}}else XE=XE.filter(t=>null!=e&&t.options.toastId!==e)}function rC(e,t){$E(e)&&(eC()||XE.push({content:e,options:t}),YE.forEach(n=>{n.buildToast(e,t)}))}function iC(e,t){YE.forEach(n=>{(null==t||null==t||!t.containerId||(null==t?void 0:t.containerId)===n.id)&&n.toggle(e,null==t?void 0:t.id)})}function sC(e){let t=e.containerId||1;return{subscribe(n){let r=QE(t,e,ZE);YE.set(t,r);let i=r.observe(n);return XE.forEach(e=>rC(e.content,e.options)),XE=[],()=>{i(),YE.delete(t)}},setProps(e){var n;null==(n=YE.get(t))||n.setProps(e)},getSnapshot(){var e;return null==(e=YE.get(t))?void 0:e.getSnapshot()}}}function oC(e){return e&&(FE(e.toastId)||ME(e.toastId))?e.toastId:GE()}function aC(e,t){return rC(e,t),t.toastId}function lC(e,t){return{...t,type:t&&t.type||e,toastId:oC(t)}}function cC(e){return(t,n)=>aC(t,lC(e,n))}function uC(e,t){return aC(e,lC("default",t))}function dC(e){let[t,n]=(0,i.useState)(!1),[r,s]=(0,i.useState)(!1),o=(0,i.useRef)(null),a=(0,i.useRef)({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:l,pauseOnHover:c,closeToast:u,onClick:d,closeOnClick:h}=e;function f(){n(!0)}function p(){n(!1)}function m(n){let r=o.current;if(a.canDrag&&r){a.didMove=!0,t&&p(),"x"===e.draggableDirection?a.delta=n.clientX-a.start:a.delta=n.clientY-a.start,a.start!==n.clientX&&(a.canCloseOnClick=!1);let i="x"===e.draggableDirection?`${a.delta}px, var(--y)`:`0, calc(${a.delta}px + var(--y))`;r.style.transform=`translate3d(${i},0)`,r.style.opacity=""+(1-Math.abs(a.delta/a.removalDistance))}}function g(){document.removeEventListener("pointermove",m),document.removeEventListener("pointerup",g);let t=o.current;if(a.canDrag&&a.didMove&&t){if(a.canDrag=!1,Math.abs(a.delta)>a.removalDistance)return s(!0),e.closeToast(!0),void e.collapseAll();t.style.transition="transform 0.2s, opacity 0.2s",t.style.removeProperty("transform"),t.style.removeProperty("opacity")}}(function(e){var t;null==(t=YE.get(e.containerId||1))||t.setToggle(e.id,e.fn)})({id:e.toastId,containerId:e.containerId,fn:n}),(0,i.useEffect)(()=>{if(e.pauseOnFocusLoss)return document.hasFocus()||p(),window.addEventListener("focus",f),window.addEventListener("blur",p),()=>{window.removeEventListener("focus",f),window.removeEventListener("blur",p)}},[e.pauseOnFocusLoss]);let v={onPointerDown:function(t){if(!0===e.draggable||e.draggable===t.pointerType){a.didMove=!1,document.addEventListener("pointermove",m),document.addEventListener("pointerup",g);let n=o.current;a.canCloseOnClick=!0,a.canDrag=!0,n.style.transition="none","x"===e.draggableDirection?(a.start=t.clientX,a.removalDistance=n.offsetWidth*(e.draggablePercent/100)):(a.start=t.clientY,a.removalDistance=n.offsetHeight*(80===e.draggablePercent?1.5*e.draggablePercent:e.draggablePercent)/100)}},onPointerUp:function(t){let{top:n,bottom:r,left:i,right:s}=o.current.getBoundingClientRect();"touchend"!==t.nativeEvent.type&&e.pauseOnHover&&t.clientX>=i&&t.clientX<=s&&t.clientY>=n&&t.clientY<=r?p():f()}};return l&&c&&(v.onMouseEnter=p,e.stacked||(v.onMouseLeave=f)),h&&(v.onClick=e=>{d&&d(e),a.canCloseOnClick&&u(!0)}),{playToast:f,pauseToast:p,isRunning:t,preventExitTransition:r,toastRef:o,eventHandlers:v}}uC.loading=(e,t)=>aC(e,lC("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...t})),uC.promise=function(e,t,n){let r,{pending:i,error:s,success:o}=t;i&&(r=FE(i)?uC.loading(i,n):uC.loading(i.render,{...n,...i}));let a={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},l=(e,t,i)=>{if(null==t)return void uC.dismiss(r);let s={type:e,...a,...n,data:i},o=FE(t)?{render:t}:t;return r?uC.update(r,{...s,...o}):uC(o.render,{...s,...o}),i},c=UE(e)?e():e;return c.then(e=>l("success",o,e)).catch(e=>l("error",s,e)),c},uC.success=cC("success"),uC.info=cC("info"),uC.error=cC("error"),uC.warning=cC("warning"),uC.warn=uC.warning,uC.dark=(e,t)=>aC(e,lC("default",{theme:"dark",...t})),uC.dismiss=function(e){nC(e)},uC.clearWaitingQueue=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};YE.forEach(t=>{t.props.limit&&(!e.containerId||t.id===e.containerId)&&t.clearQueue()})},uC.isActive=tC,uC.update=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=((e,t)=>{let{containerId:n}=t;var r;return null==(r=YE.get(n||1))?void 0:r.toasts.get(e)})(e,t);if(n){let{props:r,content:i}=n,s={delay:100,...r,...t,toastId:t.toastId||e,updateId:GE()};s.toastId!==e&&(s.staleId=e);let o=s.render||i;delete s.render,aC(o,s)}},uC.done=e=>{uC.update(e,{progress:1})},uC.onChange=function(e){return JE.add(e),()=>{JE.delete(e)}},uC.play=e=>iC(!0,e),uC.pause=e=>iC(!1,e);var hC="undefined"!=typeof window?i.useLayoutEffect:i.useEffect,fC=e=>{let{theme:t,type:n,isLoading:r,...s}=e;return i.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:"colored"===t?"currentColor":`var(--toastify-icon-color-${n})`,...s})};var pC={info:function(e){return i.createElement(fC,{...e},i.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))},warning:function(e){return i.createElement(fC,{...e},i.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))},success:function(e){return i.createElement(fC,{...e},i.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))},error:function(e){return i.createElement(fC,{...e},i.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))},spinner:function(){return i.createElement("div",{className:"Toastify__spinner"})}};function mC(e){let{theme:t,type:n,isLoading:r,icon:s}=e,o=null,a={theme:t,type:n};return!1===s||(UE(s)?o=s({...a,isLoading:r}):(0,i.isValidElement)(s)?o=(0,i.cloneElement)(s,a):r?o=pC.spinner():(e=>e in pC)(n)&&(o=pC[n](a))),o}var gC=e=>{let{isRunning:t,preventExitTransition:n,toastRef:r,eventHandlers:s,playToast:o}=dC(e),{closeButton:a,children:l,autoClose:c,onClick:u,type:d,hideProgressBar:h,closeToast:f,transition:p,position:m,className:g,style:v,progressClassName:y,updateId:b,role:_,progress:w,rtl:x,toastId:S,deleteToast:k,isIn:T,isLoading:E,closeOnClick:C,theme:N,ariaLabel:I}=e,P=LE("Toastify__toast",`Toastify__toast-theme--${N}`,`Toastify__toast--${d}`,{"Toastify__toast--rtl":x},{"Toastify__toast--close-on-click":C}),A=UE(g)?g({rtl:x,position:m,type:d,defaultClassName:P}):LE(P,g),R=mC(e),D=!!w||!c,O={closeToast:f,type:d,theme:N},j=null;return!1===a||(j=UE(a)?a(O):(0,i.isValidElement)(a)?(0,i.cloneElement)(a,O):function(e){let{closeToast:t,theme:n,ariaLabel:r="close"}=e;return i.createElement("button",{className:`Toastify__close-button Toastify__close-button--${n}`,type:"button",onClick:e=>{e.stopPropagation(),t(!0)},"aria-label":r},i.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},i.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}(O)),i.createElement(p,{isIn:T,done:k,position:m,preventExitTransition:n,nodeRef:r,playToast:o},i.createElement("div",{id:S,tabIndex:0,onClick:u,"data-in":T,className:A,...s,style:v,ref:r,...T&&{role:_,"aria-label":I}},null!=R&&i.createElement("div",{className:LE("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!E})},R),HE(l,e,!t),j,!e.customProgressBar&&i.createElement(WE,{...b&&!D?{key:`p-${b}`}:{},rtl:x,theme:N,delay:c,isRunning:t,isIn:T,closeToast:f,hide:h,type:d,className:y,controlledProgress:D,progress:w||0})))},vC=function(e){return{enter:`Toastify--animate Toastify__${e}-enter`,exit:`Toastify--animate Toastify__${e}-exit`,appendPosition:arguments.length>1&&void 0!==arguments[1]&&arguments[1]}},yC=qE(vC("bounce",!0)),bC=(qE(vC("slide",!0)),qE(vC("zoom")),qE(vC("flip")),{position:"top-right",transition:yC,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light","aria-label":"Notifications Alt+T",hotKeys:e=>e.altKey&&"KeyT"===e.code});function _C(e){let t={...bC,...e},n=e.stacked,[r,s]=(0,i.useState)(!0),o=(0,i.useRef)(null),{getToastToRender:a,isToastActive:l,count:c}=function(e){var t;let{subscribe:n,getSnapshot:r,setProps:s}=(0,i.useRef)(sC(e)).current;s(e);let o=null==(t=(0,i.useSyncExternalStore)(n,r,r))?void 0:t.slice();return{getToastToRender:function(t){if(!o)return[];let n=new Map;return e.newestOnTop&&o.reverse(),o.forEach(e=>{let{position:t}=e.props;n.has(t)||n.set(t,[]),n.get(t).push(e)}),Array.from(n,e=>t(e[0],e[1]))},isToastActive:tC,count:null==o?void 0:o.length}}(t),{className:u,style:d,rtl:h,containerId:f,hotKeys:p}=t;function m(e){let t=LE("Toastify__toast-container",`Toastify__toast-container--${e}`,{"Toastify__toast-container--rtl":h});return UE(u)?u({position:e,rtl:h,defaultClassName:t}):LE(t,VE(u))}function g(){n&&(s(!0),uC.play())}return hC(()=>{var e;if(n){let n=o.current.querySelectorAll('[data-in="true"]'),i=12,s=null==(e=t.position)?void 0:e.includes("top"),a=0,l=0;Array.from(n).reverse().forEach((e,t)=>{let n=e;n.classList.add("Toastify__toast--stacked"),t>0&&(n.dataset.collapsed=`${r}`),n.dataset.pos||(n.dataset.pos=s?"top":"bot");let o=a*(r?.2:1)+(r?0:i*t);n.style.setProperty("--y",`${s?o:-1*o}px`),n.style.setProperty("--g",`${i}`),n.style.setProperty("--s",""+(1-(r?l:0))),a+=n.offsetHeight,l+=.025})}},[r,c,n]),(0,i.useEffect)(()=>{function e(e){var t;let n=o.current;p(e)&&(null==(t=n.querySelector('[tabIndex="0"]'))||t.focus(),s(!1),uC.pause()),"Escape"===e.key&&(document.activeElement===n||null!=n&&n.contains(document.activeElement))&&(s(!0),uC.play())}return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[p]),i.createElement("section",{ref:o,className:"Toastify",id:f,onMouseEnter:()=>{n&&(s(!1),uC.pause())},onMouseLeave:g,"aria-live":"polite","aria-atomic":"false","aria-relevant":"additions text","aria-label":t["aria-label"]},a((e,t)=>{let r=t.length?{...d}:{...d,pointerEvents:"none"};return i.createElement("div",{tabIndex:-1,className:m(e),"data-stacked":n,style:r,key:`c-${e}`},t.map(e=>{let{content:t,props:r}=e;return i.createElement(gC,{...r,stacked:n,collapseAll:g,isIn:l(r.toastId,r.containerId),key:`t-${r.key}`},t)}))}))}const wC="Mission Performance",xC=(e,t,n)=>`${e}_${t}_${n}`,SC=e=>{let t=parseFloat(String(null!==e&&void 0!==e?e:"").replace(",","."));return Number.isNaN(t)&&(t=0),(e=>Math.max(0,Math.min(10,e)))(t)},kC=e=>null==e?"":String(e),TC=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return JSON.stringify([(n=e,"number"===typeof n?Number(n.toFixed(3)):SC(n)),kC(t)]);var n},EC=e=>String(e||"").toLowerCase().trim().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"").slice(0,40);function CC(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter(Boolean).join(" ")}function NC(e,t){const[n,r]=(0,i.useState)(()=>{try{const n=localStorage.getItem(e);return null!=n?JSON.parse(n):t}catch{return t}});return(0,i.useEffect)(()=>{try{localStorage.setItem(e,JSON.stringify(n))}catch{}},[e,n]),[n,r]}const IC=e=>{let{value:t=0,size:n=56}=e;const r=Math.max(0,Math.min(100,10*t)),i=`conic-gradient(${t>=8?"#34d399":t>=5?"#f59e0b":"#f87171"} ${r}%, rgba(148,163,184,0.2) ${r}% 100%)`;return(0,De.jsxs)("div",{className:"inline-grid place-items-center relative",style:{width:n,height:n},children:[(0,De.jsx)("div",{className:"rounded-full shadow-[inset_0_0_0_6px_rgba(15,23,42,.9)]",style:{width:n,height:n,background:i,transition:"background 600ms ease"}}),(0,De.jsxs)("div",{className:"absolute text-xs leading-none text-slate-100 font-semibold drop-shadow",children:[Number.isFinite(t)?t.toFixed(2):"0.00",(0,De.jsx)("span",{className:"text-[10px] opacity-70",children:"/10"})]})]})},PC=e=>{let{saved:t,onClick:n}=e;return(0,De.jsxs)("button",{type:"button",onClick:t?void 0:n,disabled:!!t,className:CC("px-3 py-2 rounded text-xs font-medium inline-flex items-center gap-1 transition",t?"bg-emerald-600/90 text-white cursor-default":"bg-indigo-600 hover:bg-indigo-500 text-white shadow hover:shadow-indigo-500/20"),title:t?"Saved":"Save (Ctrl/Cmd+Enter)",children:[(0,De.jsx)("svg",{className:CC("w-3.5 h-3.5",t?"":"animate-pulse"),viewBox:"0 0 20 20",fill:"currentColor",children:t?(0,De.jsx)("path",{d:"M16.707 5.293a1 1 0 010 1.414l-7.25 7.25a1 1 0 01-1.414 0l-3.25-3.25a1 1 0 011.414-1.414l2.543 2.543 6.543-6.543a1 1 0 011.414 0z"}):(0,De.jsx)("path",{d:"M10 2a1 1 0 011 1v7h7a1 1 0 110 2h-7v7a1 1 0 11-2 0v-7H2a1 1 0 110-2h7V3a1 1 0 011-1z"})}),t?"Saved":"Save"]})},AC=e=>{let{label:t,value:n,title:r}=e;return(0,De.jsxs)("div",{className:"rounded-lg border border-slate-700 bg-slate-800/60 px-3 py-2 text-right shadow-sm min-w-[112px]",title:r,"aria-label":r||t,children:[(0,De.jsx)("div",{className:"text-[11px] leading-none text-slate-400 mb-1",children:t}),(0,De.jsx)("div",{className:"font-semibold",children:n})]})};function RC(e){let{labels:t,series:n,unit:r="",height:i=190}=e;const s=640,o=i,a=16,l=12,c=56,u=s-c-l,d=o-a-28,h=n.flatMap(e=>(e.data||[]).filter(e=>null!=e&&isFinite(e)));let f=Math.min(...h),p=Math.max(...h);isFinite(f)&&isFinite(p)||(f=0,p=1),f===p&&(f-=.5,p+=.5);const{ticks:m,niceMin:g,niceMax:v}=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6;Number.isFinite(e)&&Number.isFinite(t)||(e=0,t=1),e===t&&(e-=.5,t+=.5);const r=(t-e)/Math.max(1,n-1),i=Math.pow(10,Math.floor(Math.log10(r))),s=r/i;let o;o=s>=7.5?10*i:s>=3.5?5*i:s>=1.5?2*i:1*i;const a=Math.floor(e/o)*o,l=Math.ceil(t/o)*o,c=[];for(let u=a;u<=l+1e-9;u+=o)c.push(Number(u.toFixed(2)));return{ticks:c,niceMin:a,niceMax:l}}(f,p,6),y=e=>c+(t.length<=1?0:u*e/(t.length-1)),b=e=>a+d-(e-g)/(v-g)*d,_=e=>{let t="",n=!1;return e.forEach((e,r)=>{if(null==e||!isFinite(e))return void(n=!1);const i=y(r),s=b(e);t+=`${n?" L ":" M "}${i.toFixed(2)} ${s.toFixed(2)}`,n=!0}),t.trim()};return(0,De.jsxs)("div",{className:"rounded-xl border border-slate-800 bg-slate-900/40 p-3",children:[(0,De.jsxs)("svg",{viewBox:`0 0 640 ${o}`,className:"w-full h-auto block",children:[m.map((e,t)=>{const n=b(e);return(0,De.jsxs)("g",{children:[(0,De.jsx)("line",{x1:c,y1:n,x2:s-l,y2:n,stroke:"#334155",strokeWidth:"1",opacity:"0.5"}),(0,De.jsxs)("text",{x:c-8,y:n,textAnchor:"end",dominantBaseline:"middle",fontSize:"11",fill:"#94a3b8",children:[e.toFixed(2),r]})]},`gy:${t}`)}),(0,De.jsx)("line",{x1:c,y1:a+d,x2:s-l,y2:a+d,stroke:"#475569",strokeWidth:"1"}),t.map((e,t)=>(0,De.jsx)("text",{x:y(t),y:a+d+16,textAnchor:"middle",fontSize:"11",fill:"#94a3b8",children:e},`xl:${t}`)),n.map((e,t)=>(0,De.jsxs)("g",{children:[(0,De.jsx)("path",{d:_(e.data||[]),fill:"none",stroke:e.color,strokeWidth:"2.5"}),(e.data||[]).map((n,r)=>null!=n&&isFinite(n)?(0,De.jsx)("circle",{cx:y(r),cy:b(n),r:"3.5",fill:e.color,stroke:"#0f172a",strokeWidth:"1"},`pt:${t}:${r}`):null)]},`s:${t}`))]}),(0,De.jsx)("div",{className:"mt-2 flex items-center gap-4 text-xs text-slate-300",children:n.map((e,t)=>(0,De.jsxs)("div",{className:"flex items-center gap-2",children:[(0,De.jsx)("span",{className:"inline-block w-3 h-3 rounded",style:{background:e.color}}),(0,De.jsx)("span",{children:e.name})]},`lg:${t}`))})]})}function DC(e){let{total:t,curTemps:n=[],curHums:r=[],onSave:s}=e;const[o,a]=(0,i.useState)(!1),[l,c]=(0,i.useState)(()=>Array.from({length:t},(e,t)=>{var r;return null!==(r=n[t])&&void 0!==r?r:""})),[u,d]=(0,i.useState)(()=>Array.from({length:t},(e,t)=>{var n;return null!==(n=r[t])&&void 0!==n?n:""}));(0,i.useEffect)(()=>{c(Array.from({length:t},(e,t)=>{var r;return null!==(r=n[t])&&void 0!==r?r:""})),d(Array.from({length:t},(e,t)=>{var n;return null!==(n=r[t])&&void 0!==n?n:""}))},[t,n,r]);const h=e=>Array.from({length:t},(t,n)=>{const r=Number(String(e[n]).replace(",","."));return Number.isFinite(r)?Number(r.toFixed(2)):null});return o?(0,De.jsxs)("div",{className:"rounded-lg border border-violet-700/40 bg-violet-950/20 p-3 mb-3",children:[(0,De.jsx)("div",{className:"text-sm font-medium text-violet-200 mb-2",children:"Organizer reference values"}),(0,De.jsx)("div",{className:"overflow-auto",children:(0,De.jsxs)("table",{className:"min-w-[560px] w-full text-sm",children:[(0,De.jsx)("thead",{children:(0,De.jsxs)("tr",{children:[(0,De.jsx)("th",{className:"px-2 py-1 text-left text-slate-300",children:"Checkpoint"}),Array.from({length:t},(e,t)=>(0,De.jsxs)("th",{className:"px-2 py-1 text-center text-slate-300",children:["P",t+1]},`h:${t}`))]})}),(0,De.jsxs)("tbody",{children:[(0,De.jsxs)("tr",{children:[(0,De.jsx)("td",{className:"px-2 py-1 text-slate-300",children:"Temp (\xb0C)"}),Array.from({length:t},(e,t)=>{var n;return(0,De.jsx)("td",{className:"px-2 py-1",children:(0,De.jsx)("input",{type:"number",step:"0.01",value:null!==(n=l[t])&&void 0!==n?n:"",onChange:e=>c(n=>{const r=[...n];return r[t]=e.target.value,r}),className:"w-24 px-2 py-1 rounded bg-slate-800 border border-slate-700 text-slate-100 text-sm outline-none focus:border-violet-400"})},`t:${t}`)})]}),(0,De.jsxs)("tr",{children:[(0,De.jsx)("td",{className:"px-2 py-1 text-slate-300",children:"Humidity (%)"}),Array.from({length:t},(e,t)=>{var n;return(0,De.jsx)("td",{className:"px-2 py-1",children:(0,De.jsx)("input",{type:"number",step:"0.01",value:null!==(n=u[t])&&void 0!==n?n:"",onChange:e=>d(n=>{const r=[...n];return r[t]=e.target.value,r}),className:"w-24 px-2 py-1 rounded bg-slate-800 border border-slate-700 text-slate-100 text-sm outline-none focus:border-violet-400"})},`h2:${t}`)})]})]})]})}),(0,De.jsxs)("div",{className:"mt-3 flex items-center gap-2",children:[(0,De.jsx)("button",{className:"px-3 py-1 rounded border border-violet-400/60 text-violet-200 hover:bg-violet-500/10 text-[12px]",onClick:()=>{c(Array.from({length:t},()=>"")),d(Array.from({length:t},()=>""))},children:"Clear"}),(0,De.jsx)("button",{className:"px-3 py-1 rounded border border-emerald-400/60 text-emerald-200 hover:bg-emerald-500/10 text-[12px]",onClick:()=>{s(h(l),h(u)),a(!1)},children:"Save refs"}),(0,De.jsx)("button",{className:"px-3 py-1 rounded border border-slate-600 text-slate-200 hover:bg-slate-800/60 text-[12px]",onClick:()=>a(!1),children:"Close"})]})]}):(0,De.jsx)("button",{className:"text-[11px] px-2 py-1 rounded border border-violet-400/60 text-violet-200 hover:bg-violet-500/10",onClick:()=>a(!0),children:"Set refs (organizer)"})}const OC=(0,i.memo)(function(e){let{title:t="Score & Justification",weightPct:n,valueFromStore:r,noteFromStore:s,onChangeValue:o,onChangeNote:a,onSave:l,saved:c}=e;const[u,d]=(0,i.useState)(0===r||"0"===r?"0":String(null!==r&&void 0!==r?r:"")),[h,f]=(0,i.useState)(kC(s));(0,i.useEffect)(()=>{const e=0===r||"0"===r?"0":String(null!==r&&void 0!==r?r:"");u!==e&&d(e)},[r]),(0,i.useEffect)(()=>{const e=kC(s);h!==e&&f(e)},[s]);const p=function(e){const t=(0,i.useRef)(null);return(0,i.useEffect)(()=>{const e=t.current;e&&(e.style.height="auto",e.style.height=`${e.scrollHeight}px`)},[e]),t}(h),m="px-3 py-2 bg-slate-800/80 border border-slate-700 rounded-md text-white focus:outline-none focus:border-indigo-400 transition-shadow focus:shadow-[0_0_0_2px_rgba(99,102,241,.25)]";return(0,De.jsxs)("div",{className:"rounded-lg border border-slate-700/70 bg-slate-800/40 p-3",children:[(0,De.jsxs)("div",{className:"flex items-end justify-between gap-3 flex-wrap",children:[(0,De.jsxs)("div",{className:"min-w-0",children:[(0,De.jsx)("div",{className:"text-[12px] uppercase tracking-wide text-slate-400",children:"Field"}),(0,De.jsxs)("div",{className:"flex items-center gap-2",children:[(0,De.jsx)("span",{className:"text-slate-200 font-medium truncate",children:t}),Number(n)>0&&(0,De.jsxs)("span",{className:"text-[11px] text-slate-400",children:["(",Number(n),"%)"]})]})]}),(0,De.jsxs)("div",{className:"flex items-end gap-3",children:[(0,De.jsxs)("div",{className:"w-[112px]",children:[(0,De.jsx)("div",{className:"text-[11px] text-slate-400 mb-1",children:"Grade"}),(0,De.jsx)("input",{type:"text",inputMode:"decimal",className:CC(m,"text-right w-full"),value:u,placeholder:"0\u201310",onChange:e=>{d(e.target.value),null===o||void 0===o||o(e.target.value)},onKeyDown:e=>{"Enter"===e.key&&(e.metaKey||e.ctrlKey)&&(null===l||void 0===l||l()),e.stopPropagation()}})]}),(0,De.jsx)("div",{children:(0,De.jsx)(PC,{saved:c,onClick:l})})]})]}),(0,De.jsxs)("div",{className:"mt-3",children:[(0,De.jsx)("div",{className:"text-[11px] text-slate-400 mb-1",children:"Justification"}),(0,De.jsx)("textarea",{ref:p,rows:3,className:CC(m,"leading-6 resize-none min-h-[88px] w-full"),value:h,placeholder:"Justification \u2014 de ce ai acordat nota\u2026",onChange:e=>{f(e.target.value),null===a||void 0===a||a(e.target.value)},onKeyDown:e=>{"Enter"===e.key&&(e.metaKey||e.ctrlKey)&&(e.preventDefault(),null===l||void 0===l||l()),e.stopPropagation()}})]})]})});function jC(e){let{scan:t,onReopen:n}=e;const[r,s]=(0,i.useState)(Date.now());if((0,i.useEffect)(()=>{const e=setInterval(()=>s(Date.now()),1e3);return()=>clearInterval(e)},[]),!t)return null;const o=Number(t.createdAtMs||0),a=Math.max(0,Math.ceil((o+6e4-r)/1e3));return a>0&&!0!==t.locked?(0,De.jsxs)("div",{className:"flex items-center gap-1",children:[(0,De.jsx)("span",{className:"text-[11px] px-2 py-0.5 rounded border border-emerald-400 text-emerald-300",children:"Unlocked"}),(0,De.jsxs)("span",{className:"text-[11px] px-2 py-0.5 rounded border border-indigo-400 text-indigo-300",children:["\u23f3 ",a,"s"]})]}):(0,De.jsxs)("div",{className:"flex items-center gap-1",children:[(0,De.jsx)("span",{className:"text-[11px] px-2 py-0.5 rounded border border-amber-400 text-amber-300",children:"Locked"}),(0,De.jsx)("button",{onClick:n,className:"text-[11px] px-2 py-0.5 rounded border border-indigo-400 text-indigo-300",children:"Re-open 60s"})]})}function LC(){const e=ee();!function(){try{"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual")}catch{}}();const[t,n]=(0,i.useState)({}),[r,s]=(0,i.useState)([]),[o,a]=(0,i.useState)([]),[l,c]=(0,i.useState)(20),[u,d]=(0,i.useState)([]),[h,f]=(0,i.useState)([]),[p,m]=(0,i.useState)({}),[g,v]=(0,i.useState)([]),[y,b]=(0,i.useState)([]),[_,w]=(0,i.useState)({}),[x,S]=(0,i.useState)({}),[k,T]=(0,i.useState)("Professor"),[E,C]=(0,i.useState)({}),[N,I]=(0,i.useState)({}),P=(0,i.useMemo)(()=>Object.keys(E).length>0||Object.keys(N).length>0,[E,N]),[A,R]=(0,i.useState)([]),[D,O]=(0,i.useState)(!1),[j,L]=(0,i.useState)(!1),[M,F]=(0,i.useState)(!1),[U,V]=NC("pp:tab","dashboard"),[z,$]=NC("pp:teamId",""),[q,B]=NC("pp:teamTab","topics"),[H,W]=NC("pp:selectedRound","");(0,i.useEffect)(()=>{const e=bT(pT(CT,"readings"),e=>n(e.val()||{}));return()=>e()},[]),(0,i.useEffect)(()=>{const e=t_(By(ET,"teams"),e=>{s(e.docs.map(e=>{const t=e.data()||{};return{id:e.id,name:t.name||e.id,scores:t.scores||{},scoresNotes:t.scoresNotes||{},scoresMeta:t.scoresMeta||{}}}))}),t=t_(Hy(ET,"probes",wC),e=>{const t=e.data()||{},n=Number(t.weight);Number.isFinite(n)&&c(n),d(function(e){const t=new Set;return(Array.isArray(e)?e:[]).map(e=>{if(!e)return null;if("string"===typeof e)return{key:EC(e),label:e};const t=(e.label||e.name||e.title||e.key||"").trim(),n=EC(e.key||t),r=Number(e.weight);if(!t||!n)return null;const i={key:n,label:t};return Number.isFinite(r)&&(i.weight=r),i}).filter(e=>e&&!t.has(e.key)&&(t.add(e.key),!0))}(t.columns))});return(async()=>{const e=Vo().currentUser||TT.currentUser;if(e){var t;const n=(await Gb(Hy(ET,"users",e.uid))).data();null!==n&&void 0!==n&&n.firstName&&T(`${n.firstName} ${null!==(t=n.lastName)&&void 0!==t?t:""}`)}})(),()=>{e(),t()}},[]),(0,i.useEffect)(()=>{(async()=>{const[e,t,n]=await Promise.all([Yb(By(ET,"probes")),Yb(By(ET,"rounds")),Yb(By(ET,"checkpoints"))]),r=[];e.docs.forEach(e=>{var t;const n=e.id;if(n===wC)return;const i=e.data()||{};r.push({id:n,weight:Number(null!==(t=i.weight)&&void 0!==t?t:0)||0,columns:Array.isArray(i.columns)?i.columns:[]})}),r.sort((e,t)=>e.id.localeCompare(t.id)),a(r);const i=t.docs.map(e=>({id:e.id,...e.data()}));f(i.map(e=>e.id));const s={},o={};i.forEach(e=>{var t,n,r;const i=null!==(t=null!==(n=e.totalCheckpoints)&&void 0!==n?n:null===(r=e.checkpoints)||void 0===r?void 0:r.totalCheckpoints)&&void 0!==t?t:0;s[e.id]=Number(i)||0;const a=Number(e.targetTemp),l=Number(e.targetHumidity);o[e.id]={targetTemp:Number.isFinite(a)?a:null,targetHumidity:Number.isFinite(l)?l:null}}),m(s),S(o);const l={};i.forEach(e=>{l[e.id]={temp:Array.isArray(e.refTemps)?e.refTemps.map(e=>Number(e)):[],humidity:Array.isArray(e.refHumidity)?e.refHumidity.map(e=>Number(e)):[]}}),w(l);const c=n.docs.map(e=>({id:e.id,...e.data()}));v(c)})()},[]),(0,i.useEffect)(()=>{const e=Date.now()-432e5,t=Rb(By(ET,"scans"),Ob("createdAtMs",">=",e),function(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=Nb("orderBy",e);return Lb._create(n,t)}("createdAtMs","desc"),function(e){return Ga("limit",e),Mb._create("limit",e,"F")}(5e3)),n=t_(t,e=>{const t=e.docs.map(e=>({id:e.id,...e.data()})),n=new Map;for(const s of t){var r,i;if(!s.teamId||!s.roundId||!s.cpId)continue;const e=xC(s.teamId,s.roundId,s.cpId),t=n.get(e),o=s.id===e||((null===(r=s.timestamp)||void 0===r?void 0:r.seconds)||0)>((null===t||void 0===t||null===(i=t.timestamp)||void 0===i?void 0:i.seconds)||0)||(s.createdAtMs||0)>((null===t||void 0===t?void 0:t.createdAtMs)||0);t&&!o||n.set(e,{...s,id:e})}b([...n.values()])});return()=>n()},[]);const K=(0,i.useMemo)(()=>{const e={};for(const n of g){var t;(null===(t=n.isActive)||void 0===t||t)&&n.roundId&&null!=n.order&&(e[`${n.roundId}:${n.id}`]=Number(n.order))}return e},[g]),G=(0,i.useMemo)(()=>{const e={};for(const n of g){var t;(null===(t=n.isActive)||void 0===t||t)&&(e[n.roundId]||(e[n.roundId]={}),e[n.roundId][Number(n.order)]=n.id)}return e},[g]),Q=(0,i.useCallback)((e,t,n,r)=>{C(i=>{const s=i[e]?{...i[e]}:{};if(r){const e=s[t]&&"object"===typeof s[t]?{...s[t]}:{};e[r]=n,s[t]=e}else s[t]=n;return{...i,[e]:s}})},[]),Y=(0,i.useCallback)((e,t,n,r)=>{I(i=>{const s=i[e]?{...i[e]}:{};if(r){const e=s[t]&&"object"===typeof s[t]?{...s[t]}:{};e[r]=n,s[t]=e}else s[t]=n;return{...i,[e]:s}})},[]),X=(e,t,n)=>{var r,i;const s=e.id,o=null===E||void 0===E||null===(r=E[s])||void 0===r?void 0:r[t],a=null===e||void 0===e||null===(i=e.scores)||void 0===i?void 0:i[t];return n?o&&"object"===typeof o&&void 0!==o[n]?String(o[n]):a&&"object"===typeof a&&void 0!==a[n]?String(a[n]):"":void 0!==o&&"object"!==typeof o?String(o):a&&"object"!==typeof a&&void 0!==a?String(a):""},J=(e,t,n)=>{var r,i;const s=e.id,o=null===N||void 0===N||null===(r=N[s])||void 0===r?void 0:r[t],a=null===e||void 0===e||null===(i=e.scoresNotes)||void 0===i?void 0:i[t];return n?o&&"object"===typeof o&&void 0!==o[n]?String(o[n]):null!==a&&void 0!==a&&a.cols&&void 0!==a.cols[n]?String(a.cols[n]):"":void 0!==o&&"object"!==typeof o?String(o):void 0!==(null===a||void 0===a?void 0:a.text)?String(a.text):""},Z=(e,t)=>{var n,r;const i=e.id,s=null===E||void 0===E||null===(n=E[i])||void 0===n?void 0:n[t.id],o=null===(r=e.scores)||void 0===r?void 0:r[t.id];return Array.isArray(t.columns)&&t.columns.length>0?((e,t,n)=>{const r=e.some(e=>Number(e.weight)>0);if(!r){const r=e.map(e=>{var r;const i=null!==(r=null===t||void 0===t?void 0:t[e.key])&&void 0!==r?r:null===n||void 0===n?void 0:n[e.key];return SC(i)});return r.length?r.reduce((e,t)=>e+t,0)/r.length:0}const i=e.reduce((e,t)=>e+(Number(t.weight)||0),0)||1,s=e.reduce((e,r)=>{var s;const o=null!==(s=null===t||void 0===t?void 0:t[r.key])&&void 0!==s?s:null===n||void 0===n?void 0:n[r.key],a=(Number(r.weight)||0)/i;return e+SC(o)*a},0);return s})(t.columns,s,o):SC(void 0!==s&&"object"!==typeof s?s:o)},te=(0,i.useMemo)(()=>{const e=o.reduce((e,t)=>e+Number(t.weight||0),0);return{totalManual:e,totalW:(Number(l)||0)+e}},[o,l]),ne=(0,i.useCallback)(e=>{const t={};for(const s of h){var n;const o=Number(null!==(n=p[s])&&void 0!==n?n:0)||0,a=y.filter(t=>t.teamId===e&&t.roundId===s),l=new Set,c=new Map;for(const e of a){const t=K[`${s}:${e.cpId}`];if(Number.isFinite(t)){var r,i;l.add(t);const n=c.get(t);(!n||((null===(r=e.timestamp)||void 0===r?void 0:r.seconds)||0)>((null===n||void 0===n||null===(i=n.timestamp)||void 0===i?void 0:i.seconds)||0))&&c.set(t,e)}}const u=Array.from(l).filter(e=>e>=1&&e<=o).length,d=o?u/o:0;t[s]={total:o,hitsCount:u,progress:d,reachedOrders:l,scanByOrder:c}}return t},[h,p,y,K]),re=(0,i.useMemo)(()=>{const e={};for(const l of h){var t,n,i,s,o;const c=Number(null!==(t=p[l])&&void 0!==t?t:0)||0,u=(null===x||void 0===x?void 0:x[l])||{},d=(null===_||void 0===_||null===(n=_[l])||void 0===n?void 0:n.temp)||[],h=(null===_||void 0===_||null===(i=_[l])||void 0===i?void 0:i.humidity)||[];let f=1/0,m=-1/0;const g={};for(const e of r){const t=e.id,n=y.filter(e=>e.teamId===t&&e.roundId===l),r=new Set,i=Array.from({length:c},()=>null),s=Array.from({length:c},()=>null),o=Array.from({length:c},()=>null);let p=0;for(const e of n){var a;const t=K[`${l}:${e.cpId}`];if(!Number.isFinite(t))continue;r.add(t);const n=t-1,c=Number.isFinite(Number(e.temp))?Number(e.temp):null,u=Number.isFinite(Number(e.humidity))?Number(e.humidity):null;null!=c&&(i[n]=c),null!=u&&(s[n]=u);const d=e.createdAtMs||1e3*((null===(a=e.timestamp)||void 0===a?void 0:a.seconds)||0);d&&(!o[n]||d<o[n])&&(o[n]=d),d>p&&(p=d)}const v=c>0&&Array.from({length:c},(e,t)=>t+1).every(e=>r.has(e)),b=i.filter(e=>Number.isFinite(e)),_=s.filter(e=>Number.isFinite(e)),w=b.length?b.reduce((e,t)=>e+t,0)/b.length:null,x=_.length?_.reduce((e,t)=>e+t,0)/_.length:null;let S=0,k=0,T=0,E=0;for(let e=0;e<c;e++){const t=d[e],n=h[e],r=i[e],o=s[e];Number.isFinite(t)&&Number.isFinite(r)&&(S+=Math.abs(r-t),k+=1),Number.isFinite(n)&&Number.isFinite(o)&&(T+=Math.abs(o-n),E+=1)}let C=null,N=null;k>0?C=S/k:null!=w&&null!=(null===u||void 0===u?void 0:u.targetTemp)&&(C=Math.abs(w-Number(u.targetTemp)),k=1),E>0?N=T/E:null!=x&&null!=(null===u||void 0===u?void 0:u.targetHumidity)&&(N=Math.abs(x-Number(u.targetHumidity)),E=1),g[t]={finished:v,finishTimeMs:v?p:null,timesMs:o,avgTemp:w,avgHum:x,maeTemp:C,maeTempN:k,maeHum:N,maeHumN:E},v&&(p<f&&(f=p),p>m&&(m=p))}e[l]={total:c,targetTemp:null!==(s=null===u||void 0===u?void 0:u.targetTemp)&&void 0!==s?s:null,targetHumidity:null!==(o=null===u||void 0===u?void 0:u.targetHumidity)&&void 0!==o?o:null,byTeam:g,minFinish:Number.isFinite(f)?f:null,maxFinish:Number.isFinite(m)?m:null}}return e},[h,p,x,_,y,r,K]),ie=(e,t)=>`MP:${e}:${t}`;function se(e,t){const n=r.find(e=>e.id===t);if(!n)return 0;const i=u||[];if(!i.length)return 0;const s=i.some(e=>Number(e.weight)>0);if(!s){let t=0;for(const r of i){const i=X(n,ie(e,r.key));let s=parseFloat(String(null!==i&&void 0!==i?i:"").replace(",","."));Number.isNaN(s)&&(s=0),s=Math.max(0,Math.min(10,s)),t+=s}return t/i.length}const o=i.reduce((e,t)=>e+(Number(t.weight)||0),0)||1;return i.reduce((t,r)=>{const i=X(n,ie(e,r.key));let s=parseFloat(String(null!==i&&void 0!==i?i:"").replace(",","."));return Number.isNaN(s)&&(s=0),s=Math.max(0,Math.min(10,s)),t+s*((Number(r.weight)||0)/o)},0)}const oe=(e,t)=>{const n=function(e){if(!(u||[]).length)return 0;const t=h.map(t=>{const n=se(t,e);return Number.isFinite(n)?n:0});return t.length?t.reduce((e,t)=>e+t,0)/t.length:0}(e.id),r=o.map((t,n)=>{const r=Z(e,t);return{index:n+1,probe:t.id,weight:Number(t.weight||0),score:isFinite(r)?r:0,columns:Array.isArray(t.columns)?t.columns:[],weighted:(isFinite(r)?r:0)*(Number(t.weight||0)/100)}}),i=r.reduce((e,t)=>e+t.weighted,0),s=n*Number(l)/100;return 100!==te.totalW?{avgMission:n,rows:r,manualSubtotal:i,mpWeighted:s,final:null}:{avgMission:n,rows:r,manualSubtotal:i,mpWeighted:s,final:i+s}},ae=(0,i.useMemo)(()=>{const e=r.map(e=>{ne(e.id);const t=oe(e),n=null==t.final?0:Number(t.final);return{teamId:e.id,name:e.name||e.id,final:n}});e.sort((e,t)=>t.final-e.final);let t=null,n=0;return e.map((e,r)=>(null!==t&&e.final===t||(n=r+1,t=e.final),{...e,rank:n}))},[r,ne,l,o,te.totalW]),le=(0,i.useMemo)(()=>{const e=new Map(ae.map(e=>[e.teamId,e]));return r.map(t=>{var n,r,i,s;const o=ne(t.id),a=oe(t),l=Object.values(o).reduce((e,t)=>(e.hits+=t.hitsCount||0,e.total+=t.total||0,e),{hits:0,total:0}),c=l.total?l.hits/l.total:0;return{id:t.id,name:t.name||t.id,rank:null!==(n=null===(r=e.get(t.id))||void 0===r?void 0:r.rank)&&void 0!==n?n:"-",final:null!==(i=null===(s=e.get(t.id))||void 0===s?void 0:s.final)&&void 0!==i?i:0,manualSubtotal:a.manualSubtotal,avgMission:a.avgMission,mpProgress:c,totalsAcrossRounds:l}})},[r,ae,ne]),ce=e=>{if(null==e)return"";const t=String(e);return/[",\n]/.test(t)?`"${t.replace(/"/g,'""')}"`:t},ue=(0,i.useCallback)(()=>{const e=[["Export","Live grades (summary)"],["Generated at",(new Date).toISOString()],["Weights",`MP ${l}%`,`Topics ${te.totalManual}%`,"Total",`${l+te.totalManual}%`],["Note","Values are live (include unsaved edits). MP total is mean of per-round scores (zeros included)."],[]],t=["Rank","Team","Final","Topics subtotal","MP avg (prof, per-round mean)","MP weighted","MP weight (%)",...o.map(e=>`${e.id} (topic)`),...h.map(e=>`MP round ${e} (prof)`)],n=new Map(ae.map(e=>[e.teamId,e])),i=[...r].sort((e,t)=>{var r,i,s,o;return(null!==(r=null===(i=n.get(e.id))||void 0===i?void 0:i.rank)&&void 0!==r?r:9999)-(null!==(s=null===(o=n.get(t.id))||void 0===o?void 0:o.rank)&&void 0!==s?s:9999)}),s=[];for(const r of i){var a,c;ne(r.id);const e=oe(r),t=[null!==(a=null===(c=n.get(r.id))||void 0===c?void 0:c.rank)&&void 0!==a?a:"",r.name||r.id,null==e.final?"":e.final.toFixed(2),e.manualSubtotal.toFixed(2),e.avgMission.toFixed(2),e.mpWeighted.toFixed(2),l],i=o.map(e=>{const t=Z(r,e);return Number.isFinite(t)?t.toFixed(2):"0.00"}),u=h.map(e=>(se(e,r.id)||0).toFixed(2));s.push([...t,...i,...u])}const u=[...e,t,...s].map(e=>e.length?e.map(ce).join(","):"").join("\n"),d=new Blob([u],{type:"text/csv;charset=utf-8;"}),f=URL.createObjectURL(d),p=document.createElement("a"),m=(new Date).toISOString().slice(0,19).replace(/[:T]/g,"-");p.href=f,p.download=`live-grades-${m}.csv`,document.body.appendChild(p),p.click(),document.body.removeChild(p),URL.revokeObjectURL(f),uC.success("Live grades CSV salvat")},[r,h,o,l,te.totalManual,ae,ne,oe]),de=(0,i.useCallback)(()=>{const e=ae.map(e=>[e.rank,e.name,e.final.toFixed(2)]),t=[["Rank","Team","FinalGrade"],...e].map(e=>e.map(ce).join(",")).join("\n"),n=new Blob([t],{type:"text/csv;charset=utf-8;"}),r=URL.createObjectURL(n),i=document.createElement("a"),s=(new Date).toISOString().slice(0,19).replace(/[:T]/g,"-");i.href=r,i.download=`ranking-${s}.csv`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(r),uC.success("Ranking exportat ca CSV")},[ae]),he=(0,i.useCallback)(()=>{const e=[["Export","Full \u2013 vertical (profesional)"],["Generat la",(new Date).toISOString()],["Ponderi",`MP ${l}%`,`Probe ${te.totalManual}%`,"Total",`${l+te.totalManual}%`],["Mission Performance","MP total = media aritmetic\u0103 a mediilor pe rund\u0103; rundele f\u0103r\u0103 note conteaz\u0103 cu 0."],[]],t=new Map(ae.map(e=>[e.teamId,{rank:e.rank,final:e.final}])),n=[...r].sort((e,n)=>{var r,i,s,o;return(null!==(r=null===(i=t.get(e.id))||void 0===i?void 0:i.rank)&&void 0!==r?r:9999)-(null!==(s=null===(o=t.get(n.id))||void 0===o?void 0:o.rank)&&void 0!==s?s:9999)}),i=[];for(const r of n){var s,a;const e=r.name||r.id,n=ne(r.id),p=oe(r),m=t.get(r.id)||{rank:"",final:0};for(const t of o){const n=Array.isArray(t.columns)?t.columns:[];if(n.length>0){var c;for(const a of n){var u;const n=SC(X(r,t.id,a.key)),s=J(r,t.id,a.key);i.push([m.rank,e,"Probe",t.id,a.label,t.weight,n.toFixed(2),s,"","",p.manualSubtotal.toFixed(2),p.avgMission.toFixed(2),p.mpWeighted.toFixed(2),(null!==(u=p.final)&&void 0!==u?u:0).toFixed(2)])}const s=Z(r,t),o=s*(Number(t.weight||0)/100);i.push([m.rank,e,"Rezumat prob\u0103",t.id,"AVG",t.weight,s.toFixed(2),"","",o.toFixed(2),p.manualSubtotal.toFixed(2),p.avgMission.toFixed(2),p.mpWeighted.toFixed(2),(null!==(c=p.final)&&void 0!==c?c:0).toFixed(2)])}else{var d;const n=SC(X(r,t.id)),s=J(r,t.id),o=n*(Number(t.weight||0)/100);i.push([m.rank,e,"Probe",t.id,"\u2014",t.weight,n.toFixed(2),s,"",o.toFixed(2),p.manualSubtotal.toFixed(2),p.avgMission.toFixed(2),p.mpWeighted.toFixed(2),(null!==(d=p.final)&&void 0!==d?d:0).toFixed(2)])}}for(const t of h){var f;const s=n[t]||{total:0,hitsCount:0,progress:0},o=se(t,r.id)||0,a=`${s.hitsCount}/${s.total}`;i.push([m.rank,e,"MP rund\u0103 (prof)",t,"\u2014","",o.toFixed(2),"",a,"",p.manualSubtotal.toFixed(2),p.avgMission.toFixed(2),p.mpWeighted.toFixed(2),(null!==(f=p.final)&&void 0!==f?f:0).toFixed(2)])}i.push([m.rank,e,"MP Rezumat","Mission Performance","AVG (prof, per-round mean)",l,p.avgMission.toFixed(2),"","",p.mpWeighted.toFixed(2),p.manualSubtotal.toFixed(2),p.avgMission.toFixed(2),p.mpWeighted.toFixed(2),(null!==(s=m.final)&&void 0!==s?s:0).toFixed(2)]),i.push([m.rank,e,"TOTAL","\u2014","\u2014","","","","","",p.manualSubtotal.toFixed(2),p.avgMission.toFixed(2),p.mpWeighted.toFixed(2),(null!==(a=m.final)&&void 0!==a?a:0).toFixed(2)])}const p=[...e,["Rank","Echip\u0103","Sec\u021biune","Proba / Runda","Criteriu","Pondere (%)","Scor","Not\u0103","Lovituri (Hits/Total)","Ponderat","Subtotal Manual","MP (Medie)","MP (Ponderat)","Final\u0103"],...i].map(e=>e.length?e.map(ce).join(","):"").join("\n"),m=new Blob([p],{type:"text/csv;charset=utf-8;"}),g=URL.createObjectURL(m),v=document.createElement("a"),y=(new Date).toISOString().slice(0,19).replace(/[:T]/g,"-");v.href=g,v.download=`full-export-${y}.csv`,document.body.appendChild(v),v.click(),document.body.removeChild(v),URL.revokeObjectURL(g),uC.success("Full export CSV (profesional) salvat")},[r,o,h,l,te.totalManual,ae,ne]),fe=(0,i.useCallback)(()=>{window.print()},[]),[pe,me]=(0,i.useState)(!1),ge=(0,i.useRef)(null);(0,i.useEffect)(()=>{const e=e=>{ge.current&&!ge.current.contains(e.target)&&me(!1)},t=e=>{"Escape"===e.key&&me(!1)};return document.addEventListener("mousedown",e),window.addEventListener("keydown",t),()=>{document.removeEventListener("mousedown",e),window.removeEventListener("keydown",t)}},[]);const ve=(0,i.useCallback)(async e=>{try{const t=Vo().currentUser||TT.currentUser,n=(null===t||void 0===t?void 0:t.uid)||"unknown";await e_(By(ET,"audits"),{...e,uid:n,at:Date.now()})}catch(NT){console.warn("audit failed",NT)}},[]),ye=(0,i.useCallback)(async(e,t,n)=>{try{const $=r.find(t=>t.id===e),q=Hy(ET,"teams",e);let B,H,W,K,G,Q;if(n){var i,s,o,a,l,c,u,d,h,f,p,m,g,v,y,b,_,w,x,S;B=null!==(i=null!==(s=null===E||void 0===E||null===(o=E[e])||void 0===o||null===(a=o[t])||void 0===a?void 0:a[n])&&void 0!==s?s:null===$||void 0===$||null===(l=$.scores)||void 0===l||null===(c=l[t])||void 0===c?void 0:c[n])&&void 0!==i?i:"",H=null!==(u=null!==(d=null===N||void 0===N||null===(h=N[e])||void 0===h||null===(f=h[t])||void 0===f?void 0:f[n])&&void 0!==d?d:null===$||void 0===$||null===(p=$.scoresNotes)||void 0===p||null===(m=p[t])||void 0===m||null===(g=m.cols)||void 0===g?void 0:g[n])&&void 0!==u?u:"",G=null!==(v=null===$||void 0===$||null===(y=$.scores)||void 0===y||null===(b=y[t])||void 0===b?void 0:b[n])&&void 0!==v?v:"",Q=null!==(_=null===$||void 0===$||null===(w=$.scoresNotes)||void 0===w||null===(x=w[t])||void 0===x||null===(S=x.cols)||void 0===S?void 0:S[n])&&void 0!==_?_:"",W=SC(B),K=kC(H);const r={[`scores.${t}.${n}`]:W,[`scoresNotes.${t}.cols.${n}`]:K,[`scoresMeta.${t}.cols.${n}.lastSavedAt`]:Date.now(),[`scoresMeta.${t}.cols.${n}.hash`]:TC(W,K)};await Jb(q,r),await ve({teamId:e,probeId:t,colKey:n,before:{v:G,n:Q},after:{v:W,n:K}}),C(r=>{const i={...r},s=i[e]?{...i[e]}:{},o=s[t]&&"object"===typeof s[t]?{...s[t]}:{};return void 0!==o[n]&&delete o[n],s[t]=o,i[e]=s,i}),I(r=>{const i={...r},s=i[e]?{...i[e]}:{},o=s[t]&&"object"===typeof s[t]?{...s[t]}:{};return void 0!==o[n]&&delete o[n],s[t]=o,i[e]=s,i})}else{var k,T,P,A,R,D,O,j,L,M,F,U,V,z;B=null!==(k=null!==(T=null===E||void 0===E||null===(P=E[e])||void 0===P?void 0:P[t])&&void 0!==T?T:null===$||void 0===$||null===(A=$.scores)||void 0===A?void 0:A[t])&&void 0!==k?k:"",H=null!==(R=null!==(D=null===N||void 0===N||null===(O=N[e])||void 0===O?void 0:O[t])&&void 0!==D?D:null===$||void 0===$||null===(j=$.scoresNotes)||void 0===j||null===(L=j[t])||void 0===L?void 0:L.text)&&void 0!==R?R:"",G=null!==(M=null===$||void 0===$||null===(F=$.scores)||void 0===F?void 0:F[t])&&void 0!==M?M:"",Q=null!==(U=null===$||void 0===$||null===(V=$.scoresNotes)||void 0===V||null===(z=V[t])||void 0===z?void 0:z.text)&&void 0!==U?U:"",W=SC(B),K=kC(H);const n={[`scores.${t}`]:W,[`scoresNotes.${t}.text`]:K,[`scoresMeta.${t}.lastSavedAt`]:Date.now(),[`scoresMeta.${t}.hash`]:TC(W,K)};await Jb(q,n),await ve({teamId:e,probeId:t,before:{v:G,n:Q},after:{v:W,n:K}}),C(n=>{const r={...n},i=r[e]?{...r[e]}:{};return"object"!==typeof i[t]&&delete i[t],r[e]=i,r}),I(n=>{const r={...n},i=r[e]?{...r[e]}:{};return"object"!==typeof i[t]&&delete i[t],r[e]=i,r})}uC.success("Saved")}catch(NT){console.error("Save failed",NT),uC.error("Save failed")}},[E,N,r,ve]),be=(0,i.useCallback)(async(e,t,n)=>{var r;const i=(e,t)=>Array.from({length:t},(t,n)=>{var r;return null!==(r=e[n])&&void 0!==r?r:null}),s=Number(null!==(r=p[e])&&void 0!==r?r:0)||0,o=i(t,s),a=i(n,s);try{await Xb(Hy(ET,"rounds",e),{refTemps:o,refHumidity:a},{merge:!0}),w(t=>({...t,[e]:{temp:o,humidity:a}})),uC.success(`Refs saved for ${e}`)}catch(NT){console.error(NT),uC.error("Failed to save refs")}},[p]),_e=(0,i.useCallback)(async(e,t,n)=>{try{const r=""===t?null:Number(t),i=""===n?null:Number(n);await Xb(Hy(ET,"rounds",e),{targetTemp:r,targetHumidity:i},{merge:!0}),S(t=>({...t,[e]:{targetTemp:r,targetHumidity:i}})),uC.success("Targets saved")}catch(NT){console.error(NT),uC.error("Saving targets failed")}},[]);return(0,De.jsxs)("div",{className:"min-h-screen bg-slate-950 text-white",children:[(0,De.jsx)(_C,{position:"top-center",autoClose:1100}),(0,De.jsx)("header",{className:"sticky top-0 z-30 backdrop-blur border-b border-slate-800 bg-slate-900/70",children:(0,De.jsxs)("div",{className:"max-w-[1400px] mx-auto px-4 sm:px-6 py-3 flex items-center gap-3",children:[(0,De.jsxs)("h1",{className:"text-lg sm:text-xl font-semibold tracking-tight shrink-0",children:["Hello, ",(0,De.jsx)("span",{className:"text-indigo-300",children:k})]}),(0,De.jsx)("nav",{className:"ml-4 inline-flex rounded-lg border border-slate-700 overflow-hidden",children:["dashboard","teams","team","Performance Benchmarks"].map(e=>(0,De.jsx)("button",{className:CC("px-3 py-1.5 text-sm capitalize",U===e?"bg-slate-800 text-white":"text-slate-300 hover:bg-slate-800/60"),onClick:()=>V(e),children:e},e))}),(0,De.jsxs)("div",{className:"ml-auto flex items-center gap-2",children:[P?(0,De.jsx)("span",{className:"text-xs text-amber-300",children:"Unsaved changes"}):null,(0,De.jsx)("button",{onClick:()=>e("/manage-probes"),className:"text-[12px] px-3 py-1 rounded-md border border-slate-600 text-slate-200 hover:bg-slate-800/60",children:"Manage Topics"}),(0,De.jsxs)("div",{ref:ge,className:"relative",children:[(0,De.jsxs)("button",{onClick:()=>me(e=>!e),className:"text-[12px] px-3 py-1 rounded-md border border-sky-400/50 text-sky-200 hover:bg-sky-500/10","aria-haspopup":"menu","aria-expanded":pe?"true":"false",title:"Export options",children:["Export",(0,De.jsx)("svg",{className:"inline ml-1 w-3 h-3 opacity-80",viewBox:"0 0 20 20",fill:"currentColor",children:(0,De.jsx)("path",{d:"M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.94a.75.75 0 111.08 1.04l-4.24 4.5a.75.75 0 01-1.08 0l-4.24-4.5a.75.75 0 01.02-1.06z"})})]}),pe&&(0,De.jsxs)("div",{role:"menu",className:"absolute right-0 mt-1 w-64 rounded-md border border-slate-700 bg-slate-900/95 shadow-2xl z-40 overflow-hidden",children:[(0,De.jsxs)("button",{role:"menuitem",onClick:()=>{ue(),me(!1)},className:"w-full text-left px-3 py-2 text-sm hover:bg-slate-800",children:["Live grades (CSV) ",(0,De.jsx)("span",{className:"text-[11px] text-slate-400",children:"\u2014 recomandat"})]}),(0,De.jsx)("div",{className:"h-px bg-slate-800"}),(0,De.jsx)("button",{role:"menuitem",onClick:()=>{de(),me(!1)},className:"w-full text-left px-3 py-2 text-sm hover:bg-slate-800",children:"Ranking (CSV)"}),(0,De.jsx)("button",{role:"menuitem",onClick:()=>{he(),me(!1)},className:"w-full text-left px-3 py-2 text-sm hover:bg-slate-800",children:"Detailed (legacy) CSV"}),(0,De.jsx)("div",{className:"h-px bg-slate-800"}),(0,De.jsx)("button",{role:"menuitem",onClick:()=>{fe(),me(!1)},className:"w-full text-left px-3 py-2 text-sm hover:bg-slate-800",children:"Print / PDF"})]})]}),(0,De.jsx)("button",{onClick:()=>{Vo().signOut().then(()=>window.location.href="/")},className:"bg-rose-600 hover:bg-rose-500 px-3 py-1.5 rounded-md text-sm",children:"Logout"})]})]})}),(0,De.jsxs)("main",{className:"max-w-[1400px] mx-auto px-4 sm:px-6 py-6",children:["dashboard"===U&&(0,De.jsx)(VC,{ranking:ae,totals:te,missionWeight:l,teamsSummary:le,onOpenHeatmap:()=>L(!0),onOpenCompare:()=>O(!0),selectedTeamIds:A,setSelectedTeamIds:R,onOpenTeam:e=>{$(e),V("team")}}),"teams"===U&&(0,De.jsx)(zC,{teamsSummary:le,selectedTeamIds:A,setSelectedTeamIds:R,onOpenTeam:e=>{$(e),V("team")},onOpenCompare:()=>O(!0),onOpenHeatmap:()=>L(!0)}),"team"===U&&(0,De.jsx)($C,{teamTab:q,setTeamTab:B,detailTeamId:z,setDetailTeamId:$,rounds:h,selectedRoundId:H,setSelectedRoundId:W,teams:r,manualProbes:o,missionWeight:l,buildRoundsUiForTeam:ne,finalGradeForTeam:oe,mpColumns:u,roundConfigs:p,sensorData:t,roundRefs:_,saveRoundRefs:be,roundTargets:x,saveRoundTargets:_e,getInput:X,getNote:J,setEditedVal:Q,setEditedNote:Y,saveField:ye,unlock60s:async(e,t,n)=>{var r,i,s;const o=null!==(r=null===G||void 0===G||null===(i=G[t])||void 0===i?void 0:i[n])&&void 0!==r?r:null===(s=g.find(e=>{var r;return(null===(r=e.isActive)||void 0===r||r)&&e.roundId===t&&Number(e.order)===Number(n)}))||void 0===s?void 0:s.id;if(!o)return void alert(`Nu g\u0103sesc checkpoint activ pentru ${t} P${n}.`);const a=xC(e,t,o),l=Date.now();await Xb(Hy(ET,"scans",a),{teamId:e,roundId:t,cpId:o,locked:!1,createdAtMs:l,updatedAtMs:l,timestamp:new Date},{merge:!0})},mpKeyFn:(e,t)=>`MP:${e}:${t}`}),"Performance Benchmarks"===U&&(0,De.jsx)(qC,{rounds:h,teams:r,roundMetrics:re,buildSpeedTop:MC,buildTempTop:FC,buildHumTop:UC})]}),j&&(0,De.jsx)(BC,{teams:r,manualProbes:o,liveScore:(e,t)=>{var n,r;const i=e.id,s=null===E||void 0===E||null===(n=E[i])||void 0===n?void 0:n[t.id],o=null===(r=e.scores)||void 0===r?void 0:r[t.id];if(Array.isArray(t.columns)&&t.columns.length>0){const e=t.columns.some(e=>Number(e.weight)>0);if(!e){const e=t.columns.map(e=>{var t;const n=null!==(t=null===s||void 0===s?void 0:s[e.key])&&void 0!==t?t:null===o||void 0===o?void 0:o[e.key];let r=parseFloat(String(null!==n&&void 0!==n?n:"").replace(",","."));return Number.isNaN(r)&&(r=0),Math.max(0,Math.min(10,r))});return e.length?e.reduce((e,t)=>e+t,0)/e.length:0}const n=t.columns.reduce((e,t)=>e+(Number(t.weight)||0),0)||1;return t.columns.reduce((e,t)=>{var r;const i=null!==(r=null===s||void 0===s?void 0:s[t.key])&&void 0!==r?r:null===o||void 0===o?void 0:o[t.key];let a=parseFloat(String(null!==i&&void 0!==i?i:"").replace(",","."));return Number.isNaN(a)&&(a=0),a=Math.max(0,Math.min(10,a)),e+a*((Number(t.weight)||0)/n)},0)}{var a,l;const e=null!==(a=null===E||void 0===E||null===(l=E[i])||void 0===l?void 0:l[t.id])&&void 0!==a?a:o;let n=parseFloat(String(null!==e&&void 0!==e?e:"").replace(",","."));return Number.isNaN(n)&&(n=0),Math.max(0,Math.min(10,n))}},onClose:()=>L(!1)}),D&&(0,De.jsx)(HC,{teams:r,selectedTeamIds:A,manualProbes:o,finalGradeForTeam:oe,buildRoundsUiForTeam:ne,onClose:()=>O(!1),onClear:()=>{R([]),O(!1)}}),M&&(0,De.jsx)(WC,{onClose:()=>F(!1),rounds:h,teams:r,roundMetrics:re,buildSpeedTop:MC,buildTempTop:FC,buildHumTop:UC})]})}function MC(e,t,n){const r=new Map;for(const s of e){const e=t[s];if(!e)continue;const i=n.map(t=>{var n,r,i;return{team:t,ft:null!==(n=null===(r=e.byTeam)||void 0===r||null===(i=r[t.id])||void 0===i?void 0:i.finishTimeMs)&&void 0!==n?n:null}}).filter(e=>null!=e.ft).sort((e,t)=>e.ft-t.ft);i.forEach((e,t)=>{const n=r.get(e.team.id)||{wins:0,ranksSum:0,ranksCnt:0,finishedCount:0,name:e.team.name||e.team.id};n.ranksSum+=t+1,n.ranksCnt+=1,n.finishedCount+=1,0===t&&(n.wins+=1),r.set(e.team.id,n)})}const i=[...n].map(e=>{const t=r.get(e.id)||{wins:0,ranksSum:0,ranksCnt:0,finishedCount:0,name:e.name||e.id};return{teamId:e.id,name:t.name,wins:t.wins,avgRank:t.ranksCnt?t.ranksSum/t.ranksCnt:1/0,finishedCount:t.finishedCount}});return i.sort((e,t)=>t.wins!==e.wins?t.wins-e.wins:e.avgRank!==t.avgRank?e.avgRank-t.avgRank:t.finishedCount-e.finishedCount),i}function FC(e,t,n){const r=[];for(const s of n){let n=0,o=0;for(const r of e){var i;const e=t[r],a=null===e||void 0===e||null===(i=e.byTeam)||void 0===i?void 0:i[s.id];a&&(Number.isFinite(a.maeTemp)&&Number(a.maeTempN)>0&&(n+=a.maeTemp*a.maeTempN,o+=a.maeTempN))}r.push({teamId:s.id,name:s.name||s.id,maeTemp:o?n/o:1/0,samples:o})}return r.sort((e,t)=>e.maeTemp-t.maeTemp),r}function UC(e,t,n){const r=[];for(const s of n){let n=0,o=0;for(const r of e){var i;const e=t[r],a=null===e||void 0===e||null===(i=e.byTeam)||void 0===i?void 0:i[s.id];a&&(Number.isFinite(a.maeHum)&&Number(a.maeHumN)>0&&(n+=a.maeHum*a.maeHumN,o+=a.maeHumN))}r.push({teamId:s.id,name:s.name||s.id,maeHum:o?n/o:1/0,samples:o})}return r.sort((e,t)=>e.maeHum-t.maeHum),r}function VC(e){let{ranking:t,totals:n,missionWeight:r,teamsSummary:i,onOpenHeatmap:s,onOpenCompare:o,selectedTeamIds:a,setSelectedTeamIds:l,onOpenTeam:c}=e;return(0,De.jsxs)("div",{className:"grid gap-6 lg:grid-cols-[1.1fr_0.9fr]",children:[(0,De.jsxs)("section",{className:"rounded-2xl border border-slate-800 bg-slate-900/60 shadow-xl overflow-hidden",children:[(0,De.jsxs)("div",{className:"px-5 py-3 flex items-center justify-between border-b border-slate-800 bg-slate-900/80",children:[(0,De.jsxs)("div",{children:[(0,De.jsx)("h2",{className:"text-lg font-semibold",children:"Overall ranking"}),(0,De.jsxs)("p",{className:"text-xs text-slate-400",children:["Weights: ",(0,De.jsxs)("span",{className:"text-slate-200",children:[r,"%"]})," MP +"," ",(0,De.jsxs)("span",{className:"text-slate-200",children:[n.totalManual||0,"%"]})," Topics"]})]}),(0,De.jsxs)("button",{className:"text-[12px] px-3 py-1 rounded-md border border-slate-700 hover:bg-slate-800",onClick:o,disabled:a.length<2,title:"Open compare",children:["Compare (",a.length,")"]})]}),(0,De.jsx)("div",{className:"overflow-x-auto",children:(0,De.jsxs)("table",{className:"w-full text-sm",children:[(0,De.jsx)("thead",{className:"bg-slate-800/90 text-slate-300 text-xs uppercase",children:(0,De.jsxs)("tr",{children:[(0,De.jsx)("th",{className:"w-16 px-4 py-3 text-left",children:"Rank"}),(0,De.jsx)("th",{className:"px-4 py-3 text-left",children:"Team"}),(0,De.jsx)("th",{className:"w-40 px-4 py-3 text-right",children:"Final"}),(0,De.jsx)("th",{className:"w-24 px-4 py-3 text-center",children:"Pick"})]})}),(0,De.jsx)("tbody",{className:"divide-y divide-slate-800 bg-slate-900",children:t.map(e=>{const t=a.includes(e.teamId);return(0,De.jsxs)("tr",{className:"hover:bg-slate-900/60",children:[(0,De.jsx)("td",{className:"px-4 py-3",children:(0,De.jsx)("span",{className:"inline-flex items-center justify-center w-8 h-8 rounded-full bg-slate-800 text-[12px]",children:e.rank})}),(0,De.jsx)("td",{className:"px-4 py-3",children:(0,De.jsx)("button",{className:"text-left hover:underline",onClick:()=>c(e.teamId),title:"Open team",children:e.name})}),(0,De.jsxs)("td",{className:"px-4 py-3 text-right font-semibold text-yellow-300",children:[e.final.toFixed(2)," / 10"]}),(0,De.jsx)("td",{className:"px-4 py-3 text-center",children:(0,De.jsx)("input",{type:"checkbox",checked:t,onChange:()=>l(n=>t?n.filter(t=>t!==e.teamId):[...n,e.teamId])})})]},`rk:${e.teamId}`)})})]})})]}),(0,De.jsxs)("aside",{className:"space-y-4",children:[(0,De.jsxs)("div",{className:"rounded-2xl border border-slate-800 bg-slate-900/70 p-4",children:[(0,De.jsx)("div",{className:"text-sm font-semibold mb-2",children:"Quick actions"}),(0,De.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,De.jsx)("button",{onClick:s,className:"px-3 py-2 rounded-lg border border-emerald-500/40 text-emerald-300 hover:bg-emerald-500/10 text-sm",children:"Open scores grid"}),(0,De.jsxs)("button",{onClick:o,className:"px-3 py-2 rounded-lg border border-indigo-500/40 text-indigo-200 hover:bg-indigo-500/10 text-sm",disabled:a.length<2,children:["Compare (",a.length,")"]})]})]}),(0,De.jsxs)("div",{className:"rounded-2xl border border-slate-800 bg-slate-900/70 p-4",children:[(0,De.jsx)("div",{className:"text-sm font-semibold mb-3",children:"Teams \u2014 progress today"}),(0,De.jsx)("div",{className:"space-y-3 max-h-[52vh] overflow-auto pr-1",children:i.slice().sort((e,t)=>{var n,r;return(null!==(n=e.rank)&&void 0!==n?n:9999)-(null!==(r=t.rank)&&void 0!==r?r:9999)}).map(e=>{const t=Math.min(100,100*(e.mpProgress||0));return(0,De.jsxs)("div",{className:"rounded-lg border border-slate-800 p-3 bg-slate-900/50",children:[(0,De.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,De.jsxs)("div",{className:"min-w-0",children:[(0,De.jsxs)("div",{className:"flex items-center gap-2",children:[(0,De.jsxs)("div",{className:"font-medium truncate",children:["TEAM \u2014 ",e.name]}),(0,De.jsxs)("span",{className:"text-[11px] px-2 py-0.5 rounded-full border border-slate-700 text-slate-300",children:["#",e.rank]})]}),(0,De.jsxs)("div",{className:"text-[11px] text-slate-400",children:["ID: ",e.id]})]}),(0,De.jsx)(IC,{value:Number(e.final)||0})]}),(0,De.jsxs)("div",{className:"mt-2 grid grid-cols-2 gap-2 text-sm",children:[(0,De.jsx)(AC,{label:"Topics subtotal",value:e.manualSubtotal.toFixed(2)}),(0,De.jsx)(AC,{label:"Mission Performance avg",value:e.avgMission.toFixed(2)})]}),(0,De.jsxs)("div",{className:"mt-2",children:[(0,De.jsxs)("div",{className:"flex items-center justify-between text-xs text-slate-400",children:[(0,De.jsx)("span",{children:"Mission progress"}),(0,De.jsxs)("span",{children:[e.totalsAcrossRounds.hits,"/",e.totalsAcrossRounds.total]})]}),(0,De.jsx)("div",{className:"mt-1 h-2 w-full rounded-full bg-slate-800 overflow-hidden",children:(0,De.jsx)("div",{className:"h-full rounded-full bg-gradient-to-r from-emerald-400 to-green-500",style:{width:`${t}%`}})})]}),(0,De.jsx)("div",{className:"mt-2 flex justify-end",children:(0,De.jsx)("button",{className:"text-[12px] px-3 py-1 rounded-md border border-slate-700 hover:bg-slate-800",onClick:()=>c(e.id),children:"Open team"})})]},`tcard:${e.id}`)})})]})]})]})}function zC(e){let{teamsSummary:t,selectedTeamIds:n,setSelectedTeamIds:r,onOpenTeam:s,onOpenCompare:o,onOpenHeatmap:a}=e;const[l,c]=(0,i.useState)(""),u=t.filter(e=>(e.name+" "+e.id).toLowerCase().includes(l.toLowerCase()));return(0,De.jsxs)("div",{className:"space-y-4",children:[(0,De.jsxs)("div",{className:"flex items-center gap-2",children:[(0,De.jsx)("input",{value:l,onChange:e=>c(e.target.value),placeholder:"Filter teams\u2026",className:"w-72 px-3 py-2 rounded-md bg-slate-800 border border-slate-700 outline-none focus:border-sky-400 text-sm"}),(0,De.jsx)("button",{onClick:a,className:"text-[12px] px-3 py-1 rounded-md border border-emerald-400/60 text-emerald-300 hover:bg-emerald-500/10",children:"Heatmap"}),(0,De.jsxs)("button",{onClick:o,disabled:n.length<2,className:CC("text-[12px] px-3 py-1 rounded-md border",n.length<2?"border-slate-700 text-slate-400 cursor-not-allowed":"border-indigo-400/60 text-indigo-200 hover:bg-indigo-500/10"),children:["Compare (",n.length,")"]})]}),(0,De.jsx)("div",{className:"grid gap-4 sm:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4",children:u.slice().sort((e,t)=>{var n,r;return(null!==(n=e.rank)&&void 0!==n?n:9999)-(null!==(r=t.rank)&&void 0!==r?r:9999)}).map(e=>{const t=n.includes(e.id),i=Math.min(100,100*(e.mpProgress||0));return(0,De.jsxs)("article",{role:"button",tabIndex:0,onClick:()=>s(e.id),onKeyDown:t=>{"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),s(e.id))},className:CC("group relative overflow-hidden rounded-xl border border-slate-800/80 bg-slate-950/50 backdrop-blur","hover:shadow-2xl hover:shadow-indigo-500/10 hover:border-slate-700/80 transition cursor-pointer"),title:`Open team ${e.name}`,children:[(0,De.jsx)("div",{className:"pointer-events-none absolute -inset-1 opacity-0 group-hover:opacity-100 transition",style:{background:"radial-gradient(600px 120px at 20% 0%, rgba(99,102,241,.12), transparent 40%), radial-gradient(600px 120px at 80% 100%, rgba(56,189,248,.12), transparent 40%)"}}),(0,De.jsxs)("div",{className:"relative p-4 flex flex-col gap-3",children:[(0,De.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,De.jsxs)("div",{className:"min-w-0",children:[(0,De.jsxs)("div",{className:"flex items-center gap-2",children:[(0,De.jsx)("h3",{className:"font-semibold text-base truncate",children:e.name}),(0,De.jsxs)("span",{className:"text-[11px] px-2 py-0.5 rounded-full border border-slate-700 text-slate-300",children:["#",e.rank]})]}),(0,De.jsxs)("div",{className:"mt-1 text-xs text-slate-400 break-words",children:["ID: ",(0,De.jsx)("span",{className:"font-mono",children:e.id})]})]}),(0,De.jsx)(IC,{value:Number(e.final)||0})]}),(0,De.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[(0,De.jsxs)("div",{className:"rounded-lg border border-slate-800 bg-slate-900/60 p-2",children:[(0,De.jsx)("div",{className:"text-[11px] text-slate-400",children:"Topics subtotal"}),(0,De.jsx)("div",{className:"font-semibold",children:e.manualSubtotal.toFixed(2)})]}),(0,De.jsxs)("div",{className:"rounded-lg border border-slate-800 bg-slate-900/60 p-2",children:[(0,De.jsx)("div",{className:"text-[11px] text-slate-400",children:"MP avg (prof)"}),(0,De.jsx)("div",{className:"font-semibold",children:e.avgMission.toFixed(2)})]})]}),(0,De.jsxs)("div",{className:"mt-1",children:[(0,De.jsxs)("div",{className:"flex items-center justify-between text-xs text-slate-400",children:[(0,De.jsx)("span",{children:"Mission progress"}),(0,De.jsxs)("span",{children:[e.totalsAcrossRounds.hits,"/",e.totalsAcrossRounds.total]})]}),(0,De.jsx)("div",{className:"mt-1 h-2 w-full rounded-full bg-slate-800 overflow-hidden",children:(0,De.jsx)("div",{className:"h-full rounded-full bg-gradient-to-r from-green-400 to-emerald-500 transition-all duration-700",style:{width:`${i}%`}})})]}),(0,De.jsxs)("div",{className:"pt-1 flex justify-between items-center",children:[(0,De.jsxs)("label",{className:"flex items-center gap-2 text-[12px] select-none cursor-pointer",onClick:e=>e.stopPropagation(),children:[(0,De.jsx)("input",{type:"checkbox",checked:t,onClick:e=>e.stopPropagation(),onChange:()=>r(t=>t.includes(e.id)?t.filter(t=>t!==e.id):[...t,e.id])}),"Compare"]}),(0,De.jsx)("div",{className:"space-x-2",children:(0,De.jsx)("button",{onClick:t=>{t.stopPropagation(),s(e.id)},className:"text-[12px] px-3 py-1 rounded-md border border-slate-600 text-slate-200 hover:bg-slate-800/60",children:"Open"})})]})]})]},`card:${e.id}`)})})]})}function $C(e){var t,n;let{teamTab:r,setTeamTab:s,detailTeamId:o,setDetailTeamId:a,rounds:l,selectedRoundId:c,setSelectedRoundId:u,teams:d,manualProbes:h,missionWeight:f,buildRoundsUiForTeam:p,finalGradeForTeam:m,mpColumns:g,roundConfigs:v,sensorData:y,roundRefs:b,saveRoundRefs:_,roundTargets:w,saveRoundTargets:x,getInput:S,getNote:k,setEditedVal:T,setEditedNote:E,saveField:C,unlock60s:N,mpKeyFn:I}=e;const P=d.find(e=>e.id===o)||d[0],A=null===P||void 0===P?void 0:P.id,R=(null===P||void 0===P?void 0:P.name)||A||"\u2014",D=P?p(P.id):{},O=P?m(P,D):{final:0,manualSubtotal:0,avgMission:0,mpWeighted:0,rows:[]},[j,L]=(0,i.useState)((null===(t=h[0])||void 0===t?void 0:t.id)||"");if((0,i.useEffect)(()=>{h.length&&!j&&L(h[0].id)},[h.length]),(0,i.useEffect)(()=>{!c&&l.length&&u(l[0])},[l.length]),!P)return(0,De.jsx)("div",{className:"text-slate-300",children:"No team selected. Pick one from Teams tab."});const M=(e,t,n)=>T(A,e,t,n),F=(e,t,n)=>E(A,e,t,n),U=e=>{const t=g||[];if(!t.length)return 0;const n=t.some(e=>Number(e.weight)>0);if(!n){let n=0;for(const r of t){const t=S(P,I(e,r.key));let i=parseFloat(String(null!==t&&void 0!==t?t:"").replace(",","."));Number.isNaN(i)&&(i=0),i=Math.max(0,Math.min(10,i)),n+=i}return n/t.length}const r=t.reduce((e,t)=>e+(Number(t.weight)||0),0)||1;return t.reduce((t,n)=>{const i=S(P,I(e,n.key));let s=parseFloat(String(null!==i&&void 0!==i?i:"").replace(",","."));return Number.isNaN(s)&&(s=0),s=Math.max(0,Math.min(10,s)),t+s*((Number(n.weight)||0)/r)},0)};return(0,De.jsxs)("div",{className:"space-y-6",children:[(0,De.jsxs)("div",{className:"rounded-2xl border bg-slate-900/60 shadow-xl overflow-hidden border-slate-800 ring-1 ring-inset ring-white/5",children:[(0,De.jsxs)("div",{className:"px-5 py-3 flex items-center justify-between bg-slate-900/80 border-b border-slate-800",children:[(0,De.jsxs)("div",{className:"flex items-center gap-3",children:[(0,De.jsx)("h2",{className:"text-xl font-bold",children:R}),(0,De.jsx)("span",{className:"text-[12px] px-2 py-0.5 rounded-full border border-slate-700 text-slate-300",children:A})]}),(0,De.jsxs)("div",{className:"flex items-center gap-5",children:[(0,De.jsxs)("div",{className:"hidden md:flex text-sm text-slate-400",children:["Weights:\xa0",(0,De.jsxs)("span",{className:"text-slate-200",children:[f,"% Mission Performance"]}),"\xa0+\xa0",(0,De.jsxs)("span",{className:"text-slate-200",children:[h.reduce((e,t)=>e+(t.weight||0),0),"%"]}),"\xa0Topics"]}),(0,De.jsx)(IC,{value:Number(null!==(n=O.final)&&void 0!==n?n:0)})]})]}),(0,De.jsxs)("div",{className:"px-5 py-3 flex items-center gap-2",children:[(0,De.jsx)("label",{className:"text-xs text-slate-400",children:"Team:"}),(0,De.jsx)("select",{value:A,onChange:e=>a(e.target.value),className:"px-2 py-1.5 rounded-md bg-slate-800 border border-slate-700 text-sm outline-none focus:border-sky-400",children:d.map(e=>(0,De.jsx)("option",{value:e.id,children:e.name||e.id},`opt:${e.id}`))}),(0,De.jsx)("nav",{className:"ml-3 inline-flex rounded-lg border border-slate-700 overflow-hidden",children:[{value:"topics",label:"topics"},{value:"mission",label:"Mission Performance"}].map(e=>{let{value:t,label:n}=e;return(0,De.jsx)("button",{className:CC("px-3 py-1.5 text-sm capitalize",r===t?"bg-slate-800 text-white":"text-slate-300 hover:bg-slate-800/60"),onClick:()=>s(t),children:n},t)})}),"mission"===r&&(0,De.jsxs)("div",{className:"ml-auto flex items-center gap-2",children:[(0,De.jsx)("label",{className:"text-xs text-slate-400",children:"Round:"}),(0,De.jsx)("select",{value:c||"",onChange:e=>u(e.target.value),className:"px-2 py-1.5 rounded-md bg-slate-800 border border-slate-700 text-sm outline-none focus:border-sky-400",children:l.map(e=>(0,De.jsx)("option",{value:e,children:e},`r:${e}`))}),(0,De.jsxs)("div",{className:"text-xs text-slate-400",children:["Round Mission Performance score:"," ",(0,De.jsx)("span",{className:"text-slate-100 font-semibold",children:U(c).toFixed(2)})]})]})]})]}),"topics"===r?(0,De.jsxs)("div",{className:"grid gap-6 lg:grid-cols-[260px_minmax(0,1fr)]",children:[(0,De.jsxs)("aside",{className:"rounded-2xl border border-slate-800 bg-slate-900/70 p-4",children:[(0,De.jsx)("div",{className:"text-sm font-semibold mb-2",children:"Topics"}),(0,De.jsx)("div",{className:"space-y-1 max-h-[62vh] overflow-auto pr-1",children:h.map((e,t)=>(0,De.jsx)("button",{className:CC("w-full text-left px-3 py-2 rounded-md border",j===e.id?"border-indigo-400/60 bg-slate-800":"border-slate-700 hover:bg-slate-800/60"),onClick:()=>L(e.id),children:(0,De.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,De.jsxs)("div",{className:"truncate",children:[(0,De.jsx)("span",{className:"text-slate-200 font-medium",children:e.id}),Number(e.weight)?(0,De.jsxs)("span",{className:"ml-2 text-[11px] text-slate-400",children:["(",Number(e.weight),"%)"]}):null]}),(0,De.jsx)("span",{className:"text-[12px] text-slate-300",children:(()=>{const t=P,n=(n=>{const r=null===t||void 0===t||null===(n=t.scores)||void 0===n?void 0:n[e.id];return Array.isArray(e.columns)&&e.columns.length>0?"\u2026":Number.isFinite(Number(r))?Number(r):0})();return"string"===typeof n?n:n.toFixed(2)})()})]})},`tp:${e.id}`))})]}),(0,De.jsxs)("section",{className:"rounded-2xl border border-slate-800 bg-slate-900/60 shadow-xl overflow-hidden",children:[(0,De.jsxs)("div",{className:"px-5 py-3 border-b border-slate-800 bg-slate-900/80 flex items-center justify-between",children:[(0,De.jsxs)("div",{className:"min-w-0",children:[(0,De.jsxs)("h3",{className:"text-lg font-semibold truncate",children:["Topic: ",(0,De.jsx)("span",{className:"text-indigo-300",children:j||"\u2014"})]}),(0,De.jsx)("p",{className:"text-xs text-slate-400",children:"Weighted into final by topic weight."})]}),(0,De.jsxs)("div",{className:"flex items-center gap-5",children:[(0,De.jsx)(AC,{label:"Topic score",value:(()=>{const e=h.find(e=>e.id===j);if(!e)return"0.00";const t=(()=>{if(Array.isArray(e.columns)&&e.columns.length>0){const t=e.columns.map(t=>{const n=S(P,e.id,t.key);let r=parseFloat(String(null!==n&&void 0!==n?n:"").replace(",","."));return Number.isNaN(r)&&(r=0),Math.max(0,Math.min(10,r))});return t.length?t.reduce((e,t)=>e+t,0)/t.length:0}const t=S(P,e.id);let n=parseFloat(String(null!==t&&void 0!==t?t:"").replace(",","."));return Number.isNaN(n)&&(n=0),Math.max(0,Math.min(10,n))})();return Number(t).toFixed(2)})()}),(0,De.jsx)(AC,{label:"Weighted subtotal",value:O.manualSubtotal.toFixed(2)})]})]}),(0,De.jsx)("div",{className:"p-5",children:((e,t)=>{const n=h.find(e=>e.id===j);if(!n)return(0,De.jsx)("div",{className:"text-sm text-slate-400",children:"Pick a topic from the left."});const r=Array.isArray(n.columns)?n.columns:[];return(0,De.jsx)("div",{className:"space-y-4",children:r.length>0?r.map(e=>{var t,r,i,s;const o=S(P,n.id,e.key),a=k(P,n.id,e.key),l=(null===P||void 0===P||null===(t=P.scoresMeta)||void 0===t||null===(r=t[n.id])||void 0===r||null===(i=r.cols)||void 0===i||null===(s=i[e.key])||void 0===s?void 0:s.hash)===JSON.stringify([Number(Number(o||0).toFixed(3)),String(a||"")]);return(0,De.jsx)(OC,{title:e.label,weightPct:e.weight,valueFromStore:o,noteFromStore:a,onChangeValue:t=>M(n.id,t,e.key),onChangeNote:t=>F(n.id,t,e.key),onSave:()=>C(A,n.id,e.key),saved:l},e.key)}):(0,De.jsx)(OC,{title:"Score & Justification",valueFromStore:S(P,n.id),noteFromStore:k(P,n.id),onChangeValue:e=>M(n.id,e),onChangeNote:e=>F(n.id,e),onSave:()=>C(A,n.id),saved:(null===P||void 0===P||null===(e=P.scoresMeta)||void 0===e||null===(t=e[n.id])||void 0===t?void 0:t.hash)===JSON.stringify([Number(Number(S(P,n.id)||0).toFixed(3)),String(k(P,n.id)||"")])})})})()})]})]}):(0,De.jsx)("section",{className:"rounded-2xl border border-slate-800 bg-slate-900/60 shadow-xl overflow-hidden",children:((e,t,n)=>{const r=c||l[0],i=D[r]||{total:Number(null!==(e=v[r])&&void 0!==e?e:0),hitsCount:0,progress:0,reachedOrders:new Set,scanByOrder:new Map},{total:s,hitsCount:o,progress:a,reachedOrders:u,scanByOrder:d}=i,h=Array.from({length:s},(e,t)=>`P${t+1}`),f=h.map((e,t)=>{var n,i,s;const o=t+1,a=d.get(o),l=null===y||void 0===y||null===(n=y[A])||void 0===n||null===(i=n[r])||void 0===i||null===(s=i[o])||void 0===s?void 0:s.temp,c=Number.isFinite(l)?l:Number(null===a||void 0===a?void 0:a.temp);return Number.isFinite(c)?c:null}),p=h.map((e,t)=>{var n,i,s;const o=t+1,a=d.get(o),l=null===y||void 0===y||null===(n=y[A])||void 0===n||null===(i=n[r])||void 0===i||null===(s=i[o])||void 0===s?void 0:s.humidity,c=Number.isFinite(l)?l:Number(null===a||void 0===a?void 0:a.humidity);return Number.isFinite(c)?c:null}),m=h.map((e,t)=>{var n,i;const s=null===b||void 0===b||null===(n=b[r])||void 0===n||null===(i=n.temp)||void 0===i?void 0:i[t];return Number.isFinite(s)?s:null}),w=h.map((e,t)=>{var n,i;const s=null===b||void 0===b||null===(n=b[r])||void 0===n||null===(i=n.humidity)||void 0===i?void 0:i[t];return Number.isFinite(s)?s:null}),x=g||[];return(0,De.jsxs)(De.Fragment,{children:[(0,De.jsxs)("div",{className:"px-5 py-3 border-b border-slate-800 bg-slate-900/80 flex items-center justify-between",children:[(0,De.jsxs)("div",{className:"min-w-0",children:[(0,De.jsxs)("h3",{className:"text-lg font-semibold",children:["Round: ",r]}),(0,De.jsx)("p",{className:"text-xs text-slate-400",children:"Edit criteria below. Left column shows live/status by checkpoint."})]}),(0,De.jsx)("div",{className:"flex items-center gap-2",children:(0,De.jsx)(DC,{total:s,curTemps:(null===b||void 0===b||null===(t=b[r])||void 0===t?void 0:t.temp)||[],curHums:(null===b||void 0===b||null===(n=b[r])||void 0===n?void 0:n.humidity)||[],onSave:(e,t)=>_(r,e,t)})})]}),(0,De.jsxs)("div",{className:"p-5 grid md:grid-cols-2 gap-6",children:[(0,De.jsx)(RC,{labels:h,unit:"\xb0C",series:[{name:"Organizer",color:"#a78bfa",data:m},{name:"Team",color:"#2dd4bf",data:f}],height:190}),(0,De.jsx)(RC,{labels:h,unit:"%",series:[{name:"Organizer",color:"#a78bfa",data:w},{name:"Team",color:"#2dd4bf",data:p}],height:190})]}),(0,De.jsxs)("div",{className:"px-5 pb-3",children:[(0,De.jsx)("div",{className:"relative flex items-center justify-between mb-3",children:Array.from({length:s}).map((e,t)=>{var n,i,s,o,a,l;const c=t+1,h=u.has(c),f=d.get(c),p=null===y||void 0===y||null===(n=y[A])||void 0===n||null===(i=n[r])||void 0===i||null===(s=i[c])||void 0===s?void 0:s.temp,m=null===y||void 0===y||null===(o=y[A])||void 0===o||null===(a=o[r])||void 0===a||null===(l=a[c])||void 0===l?void 0:l.humidity,g=Number.isFinite(p)?p:null===f||void 0===f?void 0:f.temp,v=Number.isFinite(m)?m:null===f||void 0===f?void 0:f.humidity;return(0,De.jsxs)("div",{className:"flex flex-col items-center w-full text-center",children:[(0,De.jsx)("div",{className:CC("w-8 h-8 rounded-full border-2 flex items-center justify-center text-[11px] font-bold transition-all shadow",h?"bg-green-400 border-emerald-300 text-black":"bg-slate-900 border-slate-600 text-slate-400"),title:h?null!==f&&void 0!==f&&f.locked?"Locked":"Unlocked":"Not scanned",children:c}),(0,De.jsx)("div",{className:"mt-1 flex items-center gap-1",children:h?(0,De.jsx)(jC,{scan:f,onReopen:()=>N(A,r,c)}):(0,De.jsx)("button",{onClick:()=>N(A,r,c),className:"text-[11px] px-2 py-0.5 rounded border border-indigo-400 text-indigo-300",children:"Open 60s"})}),(0,De.jsxs)("span",{className:"text-xs mt-1 text-slate-400 font-mono",children:["P",c]}),(0,De.jsxs)("div",{className:"text-[11px] text-slate-300 mt-1 text-center",children:[void 0!==g?`\ud83c\udf21 ${Number(g).toFixed(2)}\xb0C`:"\ud83c\udf21 -\xb0C",(0,De.jsx)("br",{}),void 0!==v?`\ud83d\udca7 ${Number(v).toFixed(2)}%`:"\ud83d\udca7 -%"]})]},c)})}),(0,De.jsx)("div",{className:"relative w-full h-[6px] bg-slate-800 rounded-full overflow-hidden",children:(0,De.jsx)("div",{className:"absolute h-full bg-gradient-to-r from-green-400 to-emerald-500 rounded-full transition-all duration-700",style:{width:`${Math.min(100,100*a)}%`}})})]}),(0,De.jsxs)("div",{className:"px-5 pb-5",children:[(0,De.jsxs)("div",{className:"rounded-lg border border-slate-800 bg-slate-900/40 p-3",children:[(0,De.jsx)("div",{className:"text-sm font-semibold text-slate-200 mb-3",children:"Professor grading for this round"}),0===x.length?(0,De.jsxs)("div",{className:"text-sm text-slate-400",children:["No MP fields defined in ",(0,De.jsx)("b",{children:"Manage Topics"})," (Mission Performance). Add them there."]}):(0,De.jsx)("div",{className:"grid gap-3",children:x.map(e=>{var t,n;const i=I(r,e.key),s=S(P,i),o=k(P,i),a=(null===P||void 0===P||null===(t=P.scoresMeta)||void 0===t||null===(n=t[i])||void 0===n?void 0:n.hash)===JSON.stringify([Number(Number(s||0).toFixed(3)),String(o||"")]);return(0,De.jsx)(OC,{title:e.label,valueFromStore:s,noteFromStore:o,onChangeValue:e=>M(i,e),onChangeNote:e=>F(i,e),onSave:()=>C(A,i),saved:a},i)})}),(0,De.jsx)("div",{className:"mt-3 flex justify-end",children:(0,De.jsx)(AC,{label:"Total for this trek",value:U(r).toFixed(2)})})]}),(0,De.jsxs)("p",{className:"mt-2 text-sm text-center text-slate-400",children:[o," / ",s," checkpoints"]})]})]})})()}),(0,De.jsxs)("div",{className:"grid sm:grid-cols-3 gap-3 text-sm",children:[(0,De.jsxs)("div",{className:"rounded-lg border border-slate-800 bg-slate-900/60 p-3",children:[(0,De.jsx)("div",{className:"text-[11px] text-slate-400",children:"Topics subtotal"}),(0,De.jsx)("div",{className:"font-semibold",children:O.manualSubtotal.toFixed(2)})]}),(0,De.jsxs)("div",{className:"rounded-lg border border-slate-800 bg-slate-900/60 p-3",children:[(0,De.jsx)("div",{className:"text-[11px] text-slate-400",children:"Mission Performance subtotal"}),(0,De.jsxs)("div",{className:"font-semibold",children:[O.avgMission.toFixed(2)," \xd7 ",(f/100).toFixed(2)," = ",O.mpWeighted.toFixed(2)]})]}),(0,De.jsxs)("div",{className:"rounded-lg border border-slate-800 bg-slate-900/60 p-3",children:[(0,De.jsx)("div",{className:"text-[11px] text-slate-400",children:"Final grade"}),(0,De.jsx)("div",{className:"font-bold text-yellow-300",children:null==O.final?"\u2014":`${O.final.toFixed(2)} / 10`})]})]})]})}function qC(e){let{rounds:t,teams:n,roundMetrics:r,buildSpeedTop:i,buildTempTop:s,buildHumTop:o}=e;const a=i(t,r,n),l=s(t,r,n),c=o(t,r,n),u=e=>Number.isFinite(e)&&null!=e?new Date(e).toLocaleString([],{year:"numeric",month:"2-digit",day:"2-digit",hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"}):"\u2014";return(0,De.jsxs)("div",{className:"space-y-6",children:[(0,De.jsxs)("div",{className:"grid md:grid-cols-3 gap-4",children:[(0,De.jsxs)("div",{className:"rounded-lg border border-slate-800 bg-slate-900/40",children:[(0,De.jsx)("div",{className:"px-3 py-2 text-sm font-semibold border-b border-slate-800",children:"Finishing order "}),(0,De.jsxs)("table",{className:"w-full text-sm",children:[(0,De.jsx)("thead",{className:"text-xs uppercase text-slate-400",children:(0,De.jsxs)("tr",{children:[(0,De.jsx)("th",{className:"px-3 py-2 text-left",children:"Team"}),(0,De.jsx)("th",{className:"px-3 py-2 text-right",children:"Wins"}),(0,De.jsx)("th",{className:"px-3 py-2 text-right",children:"Avg rank"})]})}),(0,De.jsx)("tbody",{className:"divide-y divide-slate-800",children:a.slice(0,10).map(e=>(0,De.jsxs)("tr",{children:[(0,De.jsx)("td",{className:"px-3 py-2",children:e.name}),(0,De.jsx)("td",{className:"px-3 py-2 text-right",children:e.wins}),(0,De.jsx)("td",{className:"px-3 py-2 text-right",children:e.avgRank===1/0?"\u2014":e.avgRank.toFixed(2)})]},`top:speed:${e.teamId}`))})]})]}),(0,De.jsxs)("div",{className:"rounded-lg border border-slate-800 bg-slate-900/40",children:[(0,De.jsx)("div",{className:"px-3 py-2 text-sm font-semibold border-b border-slate-800",children:"Temperature accuracy (MAE)"}),(0,De.jsxs)("table",{className:"w-full text-sm",children:[(0,De.jsx)("thead",{className:"text-xs uppercase text-slate-400",children:(0,De.jsxs)("tr",{children:[(0,De.jsx)("th",{className:"px-3 py-2 text-left",children:"Team"}),(0,De.jsx)("th",{className:"px-3 py-2 text-right",children:"Mean Absolute Error (\xb0C)"}),(0,De.jsx)("th",{className:"px-3 py-2 text-right",children:"Records"})]})}),(0,De.jsx)("tbody",{className:"divide-y divide-slate-800",children:l.slice(0,10).map(e=>(0,De.jsxs)("tr",{children:[(0,De.jsx)("td",{className:"px-3 py-2",children:e.name}),(0,De.jsx)("td",{className:"px-3 py-2 text-right",children:e.maeTemp===1/0?"\u2014":e.maeTemp.toFixed(2)}),(0,De.jsx)("td",{className:"px-3 py-2 text-right",children:e.samples})]},`top:temp:${e.teamId}`))})]})]}),(0,De.jsxs)("div",{className:"rounded-lg border border-slate-800 bg-slate-900/40",children:[(0,De.jsx)("div",{className:"px-3 py-2 text-sm font-semibold border-b border-slate-800",children:"Humidity accuracy (MAE)"}),(0,De.jsxs)("table",{className:"w-full text-sm",children:[(0,De.jsx)("thead",{className:"text-xs uppercase text-slate-400",children:(0,De.jsxs)("tr",{children:[(0,De.jsx)("th",{className:"px-3 py-2 text-left",children:"Team"}),(0,De.jsx)("th",{className:"px-3 py-2 text-right",children:"Mean Absolute Error (%RH)"}),(0,De.jsx)("th",{className:"px-3 py-2 text-right",children:"Records"})]})}),(0,De.jsx)("tbody",{className:"divide-y divide-slate-800",children:c.slice(0,10).map(e=>(0,De.jsxs)("tr",{children:[(0,De.jsx)("td",{className:"px-3 py-2",children:e.name}),(0,De.jsx)("td",{className:"px-3 py-2 text-right",children:e.maeHum===1/0?"\u2014":e.maeHum.toFixed(2)}),(0,De.jsx)("td",{className:"px-3 py-2 text-right",children:e.samples})]},`top:hum:${e.teamId}`))})]})]})]}),(0,De.jsxs)("div",{className:"rounded-lg border border-slate-800 bg-slate-900/40 overflow-hidden",children:[(0,De.jsxs)("div",{className:"px-3 py-2 text-sm font-semibold border-b border-slate-800",children:["Round completion order & times"," ",(0,De.jsx)("span",{className:"text-slate-400 text-xs",children:"(Start = first QR scan, Finished = last QR scan)"})]}),(0,De.jsx)("div",{className:"overflow-x-auto",children:(0,De.jsxs)("table",{className:"w-full text-sm",children:[(0,De.jsx)("thead",{className:"text-xs uppercase text-slate-400",children:(0,De.jsxs)("tr",{children:[(0,De.jsx)("th",{className:"px-3 py-2 text-left",children:"Round"}),(0,De.jsx)("th",{className:"px-3 py-2 text-left",children:"Team"}),(0,De.jsx)("th",{className:"px-3 py-2 text-left",children:"Start at"}),(0,De.jsx)("th",{className:"px-3 py-2 text-left",children:"Finished at"})]})}),(0,De.jsx)("tbody",{className:"divide-y divide-slate-800",children:t.map(e=>{const t=r[e];if(!t)return null;const i=n.map(e=>{var n,r;const i=null===(n=t.byTeam)||void 0===n?void 0:n[e.id],s=null!==(r=null===i||void 0===i?void 0:i.finishTimeMs)&&void 0!==r?r:null,o=((null===i||void 0===i?void 0:i.timesMs)||[]).filter(e=>Number.isFinite(e));return{t:e,st:o.length?Math.min(...o):null,ft:s}}).filter(e=>null!=e.ft).sort((e,t)=>e.ft-t.ft);return 0===i.length?(0,De.jsxs)("tr",{children:[(0,De.jsx)("td",{className:"px-3 py-2",children:e}),(0,De.jsx)("td",{className:"px-3 py-2 text-slate-400",colSpan:3,children:"\u2014 no team finished yet \u2014"})]},`cmp:none:${e}`):i.map((t,n)=>(0,De.jsxs)("tr",{children:[(0,De.jsx)("td",{className:"px-3 py-2",children:0===n?e:""}),(0,De.jsx)("td",{className:"px-3 py-2",children:t.t.name||t.t.id}),(0,De.jsx)("td",{className:"px-3 py-2",children:u(t.st)}),(0,De.jsx)("td",{className:"px-3 py-2",children:u(t.ft)})]},`cmp:${e}:${t.t.id}`))})})]})})]})]})}function BC(e){let{teams:t,manualProbes:n,liveScore:r,onClose:i}=e;return(0,De.jsxs)("div",{className:"fixed inset-0 z-50",onClick:i,children:[(0,De.jsx)("div",{className:"absolute inset-0 bg-black/50"}),(0,De.jsxs)("div",{className:"relative mx-auto mt-16 w-[95vw] max-w-6xl rounded-xl border border-slate-700 bg-slate-900 p-4 overflow-auto",onClick:e=>e.stopPropagation(),children:[(0,De.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,De.jsx)("h3",{className:"text-lg font-semibold",children:"Score Grid \u2014 Topics \xd7 Teams"}),(0,De.jsx)("button",{onClick:i,className:"px-3 py-1 rounded border border-slate-700 hover:bg-slate-800",children:"Close"})]}),(0,De.jsx)("div",{className:"overflow-auto",children:(0,De.jsxs)("table",{className:"text-sm min-w-[720px] w-full border border-slate-800 rounded-lg overflow-hidden",children:[(0,De.jsx)("thead",{className:"bg-slate-800 text-slate-300 text-xs uppercase",children:(0,De.jsxs)("tr",{children:[(0,De.jsx)("th",{className:"px-3 py-2 text-left",children:"Topic"}),t.map(e=>(0,De.jsx)("th",{className:"px-3 py-2 text-center",children:e.name||e.id},`hm:h:${e.id}`))]})}),(0,De.jsx)("tbody",{className:"divide-y divide-slate-800 bg-slate-900",children:n.map(e=>(0,De.jsxs)("tr",{children:[(0,De.jsx)("td",{className:"px-3 py-2",children:e.id}),t.map(t=>{const n=r(t,e),i=Math.round(n/10*120),s=`hsl(${i}, 60%, 22%)`,o=`hsl(${i}, 60%, 32%)`;return(0,De.jsx)("td",{className:"px-3 py-2 text-center",children:(0,De.jsx)("span",{className:"inline-block min-w-[56px] px-2 py-1 rounded-md border",style:{background:s,borderColor:o},title:n.toFixed(2),children:n.toFixed(2)})},`hm:${e.id}:${t.id}`)})]},`hm:${e.id}`))})]})})]})]})}function HC(e){let{teams:t,selectedTeamIds:n,manualProbes:r,finalGradeForTeam:i,buildRoundsUiForTeam:s,onClose:o,onClear:a}=e;const l=t.filter(e=>n.includes(e.id)),c=l.map(e=>{const t=s(e.id);return{team:e,br:i(e,t)}});return(0,De.jsxs)("div",{className:"fixed inset-0 z-50",onClick:o,children:[(0,De.jsx)("div",{className:"absolute inset-0 bg-black/50"}),(0,De.jsxs)("div",{className:"relative mx-auto mt-16 w-[95vw] max-w-6xl rounded-xl border border-slate-700 bg-slate-900 p-4 overflow-auto",onClick:e=>e.stopPropagation(),children:[(0,De.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,De.jsxs)("h3",{className:"text-lg font-semibold",children:["Compare \u2014 ",c.length," teams"]}),(0,De.jsxs)("div",{className:"flex items-center gap-2",children:[(0,De.jsx)("button",{onClick:o,className:"px-3 py-1 rounded border border-slate-700 hover:bg-slate-800 text-sm",children:"Close"}),(0,De.jsx)("button",{onClick:a,className:"px-3 py-1 rounded border border-slate-700 hover:bg-slate-800 text-sm",children:"Clear selection"})]})]}),c.length<2?(0,De.jsxs)("div",{className:"text-sm text-slate-300",children:["Select at least two teams from Teams tab and press ",(0,De.jsx)("b",{children:"Compare"}),"."]}):(0,De.jsx)("div",{className:"overflow-auto",children:(0,De.jsxs)("table",{className:"text-sm min-w-[880px] w-full border border-slate-800 rounded-lg overflow-hidden",children:[(0,De.jsx)("thead",{className:"bg-slate-800 text-slate-300 text-xs uppercase tracking-wide",children:(0,De.jsxs)("tr",{children:[(0,De.jsx)("th",{className:"px-3 py-2 text-left",children:"Metric"}),c.map(e=>{let{team:t}=e;return(0,De.jsx)("th",{className:"px-3 py-2 text-center",children:t.name||t.id},`cmp:h:${t.id}`)})]})}),(0,De.jsxs)("tbody",{className:"divide-y divide-slate-800 bg-slate-900",children:[(0,De.jsx)("tr",{children:(0,De.jsx)("td",{colSpan:1+c.length,className:"px-3 py-2 text-[11px] uppercase tracking-wider text-slate-400 bg-slate-900/70",children:"Topics"})}),r.map((e,t)=>(0,De.jsxs)("tr",{children:[(0,De.jsxs)("td",{className:"px-3 py-2",children:[(0,De.jsxs)("span",{className:"font-semibold",children:["Topic ",t+1,":"]})," ",(0,De.jsx)("span",{className:"font-medium",children:e.id})," ",Number(e.weight)?(0,De.jsxs)("span",{className:"text-slate-400",children:["(",Number(e.weight),"%)"]}):null]}),c.map(t=>{let{team:n}=t;const r=(t=>{const r=null===(t=n.scores)||void 0===t?void 0:t[e.id];if(Array.isArray(e.columns)&&e.columns.length>0){const t=e.columns.map(e=>{const t=null===r||void 0===r?void 0:r[e.key];let n=parseFloat(String(null!==t&&void 0!==t?t:"").replace(",","."));return Number.isNaN(n)&&(n=0),Math.max(0,Math.min(10,n))});return t.length?t.reduce((e,t)=>e+t,0)/t.length:0}let i=parseFloat(String(null!==r&&void 0!==r?r:"").replace(",","."));return Number.isNaN(i)&&(i=0),Math.max(0,Math.min(10,i))})();return(0,De.jsx)("td",{className:"px-3 py-2 text-center",title:r.toFixed(2),children:r.toFixed(2)},`cmp:topic:${e.id}:${n.id}`)})]},`cmp:topic:${e.id}`)),(0,De.jsxs)("tr",{className:"border-t border-slate-800",children:[(0,De.jsx)("td",{className:"px-3 py-2 font-semibold text-teal-300",children:"Topics subtotal"}),c.map(e=>{let{br:t,team:n}=e;return(0,De.jsx)("td",{className:"px-3 py-2 text-center font-semibold text-teal-300",children:t.manualSubtotal.toFixed(2)},`cmp:topics-sub:${n.id}`)})]}),(0,De.jsxs)("tr",{className:"text-teal-300 font-bold",children:[(0,De.jsx)("td",{className:"px-3 py-2",children:"Mission Performance (avg, prof)"}),c.map(e=>{let{br:t,team:n}=e;return(0,De.jsx)("td",{className:"px-3 py-2 text-center",children:t.avgMission.toFixed(2)},`cmp:mp:${n.id}`)})]}),(0,De.jsxs)("tr",{className:"bg-slate-900/60",children:[(0,De.jsx)("td",{className:"px-3 py-2 font-bold",children:"Final grade"}),c.map(e=>{let{br:t,team:n}=e;return(0,De.jsx)("td",{className:"px-3 py-2 text-center font-bold text-yellow-300",children:null==t.final?"\u2014":t.final.toFixed(2)},`cmp:final:${n.id}`)})]})]})]})})]})]})}function WC(e){let{onClose:t,rounds:n,teams:r,roundMetrics:i,buildSpeedTop:s,buildTempTop:o,buildHumTop:a}=e;const l=s(n,i,r),c=o(n,i,r),u=a(n,i,r);return(0,De.jsxs)("div",{className:"fixed inset-0 z-50",onClick:t,children:[(0,De.jsx)("div",{className:"absolute inset-0 bg-black/50"}),(0,De.jsxs)("div",{className:"relative mx-auto mt-16 w-[95vw] max-w-6xl rounded-xl border border-slate-700 bg-slate-900 p-4 overflow-auto",onClick:e=>e.stopPropagation(),children:[(0,De.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,De.jsx)("h3",{className:"text-lg font-semibold",children:"Benchmarks (for grading)"}),(0,De.jsx)("button",{onClick:t,className:"px-3 py-1 rounded border border-slate-700 hover:bg-slate-800 text-sm",children:"Close"})]}),(0,De.jsxs)("div",{className:"grid md:grid-cols-3 gap-4",children:[(0,De.jsxs)("div",{className:"rounded-lg border border-slate-800 bg-slate-900/40",children:[(0,De.jsx)("div",{className:"px-3 py-2 text-sm font-semibold border-b border-slate-800",children:"Finish order (global)"}),(0,De.jsxs)("table",{className:"w-full text-sm",children:[(0,De.jsx)("thead",{className:"text-xs uppercase text-slate-400",children:(0,De.jsxs)("tr",{children:[(0,De.jsx)("th",{className:"px-3 py-2 text-left",children:"Team"}),(0,De.jsx)("th",{className:"px-3 py-2 text-right",children:"Wins"}),(0,De.jsx)("th",{className:"px-3 py-2 text-right",children:"Avg rank"})]})}),(0,De.jsx)("tbody",{className:"divide-y divide-slate-800",children:l.slice(0,10).map(e=>(0,De.jsxs)("tr",{children:[(0,De.jsx)("td",{className:"px-3 py-2",children:e.name}),(0,De.jsx)("td",{className:"px-3 py-2 text-right",children:e.wins}),(0,De.jsx)("td",{className:"px-3 py-2 text-right",children:e.avgRank===1/0?"\u2014":e.avgRank.toFixed(2)})]},`top:speed:${e.teamId}`))})]})]}),(0,De.jsxs)("div",{className:"rounded-lg border border-slate-800 bg-slate-900/40",children:[(0,De.jsx)("div",{className:"px-3 py-2 text-sm font-semibold border-b border-slate-800",children:"Temperature accuracy (MAE)"}),(0,De.jsxs)("table",{className:"w-full text-sm",children:[(0,De.jsx)("thead",{className:"text-xs uppercase text-slate-400",children:(0,De.jsxs)("tr",{children:[(0,De.jsx)("th",{className:"px-3 py-2 text-left",children:"Team"}),(0,De.jsx)("th",{className:"px-3 py-2 text-right",children:"Mean Absolute Error (\xb0C)"}),(0,De.jsx)("th",{className:"px-3 py-2 text-right",children:"Samples"})]})}),(0,De.jsx)("tbody",{className:"divide-y divide-slate-800",children:c.slice(0,10).map(e=>(0,De.jsxs)("tr",{children:[(0,De.jsx)("td",{className:"px-3 py-2",children:e.name}),(0,De.jsx)("td",{className:"px-3 py-2 text-right",children:e.maeTemp===1/0?"\u2014":e.maeTemp.toFixed(2)}),(0,De.jsx)("td",{className:"px-3 py-2 text-right",children:e.samples})]},`top:temp:${e.teamId}`))})]})]}),(0,De.jsxs)("div",{className:"rounded-lg border border-slate-800 bg-slate-900/40",children:[(0,De.jsx)("div",{className:"px-3 py-2 text-sm font-semibold border-b border-slate-800",children:"Humidity accuracy (MAE)"}),(0,De.jsxs)("table",{className:"w-full text-sm",children:[(0,De.jsx)("thead",{className:"text-xs uppercase text-slate-400",children:(0,De.jsxs)("tr",{children:[(0,De.jsx)("th",{className:"px-3 py-2 text-left",children:"Team"}),(0,De.jsx)("th",{className:"px-3 py-2 text-right",children:"Mean Absolute Error (%RH)"}),(0,De.jsx)("th",{className:"px-3 py-2 text-right",children:"Records"})]})}),(0,De.jsx)("tbody",{className:"divide-y divide-slate-800",children:u.slice(0,10).map(e=>(0,De.jsxs)("tr",{children:[(0,De.jsx)("td",{className:"px-3 py-2",children:e.name}),(0,De.jsx)("td",{className:"px-3 py-2 text-right",children:e.maeHum===1/0?"\u2014":e.maeHum.toFixed(2)}),(0,De.jsx)("td",{className:"px-3 py-2 text-right",children:e.samples})]},`top:hum:${e.teamId}`))})]})]})]}),(0,De.jsxs)("div",{className:"mt-6 rounded-lg border border-slate-800 bg-slate-900/40 overflow-hidden",children:[(0,De.jsx)("div",{className:"px-3 py-2 text-sm font-semibold border-b border-slate-800",children:"First finisher by round (with time)"}),(0,De.jsxs)("table",{className:"w-full text-sm",children:[(0,De.jsx)("thead",{className:"text-xs uppercase text-slate-400",children:(0,De.jsxs)("tr",{children:[(0,De.jsx)("th",{className:"px-3 py-2 text-left",children:"Round"}),(0,De.jsx)("th",{className:"px-3 py-2 text-left",children:"Team"}),(0,De.jsx)("th",{className:"px-3 py-2 text-left",children:"Finished at"})]})}),(0,De.jsx)("tbody",{className:"divide-y divide-slate-800",children:n.map(e=>{const t=i[e];if(!t)return null;const n=r.map(e=>{var n,r,i;return{t:e,ft:null!==(n=null===(r=t.byTeam)||void 0===r||null===(i=r[e.id])||void 0===i?void 0:i.finishTimeMs)&&void 0!==n?n:null}}).filter(e=>null!=e.ft).sort((e,t)=>e.ft-t.ft),s=n[0];return(0,De.jsxs)("tr",{children:[(0,De.jsx)("td",{className:"px-3 py-2",children:e}),(0,De.jsx)("td",{className:"px-3 py-2",children:s?s.t.name||s.t.id:"\u2014"}),(0,De.jsx)("td",{className:"px-3 py-2",children:s?(o=s.ft,Number.isFinite(o)&&null!=o?new Date(o).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"}):"\u2014"):"\u2014"})]},`first:${e}`);var o})})]})]})]})]})}const KC=e=>{if(null==e)return 0;const t="number"===typeof e?e:parseFloat(String(e).replace(",","."));return(e=>Math.max(0,Math.min(10,e)))(Number.isFinite(t)?t:0)},GC=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter(Boolean).join(" ")},QC=e=>String(e||"").toLowerCase().trim().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"");const YC=(e,t)=>`MP:${e}:${t}`;function XC(e){let{title:t,subtitle:n,right:r}=e;return(0,De.jsxs)("div",{className:"flex items-center justify-between gap-4 px-6 py-4 border-b border-slate-800/80 bg-gradient-to-r from-slate-950 to-slate-900/40",children:[(0,De.jsxs)("div",{children:[(0,De.jsx)("h2",{className:"text-lg sm:text-xl font-semibold tracking-tight text-slate-100",children:t}),n?(0,De.jsx)("p",{className:"text-sm text-slate-400",children:n}):null]}),r]})}function JC(e){let{label:t,value:n,hint:r,tone:i="neutral"}=e;return(0,De.jsxs)("div",{className:GC("rounded-xl bg-slate-900/70 border p-4 shadow-sm",{neutral:"border-slate-800 text-slate-200",success:"border-emerald-500/20 text-emerald-300",warning:"border-amber-500/20 text-amber-300",danger:"border-rose-500/20 text-rose-300",accent:"border-indigo-500/20 text-indigo-300"}[i]),children:[(0,De.jsx)("div",{className:"text-xs uppercase tracking-wide text-slate-400",children:t}),(0,De.jsx)("div",{className:"mt-1 text-2xl font-semibold",children:n}),r?(0,De.jsx)("div",{className:"mt-1 text-xs text-slate-500",children:r}):null]})}function ZC(e){let{value:t=0}=e;const n=Math.max(0,Math.min(100,10*t)),r=`conic-gradient(${t>=8?"#34d399":t>=5?"#f59e0b":"#f87171"} ${n}%, rgba(148,163,184,.25) ${n}% 100%)`;return(0,De.jsxs)("div",{className:"inline-grid place-items-center w-14 h-14 relative",children:[(0,De.jsx)("div",{className:"w-14 h-14 rounded-full",style:{background:r,boxShadow:"inset 0 0 0 6px rgba(15,23,42,.95)"},"aria-hidden":"true"}),(0,De.jsx)("div",{className:"absolute text-[11px] leading-none text-slate-200 font-semibold",children:t.toFixed(1)})]})}function eN(){const{currentUser:e}=AE(),[t,n]=(0,i.useState)(null),[r,s]=(0,i.useState)(null),[o,a]=(0,i.useState)([]),[l,c]=(0,i.useState)({}),[u,d]=(0,i.useState)({}),[h,f]=(0,i.useState)({}),[p,m]=(0,i.useState)([]),[g,v]=(0,i.useState)(20),[y,b]=(0,i.useState)([]);(0,i.useEffect)(()=>{if(!e)return;let t=null;return(async r=>{const i=(null===(r=(await Gb(Hy(ET,"users",e.uid))).data())||void 0===r?void 0:r.teamId)||null;n(i),i&&(t=t_(Hy(ET,"teams",i),e=>s(e.data()||{})))})(),()=>t&&t()},[e]),(0,i.useEffect)(()=>{(async()=>{const e=(await Yb(By(ET,"rounds"))).docs.map(e=>({id:e.id,...e.data()}));a(e.map(e=>e.id));const t={};e.forEach(e=>{var n,r,i;const s=null!==(n=null!==(r=e.totalCheckpoints)&&void 0!==r?r:null===(i=e.checkpoints)||void 0===i?void 0:i.totalCheckpoints)&&void 0!==n?n:0;t[e.id]=Number(s)||0}),c(t)})()},[]),(0,i.useEffect)(()=>{0!==o.length&&(async()=>{const e={};for(const t of o){const n=Rb(By(ET,"checkpoints"),Ob("roundId","==",t),Ob("isActive","==",!0)),r=await Yb(n);e[t]=r.docs.map(e=>({id:e.id,...e.data()})).sort((e,t)=>Number(e.order)-Number(t.order))}d(e)})()},[o]),(0,i.useEffect)(()=>{if(!t)return;const e=[];let n={},i={};const s=()=>{const e={};for(const t of[n,i])Object.entries(t).forEach(t=>{let[n,r]=t;e[n]||(e[n]=[]),e[n].push(...r)});f(e)};return e.push(t_(Rb(By(ET,"scans"),Ob("teamId","==",t)),e=>{const t={};e.forEach(e=>{const n=e.data();null!==n&&void 0!==n&&n.roundId&&(t[n.roundId]||(t[n.roundId]=[]),t[n.roundId].push(n))}),n=t,s()})),null!==r&&void 0!==r&&r.name&&e.push(t_(Rb(By(ET,"scans"),Ob("teamId","==",r.name)),e=>{const t={};e.forEach(e=>{const n=e.data();null!==n&&void 0!==n&&n.roundId&&(t[n.roundId]||(t[n.roundId]=[]),t[n.roundId].push(n))}),i=t,s()})),()=>e.forEach(e=>e&&e())},[t,null===r||void 0===r?void 0:r.name]),(0,i.useEffect)(()=>{(async()=>{const e=await Yb(By(ET,"probes")),t=[];let n=20,r=[];e.forEach(e=>{const i=e.id,s=e.data()||{};if("Mission Performance"===i){const e=Number(s.weight);Number.isFinite(e)&&(n=e),r=function(e){const t=new Set;return(Array.isArray(e)?e:[]).map(e=>{if(!e)return null;if("string"===typeof e)return{key:QC(e),label:e};const t=(e.label||e.name||e.title||e.key||"").trim(),n=QC(e.key||t),r=Number(e.weight);if(!t||!n)return null;const i={key:n,label:t};return Number.isFinite(r)&&(i.weight=r),i}).filter(e=>e&&!t.has(e.key)&&(t.add(e.key),!0))}(s.columns)}else{var o;t.push({id:i,weight:Number(null!==(o=s.weight)&&void 0!==o?o:0)||0,columns:Array.isArray(s.columns)?s.columns:[]})}}),t.sort((e,t)=>e.id.localeCompare(t.id)),m(t),v(n),b(r)})()},[]);const _=(0,i.useMemo)(()=>o.map(e=>{var t;const n=(u[e]||[]).slice(),r=h[e]||[],i=new Map(n.map(e=>[e.id,Number(e.order)])),s=new Set(r.map(e=>i.get(e.cpId)).filter(e=>Number.isFinite(e))),o=new Map,a=new Map;for(const l of r){var c,d;const e=i.get(l.cpId);Number.isFinite(e)&&(void 0!==l.temp&&o.set(e,null!==(c=l.temp)&&void 0!==c?c:"\u2013"),void 0!==l.humidity&&a.set(e,null!==(d=l.humidity)&&void 0!==d?d:"\u2013"))}const f=Number(null!==(t=l[e])&&void 0!==t?t:0)||0,p=Array.from(s).filter(e=>e>=1&&e<=f).length;return{roundId:e,total:f,hitsCount:p,progress:f?p/f:0,reachedOrders:s,tempByOrder:o,humByOrder:a}}),[o,u,h,l]),w=e=>{if(!r)return null;const t=y||[];if(0===t.length)return null;const n=t.some(e=>Number(e.weight)>0);if(!n){const n=[];let s=!1;for(const o of t){var i;const t=null===r||void 0===r||null===(i=r.scores)||void 0===i?void 0:i[YC(e,o.key)];(0===t||"0"===t||""!==String(null!==t&&void 0!==t?t:"").trim())&&(s=!0),n.push(KC(t))}return s&&n.length?n.reduce((e,t)=>e+t,0)/n.length:null}const s=t.reduce((e,t)=>e+(Number(t.weight)||0),0)||1;let o=0,a=!1;for(const c of t){var l;const t=null===r||void 0===r||null===(l=r.scores)||void 0===l?void 0:l[YC(e,c.key)];(0===t||"0"===t||""!==String(null!==t&&void 0!==t?t:"").trim())&&(a=!0);o+=KC(t)*((Number(c.weight)||0)/s)}return a?o:null},x=o.map(e=>{const t=w(e);return Number.isFinite(t)?t:0}),S=o.length?x.reduce((e,t)=>e+t,0)/o.length:0,k=p.map((e,t)=>{var n;const i=null===r||void 0===r||null===(n=r.scores)||void 0===n?void 0:n[e.id],s=Array.isArray(e.columns)?e.columns:[],o=s.some(e=>Number(e.weight)>0),a=s.length>0?o?(()=>{const e=s.reduce((e,t)=>e+(Number(t.weight)||0),0)||1;return s.reduce((t,n)=>t+KC(null===i||void 0===i?void 0:i[n.key])*((Number(n.weight)||0)/e),0)})():(()=>{const e=s.map(e=>KC(null===i||void 0===i?void 0:i[e.key]));return e.length?e.reduce((e,t)=>e+t,0)/e.length:0})():KC(i);return{index:t+1,probe:e.id,weight:Number(e.weight||0),score:a,weighted:a*(Number(e.weight||0)/100),columns:s}}),T=k.reduce((e,t)=>e+t.weighted,0),E=S*(Number(g)/100),C=Number(g)+p.reduce((e,t)=>e+Number(t.weight||0),0),N=100===C?T+E:null;if(!t||!r)return(0,De.jsxs)("div",{className:"min-h-screen bg-slate-950 text-white",children:[(0,De.jsx)(RE,{}),(0,De.jsx)("div",{className:"max-w-7xl mx-auto px-6 py-12",children:(0,De.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,De.jsx)("div",{className:"h-9 w-64 bg-slate-800/60 rounded"}),(0,De.jsx)("div",{className:"h-32 w-full bg-slate-800/30 rounded-xl"}),(0,De.jsx)("div",{className:"h-80 w-full bg-slate-800/30 rounded-xl"})]})})]});const I=r.name||t;return(0,De.jsxs)("div",{className:"min-h-screen bg-slate-950 text-white",children:[(0,De.jsx)(RE,{}),(0,De.jsx)("main",{className:"max-w-7xl mx-auto px-6 py-8",children:(0,De.jsx)("div",{className:"rounded-2xl p-[1px] bg-gradient-to-r from-indigo-500/40 via-slate-700/30 to-emerald-500/40 shadow-2xl",children:(0,De.jsxs)("section",{className:"rounded-2xl bg-slate-900/70 backdrop-blur-xl border border-slate-800/80 overflow-hidden",children:[(0,De.jsxs)("div",{className:"px-6 pt-5 pb-4 border-b border-slate-800/80",children:[(0,De.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,De.jsxs)("div",{children:[(0,De.jsxs)("h1",{className:"text-2xl sm:text-3xl font-bold tracking-tight",children:["Team Dashboard \u2014 ",(0,De.jsx)("span",{className:"text-indigo-300",children:I})]}),(0,De.jsxs)("div",{className:"mt-1 text-sm text-slate-400",children:["Weights: ",(0,De.jsxs)("b",{children:[g,"%"]})," MP +"," ",(0,De.jsxs)("b",{children:[Math.max(0,C-g),"%"]})," Topics",100!==C&&(0,De.jsxs)("span",{className:"ml-2 text-amber-300",children:["(sum is ",C,"%, should be 100%)"]})]})]}),(0,De.jsxs)("div",{className:"hidden md:flex items-center gap-2",children:[(0,De.jsx)("span",{className:"px-2.5 py-1 rounded-full text-xs ring-1 ring-slate-700 text-slate-300",children:"Read-only"}),(0,De.jsx)("span",{className:"px-2.5 py-1 rounded-full text-xs ring-1 ring-indigo-500/30 text-indigo-300 bg-indigo-500/10",children:"Live"})]})]}),(0,De.jsxs)("div",{className:"grid sm:grid-cols-3 gap-4 mt-5",children:[(0,De.jsx)(JC,{label:"Topics subtotal",value:T.toFixed(2),hint:"Sum of weighted topics",tone:"success"}),(0,De.jsx)(JC,{label:"Mission Performance ",value:`${S.toFixed(2)} \xd7 ${(g/100).toFixed(2)} = ${E.toFixed(2)}`,hint:"Per-round mean over ALL rounds (ungraded rounds = 0)",tone:"accent"}),(0,De.jsx)(JC,{label:"Final grade",value:null==N?"\u2014":`${N.toFixed(2)} / 10`,hint:null==N?"Weights must sum to 100%":"Computed in real time",tone:null==N?"warning":"neutral"})]})]}),(0,De.jsx)(XC,{title:"Mission Performance",subtitle:"Checkpoints are informational only. MP grade comes solely from organizer-scored fields."}),(0,De.jsxs)("div",{className:"px-6 py-6",children:[0===_.length?(0,De.jsx)("div",{className:"text-slate-400 text-sm",children:"No rounds configured yet."}):null,_.map((e,t)=>{let{roundId:n,total:i,hitsCount:s,progress:o,reachedOrders:a,tempByOrder:l,humByOrder:c}=e;return(0,De.jsxs)("div",{className:GC("mb-6 rounded-xl p-4 border",t%2?"bg-slate-900/50":"bg-slate-900/30","border-slate-800/80"),children:[(0,De.jsx)("div",{className:"flex items-center justify-between mb-3",children:(0,De.jsx)("div",{className:"text-sm font-medium text-slate-300",children:n})}),(0,De.jsx)("div",{className:"relative flex items-center justify-between mb-3",children:Array.from({length:i}).map((e,t)=>{const n=t+1,r=a.has(n),i=l.get(n),s=c.get(n);return(0,De.jsxs)("div",{className:"flex flex-col items-center w-full text-center group",children:[(0,De.jsx)("div",{className:GC("w-8 h-8 rounded-full border-2 flex items-center justify-center text-[11px] font-bold transition-all shadow ring-1",r?"bg-emerald-400 border-emerald-300 text-black ring-emerald-600/30":"bg-slate-900 border-slate-600 text-slate-400 ring-slate-700/30 group-hover:ring-indigo-500/30"),title:r?"Reached":"Not reached",children:n}),(0,De.jsxs)("span",{className:"text-[10px] mt-1 text-slate-400 font-mono",children:["P",n]}),(0,De.jsxs)("div",{className:"text-[10px] text-slate-400 mt-1 leading-tight",children:[void 0!==i?`\ud83c\udf21 ${i}\xb0C`:"\ud83c\udf21 \u2014",(0,De.jsx)("br",{}),void 0!==s?`\ud83d\udca7 ${s}%`:"\ud83d\udca7 \u2014"]})]},n)})}),(0,De.jsx)("div",{className:"relative w-full h-[6px] bg-slate-800 rounded-full overflow-hidden",children:(0,De.jsx)("div",{className:"absolute inset-y-0 left-0 bg-gradient-to-r from-emerald-400 to-emerald-600 transition-[width] duration-700",style:{width:`${Math.min(100,100*o)}%`}})}),(0,De.jsxs)("p",{className:"mt-2 text-sm text-slate-400 text-center",children:[s," / ",i," checkpoints"]}),(0,De.jsxs)("div",{className:"mt-4 rounded-lg border border-slate-800 bg-slate-900/40 p-3",children:[(0,De.jsx)("div",{className:"text-sm font-semibold text-slate-200 mb-3",children:"Topics"}),0===y.length?(0,De.jsxs)("div",{className:"text-sm text-slate-400",children:["No MP fields defined in ",(0,De.jsx)("b",{children:"Manage Topics"}),"."]}):(0,De.jsx)("div",{className:"grid gap-3",children:y.map(e=>{var t,i,s;const o=YC(n,e.key),a=null===r||void 0===r||null===(t=r.scores)||void 0===t?void 0:t[o],l=""===String(null!==a&&void 0!==a?a:"")?null:KC(a),c=(null===r||void 0===r||null===(i=r.scoresNotes)||void 0===i||null===(s=i[o])||void 0===s?void 0:s.text)||"",u=null!==l||""!==c.trim();return(0,De.jsxs)("div",{className:"rounded-md border border-slate-800 bg-slate-900/60 p-3",children:[(0,De.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,De.jsx)("div",{className:"text-slate-200 font-medium",children:e.label}),(0,De.jsx)("div",{className:"shrink-0",children:null===l?(0,De.jsx)("span",{className:"px-2 py-1 text-xs rounded bg-slate-800 text-slate-400 ring-1 ring-slate-700",children:"\u2014"}):(0,De.jsxs)("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 rounded-full text-sm ring-1 ring-slate-700 bg-slate-900/60",children:[(0,De.jsx)("span",{className:"text-xs text-slate-400",children:"score"}),(0,De.jsx)("span",{className:"font-semibold text-slate-100",children:l.toFixed(2)}),(0,De.jsx)("span",{className:"opacity-60 text-slate-400 text-xs",children:"/10"})]})})]}),u&&""!==c.trim()?(0,De.jsx)("div",{className:"mt-2 text-sm text-slate-300 whitespace-pre-wrap",children:c}):null]},o)})}),(0,De.jsx)("div",{className:"mt-3 flex justify-end",children:(0,De.jsxs)("div",{className:"rounded-lg border border-slate-700 bg-slate-800/50 px-3 py-1.5 text-sm",children:[(0,De.jsx)("span",{className:"text-slate-400 mr-2",children:"Total score for this track"}),(0,De.jsx)("span",{className:"font-semibold text-slate-100",children:(()=>{const e=w(n);return null==e?"\u2014":e.toFixed(2)})()})]})})]})]},n)}),_.length>0&&(0,De.jsxs)("div",{className:"mt-4 text-center",children:[(0,De.jsx)("span",{className:"text-sm text-slate-400",children:"Average MP score (prof)"})," ",(0,De.jsxs)("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 rounded-full text-sm ring-1 ring-indigo-500/30 text-indigo-200 bg-indigo-500/10 font-semibold",children:[S.toFixed(2)," ",(0,De.jsx)("span",{className:"opacity-70",children:"/10"})]}),(0,De.jsxs)("div",{className:"text-xs text-slate-500 mt-1",children:["Per-round mean over ",(0,De.jsx)("b",{children:"all"})," rounds; ungraded rounds count as 0."]})]})]}),(0,De.jsx)(XC,{title:"Topics",subtitle:"Summary of topics scores from judges.",right:null}),(0,De.jsxs)("div",{className:"px-6 pb-8 pt-5",children:[(0,De.jsx)("div",{className:"overflow-x-auto rounded-xl border border-slate-800/80",children:(0,De.jsxs)("table",{className:"table-fixed min-w-[1100px] w-full text-sm",children:[(0,De.jsx)("thead",{className:"bg-slate-900/80 text-slate-300 text-xs uppercase",children:(0,De.jsxs)("tr",{children:[(0,De.jsx)("th",{className:"w-10 px-3 py-3 text-left",children:"#"}),(0,De.jsx)("th",{className:"w-48 px-3 py-3 text-left",children:"Topic"}),(0,De.jsx)("th",{className:"w-24 px-3 py-3 text-center",children:"Weight %"}),(0,De.jsx)("th",{className:"w-[580px] px-3 py-3 text-left",children:"Fields"}),(0,De.jsx)("th",{className:"w-32 px-3 py-3 text-center",children:"Topic score"}),(0,De.jsx)("th",{className:"w-28 px-3 py-3 text-center",children:"Weighted"})]})}),(0,De.jsx)("tbody",{className:"divide-y divide-slate-800 bg-slate-950/40",children:k.map((e,t)=>{var n;const i=p.find(t=>t.id===e.probe)||{columns:[]},s=i.columns||[],o=s.length>0,a=e.weighted,l=e.score;return(0,De.jsxs)("tr",{className:GC("align-top",t%2?"bg-slate-900/40":"bg-transparent","hover:bg-slate-900/70 transition-colors"),children:[(0,De.jsx)("td",{className:"py-3 px-3",children:e.index}),(0,De.jsx)("td",{className:"py-3 px-3 font-medium text-slate-200",children:e.probe}),(0,De.jsx)("td",{className:"py-3 px-3 text-center",children:e.weight}),(0,De.jsx)("td",{className:"py-3 px-3",children:o?(0,De.jsxs)("div",{className:"space-y-2",children:[s.map(t=>{var n,i;const s=KC(null===r||void 0===r||null===(n=r.scores)||void 0===n||null===(i=n[e.probe])||void 0===i?void 0:i[t.key]);return(0,De.jsxs)("div",{className:"flex items-center justify-between",children:[(0,De.jsxs)("span",{className:"text-slate-300",children:[t.label,Number(t.weight)?` (${Number(t.weight)}%)`:""]}),(0,De.jsx)("span",{className:"font-semibold text-slate-200",children:s.toFixed(2)})]},t.key)}),(0,De.jsxs)("div",{className:"flex items-center justify-end gap-2 text-sm text-slate-400",children:[(0,De.jsx)("span",{children:"Avg:"}),(0,De.jsx)("span",{className:"font-semibold text-slate-200",children:l.toFixed(2)})]})]}):(0,De.jsxs)("div",{className:"flex items-center justify-between",children:[(0,De.jsx)("span",{className:"text-slate-300",children:"Score"}),(0,De.jsx)("span",{className:"font-semibold text-slate-200",children:KC(null===r||void 0===r||null===(n=r.scores)||void 0===n?void 0:n[e.probe]).toFixed(2)})]})}),(0,De.jsx)("td",{className:"py-3 px-3 text-center",children:(0,De.jsx)(ZC,{value:l})}),(0,De.jsx)("td",{className:"py-3 px-3 text-center",children:(0,De.jsxs)("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 rounded-full ring-1 ring-slate-700 bg-slate-900/60",children:[(0,De.jsx)("span",{className:"text-xs text-slate-400",children:"w"}),(0,De.jsx)("span",{className:"font-semibold text-slate-100",children:Number.isFinite(a)?a.toFixed(2):"0.00"})]})})]},e.probe)})}),(0,De.jsx)("tfoot",{children:(0,De.jsxs)("tr",{className:"border-t border-slate-800 bg-slate-900/80",children:[(0,De.jsx)("td",{colSpan:5,className:"py-3 px-3 text-right font-semibold",children:"Topics subtotal"}),(0,De.jsx)("td",{className:"py-3 px-3 text-center",children:(0,De.jsx)("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 rounded-full bg-emerald-500/15 text-emerald-300 ring-1 ring-emerald-500/30 font-semibold",children:T.toFixed(2)})})]})})]})}),(0,De.jsxs)("div",{className:"mt-5 grid gap-2 text-sm max-w-2xl ml-auto",children:[(0,De.jsxs)("div",{className:"flex justify-between",children:[(0,De.jsx)("span",{className:"text-slate-300",children:"Mission Performance average"}),(0,De.jsxs)("span",{className:"font-semibold text-emerald-300",children:[S.toFixed(2)," \xd7 ",(g/100).toFixed(2)," = ",E.toFixed(2)]})]}),(0,De.jsxs)("div",{className:"flex justify-between border-t border-slate-800 pt-2 text-base",children:[(0,De.jsx)("span",{className:"font-semibold",children:"Final grade"}),null==N?(0,De.jsx)("span",{className:"font-bold text-amber-300",children:"\u2014 (weights must sum to 100%)"}):(0,De.jsxs)("span",{className:"font-bold text-yellow-300",children:[N.toFixed(2)," / 10"]})]})]})]})]})})})]})}const tN="https://spaceengineeringchallenge.web.app";function nN(){const[e,t]=(0,i.useState)(!1),[n,r]=(0,i.useState)(!1),[s,o]=(0,i.useState)(""),a=ee(),l=(()=>{const e="undefined"!==typeof process&&{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}&&({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_URL||{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.APP_URL)||"";return e||("undefined"!==typeof window?window.location.origin.includes("localhost")?tN:window.location.origin:tN)})();(0,i.useEffect)(()=>{const e=TT.currentUser;e&&o(e.email||"")},[]);return(0,De.jsx)("div",{className:"min-h-screen bg-slate-900 text-white flex items-center justify-center px-4",children:(0,De.jsxs)("div",{className:"bg-slate-800 p-8 rounded-xl shadow-md w-full max-w-md text-center",children:[(0,De.jsx)("h1",{className:"text-2xl font-bold mb-3",children:"Verify your email"}),(0,De.jsxs)("p",{className:"text-slate-300 mb-6",children:["We sent a verification link to"," ",(0,De.jsx)("span",{className:"text-white font-semibold",children:s}),". Open the link from your inbox (or spam), then press ",(0,De.jsx)("b",{children:"\u201cI verified\u201d"}),"."]}),(0,De.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,De.jsx)("button",{onClick:async()=>{const e=TT.currentUser;if(e){r(!0);try{var t;if(await e.reload(),!e.emailVerified)return void TE("Not verified yet.");const n=Hy(ET,"users",e.uid),r=await Gb(n);if(!r.exists())return void a("/login");const i=r.data();if("pending_team"===i.role&&null!==(t=i.pendingTeam)&&void 0!==t&&t.teamId){const{teamId:e,teamName:t,members:r}=i.pendingTeam;return await Xb(Hy(ET,"teams",e),{name:t,members:Array.isArray(r)?r:[],checkpointsReached:0,totalCheckpoints:7,scores:{}},{merge:!0}),await Jb(n,{role:"team",teamId:e,emailVerified:!0,status:"active",pendingTeam:o_()}),TE.success("Email verified. Team created!"),void a("/team")}if("pending_professor"===i.role)return await Jb(n,{emailVerified:!0,status:"active"}),TE.success("Email verified. Awaiting professor approval."),void a("/dashboard");await Jb(n,{emailVerified:!0,status:"active"}),TE.success("Email verified."),a("/dashboard")}finally{r(!1)}}else TE.error("You are not signed in. Please login again.")},disabled:n,className:"bg-emerald-600 hover:bg-emerald-700 px-4 py-2 rounded-md font-semibold transition disabled:opacity-60",children:n?"Checking\u2026":"I verified"}),(0,De.jsx)("button",{onClick:async()=>{const e=TT.currentUser;if(e){t(!0);try{try{TT.languageCode="en"}catch{}await ys(e,{url:`${l}/verify-email`,handleCodeInApp:!0}),TE.success("Verification email sent. Please check your inbox/spam.")}catch(NT){console.error("sendEmailVerification error:",NT),TE.error((n=null===NT||void 0===NT?void 0:NT.code,r=null===NT||void 0===NT?void 0:NT.message,{"auth/too-many-requests":"Too many requests. Please wait a bit and try again.","auth/invalid-continue-uri":"The redirect URL is not allowed. Add it to Firebase Authentication \u2192 Settings \u2192 Authorized domains.","auth/missing-continue-uri":"Missing redirect URL for the email action.","auth/user-token-expired":"Session expired. Please sign in again and retry.","auth/user-not-found":"User not found. Please sign in again.","auth/network-request-failed":"Network error. Check your connection and try again."}[n]||r||"Could not send email now."))}finally{t(!1)}var n,r}else TE.error("You are not signed in. Please login and try again.")},disabled:e,className:"bg-slate-700 hover:bg-slate-600 px-4 py-2 rounded-md font-semibold transition disabled:opacity-60",children:e?"Sending\u2026":"Resend verification email"})]}),(0,De.jsx)("p",{className:"mt-6 text-sm text-slate-400",children:"If you created the account on mobile, open the link in the same device\u2019s browser."})]})})}function rN(e){let{children:t}=e;const{currentUser:n,loading:r}=AE();return r?(0,De.jsx)("div",{className:"text-center mt-10",children:"Loading..."}):n?t:(0,De.jsx)(me,{to:"/login"})}const iN="Mission Performance";function sN(e){let{yesLabel:t="Da",noLabel:n="Nu"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise(r=>{uC(i=>(0,De.jsxs)("div",{className:"space-y-2",children:[(0,De.jsx)("div",{className:"font-medium",children:e}),(0,De.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,De.jsx)("button",{onClick:()=>{r(!0),uC.dismiss(i.id)},className:"px-3 py-1 rounded-md bg-indigo-600 hover:bg-indigo-500 text-white text-sm",children:t}),(0,De.jsx)("button",{onClick:()=>{r(!1),uC.dismiss(i.id)},className:"px-3 py-1 rounded-md bg-slate-700 hover:bg-slate-600 text-white text-sm",children:n})]})]}),{autoClose:!1,closeOnClick:!1})})}async function oN(e){const t=await Yb(By(ET,"teams"));let n=a_(ET),r=0;const i=[];for(const s of t.docs){const t=e(s);t&&(n.update(Hy(ET,"teams",s.id),t),r++,r>=450&&(i.push(n.commit()),n=a_(ET),r=0))}i.push(n.commit()),await Promise.all(i)}const aN=()=>{try{const e=new Uint8Array(16);return crypto.getRandomValues(e),Array.from(e).map(e=>e.toString(16).padStart(2,"0")).join("")}catch{return Math.random().toString(36).slice(2)+Math.random().toString(36).slice(2)}},lN=e=>(e||"col").toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"")+"-"+Math.random().toString(36).slice(2,6);async function cN(e,t){const n=Rb(By(ET,"checkpoints"),Ob("roundId","==",e)),r=await Yb(n),i=new Map;r.docs.forEach(e=>{const t=e.data()||{},n=Number(t.order);Number.isFinite(n)&&i.set(n,{id:e.id,isActive:!0===t.isActive,hasSecret:!!t.secret})});for(let s=1;s<=t;s++){const t=i.get(s);if(t){const e={};t.isActive||(e.isActive=!0),t.hasSecret||(e.secret=aN()),Object.keys(e).length&&await Jb(Hy(ET,"checkpoints",t.id),e)}else await e_(By(ET,"checkpoints"),{roundId:e,order:s,isActive:!0,secret:aN(),createdAt:new Date})}for(const[s,o]of i.entries())s>t&&o.isActive&&await Jb(Hy(ET,"checkpoints",o.id),{isActive:!1})}function uN(){const e=ee(),[t,n]=(0,i.useState)([]),[r,s]=(0,i.useState)({}),[o,a]=(0,i.useState)({}),[l,c]=(0,i.useState)({}),[u,d]=(0,i.useState)({}),[h,f]=(0,i.useState)({}),[p,m]=(0,i.useState)([]),[g,v]=(0,i.useState)({}),[y,b]=(0,i.useState)({}),[_,w]=(0,i.useState)(""),[x,S]=(0,i.useState)({}),[k,T]=(0,i.useState)(""),E=Object.values(l).reduce((e,t)=>e+(parseInt(t)||0),0),C=parseInt(l[iN])||0,N=Math.max(0,E-C);(0,i.useEffect)(()=>{(async()=>{const e=await Yb(By(ET,"probes")),t=[],r={},i={};let o=!1;e.docs.forEach(e=>{var n;const s=e.id,a=e.data()||{},l=Number(null!==(n=a.weight)&&void 0!==n?n:0),c=Array.isArray(a.columns)&&a.columns.length?a.columns:[{key:"score",label:"Score"}];r[s]=Number.isFinite(l)?l:0,t.push(s),i[s]={weight:r[s],columns:c},s===iN&&(o=!0)}),o||(await Xb(Hy(ET,"probes",iN),{weight:20,createdAt:new Date,columns:[{key:"score",label:"Score"}]},{merge:!0}),r[iN]=20,t.push(iN),i[iN]={weight:20,columns:[{key:"score",label:"Score"}]});const a=t.filter(e=>e!==iN).sort((e,t)=>e.localeCompare(t));n([iN,...a]),c(r),d(r),s(i);const l=(await Yb(By(ET,"rounds"))).docs.map(e=>({id:e.id,...e.data()})),u=l.map(e=>e.id);m(u);const h={};l.forEach(e=>h[e.id]=Number(e.totalCheckpoints||5)),v(h),b(h)})()},[]);return(0,De.jsxs)("div",{className:"min-h-screen bg-slate-950 text-slate-100",children:[(0,De.jsx)(_C,{position:"top-center"}),(0,De.jsxs)("header",{className:"bg-slate-900 border-b border-slate-800",children:[(0,De.jsx)("div",{className:"px-3 py-3",children:(0,De.jsx)("button",{onClick:()=>e("/professor"),className:"text-slate-300 hover:text-white px-2 py-1 rounded border border-transparent hover:border-slate-600",children:"\u2190 Back"})}),(0,De.jsx)("div",{className:"max-w-6xl mx-auto px-6 pb-3",children:(0,De.jsx)("h1",{className:"text-xl font-semibold tracking-tight",children:"Manage Topics and Attempts"})})]}),(0,De.jsxs)("main",{className:"max-w-6xl mx-auto px-6 py-6 space-y-8",children:[(0,De.jsxs)("section",{children:[(0,De.jsx)("h2",{className:"text-lg font-semibold",children:"Configuration"}),(0,De.jsx)("p",{className:"text-slate-400",children:"Set topics names and weights. Mission Performance is name-locked; you can change its weight and now also its fields (columns)."})]}),(0,De.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2 justify-end",children:[(0,De.jsx)("input",{type:"text",placeholder:"New topic name",value:k,onChange:e=>T(e.target.value),className:"bg-slate-900 px-3 py-2 rounded-md border border-slate-700 focus:border-slate-500 outline-none text-sm w-full sm:w-72"}),(0,De.jsx)("button",{onClick:async()=>{await(async()=>{const e=k.trim();if(!e||e===iN)return void uC.error("Nume invalid.");if(t.includes(e))return void uC.error("Exist\u0103 deja o prob\u0103 cu acest nume.");if(!await sN(`Adaugi proba \u201e${e}\u201d?`,{yesLabel:"Adaug\u0103",noLabel:"Anuleaz\u0103"}))return void uC.info("Ad\u0103ugarea probei a fost anulat\u0103");const r=[{key:"score",label:"Score"}];await Xb(Hy(ET,"probes",e),{createdAt:new Date,weight:0,columns:r},{merge:!0}),await Xb(Hy(ET,"probeWeights",e),{weight:0},{merge:!0});try{await oN(()=>({[`scores.${e}`]:0}))}catch{}n(t=>{const n=[...t.filter(e=>e!==iN),e].sort((e,t)=>e.localeCompare(t));return[iN,...n]}),c(t=>({...t,[e]:0})),d(t=>({...t,[e]:0})),s(t=>({...t,[e]:{weight:0,columns:r}})),T(""),uC.success("Proba a fost ad\u0103ugat\u0103")})()},className:"px-3 py-2 rounded-md bg-emerald-600 hover:bg-emerald-500 text-white font-medium text-sm",children:"Add"})]}),(0,De.jsxs)("section",{className:"mt-2",children:[(0,De.jsxs)("div",{className:"rounded-lg border border-slate-800 overflow-hidden",children:[(0,De.jsxs)("div",{className:"hidden md:grid bg-slate-900 grid-cols-[56px_1fr_minmax(220px,_auto)_minmax(240px,_auto)] text-xs uppercase tracking-wider text-slate-400 px-4 py-2",children:[(0,De.jsx)("div",{children:"#"}),(0,De.jsx)("div",{children:" Topics"}),(0,De.jsx)("div",{children:"Weight"}),(0,De.jsx)("div",{className:"text-right",children:"Actions"})]}),(0,De.jsx)("div",{className:"divide-y divide-slate-800",children:t.map((e,i)=>{var p,m,g,v;const y=(null!==e&&void 0!==e?e:"").trim()===iN,b=(null!==(p=o[e])&&void 0!==p?p:e).trim(),_=null!==(m=l[e])&&void 0!==m?m:"",w=!y&&b!==e,x=(null!==(g=u[e])&&void 0!==g?g:0)!==(parseInt(_)||0),S=(null===(v=r[e])||void 0===v?void 0:v.columns)||[{key:"score",label:"Score"}];return(0,De.jsxs)("div",{className:"bg-slate-950 hover:bg-slate-900/60 transition-colors",children:[(0,De.jsxs)("div",{className:"grid gap-3 px-4 py-3 grid-cols-1 md:grid-cols-[56px_1fr_minmax(220px,_auto)_minmax(240px,_auto)]",children:[(0,De.jsxs)("div",{className:"text-slate-400 md:place-self-center",children:[i+1,"."]}),(0,De.jsx)("div",{className:"flex items-center gap-2 min-w-0",children:y?(0,De.jsxs)(De.Fragment,{children:[(0,De.jsx)("span",{className:"font-medium truncate",children:e}),(0,De.jsx)("span",{className:"text-[11px] px-2 py-0.5 rounded bg-slate-800 text-amber-300 shrink-0 border border-slate-700",children:"locked"})]}):(0,De.jsxs)(De.Fragment,{children:[(0,De.jsx)("input",{value:b,onChange:t=>a(n=>({...n,[e]:t.target.value})),className:"flex-1 min-w-0 bg-slate-950 rounded-md px-3 py-2 outline-none border border-slate-700 focus:border-slate-500 text-sm truncate",placeholder:"Probe name"}),(0,De.jsx)("button",{onClick:()=>(async e=>{var r,i;if(e===iN)return void uC.error("Mission Performance nu poate fi redenumit\u0103.");const l=(null!==(r=o[e])&&void 0!==r?r:"").trim();if(!l||l===e)return;if(t.includes(l))return void uC.error("Exist\u0103 deja o prob\u0103 cu acest nume.");if(!await sN(`Redenume\u0219ti proba \u201e${e}\u201d \xeen \u201e${l}\u201d?`))return void uC.info("Redenumirea a fost anulat\u0103");const u=await Gb(Hy(ET,"probes",e)),d=u.exists()&&null!==(i=u.data().weight)&&void 0!==i?i:0,h=u.exists()&&Array.isArray(u.data().columns)?u.data().columns:[{key:"score",label:"Score"}];await Xb(Hy(ET,"probes",l),{createdAt:new Date,weight:d,columns:h},{merge:!0}),await Xb(Hy(ET,"probeWeights",l),{weight:d},{merge:!0});try{await oN(t=>{var n;const r=(null===(n=t.data())||void 0===n?void 0:n.scores)||{};return Object.prototype.hasOwnProperty.call(r,e)?{[`scores.${l}`]:r[e],[`scores.${e}`]:o_()}:null})}catch{}await Zb(Hy(ET,"probes",e)),await Zb(Hy(ET,"probeWeights",e)),n(t=>{const n=t.map(t=>t===e?l:t),r=n.filter(e=>e!==iN).sort((e,t)=>e.localeCompare(t));return[iN,...r]}),c(t=>{const n={...t};return n[l]=n[e],delete n[e],n}),s(t=>{const n={...t};return n[l]=n[e],delete n[e],n}),a(t=>{const n={...t};return delete n[e],n}),uC.success("Numele probei a fost actualizat")})(e),disabled:!w,className:"px-3 py-2 rounded-md text-sm font-medium shrink-0 "+(w?"bg-indigo-600 hover:bg-indigo-500 text-white":"bg-slate-800 text-slate-400 cursor-not-allowed border border-slate-700"),children:"Save name"})]})}),(0,De.jsxs)("div",{className:"flex items-center gap-2",children:[(0,De.jsx)("input",{type:"text",inputMode:"numeric",pattern:"[0-9]*",value:_,onChange:t=>{let n=(t.target.value||"").replace(/\D/g,"");n.length>3&&(n=n.slice(0,3));const r=Math.min(100,Number(n||0));c(t=>({...t,[e]:isNaN(r)?"":r}))},className:"w-24 text-center bg-slate-950 rounded-md px-3 py-2 outline-none border border-slate-700 focus:border-slate-500 text-sm"}),(0,De.jsx)("span",{className:"text-slate-400 shrink-0 text-sm",children:"%"})]}),(0,De.jsxs)("div",{className:"flex items-center gap-2 justify-end flex-wrap",children:[(0,De.jsx)("button",{onClick:()=>(async e=>{const t=parseInt(l[e])||0,n=Object.entries(l).reduce((n,r)=>{let[i,s]=r;return n+(i===e?t:parseInt(s)||0)},0);if(100!==n)return void uC.error(`Suma ponderilor trebuie s\u0103 fie 100%. Ar fi ${n}%.`);await sN(`Salvezi ponderea pentru \u201e${e}\u201d la ${t}%?`,{yesLabel:"Salveaz\u0103",noLabel:"Anuleaz\u0103"})?(await Xb(Hy(ET,"probes",e),{weight:t},{merge:!0}),await Xb(Hy(ET,"probeWeights",e),{weight:t},{merge:!0}),d(n=>({...n,[e]:t})),s(n=>({...n,[e]:{...n[e]||{},weight:t}})),uC.success("Pondere salvat\u0103")):uC.info("Salvarea ponderii a fost anulat\u0103")})(e),disabled:!x,className:"px-3 py-2 rounded-md text-sm font-medium shrink-0 "+(x?"bg-blue-600 hover:bg-blue-500 text-white":"bg-slate-800 text-slate-400 cursor-not-allowed border border-slate-700"),children:"Save weight"}),(0,De.jsx)("button",{onClick:async()=>{const t=!h[e];await sN(t?`Deschizi editorul de coloane pentru \u201e${b}\u201d?`:`\xcenchizi editorul de coloane pentru \u201e${b}\u201d?`,{yesLabel:t?"Deschide":"\xcenchide",noLabel:"Anuleaz\u0103"})?(f(n=>({...n,[e]:t})),uC.info(t?"Editor coloane deschis":"Editor coloane \xeenchis")):uC.info("Ac\u021biunea a fost anulat\u0103")},className:"px-3 py-2 rounded-md bg-slate-800 hover:bg-slate-700 text-white text-sm font-medium shrink-0",children:h[e]?"Hide":"Columns"}),!y&&(0,De.jsx)("button",{onClick:()=>(async e=>{if(e===iN)return void uC.error("Nu po\u021bi \u0219terge Mission Performance.");if(await sN(`\u0218tergi proba \u201e${e}\u201d?`)){await Zb(Hy(ET,"probes",e)),await Zb(Hy(ET,"probeWeights",e));try{await oN(()=>({[`scores.${e}`]:o_()}))}catch{}n(t=>t.filter(t=>t!==e)),c(t=>{const n={...t};return delete n[e],n}),s(t=>{const n={...t};return delete n[e],n}),uC.success("Proba a fost \u0219tears\u0103")}else uC.info("\u0218tergerea a fost anulat\u0103")})(e),className:"px-3 py-2 rounded-md bg-rose-600 hover:bg-rose-500 text-white text-sm font-medium shrink-0",children:"Delete"})]})]}),h[e]&&(0,De.jsx)("div",{className:"px-6 pb-4",children:(0,De.jsxs)("div",{className:"rounded-md border border-slate-800 bg-slate-900/40 p-3",children:[(0,De.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,De.jsxs)("div",{className:"text-slate-300 font-medium",children:["Columns for ",b]}),(0,De.jsxs)("div",{className:"flex gap-2",children:[(0,De.jsx)("button",{onClick:()=>(async e=>{await sN(`Adaugi o coloan\u0103 nou\u0103 la \u201e${e}\u201d?`,{yesLabel:"Adaug\u0103",noLabel:"Anuleaz\u0103"})?s(t=>{const n=t[e]||{columns:[]},r=[...n.columns||[],{key:lN("criterion"),label:"Criterion"}];return uC.success("Coloan\u0103 ad\u0103ugat\u0103"),{...t,[e]:{...n,columns:r}}}):uC.info("Ad\u0103ugarea coloanei a fost anulat\u0103")})(e),className:"px-3 py-2 rounded-md bg-emerald-600 hover:bg-emerald-500 text-white text-sm",children:"+ Add column"}),(0,De.jsx)("button",{onClick:()=>(async e=>{var t;const n=(null===(t=r[e])||void 0===t?void 0:t.columns)||[{key:"score",label:"Score"}];await sN(`Salvezi coloanele pentru \u201e${e}\u201d?`,{yesLabel:"Salveaz\u0103",noLabel:"Anuleaz\u0103"})?(await Xb(Hy(ET,"probes",e),{columns:n},{merge:!0}),uC.success("Coloanele au fost salvate")):uC.info("Salvarea coloanelor a fost anulat\u0103")})(e),className:"px-3 py-2 rounded-md bg-indigo-600 hover:bg-indigo-500 text-white text-sm",children:"Save columns"})]})]}),(0,De.jsxs)("div",{className:"space-y-2",children:[S.map((t,n)=>(0,De.jsxs)("div",{className:"flex items-center gap-2",children:[(0,De.jsx)("input",{value:t.label,onChange:t=>((e,t,n)=>{s(r=>{const i=r[e]||{columns:[]},s=[...i.columns||[]],o=s[t]||{key:lN(n),label:n};return s[t]={...o,label:n},{...r,[e]:{...i,columns:s}}})})(e,n,t.target.value),className:"flex-1 bg-slate-950 rounded-md px-3 py-2 outline-none border border-slate-700 focus:border-slate-500 text-sm"}),(0,De.jsx)("button",{onClick:()=>(async(e,t)=>{var n;const i=((null===(n=r[e])||void 0===n?void 0:n.columns)||[])[t],o=(null===i||void 0===i?void 0:i.label)||"coloan\u0103";await sN(`\u0218tergi \u201e${o}\u201d din \u201e${e}\u201d?`,{yesLabel:"\u0218terge",noLabel:"Anuleaz\u0103"})?s(n=>{const r=n[e]||{columns:[]},i=[...r.columns||[]];return i.splice(t,1),uC.success("Coloan\u0103 \u0219tears\u0103"),{...n,[e]:{...r,columns:i}}}):uC.info("\u0218tergerea coloanei a fost anulat\u0103")})(e,n),className:"px-3 py-2 rounded-md bg-slate-800 hover:bg-slate-700 text-white text-sm",children:"Remove"})]},t.key)),0===S.length&&(0,De.jsx)("div",{className:"text-sm text-slate-400",children:"No columns \u2014 scorul pe prob\u0103 nu va putea fi introdus."})]})]})})]},e)})})]}),(0,De.jsxs)("div",{className:"mt-4 text-sm "+(100===E?"text-emerald-400":"text-rose-400"),children:["Topics: ",(0,De.jsxs)("b",{children:[N,"%"]})," + Mission Performance: ",(0,De.jsxs)("b",{children:[C,"%"]})," ="," ",(0,De.jsxs)("b",{children:[E,"%"]})," \u2014 trebuie s\u0103 fie ",(0,De.jsx)("b",{children:"100%"}),"."]})]}),(0,De.jsxs)("section",{className:"rounded-lg border border-slate-800 overflow-hidden",children:[(0,De.jsx)("div",{className:"px-4 py-3 border-b border-slate-800 bg-slate-900 text-center",children:(0,De.jsx)("h3",{className:"font-semibold",children:"\ud83d\udccd Manage Checkpoints per Attempts"})}),(0,De.jsx)("div",{className:"divide-y divide-slate-800",children:p.map(e=>{var t,n,r,i;const s=null!==(t=null!==(n=y[e])&&void 0!==n?n:g[e])&&void 0!==t?t:0,o=Number(s)!==Number(null!==(r=g[e])&&void 0!==r?r:0),a=(null!==(i=x[e])&&void 0!==i?i:e).trim(),l=a!==e;return(0,De.jsxs)("div",{className:"px-4 py-3 flex items-center gap-3 flex-wrap",children:[(0,De.jsxs)("div",{className:"flex-1 min-w-[260px] font-medium flex items-center gap-2",children:[(0,De.jsx)("span",{className:"inline-flex h-8 w-8 items-center justify-center rounded-md bg-slate-800 border border-slate-700",children:"\ud83c\udfc1"}),(0,De.jsx)("input",{value:a,onChange:t=>S(n=>({...n,[e]:t.target.value})),className:"flex-1 min-w-0 bg-slate-950 rounded-md px-3 py-2 outline-none border border-slate-700 focus:border-slate-500 text-sm truncate",placeholder:"Round name"}),(0,De.jsx)("button",{onClick:()=>(async e=>{var t,n;const r=(null!==(t=x[e])&&void 0!==t?t:"").trim();if(!r||r===e)return;if(p.includes(r))return void uC.error("Exist\u0103 deja o rund\u0103 cu acest nume.");if(!await sN(`Redenume\u0219ti runda \u201e${e}\u201d \xeen \u201e${r}\u201d?`))return void uC.info("Redenumirea a fost anulat\u0103");const i=await Gb(Hy(ET,"rounds",e)),s=i.exists()?i.data():{totalCheckpoints:Number(null!==(n=g[e])&&void 0!==n?n:0)};await Xb(Hy(ET,"rounds",r),{...s,updatedAt:new Date},{merge:!0});const o=Rb(By(ET,"checkpoints"),Ob("roundId","==",e)),a=await Yb(o),l=[];a.docs.forEach(e=>{l.push(Jb(Hy(ET,"checkpoints",e.id),{roundId:r}))}),await Promise.all(l),await Zb(Hy(ET,"rounds",e)),m(t=>t.map(t=>t===e?r:t)),v(t=>{const n={...t};return n[r]=n[e],delete n[e],n}),b(t=>{const n={...t};return n[r]=n[e],delete n[e],n}),S(t=>{const n={...t};return delete n[e],n}),uC.success("Numele rundei a fost actualizat")})(e),disabled:!l,className:"px-3 py-2 rounded-md text-sm font-medium shrink-0 "+(l?"bg-indigo-600 hover:bg-indigo-500 text-white":"bg-slate-800 text-slate-400 cursor-not-allowed border border-slate-700"),children:"Save name"})]}),(0,De.jsxs)("div",{className:"flex items-center gap-2",children:[(0,De.jsx)("input",{type:"text",inputMode:"numeric",value:s,onChange:t=>{let n=(t.target.value||"").replace(/\D/g,"");n.length>2&&(n=n.slice(0,2));const r=Math.max(0,Math.min(50,Number(n||0)));b(t=>({...t,[e]:r}))},className:"w-20 text-center bg-slate-950 rounded-md px-3 py-2 outline-none border border-slate-700 focus:border-slate-500 text-sm"}),(0,De.jsx)("span",{className:"text-slate-400 text-sm",children:"checkpoints"})]}),(0,De.jsxs)("div",{className:"ml-auto flex items-center gap-2",children:[(0,De.jsx)("button",{onClick:()=>(async e=>{let t=Number(y[e]);(!Number.isFinite(t)||t<0)&&(t=0),t>50&&(t=50),await sN(`Salvezi num\u0103rul de checkpoints pentru \u201e${e}\u201d la ${t}?`,{yesLabel:"Salveaz\u0103",noLabel:"Anuleaz\u0103"})?(await Xb(Hy(ET,"rounds",e),{totalCheckpoints:t,updatedAt:new Date},{merge:!0}),await cN(e,t),v(n=>({...n,[e]:t})),b(n=>({...n,[e]:t})),uC.success("Num\u0103rul de checkpoints a fost salvat")):uC.info("Salvarea num\u0103rului de checkpoints a fost anulat\u0103")})(e),disabled:!o,className:"px-3 py-2 rounded-md text-sm font-medium "+(o?"bg-slate-700 hover:bg-slate-600 text-white":"bg-slate-800 text-slate-400 cursor-not-allowed border border-slate-700"),children:"Save"}),(0,De.jsx)("button",{onClick:()=>(async e=>{if(!await sN(`\u0218tergi runda \u201e${e}\u201d? Checkpoint-urile vor fi dezactivate.`))return void uC.info("\u0218tergerea a fost anulat\u0103");const t=Rb(By(ET,"checkpoints"),Ob("roundId","==",e)),n=await Yb(t),r=[];n.docs.forEach(e=>{r.push(Jb(Hy(ET,"checkpoints",e.id),{isActive:!1}))}),await Promise.all(r),await Zb(Hy(ET,"rounds",e)),m(t=>t.filter(t=>t!==e)),v(t=>{const n={...t};return delete n[e],n}),b(t=>{const n={...t};return delete n[e],n}),uC.success("Runda a fost \u0219tears\u0103")})(e),className:"px-3 py-2 rounded-md bg-rose-600 hover:bg-rose-500 text-white text-sm font-medium",children:"Delete"})]})]},e)})}),(0,De.jsxs)("div",{className:"px-4 py-3 border-t border-slate-800 flex items-center gap-2",children:[(0,De.jsx)("input",{type:"text",placeholder:"New round name",value:_,onChange:e=>w(e.target.value),className:"flex-1 bg-slate-950 rounded-md px-3 py-2 outline-none border border-slate-700 focus:border-slate-500 text-sm"}),(0,De.jsx)("button",{onClick:async()=>{await(async()=>{const e=_.trim();if(!e)return void uC.error("Scrie un nume de rund\u0103.");if(p.includes(e))return void uC.error("Exist\u0103 deja o rund\u0103 cu acest nume.");if(!await sN(`Adaugi runda \u201e${e}\u201d?`,{yesLabel:"Adaug\u0103",noLabel:"Anuleaz\u0103"}))return void uC.info("Ad\u0103ugarea rundei a fost anulat\u0103");await Xb(Hy(ET,"rounds",e),{totalCheckpoints:6,createdAt:new Date},{merge:!0}),await cN(e,6),m(t=>[...t,e]),v(t=>({...t,[e]:6})),b(t=>({...t,[e]:6})),w(""),uC.success("Rund\u0103 ad\u0103ugat\u0103")})()},className:"px-3 py-2 rounded-md bg-fuchsia-600 hover:bg-fuchsia-500 text-white text-sm font-medium",children:"+ Add"})]})]})]})]})}function dN(e){let{children:t}=e;const{userData:n,loading:r}=AE();return r?null:"admin"!==(null===n||void 0===n?void 0:n.role)?(0,De.jsx)(me,{to:"/dashboard",replace:!0}):t}function hN(e){let{children:t}=e;const{userData:n,loading:r}=AE();return r?null:"professor"!==(null===n||void 0===n?void 0:n.role)?(0,De.jsx)(me,{to:"/dashboard",replace:!0}):t}const fN=function(){return(0,De.jsx)(Ee,{children:(0,De.jsxs)(ye,{children:[(0,De.jsx)(ge,{path:"/",element:(0,De.jsx)(Oe,{})}),(0,De.jsx)(ge,{path:"/login",element:(0,De.jsx)(EE,{})}),(0,De.jsx)(ge,{path:"/signup",element:(0,De.jsx)(NE,{})}),(0,De.jsx)(ge,{path:"/manage-probes",element:(0,De.jsx)(uN,{})}),(0,De.jsx)(ge,{path:"/verify-email",element:(0,De.jsx)(rN,{children:(0,De.jsx)(nN,{})})}),(0,De.jsx)(ge,{path:"/dashboard",element:(0,De.jsx)(rN,{children:(0,De.jsx)(DE,{})})}),(0,De.jsx)(ge,{path:"/team",element:(0,De.jsx)(rN,{children:(0,De.jsx)(eN,{})})}),(0,De.jsx)(ge,{path:"/professor",element:(0,De.jsx)(rN,{children:(0,De.jsx)(hN,{children:(0,De.jsx)(LC,{})})})}),(0,De.jsx)(ge,{path:"/admin",element:(0,De.jsx)(rN,{children:(0,De.jsx)(dN,{children:(0,De.jsx)(OE,{})})})})]})})};o.createRoot(document.getElementById("root")).render((0,De.jsxs)(PE,{children:[(0,De.jsx)(kE,{position:"top-center"}),(0,De.jsx)(fN,{})]}))})();
//# sourceMappingURL=main.d2b2e823.js.map